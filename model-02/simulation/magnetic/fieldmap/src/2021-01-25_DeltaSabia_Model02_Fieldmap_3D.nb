(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    346113,       7486]
NotebookOptionsPosition[    334579,       7263]
NotebookOutlinePosition[    334952,       7279]
CellTagsIndexPosition[    334909,       7276]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Delta Sabia (last update: 25/01/21)", "Title",
 CellChangeTimes->{{3.681300194179221*^9, 3.6813002033832407`*^9}, {
   3.681305983976405*^9, 3.6813059853359213`*^9}, {3.6813176225703306`*^9, 
   3.6813176235079107`*^9}, {3.6813177175941257`*^9, 3.68131771915676*^9}, {
   3.708272177122472*^9, 3.708272189394394*^9}, {3.708272239370994*^9, 
   3.708272253185425*^9}, {3.7247626663439655`*^9, 3.724762668594143*^9}, 
   3.724763762181196*^9, {3.725974849294973*^9, 3.725974857279992*^9}, {
   3.7316800228814087`*^9, 3.7316800249126425`*^9}, {3.731761928333893*^9, 
   3.731761928740137*^9}, {3.7377345647344294`*^9, 3.7377345664687967`*^9}, {
   3.737994165253688*^9, 3.7379941653786864`*^9}, {3.7489625392900763`*^9, 
   3.7489625531505637`*^9}, {3.749318816981333*^9, 3.749318817559469*^9}, {
   3.7656382216793394`*^9, 3.7656382261328287`*^9}, {3.7662401432029853`*^9, 
   3.766240154985159*^9}, {3.7663282678653297`*^9, 3.766328270484855*^9}, {
   3.766331146283388*^9, 3.7663311568355923`*^9}, {3.7663982782306576`*^9, 
   3.7663982795028768`*^9}, {3.7664037488989267`*^9, 
   3.7664037535714073`*^9}, {3.76675425955847*^9, 3.766754260902328*^9}, {
   3.767446029232342*^9, 3.7674460297011285`*^9}, {3.7675176217294626`*^9, 
   3.767517621841589*^9}, {3.7685471006341314`*^9, 3.7685471031625986`*^9}, {
   3.782651674525923*^9, 3.7826516762290554`*^9}, {3.7827472341594315`*^9, 
   3.7827472344406757`*^9}, {3.7845390971377993`*^9, 
   3.7845390993098416`*^9}, {3.7846213628789454`*^9, 
   3.7846213635508842`*^9}, {3.784971285415371*^9, 3.784971285852929*^9}, {
   3.80003815573755*^9, 3.8000381597687845`*^9}, {3.8049514458306084`*^9, 
   3.804951448440013*^9}, {3.8062446719465714`*^9, 3.8062446751540537`*^9}, {
   3.811791929593967*^9, 3.8117919321569138`*^9}, {3.8117920042649097`*^9, 
   3.811792032147236*^9}, {3.8118211262516327`*^9, 3.8118211320157013`*^9}, {
   3.811821179647152*^9, 3.8118211867633*^9}, {3.811860188752576*^9, 
   3.811860258482793*^9}, {3.811993829198284*^9, 3.811993830379608*^9}, {
   3.812527211310811*^9, 3.812527222117728*^9}, {3.812606129475505*^9, 
   3.8126061346758695`*^9}, {3.8136661285689297`*^9, 
   3.8136661439784617`*^9}, {3.813666203027869*^9, 3.81366621078681*^9}, {
   3.8140077054911613`*^9, 3.8140077058612165`*^9}, {3.8157444601701145`*^9, 
   3.815744485115374*^9}, {3.8159135249298954`*^9, 3.815913527874877*^9}, {
   3.8160829516889467`*^9, 3.816082959653524*^9}, {3.816084844383486*^9, 
   3.8160848526688385`*^9}, {3.819099771529953*^9, 3.8190997841007185`*^9}, {
   3.8199874177798595`*^9, 3.81998742196014*^9}, {3.8200640099715233`*^9, 
   3.8200640101014977`*^9}, {3.8201328050621567`*^9, 
   3.8201328054521856`*^9}, {3.8202199532315683`*^9, 3.820219953313529*^9}, {
   3.82031867430654*^9, 3.8203186744365473`*^9}, {3.8205719314428616`*^9, 
   3.820571931562842*^9}},ExpressionUUID->"6afd2076-4493-4f08-b468-\
fa4711877d85"],

Cell[CellGroupData[{

Cell["Functions", "Chapter",
 CellChangeTimes->{{3.8118211945703535`*^9, 
  3.811821216548972*^9}},ExpressionUUID->"d737e070-6f97-4607-ac28-\
30ab012a12aa"],

Cell[CellGroupData[{

Cell["Load Radia", "Section",
 CellChangeTimes->{{3.766397988602113*^9, 3.766398000439457*^9}, {
  3.784905891255539*^9, 
  3.7849058937557244`*^9}},ExpressionUUID->"0e22e4d4-c6dd-44c6-aced-\
c34f7308122d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"<<", "Radia`"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RadPlot3DOptions", "[", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6818148953014574`*^9, 3.6818148962234063`*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[2]:=",ExpressionUUID->"3eccabbd-bb9c-4e0e-b532-6f6408da7c58"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Radia Version: \"\>", "\[InvisibleSpace]", "4.31`", 
   "\[InvisibleSpace]", "\<\" is loaded\"\>"}],
  SequenceForm["Radia Version: ", 4.31, " is loaded"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820572706326028*^9, 3.8205731185622883`*^9},
 CellLabel->
  "During evaluation of \
In[2]:=",ExpressionUUID->"679f2714-c812-4c73-94fc-c1e7d62bde46"],

Cell[BoxData["\<\"Radia is copyright ESRF, France.\"\>"], "Print",
 CellChangeTimes->{3.820572706326028*^9, 3.8205731185622883`*^9},
 CellLabel->
  "During evaluation of \
In[2]:=",ExpressionUUID->"97c5c2ac-84d7-47d8-ad61-a2254c3025fd"],

Cell[BoxData["\<\"Portions copyright Synchrotron SOLEIL, France.\"\>"], \
"Print",
 CellChangeTimes->{3.820572706326028*^9, 3.820573118572209*^9},
 CellLabel->
  "During evaluation of \
In[2]:=",ExpressionUUID->"321f5d75-0acb-4ab8-a4c2-57203c95bbca"],

Cell[BoxData["\<\"Portions copyright Wolfram Research, Inc.\"\>"], "Print",
 CellChangeTimes->{3.820572706326028*^9, 3.820573118572209*^9},
 CellLabel->
  "During evaluation of \
In[2]:=",ExpressionUUID->"3dcd0ec8-62a1-4db7-ae90-26ad438fd92f"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Delta", "Section",
 CellChangeTimes->{{3.7663980194296393`*^9, 
  3.7663980316884046`*^9}},ExpressionUUID->"3b9f4df9-b498-4bb2-a855-\
8df473489a1f"],

Cell[CellGroupData[{

Cell["IDDelta", "Subsection",
 CellChangeTimes->{{3.766754518453103*^9, 3.766754525359883*^9}, {
  3.767534951344644*^9, 3.767534995136586*^9}, {3.7826516660103407`*^9, 
  3.7826516661978397`*^9}},ExpressionUUID->"edd14911-287c-45ca-b6c8-\
e5cb4d8bede9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IDDelta", "::", "usage"}], "=", 
    "\"\<IDDelta[\[Lambda]u, Np, Br, Gap, Len1, Len2, Len3, \
\\\"\[Delta]P\\\":0, \\\"\[Delta]GV\\\":0, \\\"\[Delta]GH\\\":0, \
\\\"\[Delta]CP\\\":0, \\\"BlockGap\\\":0, \\\"Termination\\\":\\\"None\\\", \
\\\"BlockShape\\\"\[Rule] \\\"DeltaSabia\\\", \\\"BlockSubdivision\\\"\[Rule] \
\\\"None\\\"]: Returns the ID model. \\n\\nArgs: \\n\[Lambda]u [mm] is the ID \
period, \\nNp is the number of periods, \\nBr [T] is the remanent \
magnetization of the permanent magnet blocks, \\nGap [mm] is the length of \
the minimum gap between the cassettes. \\n\\nOptional args: \\n\[Delta]P \
[mm], \[Delta]GV [mm], \[Delta]GH [mm] and \[Delta]CP [mm] are four types of \
longitudinal movements between the cassettes, \[Delta]P is the phase \
adjustement, \[Delta]GV and \[Delta]GH control the amplitude of the \
longitudinal field component and \[Delta]CP is the inclined-polarization \
adjustment, \\nBlockGap [mm] is the longitudinal gap between the blocks, \
\\nTermination is the termination type (one of the following: None, \
OneBlockSym, OneBlockAntiSym, ThreeBlocksSym, ThreeBlocksAntiSym), \
\\nBlockShape is the shape of the permanent magnet blocks (one of the \
following: Prototype, DeltaSabia or list of block shapes),  \
\\nBlockSubdivision is the subdivision to be apply to the blocks (must have \
the same length as BlockShape).\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDDelta", "[", 
    RowBox[{
    "\[Lambda]u_", ",", " ", "Np_", ",", " ", "Br_", ",", " ", "Gap_", ",", 
     "  ", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<\[Delta]P\>\"", "\[Rule]", " ", "0"}], ",", " ", 
        RowBox[{"\"\<\[Delta]GV\>\"", "\[Rule]", " ", "0"}], ",", " ", 
        RowBox[{"\"\<\[Delta]GH\>\"", "\[Rule]", " ", "0"}], ",", " ", 
        RowBox[{"\"\<\[Delta]CP\>\"", "\[Rule]", " ", "0"}], ",", " ", 
        RowBox[{"\"\<BlockGap\>\"", "->", "0"}], ",", "  ", 
        RowBox[{"\"\<Termination\>\"", "\[Rule]", " ", "\"\<None\>\""}], ",", 
        " ", 
        RowBox[{"\"\<BlockShape\>\"", "\[Rule]", " ", "\"\<DeltaSabia\>\""}], 
        ",", " ", 
        RowBox[{"\"\<BlockSubdivision\>\"", "\[Rule]", " ", "\"\<None\>\""}], 
        ",", " ", 
        RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "False"}], ",", "  ", 
        RowBox[{"\"\<Size1\>\"", "\[Rule]", " ", "1"}], ",", " ", 
        RowBox[{"\"\<Size2\>\"", "\[Rule]", "1"}], ",", " ", 
        RowBox[{"\"\<Size3\>\"", "\[Rule]", " ", "1"}], " ", ",", 
        RowBox[{"\"\<Size4\>\"", "\[Rule]", " ", "1"}], " ", ",", " ", 
        RowBox[{"\"\<Gap1\>\"", "\[Rule]", " ", "0"}], ",", " ", 
        RowBox[{"\"\<Gap2\>\"", "\[Rule]", "0"}], ",", " ", 
        RowBox[{"\"\<Gap3\>\"", "\[Rule]", " ", "0"}], ",", " ", 
        RowBox[{"\"\<Gap4\>\"", "\[Rule]", " ", "0"}], ",", " ", 
        RowBox[{"\"\<Shift1\>\"", "\[Rule]", " ", "0"}], ",", " ", 
        RowBox[{"\"\<Shift2\>\"", "\[Rule]", "0"}], ",", " ", 
        RowBox[{"\"\<Shift3\>\"", "\[Rule]", " ", "0"}], ",", 
        RowBox[{"\"\<Shift4\>\"", "\[Rule]", " ", "0"}], ",", " ", 
        RowBox[{"\"\<FourBlocks\>\"", "\[Rule]", " ", "0"}]}], "}"}], "]"}]}],
     "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "f", ",", " ", "Blocka", " ", ",", " ", "Blockb", ",", "Blockc", ",", 
       "Blockd", ",", " ", "Blocke", ",", " ", "Blocks", ",", "BlockShape", 
       ",", "BlockSubdivision", ",", "\[IndentingNewLine]", "BRCBlockShape", 
       ",", " ", "BLCBlockShape", ",", " ", "ULCBlockShape", ",", " ", 
       "URCBlockShape", ",", " ", "\[IndentingNewLine]", "BRCSubdivision", 
       ",", " ", "BLCSubdivision", ",", "ULCSubdivision", ",", " ", 
       "URCSubdivision", ",", "Silent", ",", "\[IndentingNewLine]", 
       "\[Delta]P", ",", " ", "\[Delta]GV", ",", " ", "\[Delta]GH", ",", " ", 
       "\[Delta]CP", ",", " ", "Termination", ",", "Size1", ",", " ", "Size2",
        ",", " ", "Size3", ",", " ", "Size4", ",", " ", "Gap1", ",", " ", 
       "Gap2", ",", " ", "Gap3", ",", "Gap4", ",", "Shift1", ",", " ", 
       "Shift2", ",", " ", "Shift3", ",", "Shift4", ",", " ", "FourBlocks", 
       ",", "\[IndentingNewLine]", "BlockGap", ",", " ", "\[Delta]BRC", ",", 
       " ", "BRC", ",", " ", "\[Delta]BLC", ",", " ", "BLC", ",", " ", 
       "\[Delta]ULC", ",", " ", "ULC", ",", " ", "\[Delta]URC", ",", " ", 
       "URC", ",", "Device", ",", " ", "Cassettes", ",", " ", "t0", ",", " ", 
       "t1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "The", " ", "insertion", " ", "device", " ", "is", " ", "created", " ",
         "rotated", " ", "by", " ", 
        RowBox[{"\[Pi]", "/", "4"}], " ", "about", " ", "the", " ", "y"}], 
       "-", 
       RowBox[{
       "axis", " ", "to", " ", "simplified", " ", "the", " ", "magnetization",
         " ", 
        RowBox[{"functions", ".", " ", "The"}], " ", "entire", " ", "device", 
        " ", "is", " ", "rotated", " ", "to", " ", "the", " ", "correct", " ",
         "position", " ", "at", " ", "the", " ", "end", " ", "of", " ", "the",
         " ", 
        RowBox[{"function", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t0", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Delete", " ", "previous", " ", "Radia", " ", "objects"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"radUtiDelAll", "[", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Check", " ", "arguments"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{"\[Lambda]u", " ", "\[LessEqual]", " ", "0"}], ",", " ", 
        RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{"Np", " ", "\[LessEqual]", " ", "0"}], ",", " ", 
        RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{"Br", " ", "\[LessEqual]", " ", "0"}], ",", " ", 
        RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{"Gap", " ", "\[LessEqual]", " ", "0"}], ",", " ", 
        RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Gap", " ", "between", " ", "blocks"}], "*)"}], 
      "\[IndentingNewLine]", " ", 
      RowBox[{"BlockGap", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<BlockGap\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Cassettes", " ", "longitudinal", " ", 
        RowBox[{"displacement", " ", "[", "mm", "]"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"\[Delta]P", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<\[Delta]P\>\"", "]"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"Phase", " ", "adjustment"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Delta]GV", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<\[Delta]GV\>\"", "]"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Vertical", " ", "field", " ", "amplitude", " ", "to", " ", 
         "longitudinal", " ", "field", " ", "amplitude"}], ",", " ", 
        RowBox[{
        "also", " ", "decreases", " ", "horizontal", " ", "field", " ", 
         "amplitude"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Delta]GH", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<\[Delta]GH\>\"", "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Horizontal", " ", "field", " ", "amplitude", " ", "to", " ", 
         "longitudinal", " ", "field", " ", "amplitude"}], ",", " ", 
        RowBox[{
        "also", " ", "decreases", " ", "vertical", " ", "field", " ", 
         "amplitude"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Delta]CP", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<\[Delta]CP\>\"", "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"Inclined", " ", "polarization", " ", "adjustment"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Termination", " ", "Type"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Termination", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Termination\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Block", " ", "vertices"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"BlockShape", "=", "  ", 
       RowBox[{"OptionValue", "[", "\"\<BlockShape\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"BlockSubdivision", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<BlockSubdivision\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Silent", " ", "flag"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Silent", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Silent\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Size1", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Size1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Size2", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Size2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Size3", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Size3\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Size4", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Size4\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Gap1", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Gap1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Gap2", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Gap2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Gap3", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Gap3\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Gap4", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Gap4\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Shift1", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Shift1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Shift2", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Shift2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Shift3", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Shift3\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Shift4", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Shift4\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"FourBlocks", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<FourBlocks\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Blocks", " ", "=", " ", "BlockShape"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"BlockShape", "\[Equal]", " ", "\"\<Prototype\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Blocka", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "2.75"}], ",", " ", "0"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "11.2662"}], ",", "8.9645"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "7.73071"}], ",", "12.5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"7.73071", ",", " ", "12.5"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"11.2662", ",", " ", "8.9645"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"2.75", ",", "0"}], "}"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Blockb", " ", "=", " ", 
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "7.73071"}], ",", "12.5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "11.2662"}], ",", " ", "16.0355"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "2.75"}], ",", "25"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"2.75", ",", "25"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"11.2662", ",", "16.0355"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"7.73071", ",", " ", "12.5"}], "}"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Blocks", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"Blocka", ",", " ", "Blockb"}], "}"}]}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"BlockShape", " ", "\[Equal]", " ", "\"\<DeltaSabia\>\""}], 
        " ", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Blocka", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "5.25"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "22.5"}], ",", "19.3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "22.5"}], ",", " ", "29.2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "17.8"}], ",", " ", "33.2"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"17.8", ",", " ", "33.2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"22.5", ",", "29.2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"22.5", ",", "19.3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"5.25", ",", "0"}], "}"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Blockc", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "17.8"}], ",", " ", "33.2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "17.8"}], ",", "38.4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"17.8", ",", " ", "38.4"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"17.8", ",", " ", "33.2"}], "}"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Blockb", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "17.8"}], ",", "38.4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "22.5"}], ",", "42.4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "22.5"}], ",", "49"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "21.5"}], ",", "50"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"21.5", ",", "50"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"22.5", ",", "49"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"22.5", ",", "42.4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"17.8", ",", "38.4"}], "}"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Blocks", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"Blocka", ",", " ", "Blockc", ",", "Blockb"}], "}"}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Blocks", " ", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", " ", "All", ",", " ", "2"}], "]"}], "]"}], "=", 
       " ", 
       RowBox[{
        RowBox[{"Blocks", " ", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", " ", "All", ",", " ", "2"}], "]"}], "]"}], "+", 
        " ", 
        RowBox[{"Gap", "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Block", " ", "vertices", " ", "for", " ", "each", " ", "cassette", 
        " ", 
        RowBox[{"(", 
         RowBox[{
         "cross", " ", "section", " ", "in", " ", "the", " ", "xy", " ", 
          "plane"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"URCBlockShape", " ", "=", "Blocks"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ULCBlockShape", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Dot", "[", 
            RowBox[{
             RowBox[{"RotationMatrix", "[", 
              RowBox[{"\[Pi]", "/", "2"}], "]"}], ",", "#"}], "]"}], "&"}], "/@",
           "#"}], "&"}], "/@", "URCBlockShape"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"BLCBlockShape", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Dot", "[", 
            RowBox[{
             RowBox[{"RotationMatrix", "[", 
              RowBox[{"\[Pi]", "/", "2"}], "]"}], ",", "#"}], "]"}], "&"}], "/@",
           "#"}], "&"}], "/@", "ULCBlockShape"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"BRCBlockShape", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Dot", "[", 
            RowBox[{
             RowBox[{"RotationMatrix", "[", 
              RowBox[{"\[Pi]", "/", "2"}], "]"}], ",", "#"}], "]"}], "&"}], "/@",
           "#"}], "&"}], "/@", "BLCBlockShape"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"URCSubdivision", "  ", "=", 
       RowBox[{"ULCSubdivision", "=", 
        RowBox[{"BLCSubdivision", "=", 
         RowBox[{"BRCSubdivision", " ", "=", "BlockSubdivision"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "BlockSubdivision", "]"}], ">", " ", "0"}], 
        ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"URCSubdivision", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", " ", 
           "BlockSubdivision"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ULCSubdivision", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", " ", 
             RowBox[{"Dot", "[", 
              RowBox[{
               RowBox[{"RotationMatrix", "[", 
                RowBox[{
                 RowBox[{"\[Pi]", "/", "2"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0", ",", " ", "0"}], "}"}]}], "]"}], ",",
                "#"}], "]"}], "]"}], "&"}], "/@", " ", "URCSubdivision"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"BLCSubdivision", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", " ", 
             RowBox[{"Dot", "[", 
              RowBox[{
               RowBox[{"RotationMatrix", "[", 
                RowBox[{
                 RowBox[{"\[Pi]", "/", "2"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0", ",", " ", "0"}], "}"}]}], "]"}], ",",
                "#"}], "]"}], "]"}], "&"}], "/@", " ", "ULCSubdivision"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"BRCSubdivision", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", " ", 
             RowBox[{"Dot", "[", 
              RowBox[{
               RowBox[{"RotationMatrix", "[", 
                RowBox[{
                 RowBox[{"\[Pi]", "/", "2"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0", ",", " ", "0"}], "}"}]}], "]"}], ",",
                "#"}], "]"}], "]"}], "&"}], "/@", "BLCSubdivision"}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "Cassettes", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Delta]URC", " ", "=", "\[Delta]GV"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"URC", " ", "=", " ", 
       RowBox[{"auxIDCassette", "[", 
        RowBox[{
        "\[Lambda]u", ",", " ", "Np", ",", " ", "Br", ",", "\[Delta]URC", ",",
          " ", "URCBlockShape", ",", 
         RowBox[{"\"\<BlockGap\>\"", "\[Rule]", " ", "BlockGap"}], ",", " ", 
         RowBox[{"\"\<Termination\>\"", "\[Rule]", " ", "Termination"}], ",", 
         " ", " ", 
         RowBox[{"\"\<PointingUp\>\"", "\[Rule]", " ", "False"}], ",", 
         RowBox[{"\"\<FirstBlock\>\"", "\[Rule]", " ", "\"\<Up\>\""}], ",", 
         RowBox[{
         "\"\<FieldDirection\>\"", "\[Rule]", " ", "\"\<Vertical\>\""}], ",", 
         " ", 
         RowBox[{
         "\"\<BlockSubdivision\>\"", "\[Rule]", " ", "URCSubdivision"}], ",", 
         " ", 
         RowBox[{"\"\<Size1\>\"", "\[Rule]", " ", "Size1"}], ",", " ", 
         RowBox[{"\"\<Size2\>\"", "\[Rule]", " ", "Size2"}], ",", " ", 
         RowBox[{"\"\<Size3\>\"", "\[Rule]", " ", "Size3"}], ",", 
         RowBox[{"\"\<Size4\>\"", "\[Rule]", " ", "Size4"}], ",", " ", 
         RowBox[{"\"\<Gap1\>\"", "\[Rule]", " ", "Gap1"}], ",", "  ", 
         RowBox[{"\"\<Gap2\>\"", "\[Rule]", " ", "Gap2"}], ",", "  ", 
         RowBox[{"\"\<Gap3\>\"", "\[Rule]", " ", "Gap3"}], ",", 
         RowBox[{"\"\<Gap4\>\"", "\[Rule]", " ", "Gap4"}], ",", " ", 
         RowBox[{"\"\<Shift1\>\"", "\[Rule]", " ", "Shift1"}], ",", " ", 
         RowBox[{"\"\<Shift2\>\"", "\[Rule]", " ", "Shift2"}], ",", " ", 
         RowBox[{"\"\<Shift3\>\"", "\[Rule]", " ", "Shift3"}], ",", 
         RowBox[{"\"\<Shift4\>\"", "\[Rule]", " ", "Shift4"}], ",", " ", 
         RowBox[{"\"\<FourBlocks\>\"", "\[Rule]", " ", "FourBlocks"}], ",", 
         " ", 
         RowBox[{"\"\<ShiftDirection\>\"", "\[Rule]", " ", "1"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\[Delta]ULC", " ", "=", " ", 
       RowBox[{
       "\[Delta]GV", "+", " ", "\[Delta]GH", "+", " ", "\[Delta]P", "+", 
        "\[Delta]CP"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ULC", " ", "=", " ", 
       RowBox[{"auxIDCassette", "[", 
        RowBox[{
        "\[Lambda]u", ",", " ", "Np", ",", " ", "Br", ",", "\[Delta]ULC", ",",
          " ", "ULCBlockShape", ",", " ", 
         RowBox[{"\"\<BlockGap\>\"", "\[Rule]", " ", "BlockGap"}], ",", " ", 
         RowBox[{"\"\<Termination\>\"", "\[Rule]", " ", "Termination"}], ",", 
         " ", " ", 
         RowBox[{"\"\<PointingUp\>\"", "\[Rule]", " ", "True"}], ",", 
         RowBox[{"\"\<FirstBlock\>\"", "\[Rule]", " ", "\"\<Down\>\""}], ",", 
         " ", 
         RowBox[{
         "\"\<FieldDirection\>\"", "\[Rule]", " ", "\"\<Horizontal\>\""}], 
         ",", " ", 
         RowBox[{"\"\<BlockSubdivision\>\"", "\[Rule]", "ULCSubdivision"}], 
         ",", " ", 
         RowBox[{"\"\<Size1\>\"", "\[Rule]", " ", "Size1"}], ",", " ", 
         RowBox[{"\"\<Size2\>\"", "\[Rule]", " ", "Size2"}], ",", " ", 
         RowBox[{"\"\<Size3\>\"", "\[Rule]", " ", "Size3"}], ",", 
         RowBox[{"\"\<Size4\>\"", "\[Rule]", " ", "Size4"}], ",", " ", 
         RowBox[{"\"\<Gap1\>\"", "\[Rule]", " ", "Gap1"}], ",", "  ", 
         RowBox[{"\"\<Gap2\>\"", "\[Rule]", " ", "Gap2"}], ",", "  ", 
         RowBox[{"\"\<Gap3\>\"", "\[Rule]", " ", "Gap3"}], ",", 
         RowBox[{"\"\<Gap4\>\"", "\[Rule]", " ", "Gap4"}], ",", " ", 
         RowBox[{"\"\<Shift1\>\"", "\[Rule]", " ", "Shift1"}], ",", " ", 
         RowBox[{"\"\<Shift2\>\"", "\[Rule]", " ", "Shift2"}], ",", " ", 
         RowBox[{"\"\<Shift3\>\"", "\[Rule]", " ", "Shift3"}], ",", 
         RowBox[{"\"\<Shift4\>\"", "\[Rule]", " ", "Shift4"}], ",", " ", 
         RowBox[{"\"\<FourBlocks\>\"", "\[Rule]", " ", "FourBlocks"}], ",", 
         " ", " ", 
         RowBox[{"\"\<ShiftDirection\>\"", "\[Rule]", " ", 
          RowBox[{"-", "1"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Delta]BLC", " ", "=", "\[Delta]GH"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"BLC", " ", "=", " ", 
       RowBox[{"auxIDCassette", "[", 
        RowBox[{
        "\[Lambda]u", ",", " ", "Np", ",", " ", "Br", ",", "\[Delta]BLC", ",",
          " ", "BLCBlockShape", ",", "  ", 
         RowBox[{"\"\<BlockGap\>\"", "\[Rule]", " ", "BlockGap"}], ",", " ", 
         RowBox[{"\"\<Termination\>\"", "\[Rule]", " ", "Termination"}], ",", 
         " ", " ", 
         RowBox[{"\"\<PointingUp\>\"", "\[Rule]", " ", "True"}], ",", 
         RowBox[{"\"\<FirstBlock\>\"", "\[Rule]", " ", "\"\<Up\>\""}], ",", 
         " ", 
         RowBox[{
         "\"\<FieldDirection\>\"", "\[Rule]", " ", "\"\<Vertical\>\""}], ",", 
         " ", 
         RowBox[{
         "\"\<BlockSubdivision\>\"", "\[Rule]", " ", "BLCSubdivision"}], ",", 
         RowBox[{"\"\<Size1\>\"", "\[Rule]", " ", "Size1"}], ",", " ", 
         RowBox[{"\"\<Size2\>\"", "\[Rule]", " ", "Size2"}], ",", " ", 
         RowBox[{"\"\<Size3\>\"", "\[Rule]", " ", "Size3"}], ",", 
         RowBox[{"\"\<Size4\>\"", "\[Rule]", " ", "Size4"}], ",", " ", 
         RowBox[{"\"\<Gap1\>\"", "\[Rule]", " ", "Gap1"}], ",", "  ", 
         RowBox[{"\"\<Gap2\>\"", "\[Rule]", " ", "Gap2"}], ",", "  ", 
         RowBox[{"\"\<Gap3\>\"", "\[Rule]", " ", "Gap3"}], ",", 
         RowBox[{"\"\<Gap4\>\"", "\[Rule]", " ", "Gap4"}], ",", " ", 
         RowBox[{"\"\<Shift1\>\"", "\[Rule]", " ", "Shift1"}], ",", " ", 
         RowBox[{"\"\<Shift2\>\"", "\[Rule]", " ", "Shift2"}], ",", " ", 
         RowBox[{"\"\<Shift3\>\"", "\[Rule]", " ", "Shift3"}], ",", 
         RowBox[{"\"\<Shift4\>\"", "\[Rule]", " ", "Shift4"}], ",", " ", 
         RowBox[{"\"\<FourBlocks\>\"", "\[Rule]", " ", "FourBlocks"}], ",", 
         " ", " ", 
         RowBox[{"\"\<ShiftDirection\>\"", "\[Rule]", " ", 
          RowBox[{"-", "1"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Delta]BRC", " ", "=", 
       RowBox[{"\[Delta]P", "-", "\[Delta]CP"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"BRC", " ", "=", 
       RowBox[{"auxIDCassette", "[", 
        RowBox[{
        "\[Lambda]u", ",", " ", "Np", ",", " ", "Br", ",", " ", "\[Delta]BRC",
          ",", "BRCBlockShape", ",", " ", 
         RowBox[{"\"\<BlockGap\>\"", "\[Rule]", " ", "BlockGap"}], ",", " ", 
         RowBox[{"\"\<Termination\>\"", "\[Rule]", " ", "Termination"}], ",", 
         " ", " ", 
         RowBox[{"\"\<PointingUp\>\"", "\[Rule]", "False"}], ",", " ", 
         RowBox[{"\"\<FirstBlock\>\"", "\[Rule]", " ", "\"\<Down\>\""}], ",", 
         " ", 
         RowBox[{
         "\"\<FieldDirection\>\"", "\[Rule]", " ", "\"\<Horizontal\>\""}], 
         ",", " ", 
         RowBox[{
         "\"\<BlockSubdivision\>\"", "\[Rule]", " ", "BRCSubdivision"}], ",", 
         " ", 
         RowBox[{"\"\<Size1\>\"", "\[Rule]", " ", "Size1"}], ",", " ", 
         RowBox[{"\"\<Size2\>\"", "\[Rule]", " ", "Size2"}], ",", " ", 
         RowBox[{"\"\<Size3\>\"", "\[Rule]", " ", "Size3"}], ",", 
         RowBox[{"\"\<Size4\>\"", "\[Rule]", " ", "Size4"}], ",", " ", 
         RowBox[{"\"\<Gap1\>\"", "\[Rule]", " ", "Gap1"}], ",", "  ", 
         RowBox[{"\"\<Gap2\>\"", "\[Rule]", " ", "Gap2"}], ",", "  ", 
         RowBox[{"\"\<Gap3\>\"", "\[Rule]", " ", "Gap3"}], ",", 
         RowBox[{"\"\<Gap4\>\"", "\[Rule]", " ", "Gap4"}], ",", " ", 
         RowBox[{"\"\<Shift1\>\"", "\[Rule]", " ", "Shift1"}], ",", " ", 
         RowBox[{"\"\<Shift2\>\"", "\[Rule]", " ", "Shift2"}], ",", " ", 
         RowBox[{"\"\<Shift3\>\"", "\[Rule]", " ", "Shift3"}], ",", 
         RowBox[{"\"\<Shift4\>\"", "\[Rule]", " ", "Shift4"}], ",", " ", 
         RowBox[{"\"\<FourBlocks\>\"", "\[Rule]", " ", "FourBlocks"}], ",", 
         " ", " ", 
         RowBox[{"\"\<ShiftDirection\>\"", "\[Rule]", " ", "1"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Insertion", " ", "device"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Device", " ", "=", 
       RowBox[{"radObjCnt", "[", 
        RowBox[{"{", 
         RowBox[{"BRC", ",", " ", "BLC", ",", " ", "ULC", ",", " ", "URC"}], 
         "}"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Counterclockwise", " ", "rotation", " ", "of", " ", "insertion", " ",
          "device", " ", "by"}], " ", "-", 
        RowBox[{
         RowBox[{"\[Pi]", "/", "4"}], " ", "around", " ", "the", " ", "z"}], 
        "-", "axis"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Device", "=", " ", 
       RowBox[{"radTrfOrnt", "[", 
        RowBox[{"Device", ",", 
         RowBox[{"radTrfRot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
           RowBox[{
            RowBox[{"-", "\[Pi]"}], "/", "4"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", " ", "Silent"}], ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<IDDelta: elapsed time = \>\"", ",", 
          RowBox[{"(", 
           RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "Device", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7667551788345585`*^9, 3.766755219697137*^9}, {
   3.7667552608722496`*^9, 3.766755336956355*^9}, {3.7667553842569494`*^9, 
   3.766755392727988*^9}, {3.7667554904075484`*^9, 3.7667554958142147`*^9}, {
   3.766755533035892*^9, 3.766755536817438*^9}, {3.7667555822585154`*^9, 
   3.766755653420355*^9}, {3.766756597123891*^9, 3.7667567178365045`*^9}, {
   3.766758273756778*^9, 3.7667582858827343`*^9}, {3.766758881931342*^9, 
   3.766758895901193*^9}, {3.7667589294194484`*^9, 3.766759099497465*^9}, {
   3.7667594411382713`*^9, 3.766759474594048*^9}, 3.766759676703664*^9, {
   3.7667597589931507`*^9, 3.7667597604151382`*^9}, {3.767445913038151*^9, 
   3.7674459154914675`*^9}, {3.7674480119644413`*^9, 3.767448037403933*^9}, {
   3.767517216023782*^9, 3.76751735632812*^9}, {3.767517388002474*^9, 
   3.7675175908758945`*^9}, {3.767517710921748*^9, 3.7675177169357166`*^9}, {
   3.7675352221793385`*^9, 3.7675352299784536`*^9}, {3.7826507708075814`*^9, 
   3.7826508410104322`*^9}, {3.7826509152630415`*^9, 
   3.7826509534060044`*^9}, {3.7826509875464926`*^9, 
   3.7826513618482885`*^9}, {3.7826514197543125`*^9, 
   3.7826514691465225`*^9}, {3.782651516571157*^9, 3.7826516281644516`*^9}, {
   3.782651791808872*^9, 3.782651794105769*^9}, {3.782651877699188*^9, 
   3.7826519147927847`*^9}, {3.7826519494332795`*^9, 3.782652148716467*^9}, {
   3.78265266546935*^9, 3.782652666719343*^9}, {3.782659005138482*^9, 
   3.7826590070603485`*^9}, {3.7826592858206563`*^9, 3.78265929694561*^9}, {
   3.7826604221508827`*^9, 3.7826604311977215`*^9}, {3.782660660486992*^9, 
   3.7826607614709654`*^9}, {3.782660802567483*^9, 3.7826608417392*^9}, {
   3.782660872520325*^9, 3.7826610165052404`*^9}, {3.7826610636786795`*^9, 
   3.7826610639755516`*^9}, {3.782723152329569*^9, 3.782723364147324*^9}, {
   3.7827251626917877`*^9, 3.7827253028474708`*^9}, {3.782726489766873*^9, 
   3.782726501032457*^9}, {3.7827273648822813`*^9, 3.7827274629720583`*^9}, {
   3.7827276445539565`*^9, 3.7827276448195767`*^9}, {3.782727745825308*^9, 
   3.7827277459503107`*^9}, 3.7834343693375583`*^9, {3.7834360989694023`*^9, 
   3.783436118125576*^9}, {3.7849708241210814`*^9, 3.7849708397628965`*^9}, {
   3.784970923135537*^9, 3.7849709525780067`*^9}, {3.7849709861275373`*^9, 
   3.7849710402907534`*^9}, {3.78497114577227*^9, 3.784971236235998*^9}, {
   3.7849718913198776`*^9, 3.7849718949763823`*^9}, 3.7849748915670214`*^9, {
   3.784974976765699*^9, 3.7849750359324846`*^9}, {3.7900994598001757`*^9, 
   3.790099463909542*^9}, {3.790099514677552*^9, 3.7900997992215023`*^9}, {
   3.79010000114565*^9, 3.790100003317521*^9}, {3.79010015867902*^9, 
   3.790100158897772*^9}, {3.7901002128664656`*^9, 3.7901003135256205`*^9}, {
   3.7901003717130585`*^9, 3.790100435822373*^9}, {3.790325198838755*^9, 
   3.7903252471519814`*^9}, {3.7903252936050653`*^9, 3.7903253764191914`*^9}, 
   3.7903255200596695`*^9, {3.790325588153353*^9, 3.790325590481475*^9}, {
   3.7905969395027122`*^9, 3.7905969919103193`*^9}, {3.7905970629101562`*^9, 
   3.7905970831444855`*^9}, {3.790597114275004*^9, 3.7905971169312763`*^9}, {
   3.790597181509253*^9, 3.7905973150116053`*^9}, {3.790597381950594*^9, 
   3.7905974064349146`*^9}, {3.790598731815971*^9, 3.7905988024267626`*^9}, {
   3.7905988377079296`*^9, 3.790598873335472*^9}, {3.790599019132003*^9, 
   3.790599019772629*^9}, {3.7905990695098543`*^9, 3.7905990899004335`*^9}, {
   3.8000349773448105`*^9, 3.80003500226662*^9}, {3.8000359490205283`*^9, 
   3.8000359640517445`*^9}, {3.8002673544039755`*^9, 3.80026736304457*^9}, {
   3.8002673945757475`*^9, 3.8002676403442945`*^9}, {3.800267793015761*^9, 
   3.8002679116404524`*^9}, {3.8002682772106752`*^9, 3.800268314054346*^9}, {
   3.8002684873835907`*^9, 3.800268545992809*^9}, {3.8002686718362293`*^9, 
   3.8002687228048415`*^9}, {3.800268770570323*^9, 3.8002688254941435`*^9}, {
   3.800269396639897*^9, 3.8002696335625005`*^9}, {3.8002905604446383`*^9, 
   3.800290563147753*^9}, {3.8002906246007395`*^9, 3.8002906421475267`*^9}, {
   3.80029385478183*^9, 3.800293855188079*^9}, {3.8007804660998197`*^9, 
   3.8007804853653784`*^9}, {3.8049514125963106`*^9, 3.804951432330654*^9}, {
   3.804952168477005*^9, 3.804952170998558*^9}, {3.81179071275385*^9, 
   3.8117909188845043`*^9}, {3.8117909505127134`*^9, 3.811790955939063*^9}, {
   3.8118216752631655`*^9, 3.8118217479403887`*^9}, {3.8118224694406757`*^9, 
   3.8118225353980384`*^9}, {3.8118239228435664`*^9, 3.811823941060009*^9}, 
   3.811853739330413*^9, {3.8118550788946776`*^9, 3.811855113667631*^9}, {
   3.8118553803153696`*^9, 3.8118553860626345`*^9}, {3.811857279645944*^9, 
   3.8118574607078314`*^9}, {3.8118577180665503`*^9, 
   3.8118577323166695`*^9}, {3.81185867535961*^9, 3.8118586848839583`*^9}, {
   3.811858716583386*^9, 3.811858723770481*^9}, {3.811858795287467*^9, 
   3.811858798451473*^9}, {3.8118588957959085`*^9, 3.81185890068201*^9}, {
   3.8118589601334143`*^9, 3.8118589663100467`*^9}, {3.811859006875464*^9, 
   3.811859013942975*^9}, {3.8118590696978855`*^9, 3.8118591333640137`*^9}, {
   3.8118593209471064`*^9, 3.811859331749689*^9}, {3.811859398881408*^9, 
   3.811859413680354*^9}, {3.811859496425479*^9, 3.811859510543769*^9}, {
   3.8125357237153625`*^9, 3.8125357794488344`*^9}, {3.8125358562163982`*^9, 
   3.812536074380492*^9}, {3.8125396170109572`*^9, 3.8125397631918306`*^9}, {
   3.8125399907159967`*^9, 3.812540047231269*^9}, {3.812540706746953*^9, 
   3.812540720717823*^9}, {3.8125408905125217`*^9, 3.812540899033056*^9}, {
   3.8125410026895056`*^9, 3.812541080246192*^9}, {3.8125411109781055`*^9, 
   3.812541115678444*^9}, {3.812541167481624*^9, 3.8125411781623073`*^9}, {
   3.812541253516964*^9, 3.812541279098573*^9}, {3.8125413096804953`*^9, 
   3.812541347942879*^9}, {3.812541381424944*^9, 3.8125414423587456`*^9}, {
   3.812541503182525*^9, 3.8125415046526175`*^9}, {3.8125415399948206`*^9, 
   3.812541556375874*^9}, {3.8125418247047873`*^9, 3.8125418400357428`*^9}, {
   3.812541902069605*^9, 3.8125419268611326`*^9}, {3.81254199810559*^9, 
   3.8125420021458564`*^9}, {3.8125421708663406`*^9, 3.812542187437378*^9}, {
   3.8125422650522037`*^9, 3.8125422751228313`*^9}, {3.815744962481203*^9, 
   3.8157451009659996`*^9}, {3.8157453444181366`*^9, 3.81574534546264*^9}, {
   3.816612809032319*^9, 3.816612834588354*^9}, {3.816612943933936*^9, 
   3.8166130726865044`*^9}, {3.8166137735805607`*^9, 
   3.8166137820592265`*^9}, {3.8166288692602444`*^9, 
   3.8166290677949224`*^9}, {3.8166989638591733`*^9, 3.816698983451342*^9}, {
   3.816699075727983*^9, 3.816699090372263*^9}, 3.8166991243103104`*^9, {
   3.8166991628313665`*^9, 3.8166992271492853`*^9}, {3.816699355516037*^9, 
   3.8166993845153613`*^9}, {3.818845680037689*^9, 3.818845712930765*^9}, {
   3.818845744753772*^9, 3.8188457575292487`*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[4]:=",ExpressionUUID->"d4295d6b-5e5f-4955-8ce4-9cdda100a50e"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Utilities", "Section",
 CellChangeTimes->{{3.7663982103876667`*^9, 3.7663982168978977`*^9}, {
  3.7663982623594646`*^9, 
  3.766398265542498*^9}},ExpressionUUID->"f4366deb-1b60-41eb-9dc8-\
6ebd3361a7fc"],

Cell[CellGroupData[{

Cell["IDSolve", "Subsection",
 CellChangeTimes->{
  3.7667548496524267`*^9, {3.8119940063406706`*^9, 
   3.811994007491991*^9}},ExpressionUUID->"2ad9b229-e14f-4a3a-8e5f-\
2858a5e5451b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IDSolve", "::", "usage"}], " ", "=", " ", 
    "\"\<IDSolve[ID, Prec, MaxIter]: Call RadSolve function and print \
results.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDSolve", "[", 
    RowBox[{"ID_", ",", "  ", "Prec_", ",", " ", "MaxIter_", ",", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"{", 
       RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "False"}], "}"}], "]"}]}], 
    " ", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "sre", ",", " ", "sz", ",", " ", "t0", ",", " ", "t1", ",", " ", 
       "Silent"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t0", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"sre", "=", 
       RowBox[{"RadSolve", "[", 
        RowBox[{"ID", ",", "Prec", ",", "MaxIter"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sz", " ", "=", " ", 
       RowBox[{"radObjDegFre", "[", "ID", "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Silent", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Silent\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", " ", "Silent"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Solved in: \>\"", ",", 
           RowBox[{
            RowBox[{"Round", "[", 
             RowBox[{"t1", "-", "t0"}], "]"}], "/", "60.0"}], ",", 
           "\"\< min\>\""}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Number of Degrees of Freedom = \>\"", ",", "sz"}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Typical Memory Size of Interation Matrix [MBytes] = \>\"", ",", 
           RowBox[{"N", "[", 
            RowBox[{"sz", "*", 
             RowBox[{"(", 
              RowBox[{"sz", "+", "1"}], ")"}], "*", 
             RowBox[{"4", "/", "1000000"}]}], "]"}]}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Average absolute change in magnetization between the last two \
iterations = \>\"", ",", 
           RowBox[{"sre", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Maximum absolute value of magnetization over all the objects = \
\>\"", ",", 
           RowBox[{"sre", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Maximum absolute value of magnetic field strength over central \
points of all the objects = \>\"", ",", 
           RowBox[{"sre", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Number of iterations done = \>\"", ",", 
           RowBox[{"sre", "[", 
            RowBox[{"[", "4", "]"}], "]"}], ",", " ", "\"\<\\n\>\""}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.811994080047217*^9, 3.811994158715458*^9}, {
  3.8119942336302195`*^9, 3.8119942569198236`*^9}, {3.811994358880513*^9, 
  3.811994431713492*^9}, {3.8119944656793065`*^9, 3.8119945642559*^9}, {
  3.8157453072264175`*^9, 3.8157453789063025`*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[6]:=",ExpressionUUID->"068e143d-bd0f-46f2-9082-ce6f19ee2c7b"]
}, Closed]],

Cell[CellGroupData[{

Cell["IDShow", "Subsection",
 CellChangeTimes->{
  3.766754821368951*^9},ExpressionUUID->"80d519b9-e0f1-46b9-b652-\
4e226e79bc05"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IDShow", "::", "usage"}], " ", "=", " ", 
    "\"\<IDShow[ID, \\\"MagDirection\\\"\[Rule] False, \\\"ArrowSize\\\"\
\[Rule] 10, \\\"ArrowHeadSize\\\"\[Rule] Medium]: Show the ID model.\>\""}], 
   ";"}], " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDShow", "[", 
    RowBox[{"ID_", ",", " ", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<MagDirection\>\"", "\[Rule]", " ", "False"}], ",", "  ", 
        RowBox[{"\"\<ArrowSize\>\"", "\[Rule]", " ", "10"}], ",", " ", 
        RowBox[{"\"\<ArrowHeadSize\>\"", "\[Rule]", "Medium"}], ",", " ", 
        RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "False"}]}], "}"}], "]"}]}],
     "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "MagDirection", ",", " ", "ArrowSize", " ", ",", " ", "ArrowHeadSize", 
       " ", ",", " ", "ObjM", " ", ",", " ", "ArrowList", ",", " ", "t0", ",",
        " ", "t1", ",", "  ", "Silent"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t0", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"RadPlot3DOptions", "[", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"MagDirection", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<MagDirection\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ArrowSize", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<ArrowSize\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ArrowHeadSize", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<ArrowHeadSize\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"MagDirection", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ObjM", " ", "=", " ", 
          RowBox[{"radObjM", "[", "ID", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ArrowList", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"auxIDBlockArrow", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", " ", "ArrowSize"}], "]"}],
             "&"}], "/@", "ObjM"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"Graphics3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Opacity", "[", "0.5", "]"}], ",", " ", 
              RowBox[{"radObjDrw", "[", "ID", "]"}], ",", 
              RowBox[{"Opacity", "[", "1", "]"}], ",", 
              RowBox[{"Arrowheads", "[", "ArrowHeadSize", "]"}], ",", 
              "ArrowList"}], "}"}], ",", " ", 
            RowBox[{"BaseStyle", " ", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{"12", ",", " ", 
               RowBox[{
               "FontFamily", " ", "\[Rule]", " ", "\"\<Calibri\>\""}]}], 
              "}"}]}]}], "]"}], "]"}], ";"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"Graphics3D", "[", 
           RowBox[{
            RowBox[{"radObjDrw", "[", "ID", "]"}], ",", 
            RowBox[{"BaseStyle", " ", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{"16", ",", " ", 
               RowBox[{
               "FontFamily", " ", "\[Rule]", " ", "\"\<Calibri\>\""}]}], 
              "}"}]}]}], "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Silent", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Silent\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", " ", "Silent"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<IDShow: elapsed time = \>\"", ",", 
           RowBox[{"(", 
            RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7667558489826016`*^9, 3.766755892642285*^9}, {
   3.76675595766302*^9, 3.7667561689633245`*^9}, {3.7667562043411093`*^9, 
   3.766756256829613*^9}, 3.7667563179437857`*^9, 3.766757279583788*^9, {
   3.7674475847961235`*^9, 3.7674476020787315`*^9}, {3.767447784535589*^9, 
   3.767447797099101*^9}, {3.8119962560447073`*^9, 3.811996256795929*^9}, {
   3.8157454068773603`*^9, 3.815745432178673*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[8]:=",ExpressionUUID->"d01a001e-9065-45b4-8e73-d9728b90eeea"]
}, Closed]],

Cell[CellGroupData[{

Cell["IDInfo", "Subsection",
 CellChangeTimes->{{3.766754821368951*^9, 3.766754837401464*^9}, {
  3.76744992179731*^9, 
  3.7674499282822175`*^9}},ExpressionUUID->"53ad71eb-17b9-4d6d-ac98-\
0730df07584e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IDInfo", "::", "usage"}], " ", "=", " ", 
    "\"\<IDInfo[ID, \[Lambda]u]: Print the field amplitudes and K values of \
the ID.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDInfo", "[", 
    RowBox[{"ID_", ",", " ", "\[Lambda]u_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Bv", ",", " ", "Bh", ",", " ", "Bs", ",", " ", "Kh", ",", " ", "Kv", 
       ",", " ", "t0", ",", " ", "t1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t0", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Bh", " ", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{"radFldLst", "[", 
          RowBox[{"ID", ",", " ", "\"\<Bx\>\"", ",", " ", 
           RowBox[{"{", " ", 
            RowBox[{"0", ",", "0", ",", " ", 
             RowBox[{"-", "\[Lambda]u"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "\[Lambda]u"}], "}"}], ",", " ", 
           "100", ",", " ", "\"\<noarg\>\"", ",", " ", 
           RowBox[{"-", "\[Lambda]u"}]}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Bv", " ", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{"radFldLst", "[", 
          RowBox[{"ID", ",", " ", "\"\<By\>\"", ",", " ", 
           RowBox[{"{", " ", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "\[Lambda]u"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "\[Lambda]u"}], "}"}], ",", " ", 
           "100", ",", " ", "\"\<noarg\>\"", ",", " ", 
           RowBox[{"-", "\[Lambda]u"}]}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Bs", " ", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{"radFldLst", "[", 
          RowBox[{"ID", ",", " ", "\"\<Bz\>\"", ",", " ", 
           RowBox[{"{", " ", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "\[Lambda]u"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "\[Lambda]u"}], "}"}], ",", " ", 
           "100", ",", " ", "\"\<noarg\>\"", ",", " ", 
           RowBox[{"-", "\[Lambda]u"}]}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<\\nHorizontal field amplitude:    \>\"", ",", " ", "Bh", ",", 
        "  ", "\"\< [T]\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Vertical field amplitude:      \>\"", ",", " ", "Bv", ",", " ", 
        "\"\< [T]\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Longitudinal field amplitude:  \>\"", ",", " ", "Bs", ",", "  ", 
        "\"\< [T]\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Kh", " ", "=", " ", 
       RowBox[{"0.934", "*", "Bv", "*", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]u", "/", "10"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Kv", " ", "=", " ", 
       RowBox[{"0.934", "*", "Bh", "*", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]u", "/", "10"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<\\nHorizontal K: \>\"", ",", " ", "Kh"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Vertical K:   \>\"", ",", " ", "Kv"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<IDInfo: elapsed time = \>\"", ",", 
        RowBox[{"(", 
         RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7674474456397743`*^9, 3.7674474806295147`*^9}, {
  3.7674475680916853`*^9, 3.7674475684823327`*^9}, {3.767447806856612*^9, 
  3.767447814544712*^9}, {3.76744993168874*^9, 3.76744994276999*^9}, {
  3.7826552143586717`*^9, 3.7826552578428774`*^9}, {3.782655290186495*^9, 
  3.782655300623965*^9}, {3.7844725656385136`*^9, 3.7844725686856365`*^9}, {
  3.7845390869807477`*^9, 3.784539088824651*^9}, {3.8118689810124674`*^9, 
  3.811868999379013*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[10]:=",ExpressionUUID->"f619c123-566c-42f1-a68a-7bbe2814a613"]
}, Closed]],

Cell[CellGroupData[{

Cell["IDPlotFields", "Subsection",
 CellChangeTimes->{
  3.7667548496524267`*^9},ExpressionUUID->"75a7f740-ea21-4afe-8108-\
05b029f59846"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IDPlotFields", "::", "usage"}], " ", "=", " ", 
    "\"\<IDPlotFields[ID, p, pRange, p2:0, p3:0, BRange:{All, All}]: Plot the \
ID magnetic field versus the coordinate p ('x', 'y' or 'z').\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDPlotFields", "[", 
    RowBox[{"ID_", ",", " ", "p_", ",", "pRange_", ",", " ", 
     RowBox[{"p2_:", "0"}], ",", " ", 
     RowBox[{"p3_:", "0"}], ",", " ", 
     RowBox[{"BRange_:", 
      RowBox[{"{", 
       RowBox[{"All", ",", " ", "All"}], "}"}]}], " ", ",", " ", 
     RowBox[{"Silent_:", "0"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"plots", ",", " ", "t0", ",", " ", "t1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t0", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"plots", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"p", " ", "\[Equal]", " ", "\"\<x\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"radFld", "[", 
                RowBox[{"ID", ",", "\"\<Bx\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "p2", ",", "p3"}], "}"}]}], "]"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"pRange", ",", " ", "BRange"}], "}"}]}], ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<x [mm]\>\"", ",", "\"\<Bx[T]\>\""}], "}"}]}], 
              ",", " ", 
              RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", "  ", 
              RowBox[{"PlotLegends", "\[Rule]", " ", 
               RowBox[{"{", "\"\<Bx\>\"", "}"}]}]}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"radFld", "[", 
                RowBox[{"ID", ",", "\"\<By\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "p2", ",", "p3"}], "}"}]}], "]"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"pRange", ",", "  ", "BRange"}], "}"}]}], ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<x [mm]\>\"", ",", "\"\<By[T]\>\""}], "}"}]}], 
              ",", " ", 
              RowBox[{"PlotStyle", "\[Rule]", "Green"}], ",", "  ", 
              RowBox[{"PlotLegends", "\[Rule]", " ", 
               RowBox[{"{", "\"\<By\>\"", "}"}]}]}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"radFld", "[", 
                RowBox[{"ID", ",", "\"\<Bz\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "p2", ",", "p3"}], "}"}]}], "]"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"pRange", ",", " ", "BRange"}], "}"}]}], ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<x [mm]\>\"", ",", "\"\<Bz[T]\>\""}], "}"}]}], 
              ",", " ", 
              RowBox[{"PlotStyle", "\[Rule]", "Blue"}], ",", "  ", 
              RowBox[{"PlotLegends", "\[Rule]", " ", 
               RowBox[{"{", "\"\<Bz\>\"", "}"}]}]}], "]"}]}], "]"}], ";"}], 
         ")"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"p", " ", "\[Equal]", " ", "\"\<y\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"radFld", "[", 
                RowBox[{"ID", ",", "\"\<Bx\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"p2", ",", "y", ",", "p3"}], "}"}]}], "]"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"pRange", ",", " ", "BRange"}], "}"}]}], ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<y [mm]\>\"", ",", "\"\<Bx[T]\>\""}], "}"}]}], 
              ",", " ", 
              RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", "  ", 
              RowBox[{"PlotLegends", "\[Rule]", " ", 
               RowBox[{"{", "\"\<Bx\>\"", "}"}]}]}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"radFld", "[", 
                RowBox[{"ID", ",", "\"\<By\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"p2", ",", "y", ",", "p3"}], "}"}]}], "]"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"pRange", ",", "  ", "BRange"}], "}"}]}], ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<y [mm]\>\"", ",", "\"\<By[T]\>\""}], "}"}]}], 
              ",", " ", 
              RowBox[{"PlotStyle", "\[Rule]", "Green"}], ",", "  ", 
              RowBox[{"PlotLegends", "\[Rule]", " ", 
               RowBox[{"{", "\"\<By\>\"", "}"}]}]}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"radFld", "[", 
                RowBox[{"ID", ",", "\"\<Bz\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"p2", ",", "y", ",", "p3"}], "}"}]}], "]"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"pRange", ",", "BRange"}], "}"}]}], ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<y [mm]\>\"", ",", "\"\<Bz[T]\>\""}], "}"}]}], 
              ",", " ", 
              RowBox[{"PlotStyle", "\[Rule]", "Blue"}], ",", "  ", 
              RowBox[{"PlotLegends", "\[Rule]", " ", 
               RowBox[{"{", "\"\<Bz\>\"", "}"}]}]}], "]"}]}], "]"}], ";"}], 
         ")"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"p", " ", "\[Equal]", " ", "\"\<z\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"radFld", "[", 
                RowBox[{"ID", ",", "\"\<Bx\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"p2", ",", "p3", ",", "z"}], "}"}]}], "]"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"z", ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"pRange", ",", " ", "BRange"}], "}"}]}], ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<z [mm]\>\"", ",", "\"\<Bx[T]\>\""}], "}"}]}], 
              ",", " ", 
              RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", "  ", 
              RowBox[{"PlotLegends", "\[Rule]", " ", 
               RowBox[{"{", "\"\<Bx\>\"", "}"}]}]}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"radFld", "[", 
                RowBox[{"ID", ",", "\"\<By\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"p2", ",", "p3", ",", "z"}], "}"}]}], "]"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"z", ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"pRange", ",", "  ", "BRange"}], "}"}]}], ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<z [mm]\>\"", ",", "\"\<By[T]\>\""}], "}"}]}], 
              ",", " ", 
              RowBox[{"PlotStyle", "\[Rule]", "Green"}], ",", "  ", 
              RowBox[{"PlotLegends", "\[Rule]", " ", 
               RowBox[{"{", "\"\<By\>\"", "}"}]}]}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"radFld", "[", 
                RowBox[{"ID", ",", "\"\<Bz\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"p2", ",", "p3", ",", "z"}], "}"}]}], "]"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"z", ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"pRange", ",", "BRange"}], "}"}]}], ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<z [mm]\>\"", ",", "\"\<Bz[T]\>\""}], "}"}]}], 
              ",", " ", 
              RowBox[{"PlotStyle", "\[Rule]", "Blue"}], ",", "  ", 
              RowBox[{"PlotLegends", "\[Rule]", " ", 
               RowBox[{"{", "\"\<Bz\>\"", "}"}]}]}], "]"}]}], "]"}], ";"}], 
         ")"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", " ", "Silent"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<IDPlotFields: elapsed time = \>\"", ",", 
           RowBox[{"(", 
            RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "plots", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7674474943805976`*^9, 3.767447507209737*^9}, 
   3.7674475635600443`*^9, {3.767447820092058*^9, 3.767447829967826*^9}, {
   3.7826561255566607`*^9, 3.7826561994021025`*^9}, {3.7826562490425296`*^9, 
   3.7826562914642067`*^9}, {3.8119938559702997`*^9, 3.811993875414157*^9}, {
   3.8119940298393707`*^9, 3.8119940361520557`*^9}, {3.815746982764694*^9, 
   3.815747004835119*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[12]:=",ExpressionUUID->"bd41ff99-499b-46be-91ce-555d82436805"]
}, Closed]],

Cell[CellGroupData[{

Cell["IDFieldIntegrals", "Subsection",
 CellChangeTimes->{
  3.7667548688726835`*^9},ExpressionUUID->"bb19f30a-f850-414b-b3be-\
1dd929f5855c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IDFieldIntegrals", "::", "usage"}], " ", "=", " ", 
    "\"\<IDFieldIntegrals[ID, field, yrange, ny]: Returns the first and \
second magnetic field integrals. The unit is G.cm for the first integral and \
T.cm\.b2 for the second integral.\>\""}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDFieldIntegrals", "[", 
    RowBox[{
    "ID_", ",", " ", "field_", ",", " ", "lrange_", ",", " ", "nl_", ",", " ", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"{", 
       RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "False"}], "}"}], "]"}]}], 
    "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "llist", ",", " ", "firstintlist", ",", " ", "i", ",", " ", "sfl", ",", 
       " ", "firstint", ",", " ", "secondint", ",", " ", "t0", ",", " ", "t1",
        ",", " ", "Silent"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t0", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Silent", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Silent\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"firstint", " ", "=", " ", 
       RowBox[{"radFldInt", "[", 
        RowBox[{"ID", ",", "\"\<fin\>\"", ",", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"\"\<i\>\"", ",", " ", "field"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0", ",", "  ", 
           RowBox[{"lrange", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0", ",", " ", 
           RowBox[{"lrange", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"llist", " ", "=", " ", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{"#", "&"}], ",", "nl", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"lrange", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"lrange", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"sfl", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"firstintlist", " ", "=", " ", 
       RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", " ", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", " ", 
        RowBox[{"i", "\[LessEqual]", " ", 
         RowBox[{
          RowBox[{"Length", "[", "llist", "]"}], "-", "1"}]}], ",", " ", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sfl", " ", "=", " ", 
          RowBox[{"sfl", " ", "+", " ", 
           RowBox[{"radFldInt", "[", 
            RowBox[{"ID", ",", "\"\<fin\>\"", ",", 
             RowBox[{"StringJoin", "[", 
              RowBox[{"\"\<i\>\"", ",", " ", "field"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "  ", 
               RowBox[{"llist", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "  ", "0", ",", " ", 
               RowBox[{"llist", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"firstintlist", ",", " ", "sfl"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"secondint", " ", "=", " ", 
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Interpolation", "[", 
           RowBox[{
            RowBox[{"Transpose", "@", 
             RowBox[{"{", 
              RowBox[{"llist", ",", " ", "firstintlist"}], "}"}]}], ",", " ", 
            RowBox[{"InterpolationOrder", "\[Rule]", "3"}]}], "]"}], "[", "u",
           "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"u", ",", " ", 
           RowBox[{"lrange", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
           RowBox[{"lrange", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"firstint", " ", "=", " ", 
       RowBox[{"firstint", "*", "1000"}]}], " ", ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"[", 
         RowBox[{"T", ".", "mm"}], "]"}], " ", "\[Rule]", " ", 
        RowBox[{"[", 
         RowBox[{"G", ".", "cm"}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"secondint", " ", "=", " ", 
       RowBox[{"secondint", "*", "100"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"[", 
         RowBox[{"T", ".", "mm\.b2"}], "]"}], " ", "\[Rule]", " ", 
        RowBox[{"[", 
         RowBox[{"G", ".", "cm\.b2"}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", " ", "Silent"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "field", ",", " ", "\"\< First integral: \>\"", ",", " ", 
           "firstint", ",", "\"\< G.cm\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "field", ",", " ", "\"\< Second integral: \>\"", ",", " ", 
           "secondint", ",", "\"\< G.cm\.b2\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<IDFieldIntegrals: elapsed time = \>\"", ",", 
           RowBox[{"(", 
            RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"firstint", ",", " ", "secondint"}], "}"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.767447519038801*^9, 3.7674475570126853`*^9}, {
  3.7674478527196264`*^9, 3.767447856876173*^9}, {3.7674486002357836`*^9, 
  3.7674486471790524`*^9}, {3.782655379174*^9, 3.782655472079883*^9}, {
  3.782655523001548*^9, 3.78265553242339*^9}, {3.8062342296637506`*^9, 
  3.8062342486693964`*^9}, {3.815745479423485*^9, 3.8157455231570635`*^9}, {
  3.8157508495658913`*^9, 3.815750856466805*^9}, {3.8157532035553007`*^9, 
  3.815753204065875*^9}, {3.8157566108675365`*^9, 3.81575661141105*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[14]:=",ExpressionUUID->"24664741-e07d-4598-8b68-6b4113008b82"]
}, Closed]],

Cell[CellGroupData[{

Cell["IDFieldIntegralsFast", "Subsection",
 CellChangeTimes->{
  3.7667548688726835`*^9, {3.816633593553114*^9, 3.8166335941013985`*^9}, {
   3.8167015223022566`*^9, 3.8167015224939375`*^9}, {3.816879986192546*^9, 
   3.8168799863306847`*^9}},ExpressionUUID->"cdeaf6fe-40fd-4cda-8432-\
a30fc6389d80"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IDFieldIntegralsFast", "::", "usage"}], " ", "=", " ", 
    "\"\<IDFieldIntegralsFast[ID, field, yrange, ny]: Returns the first and \
second magnetic field integrals. The unit is G.cm for the first integral and \
T.cm\.b2 for the second integral.\>\""}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDFieldIntegralsFast", "[", 
    RowBox[{
    "ID_", ",", " ", "field_", ",", " ", "lrange_", ",", " ", "nl_", ",", " ", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"{", 
       RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "False"}], "}"}], "]"}]}], 
    "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "llist", ",", " ", "firstintlist", ",", " ", "i", ",", " ", "firstint", 
       ",", " ", "secondint", ",", " ", "t0", ",", " ", "t1", ",", " ", 
       "Silent", ",", " ", "lstep", ",", " ", "IB", ",", " ", "IIB", ",", " ",
        "B", ",", " ", "ibsum", ",", " ", "iibsum"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t0", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Silent", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Silent\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"lstep", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"lrange", "[", 
           RowBox[{"[", "2", "]"}], "]"}], " ", "-", " ", 
          RowBox[{"lrange", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", "nl"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"IB", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"IIB", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"B", " ", "=", " ", 
       RowBox[{"radFldLst", "[", 
        RowBox[{"ID", ",", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"\"\<i\>\"", ",", " ", "field"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0", ",", "  ", 
           RowBox[{"lrange", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0", ",", " ", 
           RowBox[{"lrange", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", " ", "nl", ",", 
         " ", "\"\<noarg\>\"", ",", " ", 
         RowBox[{"lrange", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"IB", " ", "=", " ", 
       RowBox[{"Accumulate", "[", "B", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"IIB", " ", "=", " ", 
       RowBox[{"Accumulate", "[", "IB", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"IB", " ", "=", " ", 
       RowBox[{"IB", "*", "lstep"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"IIB", " ", "=", " ", 
       RowBox[{"IIB", "*", "lstep", "*", "lstep"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"firstint", " ", "=", " ", 
       RowBox[{
        RowBox[{"IB", "[", 
         RowBox[{"[", 
          RowBox[{"Length", "[", "IB", "]"}], "]"}], "]"}], "*", "1000"}]}], 
      " ", ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"[", 
         RowBox[{"T", ".", "mm"}], "]"}], " ", "\[Rule]", " ", 
        RowBox[{"[", 
         RowBox[{"G", ".", "cm"}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"secondint", " ", "=", 
       RowBox[{
        RowBox[{"IIB", "[", 
         RowBox[{"[", 
          RowBox[{"Length", "[", "IIB", "]"}], "]"}], "]"}], "*", "100"}]}], 
      ";", " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"[", 
         RowBox[{"T", ".", "mm\.b2"}], "]"}], " ", "\[Rule]", " ", 
        RowBox[{"[", 
         RowBox[{"G", ".", "cm\.b2"}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", " ", "Silent"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "field", ",", " ", "\"\< First integral: \>\"", ",", " ", 
           "firstint", ",", "\"\< G.cm\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "field", ",", " ", "\"\< Second integral: \>\"", ",", " ", 
           "secondint", ",", "\"\< G.cm\.b2\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<IDFieldIntegrals: elapsed time = \>\"", ",", 
           RowBox[{"(", 
            RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"firstint", ",", " ", "secondint"}], "}"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.767447519038801*^9, 3.7674475570126853`*^9}, {
  3.7674478527196264`*^9, 3.767447856876173*^9}, {3.7674486002357836`*^9, 
  3.7674486471790524`*^9}, {3.782655379174*^9, 3.782655472079883*^9}, {
  3.782655523001548*^9, 3.78265553242339*^9}, {3.8062342296637506`*^9, 
  3.8062342486693964`*^9}, {3.815745479423485*^9, 3.8157455231570635`*^9}, {
  3.8157508495658913`*^9, 3.815750856466805*^9}, {3.8157532035553007`*^9, 
  3.815753204065875*^9}, {3.8157566108675365`*^9, 3.81575661141105*^9}, {
  3.816633607601183*^9, 3.8166336118684316`*^9}, {3.81663364247663*^9, 
  3.816633850091959*^9}, {3.8167015271529093`*^9, 3.8167015653895493`*^9}, {
  3.8168799883918858`*^9, 3.816879993142429*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[16]:=",ExpressionUUID->"a88e2988-4885-46a3-ab3f-cbf916edb31d"]
}, Closed]],

Cell[CellGroupData[{

Cell["IDFieldPhase", "Subsection",
 CellChangeTimes->{
  3.7667548688726835`*^9, {3.814004773706389*^9, 
   3.8140047880793447`*^9}},ExpressionUUID->"c7130cda-35d4-4dfa-aec2-\
ed9d1e576d19"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IDFieldPhase", "::", "usage"}], " ", "=", " ", 
    "\"\<IDFieldPhase[ID, lrange, nl]: Returns the phase between By and Bx \
[radians].\>\""}], ";"}], " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDFieldPhase", "[", 
    RowBox[{"ID_", ",", "lrange_", ",", " ", "nl_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "bx", ",", " ", "by", ",", " ", "phase", ",", "  ", "fftx", ",", " ", 
       "ffty", ",", " ", "max", ",", " ", "pos", ",", "  ", "t0", ",", " ", 
       "t1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t0", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"bx", " ", "=", " ", 
       RowBox[{"radFldLst", "[", 
        RowBox[{"ID", ",", " ", "\"\<bx\>\"", ",", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0", ",", " ", 
           RowBox[{"lrange", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0", ",", " ", 
           RowBox[{"lrange", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", " ", "nl", ",", 
         " ", "\"\<noarg\>\"", ",", " ", 
         RowBox[{"lrange", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"by", " ", "=", " ", 
       RowBox[{"radFldLst", "[", 
        RowBox[{"ID", ",", " ", "\"\<by\>\"", ",", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0", ",", " ", 
           RowBox[{"lrange", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0", ",", " ", 
           RowBox[{"lrange", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", " ", "nl", ",", " ",
          "\"\<noarg\>\"", ",", " ", 
         RowBox[{"lrange", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"fftx", "=", 
       RowBox[{"Fourier", "[", 
        RowBox[{"bx", ",", 
         RowBox[{"FourierParameters", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ffty", "=", 
       RowBox[{"Fourier", "[", 
        RowBox[{"by", ",", 
         RowBox[{"FourierParameters", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"max", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Abs", "[", "ffty", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"First", "[", 
        RowBox[{"First", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Abs", "[", "ffty", "]"}], ",", "max"}], "]"}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phase", " ", "=", " ", 
       RowBox[{
        RowBox[{"Arg", "[", 
         RowBox[{"ffty", "[", 
          RowBox[{"[", "pos", "]"}], "]"}], "]"}], "-", 
        RowBox[{"Arg", "[", 
         RowBox[{"fftx", "[", 
          RowBox[{"[", "pos", "]"}], "]"}], "]"}]}]}], ";", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<IDFieldPhase: elapsed time = \>\"", ",", 
        RowBox[{"(", 
         RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "phase", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.767447519038801*^9, 3.7674475570126853`*^9}, {
  3.7674478527196264`*^9, 3.767447856876173*^9}, {3.7674486002357836`*^9, 
  3.7674486471790524`*^9}, {3.782655379174*^9, 3.782655472079883*^9}, {
  3.782655523001548*^9, 3.78265553242339*^9}, {3.8062342296637506`*^9, 
  3.8062342486693964`*^9}, {3.8140047791487875`*^9, 3.8140048030103016`*^9}, {
  3.814004846343008*^9, 3.8140050344263144`*^9}, {3.8140051047107515`*^9, 
  3.814005147863482*^9}, {3.81400575161285*^9, 3.814005757983315*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[18]:=",ExpressionUUID->"aa4fa799-86cd-462b-b44a-5bf06a051ea2"]
}, Closed]],

Cell[CellGroupData[{

Cell["IDFieldMap", "Subsection",
 CellChangeTimes->{{3.7667548871084976`*^9, 3.76675490671941*^9}, 
   3.767449882481743*^9, 
   3.7826556381260996`*^9},ExpressionUUID->"316b54f4-260c-4ab7-bc23-\
0da6dd39fb46"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IDFieldMap", "::", "usage"}], " ", "=", " ", 
    "\"\<IDFieldMapNoTransf[fieldmapname, ID, xrange, yrange, zrange, nx, ny, \
nz]: Writes the fieldmap to file.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDFieldMap", "[", 
    RowBox[{
    "fieldmapname_", ",", " ", "ID_", ",", "xrange_", ",", " ", "yrange_", 
     ",", " ", "zrange_", ",", " ", "nx_", ",", " ", "ny_", ",", " ", "nz_"}],
     " ", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "fieldmap", ",", " ", "hmin", ",", " ", "hmax", ",", " ", "vmin", ",", 
       " ", "vmax", ",", " ", "smin", ",", " ", "smax", ",", "nh", ",", " ", 
       "nv", ",", " ", "ns", ",", " ", "hstep", ",", " ", "vstep", ",", " ", 
       "sstep", ",", " ", "h", ",", " ", "v", ",", " ", "s", ",", "  ", "i", 
       ",", " ", "j", ",", " ", "k", ",", "field", ",", " ", "line", ",", " ",
        "t0", ",", " ", "t1"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t0", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"fieldmap", "=", 
       RowBox[{"OpenWrite", "[", "fieldmapname", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"hmin", " ", "=", 
       RowBox[{"xrange", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"hmax", " ", "=", 
       RowBox[{"xrange", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nh", " ", "=", " ", "nx"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"vmin", " ", "=", 
       RowBox[{"yrange", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vmax", " ", "=", 
       RowBox[{"yrange", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nv", " ", "=", " ", "ny"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"smin", " ", "=", 
       RowBox[{"zrange", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"smax", " ", "=", 
       RowBox[{"zrange", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ns", " ", "=", "nz"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"hmin", " ", "\[NotEqual]", " ", "hmax"}], ")"}], ",", 
        RowBox[{"hstep", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"hmax", "-", "hmin"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"nh", "-", "1"}], ")"}]}]}], ",", " ", 
        RowBox[{"hstep", "=", "0"}]}], " ", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"vmin", " ", "\[NotEqual]", " ", "vmax"}], ")"}], ",", 
        RowBox[{"vstep", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"vmax", "-", "vmin"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"nv", "-", "1"}], ")"}]}]}], ",", " ", 
        RowBox[{"vstep", "=", "0"}]}], " ", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"smin", " ", "\[NotEqual]", " ", "smax"}], ")"}], ",", 
        RowBox[{"sstep", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"smax", "-", "smin"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"ns", "-", "1"}], ")"}]}]}], ",", " ", 
        RowBox[{"sstep", "=", "0"}]}], " ", "]"}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", " ", 
        RowBox[{
        "\"\<X[mm]\>\"", "<>", " ", "\"\<\\t\>\"", "<>", " ", "\"\<Y[mm]\>\"",
          "<>", " ", "\"\<\\t\>\"", "<>", " ", "\"\<Z[mm]\>\"", "<>", " ", 
         "\"\<\\t\>\"", "<>", " ", "\"\<Bx[T]\>\"", "<>", " ", "\"\<\\t\>\"", 
         "<>", " ", "\"\<By[T]\>\"", "<>", " ", "\"\<\\t\>\"", "<>", " ", 
         "\"\<Bz[T]\>\"", "<>", "\"\<\\n\>\""}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{
       "fieldmap", ",", 
        "\"\<-----------------------------------------------------------------\
------------------------------------------------------------------------------\
-------------------\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "1"}], ",", 
        RowBox[{"k", "\[LessEqual]", "ns"}], ",", 
        RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", "nv"}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"i", "=", "1"}], ",", 
              RowBox[{"i", "\[LessEqual]", "nh"}], ",", 
              RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"h", " ", "=", " ", 
                RowBox[{"hmin", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"i", "-", "1"}], ")"}], "*", "hstep"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"v", " ", "=", " ", 
                RowBox[{"vmin", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"j", "-", "1"}], ")"}], "*", "vstep"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"s", " ", "=", " ", 
                RowBox[{"smin", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"k", "-", "1"}], ")"}], "*", "sstep"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"field", " ", "=", " ", 
                RowBox[{"radFld", "[", 
                 RowBox[{"ID", ",", "\"\<b\>\"", ",", 
                  RowBox[{"{", 
                   RowBox[{"h", ",", "v", ",", " ", "s"}], "}"}]}], "]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"line", " ", "=", 
                RowBox[{
                 RowBox[{"auxIDNumberToString", "[", "h", "]"}], "<>", " ", 
                 "\"\<\\t\>\"", " ", "<>", " ", 
                 RowBox[{"auxIDNumberToString", "[", "v", "]"}], " ", "<>", 
                 " ", "\"\<\\t\>\"", " ", "<>", " ", 
                 RowBox[{"auxIDNumberToString", "[", "s", "]"}], " ", "<>", 
                 "\"\<\\t\>\"", " ", "<>", " ", 
                 RowBox[{"auxIDNumberToString", "[", 
                  RowBox[{"field", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "<>", " ", 
                 "\"\<\\t\>\"", " ", "<>", "  ", 
                 RowBox[{"auxIDNumberToString", "[", 
                  RowBox[{"field", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", " ", 
                 "\"\<\\t\>\"", " ", "<>", "  ", 
                 RowBox[{"auxIDNumberToString", "[", 
                  RowBox[{"field", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", 
                 "\"\<\\n\>\""}]}], "  ", ";", " ", "\[IndentingNewLine]", 
               RowBox[{"WriteString", "[", 
                RowBox[{"fieldmap", ",", "line"}], "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Close", "[", "fieldmap", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Fieldmap saved in file: \>\"", ",", " ", "fieldmapname"}],
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<IDFieldMap: elapsed time = \>\"", ",", 
        RowBox[{"(", 
         RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.767447676712742*^9, 3.7674476901356754`*^9}, {
   3.767447877752833*^9, 3.7674478819250393`*^9}, {3.7674498877634153`*^9, 
   3.7674499000768747`*^9}, {3.782655619766797*^9, 3.7826556288292556`*^9}, {
   3.7826568647102003`*^9, 3.782656886835105*^9}, 3.784621350331092*^9, {
   3.8205729767118607`*^9, 3.8205729776318617`*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[20]:=",ExpressionUUID->"40008148-2423-4d1a-aa09-6e0b7f4651d7"]
}, Closed]],

Cell[CellGroupData[{

Cell["IDFieldMapWithHeader", "Subsection",
 CellChangeTimes->{{3.7667548871084976`*^9, 3.76675490671941*^9}, 
   3.767449882481743*^9, 3.7826556381260996`*^9, {3.820132820008762*^9, 
   3.820132822768936*^9}},ExpressionUUID->"b5d71522-78aa-4e39-b901-\
2b1c796bfe78"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IDFieldMapWithHeader", "::", "usage"}], " ", "=", " ", 
    "\"\<IDFieldMapWithHeader[ID, xrange, yrange, zrange, nx, ny, nz, \
magnetname, polarization, magnetlength, phaselabel, \[Lambda]u, Gap, \
\[Delta]P, \[Delta]GV, \[Delta]GH, \[Delta]CP]: Writes the fieldmap to \
file.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDFieldMapWithHeader", "[", 
    RowBox[{
    "ID_", ",", " ", "xrange_", ",", " ", "yrange_", ",", " ", "zrange_", ",",
      " ", "nx_", ",", " ", "ny_", ",", " ", "nz_", ",", "magnetname_", ",", 
     " ", "polarization_", ",", "phasename_", ",", "  ", "magnetlength_", ",",
      "\[Lambda]u_", ",", " ", "Gap_", ",", "  ", "\[Delta]P_", ",", " ", 
     "\[Delta]GV_", ",", " ", "\[Delta]GH_", ",", " ", "\[Delta]CP_"}], "]"}],
    " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "fieldmap", ",", " ", "fieldmapname", ",", " ", "date", ",", "  ", 
       "timestamp", ",", "  ", "hmin", ",", " ", "hmax", ",", " ", "vmin", 
       ",", " ", "vmax", ",", " ", "smin", ",", " ", "smax", ",", "nh", ",", 
       " ", "nv", ",", " ", "ns", ",", " ", "hstep", ",", " ", "vstep", ",", 
       " ", "sstep", ",", " ", "h", ",", " ", "v", ",", " ", "s", ",", "  ", 
       "i", ",", " ", "j", ",", " ", "k", ",", "field", ",", " ", "line", ",",
        " ", "t0", ",", " ", "t1", ",", " ", "Bh", ",", " ", "Bv", ",", " ", 
       "Kh", ",", " ", "Kv", ",", " ", "K", ",", " ", "PosURC", ",", " ", 
       "PosULC", ",", " ", "PosBLC", ",", " ", "PosBRC"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t0", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"date", " ", "=", " ", 
       RowBox[{"DateString", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Year\>\"", ",", "\"\<-\>\"", ",", "\"\<Month\>\"", ",", 
          "\"\<-\>\"", ",", "\"\<Day\>\""}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"timestamp", " ", "=", " ", 
       RowBox[{"date", " ", "<>", "\"\<_\>\"", "<>", " ", 
        RowBox[{"DateString", "[", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Hour24\>\"", ",", "\"\<-\>\"", ",", "\"\<Minute\>\"", ",", 
           "\"\<-\>\"", ",", " ", "\"\<Second\>\""}], "}"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"PosURC", " ", "=", "\[Delta]GV"}], ";", "\[IndentingNewLine]", 
      RowBox[{"PosULC", " ", "=", " ", 
       RowBox[{
       "\[Delta]GV", "+", " ", "\[Delta]GH", "+", " ", "\[Delta]P", "+", 
        "\[Delta]CP"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"PosBLC", " ", "=", "\[Delta]GH"}], ";", "\[IndentingNewLine]", 
      RowBox[{"PosBRC", " ", "=", 
       RowBox[{"\[Delta]P", "-", "\[Delta]CP"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"Bh", " ", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{"radFldLst", "[", 
          RowBox[{"ID", ",", " ", "\"\<Bx\>\"", ",", " ", 
           RowBox[{"{", " ", 
            RowBox[{"0", ",", "0", ",", " ", 
             RowBox[{"-", "\[Lambda]u"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "\[Lambda]u"}], "}"}], ",", " ", 
           "100", ",", " ", "\"\<noarg\>\"", ",", " ", 
           RowBox[{"-", "\[Lambda]u"}]}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Bv", " ", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{"radFldLst", "[", 
          RowBox[{"ID", ",", " ", "\"\<By\>\"", ",", " ", 
           RowBox[{"{", " ", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "\[Lambda]u"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "\[Lambda]u"}], "}"}], ",", " ", 
           "100", ",", " ", "\"\<noarg\>\"", ",", " ", 
           RowBox[{"-", "\[Lambda]u"}]}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Kh", " ", "=", " ", 
       RowBox[{"0.934", "*", "Bv", "*", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]u", "/", "10"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Kv", " ", "=", " ", 
       RowBox[{"0.934", "*", "Bh", "*", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]u", "/", "10"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"K", " ", "=", " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"Kh", "^", "2"}], " ", "+", " ", 
         RowBox[{"Kv", "^", "2"}]}], " ", "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"Kh", " ", "=", " ", 
       RowBox[{"Round", "[", 
        RowBox[{"Kh", ",", " ", "0.01"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Kv", "=", " ", 
       RowBox[{"Round", "[", 
        RowBox[{"Kv", ",", " ", "0.01"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"K", " ", "=", " ", 
       RowBox[{"Round", "[", 
        RowBox[{"K", ",", " ", "0.01"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"fieldmapname", " ", "=", 
       RowBox[{
        RowBox[{
        "StringTemplate", "[", "\"\<`1`_`2`_`3`_Kh=`4`_Kv=`5`\>\"", "]"}], 
        "[", 
        RowBox[{
        "date", ",", " ", "magnetname", ",", " ", "polarization", ",", " ", 
         "Kh", ",", " ", "Kv"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nx", " ", ">", " ", "1"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"fieldmapname", " ", "=", " ", 
          RowBox[{
           RowBox[{"StringTemplate", "[", "\"\<`1`_X=`2`_`3`mm\>\"", "]"}], 
           "[", 
           RowBox[{"fieldmapname", ",", " ", 
            RowBox[{"xrange", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
            RowBox[{"xrange", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], " ", ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ny", " ", ">", " ", "1"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"fieldmapname", " ", "=", " ", 
          RowBox[{
           RowBox[{"StringTemplate", "[", "\"\<`1`_Y=`2`_`3`mm\>\"", "]"}], 
           "[", 
           RowBox[{"fieldmapname", ",", " ", 
            RowBox[{"yrange", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
            RowBox[{"yrange", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], " ", ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nz", " ", ">", " ", "1"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"fieldmapname", " ", "=", " ", 
          RowBox[{
           RowBox[{"StringTemplate", "[", "\"\<`1`_Z=`2`_`3`mm\>\"", "]"}], 
           "[", 
           RowBox[{"fieldmapname", ",", " ", 
            RowBox[{"zrange", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
            RowBox[{"zrange", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], " ", ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringLength", "[", "phasename", "]"}], " ", "\[NotEqual]", 
         " ", "0"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{"fieldmapname", " ", "=", " ", 
         RowBox[{
         "fieldmapname", " ", "<>", " ", "\"\<_\>\"", " ", "<>", " ", 
          "phasename", "<>", " ", "\"\<.fld\>\""}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"fieldmapname", " ", "=", " ", 
         RowBox[{"fieldmapname", "  ", "<>", " ", "\"\<.fld\>\""}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"fieldmap", "=", 
       RowBox[{"OpenWrite", "[", "fieldmapname", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<timestamp:\\t`1`\\n\>\"", "]"}], 
        "[", "timestamp", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<filename:\\t`1`\\n\>\"", "]"}], 
        "[", "fieldmapname", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<magnet_name:\\t`1`\\n\>\"", "]"}],
         "[", "magnetname", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<gap[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "Gap", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{
        "StringTemplate", "[", "\"\<period_length[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "\[Lambda]u", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{
        "StringTemplate", "[", "\"\<magnet_length[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "magnetlength", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<dP[mm]:\\t\\t`1`\\n\>\"", "]"}], 
        "[", "\[Delta]P", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<dGV[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "\[Delta]GV", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<dGH[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "\[Delta]GH", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<dCP[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "\[Delta]CP", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<posURC[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "PosURC", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<posULC[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "PosULC", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<posBRC[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "PosBRC", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<posBLC[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "PosBLC", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{
        "StringTemplate", "[", "\"\<K_Horizontal:\\t`1`\\n\>\"", "]"}], "[", 
        "Kh", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<K_Vertical:\\t`1`\\n\>\"", "]"}], 
        "[", "Kv", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<K:\\t\\t`1`\\n\>\"", "]"}], "[", 
        "K", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "\"\<\\n\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"hmin", " ", "=", 
       RowBox[{"xrange", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"hmax", " ", "=", 
       RowBox[{"xrange", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nh", " ", "=", " ", "nx"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"vmin", " ", "=", 
       RowBox[{"yrange", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vmax", " ", "=", 
       RowBox[{"yrange", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nv", " ", "=", " ", "ny"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"smin", " ", "=", 
       RowBox[{"zrange", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"smax", " ", "=", 
       RowBox[{"zrange", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ns", " ", "=", "nz"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"hmin", " ", "\[NotEqual]", " ", "hmax"}], ")"}], ",", 
        RowBox[{"hstep", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"hmax", "-", "hmin"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"nh", "-", "1"}], ")"}]}]}], ",", " ", 
        RowBox[{"hstep", "=", "0"}]}], " ", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"vmin", " ", "\[NotEqual]", " ", "vmax"}], ")"}], ",", 
        RowBox[{"vstep", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"vmax", "-", "vmin"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"nv", "-", "1"}], ")"}]}]}], ",", " ", 
        RowBox[{"vstep", "=", "0"}]}], " ", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"smin", " ", "\[NotEqual]", " ", "smax"}], ")"}], ",", 
        RowBox[{"sstep", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"smax", "-", "smin"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"ns", "-", "1"}], ")"}]}]}], ",", " ", 
        RowBox[{"sstep", "=", "0"}]}], " ", "]"}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", " ", 
        RowBox[{
        "\"\<X[mm]\>\"", "<>", " ", "\"\<\\t\>\"", "<>", " ", "\"\<Y[mm]\>\"",
          "<>", " ", "\"\<\\t\>\"", "<>", " ", "\"\<Z[mm]\>\"", "<>", " ", 
         "\"\<\\t\>\"", "<>", " ", "\"\<Bx[T]\>\"", "<>", " ", "\"\<\\t\>\"", 
         "<>", " ", "\"\<By[T]\>\"", "<>", " ", "\"\<\\t\>\"", "<>", " ", 
         "\"\<Bz[T]\>\"", "<>", "\"\<\\n\>\""}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{
       "fieldmap", ",", 
        "\"\<-----------------------------------------------------------------\
------------------------------------------------------------------------------\
-------------------\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "1"}], ",", 
        RowBox[{"k", "\[LessEqual]", "ns"}], ",", 
        RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", "nv"}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"i", "=", "1"}], ",", 
              RowBox[{"i", "\[LessEqual]", "nh"}], ",", 
              RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"h", " ", "=", " ", 
                RowBox[{"hmin", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"i", "-", "1"}], ")"}], "*", "hstep"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"v", " ", "=", " ", 
                RowBox[{"vmin", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"j", "-", "1"}], ")"}], "*", "vstep"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"s", " ", "=", " ", 
                RowBox[{"smin", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"k", "-", "1"}], ")"}], "*", "sstep"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"field", " ", "=", " ", 
                RowBox[{"radFld", "[", 
                 RowBox[{"ID", ",", "\"\<b\>\"", ",", 
                  RowBox[{"{", 
                   RowBox[{"h", ",", "v", ",", " ", "s"}], "}"}]}], "]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"line", " ", "=", 
                RowBox[{
                 RowBox[{"auxIDNumberToString", "[", "h", "]"}], "<>", " ", 
                 "\"\<\\t\>\"", " ", "<>", " ", 
                 RowBox[{"auxIDNumberToString", "[", "v", "]"}], " ", "<>", 
                 " ", "\"\<\\t\>\"", " ", "<>", " ", 
                 RowBox[{"auxIDNumberToString", "[", "s", "]"}], " ", "<>", 
                 "\"\<\\t\>\"", " ", "<>", " ", 
                 RowBox[{"auxIDNumberToString", "[", 
                  RowBox[{"field", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "<>", " ", 
                 "\"\<\\t\>\"", " ", "<>", "  ", 
                 RowBox[{"auxIDNumberToString", "[", 
                  RowBox[{"field", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", " ", 
                 "\"\<\\t\>\"", " ", "<>", "  ", 
                 RowBox[{"auxIDNumberToString", "[", 
                  RowBox[{"field", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", 
                 "\"\<\\n\>\""}]}], "  ", ";", " ", "\[IndentingNewLine]", 
               RowBox[{"WriteString", "[", 
                RowBox[{"fieldmap", ",", "line"}], "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Close", "[", "fieldmap", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Fieldmap saved in file: \>\"", ",", " ", "fieldmapname"}],
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<IDFieldMap: elapsed time = \>\"", ",", 
        RowBox[{"(", 
         RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.767447676712742*^9, 3.7674476901356754`*^9}, {
   3.767447877752833*^9, 3.7674478819250393`*^9}, {3.7674498877634153`*^9, 
   3.7674499000768747`*^9}, {3.782655619766797*^9, 3.7826556288292556`*^9}, {
   3.7826568647102003`*^9, 3.782656886835105*^9}, 3.784621350331092*^9, {
   3.8201328287093325`*^9, 3.8201328301894054`*^9}, {3.8201475833268857`*^9, 
   3.82014772475784*^9}, {3.820147903479143*^9, 3.8201479195002623`*^9}, {
   3.8201479575827456`*^9, 3.8201480152565284`*^9}, {3.820148073780411*^9, 
   3.820148094041765*^9}, {3.8201481578859253`*^9, 3.8201484002139997`*^9}, {
   3.820148442706847*^9, 3.8201489300314655`*^9}, {3.8201489649837694`*^9, 
   3.820148998295968*^9}, {3.8201490518994956`*^9, 3.82014945269989*^9}, {
   3.820149575878006*^9, 3.8201496158606415`*^9}, {3.8201496684041023`*^9, 
   3.8201497274780054`*^9}, {3.8201497623102913`*^9, 
   3.8201497783813515`*^9}, {3.8201499985877542`*^9, 3.820150017769049*^9}, {
   3.820150256796426*^9, 3.820150324490906*^9}, {3.82015038955519*^9, 
   3.820150396285636*^9}, {3.820150623392577*^9, 3.8201506453240223`*^9}, {
   3.8201507623230314`*^9, 3.8201507878947144`*^9}, 3.820151721795121*^9, {
   3.820152623918645*^9, 3.82015263157914*^9}, 3.8201528026126175`*^9, {
   3.8201537926163034`*^9, 3.8201537940663977`*^9}, {3.8201569443179674`*^9, 
   3.8201569486982536`*^9}, {3.8202203671869135`*^9, 3.820220375416733*^9}, {
   3.8203186866073475`*^9, 3.820318926733198*^9}, {3.8205729537402887`*^9, 
   3.8205729550203905`*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[22]:=",ExpressionUUID->"1691ba71-b213-4cf8-94e8-cd5d10f95e49"]
}, Closed]],

Cell[CellGroupData[{

Cell["IDRungeKuttaTrajectory", "Subsection",
 CellChangeTimes->{{3.7667548871084976`*^9, 3.76675490671941*^9}, 
   3.7667549708182*^9},ExpressionUUID->"dc98927d-e916-471e-b538-f605e04d23e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IDRungeKuttaTrajectory", "::", "usage"}], " ", "=", " ", 
    "\"\<IDRungeKuttaTrajectory[ID, energy, r0, smax, rkstep]: Calculates the \
particle trajectory using the Runge-Kutta algorithm. The particle energy must \
be in GeV, r0 is the initial position and normalized momentum vector {x0, y0, \
z0, dx0ds, dy0ds, dz0ds}, smax and rkstep are the final longitudinal position \
and the Runge-Kutta step. All positions are in millimeters.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDRungeKuttaTrajectory", "[", 
    RowBox[{
    "ID_", ",", " ", "energy_", ",", "r0_", ",", "smax_", ",", "rkstep_"}], 
    "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "trajectory", ",", " ", "ElectronRestEnergy", ",", " ", "LightSpeed", 
       ",", " ", "beta", ",", " ", "brho", ",", " ", "a", ",", " ", "b", ",", 
       " ", "b1", ",", " ", "b2", ",", " ", "b3", ",", " ", "r", ",", " ", 
       "r1", ",", " ", "r2", ",", " ", "r3", ",", " ", "drds1", ",", " ", 
       "drds2", ",", " ", "drds3", ",", " ", "drds4", ",", " ", "i", ",", " ",
        "sm", ",", " ", "step", ",", " ", "t0", ",", " ", "t1"}], "}"}], ",", 
     "\n", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t0", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"ElectronRestEnergy", "=", "510998.92811"}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"[", "eV", "]"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"LightSpeed", "=", "299792458"}], ";", 
      RowBox[{"(*", 
       RowBox[{"[", 
        RowBox[{"m", "/", "s"}], "]"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"r1", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"r2", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"r3", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"from", " ", "GeV", " ", "to", " ", "eV"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"beta", "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1.0", "-", 
         RowBox[{"(", 
          RowBox[{"1.0", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"energy", "*", 
               RowBox[{"1000000000", "/", "ElectronRestEnergy"}]}], ")"}], 
             "^", "2"}], ")"}]}], ")"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"brho", "=", 
       RowBox[{"(", 
        RowBox[{"beta", "*", "energy", "*", 
         RowBox[{"1000000000", "/", "LightSpeed"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{
        RowBox[{"1.0", "/", "brho"}], "/", "beta"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"r", "=", " ", "r0"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"from", " ", "mm", " ", "to", " ", "m"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", " ", 
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/", "1000"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "=", " ", 
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "/", "1000"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "=", " ", 
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "/", "1000"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sm", " ", "=", " ", 
       RowBox[{"smax", "/", "1000"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"step", " ", "=", " ", 
       RowBox[{"rkstep", "/", "1000"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"trajectory", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"trajectory", ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "*", "1000"}], ",", " ", 
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "*", "1000"}], ",", " ", 
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "*", "1000"}], ",", " ", 
          RowBox[{"r", "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", " ", 
          RowBox[{"r", "[", 
           RowBox[{"[", "5", "]"}], "]"}], ",", " ", 
          RowBox[{"r", "[", 
           RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"While", " ", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "<", "sm"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"b", "=", 
          RowBox[{"radFld", "[", 
           RowBox[{"ID", ",", " ", "\"\<BxByBz\>\"", ",", " ", 
            RowBox[{"1000", "*", 
             RowBox[{"r", "[", 
              RowBox[{"[", 
               RowBox[{";;", "3"}], "]"}], "]"}]}]}], "]"}]}], ";", "\n", 
         "\t", 
         RowBox[{"drds1", "=", 
          RowBox[{"auxIDNewtonLorentzEquation", "[", 
           RowBox[{"a", ",", "r", ",", "b"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", " ", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", " ", 
           RowBox[{"i", "\[LessEqual]", "6"}], ",", " ", 
           RowBox[{"i", "++"}], ",", 
           RowBox[{
            RowBox[{"r1", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"r", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"step", "/", "2.0"}], ")"}], "*", 
              RowBox[{"drds1", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"b1", "=", 
          RowBox[{"radFld", "[", 
           RowBox[{"ID", ",", " ", "\"\<BxByBz\>\"", ",", " ", 
            RowBox[{"1000", "*", 
             RowBox[{"r1", "[", 
              RowBox[{"[", 
               RowBox[{";;", "3"}], "]"}], "]"}]}]}], "]"}]}], ";", "\n", 
         "\t", 
         RowBox[{"drds2", "=", 
          RowBox[{"auxIDNewtonLorentzEquation", "[", 
           RowBox[{"a", ",", "r1", ",", "b1"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", " ", 
           RowBox[{"i", "\[LessEqual]", "6"}], ",", " ", 
           RowBox[{"i", "++"}], ",", 
           RowBox[{
            RowBox[{"r2", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"r", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"step", "/", "2.0"}], ")"}], "*", 
              RowBox[{"drds2", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"b2", "=", 
          RowBox[{"radFld", "[", 
           RowBox[{"ID", ",", " ", "\"\<BxByBz\>\"", ",", " ", 
            RowBox[{"1000", "*", 
             RowBox[{"r2", "[", 
              RowBox[{"[", 
               RowBox[{";;", "3"}], "]"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"drds3", "=", 
          RowBox[{"auxIDNewtonLorentzEquation", "[", 
           RowBox[{"a", ",", "r2", ",", "b2"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", " ", 
           RowBox[{"i", "\[LessEqual]", " ", "6"}], ",", " ", 
           RowBox[{"i", "++"}], ",", " ", 
           RowBox[{
            RowBox[{"r3", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"r", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", 
             RowBox[{"step", "*", 
              RowBox[{"drds3", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"b3", "=", 
          RowBox[{"radFld", "[", 
           RowBox[{"ID", ",", " ", "\"\<BxByBz\>\"", ",", " ", 
            RowBox[{"1000", "*", 
             RowBox[{"r3", "[", 
              RowBox[{"[", 
               RowBox[{";;", "3"}], "]"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"drds4", "=", 
          RowBox[{"auxIDNewtonLorentzEquation", "[", 
           RowBox[{"a", ",", "r3", ",", "b3"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"For", " ", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", " ", 
           RowBox[{"i", "\[LessEqual]", "6"}], ",", " ", 
           RowBox[{"i", "++"}], ",", " ", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"r", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"step", "/", "6.0"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"drds1", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "+", 
                RowBox[{"2.0", "*", 
                 RowBox[{"drds2", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "+", 
                RowBox[{"2.0", "*", 
                 RowBox[{"drds3", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "+", 
                RowBox[{"drds4", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"trajectory", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"r", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "*", "1000"}], ",", " ", 
             RowBox[{
              RowBox[{"r", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "*", "1000"}], ",", " ", 
             RowBox[{
              RowBox[{"r", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "*", "1000"}], ",", " ", 
             RowBox[{"r", "[", 
              RowBox[{"[", "4", "]"}], "]"}], ",", " ", 
             RowBox[{"r", "[", 
              RowBox[{"[", "5", "]"}], "]"}], ",", " ", 
             RowBox[{"r", "[", 
              RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<IDRungeKuttaTrajectory: elapsed time = \>\"", ",", 
        RowBox[{"(", 
         RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "trajectory", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.76744770185725*^9, 3.767447715061404*^9}, {
  3.7674478894725156`*^9, 3.7674478930665445`*^9}, {3.782655720566373*^9, 
  3.782655720941368*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[24]:=",ExpressionUUID->"494c7822-7765-4f5f-bf96-15e4412f31ad"]
}, Closed]],

Cell[CellGroupData[{

Cell["IDTrajectoryFile", "Subsection",
 CellChangeTimes->{{3.7667548871084976`*^9, 3.76675490671941*^9}, 
   3.767449882481743*^9, 3.7826556381260996`*^9, {3.820132820008762*^9, 
   3.820132822768936*^9}, {3.820151688212949*^9, 
   3.820151693903324*^9}},ExpressionUUID->"ba0c27f7-7afe-4d7f-bf71-\
31b954642dee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IDTrajectoryFile", "::", "usage"}], " ", "=", " ", 
    "\"\<IDTrajectoryFile[ID, energy, r0, smax, rkstep,  xrange, yrange, \
zrange, nx, ny, nz, magnetname, polarization, phasename,  magnetlength, \
\[Lambda]u, Gap, \[Delta]P, \[Delta]GV, \[Delta]GH, \[Delta]CP]: Calculate \
and write the trajectory to file.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDTrajectoryFile", "[", " ", 
    RowBox[{
    "ID_", ",", " ", "energy_", ",", "r0_", ",", "smax_", ",", "rkstep_", ",",
      " ", "magnetname_", ",", " ", "polarization_", ",", "phasename_", ",", 
     "  ", "magnetlength_", ",", "\[Lambda]u_", ",", " ", "Gap_", ",", "  ", 
     "\[Delta]P_", ",", " ", "\[Delta]GV_", ",", " ", "\[Delta]GH_", ",", " ",
      "\[Delta]CP_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "traj", ",", " ", "trajfilename", ",", " ", "trajfile", ",", " ", 
       "date", ",", "  ", "timestamp", ",", "  ", "line", ",", " ", "t0", ",",
        " ", "t1", ",", " ", "Bh", ",", " ", "Bv", ",", " ", "Kh", ",", " ", 
       "Kv", ",", " ", "K", ",", " ", "PosURC", ",", " ", "PosULC", ",", " ", 
       "PosBLC", ",", " ", "PosBRC", ",", " ", "i"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t0", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"traj", " ", "=", " ", 
       RowBox[{"IDRungeKuttaTrajectory", "[", 
        RowBox[{
        "ID", ",", " ", "energy", ",", "r0", ",", "smax", ",", "rkstep"}], 
        "]"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"date", " ", "=", " ", 
       RowBox[{"DateString", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Year\>\"", ",", "\"\<-\>\"", ",", "\"\<Month\>\"", ",", 
          "\"\<-\>\"", ",", "\"\<Day\>\""}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"timestamp", " ", "=", " ", 
       RowBox[{"date", " ", "<>", "\"\<_\>\"", "<>", " ", 
        RowBox[{"DateString", "[", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Hour24\>\"", ",", "\"\<-\>\"", ",", "\"\<Minute\>\"", ",", 
           "\"\<-\>\"", ",", " ", "\"\<Second\>\""}], "}"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"PosURC", " ", "=", "\[Delta]GV"}], ";", "\[IndentingNewLine]", 
      RowBox[{"PosULC", " ", "=", " ", 
       RowBox[{
       "\[Delta]GV", "+", " ", "\[Delta]GH", "+", " ", "\[Delta]P", "+", 
        "\[Delta]CP"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"PosBLC", " ", "=", "\[Delta]GH"}], ";", "\[IndentingNewLine]", 
      RowBox[{"PosBRC", " ", "=", 
       RowBox[{"\[Delta]P", "-", "\[Delta]CP"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"Bh", " ", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{"radFldLst", "[", 
          RowBox[{"ID", ",", " ", "\"\<Bx\>\"", ",", " ", 
           RowBox[{"{", " ", 
            RowBox[{"0", ",", "0", ",", " ", 
             RowBox[{"-", "\[Lambda]u"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "\[Lambda]u"}], "}"}], ",", " ", 
           "100", ",", " ", "\"\<noarg\>\"", ",", " ", 
           RowBox[{"-", "\[Lambda]u"}]}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Bv", " ", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{"radFldLst", "[", 
          RowBox[{"ID", ",", " ", "\"\<By\>\"", ",", " ", 
           RowBox[{"{", " ", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "\[Lambda]u"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "\[Lambda]u"}], "}"}], ",", " ", 
           "100", ",", " ", "\"\<noarg\>\"", ",", " ", 
           RowBox[{"-", "\[Lambda]u"}]}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Kh", " ", "=", " ", 
       RowBox[{"0.934", "*", "Bv", "*", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]u", "/", "10"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Kv", " ", "=", " ", 
       RowBox[{"0.934", "*", "Bh", "*", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]u", "/", "10"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"K", " ", "=", " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"Kh", "^", "2"}], " ", "+", " ", 
         RowBox[{"Kv", "^", "2"}]}], " ", "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"Kh", " ", "=", " ", 
       RowBox[{"Round", "[", 
        RowBox[{"Kh", ",", " ", "0.01"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Kv", "=", " ", 
       RowBox[{"Round", "[", 
        RowBox[{"Kv", ",", " ", "0.01"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"K", " ", "=", " ", 
       RowBox[{"Round", "[", 
        RowBox[{"K", ",", " ", "0.01"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"trajfilename", " ", "=", 
       RowBox[{
        RowBox[{
        "StringTemplate", "[", 
         "\"\<`1`_`2`_`3`_Kh=`4`_Kv=`5`_Z=`6`_`7`mm\>\"", "]"}], "[", 
        RowBox[{
        "date", ",", " ", "magnetname", ",", " ", "polarization", ",", " ", 
         "Kh", ",", " ", "Kv", ",", " ", 
         RowBox[{"r0", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", " ", "smax"}], "]"}]}], " ", 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringLength", "[", "phasename", "]"}], " ", "\[NotEqual]", 
         " ", "0"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{"trajfilename", "=", " ", 
         RowBox[{
         "trajfilename", "<>", " ", "\"\<_\>\"", " ", "<>", " ", "phasename", 
          "<>", " ", "\"\<.trj\>\""}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"trajfilename", "=", " ", 
         RowBox[{"trajfilename", "  ", "<>", " ", "\"\<.trj\>\""}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"trajfile", "=", 
       RowBox[{"OpenWrite", "[", "trajfilename", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<timestamp:\\t`1`\\n\>\"", "]"}], 
        "[", "timestamp", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<filename:\\t`1`\\n\>\"", "]"}], 
        "[", "trajfilename", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<magnet_name:\\t`1`\\n\>\"", "]"}],
         "[", "magnetname", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<gap[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "Gap", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{
        "StringTemplate", "[", "\"\<period_length[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "\[Lambda]u", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{
        "StringTemplate", "[", "\"\<magnet_length[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "magnetlength", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<dP[mm]:\\t\\t`1`\\n\>\"", "]"}], 
        "[", "\[Delta]P", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<dGV[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "\[Delta]GV", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<dGH[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "\[Delta]GH", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<dCP[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "\[Delta]CP", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<posURC[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "PosURC", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<posULC[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "PosULC", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<posBRC[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "PosBRC", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<posBLC[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "PosBLC", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{
        "StringTemplate", "[", "\"\<K_Horizontal:\\t`1`\\n\>\"", "]"}], "[", 
        "Kh", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<K_Vertical:\\t`1`\\n\>\"", "]"}], 
        "[", "Kv", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<K:\\t\\t`1`\\n\>\"", "]"}], "[", 
        "K", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{
        "StringTemplate", "[", "\"\<particle_energy[GeV]:\\t`1`\\n\>\"", 
         "]"}], "[", "energy", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "\"\<\\n\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", " ", 
        RowBox[{
        "\"\<x[mm]\>\"", "<>", " ", "\"\<\\t\>\"", "<>", " ", "\"\<y[mm]\>\"",
          "<>", " ", "\"\<\\t\>\"", "<>", " ", "\"\<z[mm]\>\"", "<>", " ", 
         "\"\<\\t\>\"", "<>", " ", "\"\<dxds\>\"", "<>", " ", "\"\<\\t\>\"", "<>",
          " ", "\"\<dyds\>\"", "<>", " ", "\"\<\\t\>\"", "<>", " ", 
         "\"\<dzds\>\"", "<>", "\"\<\\n\>\""}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{
       "trajfile", ",", 
        "\"\<-----------------------------------------------------------------\
------------------------------------------------------------------------------\
-------------------\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "traj", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"line", " ", "=", 
          RowBox[{
           RowBox[{"auxIDNumberToString", "[", 
            RowBox[{"traj", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "1"}], "]"}], "]"}], "]"}], "<>", " ", 
           "\"\<\\t\>\"", " ", "<>", " ", 
           RowBox[{"auxIDNumberToString", "[", 
            RowBox[{"traj", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "2"}], "]"}], "]"}], "]"}], " ", "<>", 
           " ", "\"\<\\t\>\"", " ", "<>", " ", 
           RowBox[{"auxIDNumberToString", "[", 
            RowBox[{"traj", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "3"}], "]"}], "]"}], "]"}], " ", "<>", 
           "\"\<\\t\>\"", " ", "<>", " ", 
           RowBox[{"auxIDNumberToString", "[", 
            RowBox[{"traj", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "4"}], "]"}], "]"}], "]"}], " ", "<>", 
           " ", "\"\<\\t\>\"", " ", "<>", "  ", 
           RowBox[{"auxIDNumberToString", "[", 
            RowBox[{"traj", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "5"}], "]"}], "]"}], "]"}], "<>", " ", 
           "\"\<\\t\>\"", " ", "<>", "  ", 
           RowBox[{"auxIDNumberToString", "[", 
            RowBox[{"traj", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "6"}], "]"}], "]"}], "]"}], "<>", 
           "\"\<\\n\>\""}]}], "  ", ";", " ", "\[IndentingNewLine]", 
         RowBox[{"WriteString", "[", 
          RowBox[{"trajfile", ",", "line"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Close", "[", "trajfile", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Trajectory file saved in file: \>\"", ",", " ", "trajfilename"}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<IDTrajectoryFile: elapsed time = \>\"", ",", 
        RowBox[{"(", 
         RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.767447676712742*^9, 3.7674476901356754`*^9}, {
   3.767447877752833*^9, 3.7674478819250393`*^9}, {3.7674498877634153`*^9, 
   3.7674499000768747`*^9}, {3.782655619766797*^9, 3.7826556288292556`*^9}, {
   3.7826568647102003`*^9, 3.782656886835105*^9}, 3.784621350331092*^9, {
   3.8201328287093325`*^9, 3.8201328301894054`*^9}, {3.8201475833268857`*^9, 
   3.82014772475784*^9}, {3.820147903479143*^9, 3.8201479195002623`*^9}, {
   3.8201479575827456`*^9, 3.8201480152565284`*^9}, {3.820148073780411*^9, 
   3.820148094041765*^9}, {3.8201481578859253`*^9, 3.8201484002139997`*^9}, {
   3.820148442706847*^9, 3.8201489300314655`*^9}, {3.8201489649837694`*^9, 
   3.820148998295968*^9}, {3.8201490518994956`*^9, 3.82014945269989*^9}, {
   3.820149575878006*^9, 3.8201496158606415`*^9}, {3.8201496684041023`*^9, 
   3.8201497274780054`*^9}, {3.8201497623102913`*^9, 
   3.8201497783813515`*^9}, {3.8201499985877542`*^9, 3.820150017769049*^9}, {
   3.820150256796426*^9, 3.820150324490906*^9}, {3.82015038955519*^9, 
   3.820150396285636*^9}, {3.820150623392577*^9, 3.8201506453240223`*^9}, {
   3.8201507623230314`*^9, 3.8201507878947144`*^9}, {3.8201517335859165`*^9, 
   3.820151799450259*^9}, {3.8201518480434513`*^9, 3.820152145583065*^9}, {
   3.8201522712813473`*^9, 3.82015233346713*^9}, {3.8201523901208687`*^9, 
   3.820152605577426*^9}, {3.820152645900069*^9, 3.8201527467889404`*^9}, 
   3.8201527920919256`*^9, 3.820152834384712*^9, 3.820152919720341*^9, {
   3.820154318037429*^9, 3.8201543256479316`*^9}, {3.820154709585966*^9, 
   3.8201547108860326`*^9}, {3.820155081922237*^9, 3.8201551083140097`*^9}, {
   3.8201569614891415`*^9, 3.820156965759404*^9}, {3.820220398988186*^9, 
   3.820220405875295*^9}, {3.8203189383739424`*^9, 3.8203189411941247`*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[26]:=",ExpressionUUID->"ee2a2080-707a-4eb3-87d9-c28ada49e95e"]
}, Closed]],

Cell[CellGroupData[{

Cell["IDPlotRungeKuttaTrajectory", "Subsection",
 CellChangeTimes->{{3.7667548871084976`*^9, 3.76675490671941*^9}, 
   3.7667549708182*^9, {3.766755041776903*^9, 
   3.7667550428863707`*^9}},ExpressionUUID->"157ca7c9-6722-4d5a-ad5b-\
229aadb8b0bc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IDPlotRungeKuttaTrajectory", "::", "usage"}], " ", "=", " ", 
    "\"\<IDPlotRungeKuttaTrajectory[trajectory, s:\\\"y\\\"]: Plot the \
electron trajectory.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDPlotRungeKuttaTrajectory", "[", 
    RowBox[{"trajectory_", ",", " ", 
     RowBox[{"s_:", "\"\<z\>\""}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "plots", ",", " ", "x", ",", " ", "y", ",", " ", "z", ",", " ", "t0", 
       ",", " ", "t1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t0", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"plots", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"x", "=", " ", 
       RowBox[{"trajectory", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", " ", "1"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"y", " ", "=", " ", 
       RowBox[{"trajectory", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", " ", "2"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"z", " ", "=", " ", 
       RowBox[{"trajectory", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", " ", "3"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"s", " ", "\[Equal]", " ", "\"\<x\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", 
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"Transpose", "@", 
               RowBox[{"{", 
                RowBox[{"x", ",", " ", 
                 RowBox[{"y", "*", "1000"}]}], "}"}]}], ",", " ", 
              RowBox[{"PlotRange", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"All", ",", " ", "All"}], "}"}]}], ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", " ", 
              RowBox[{"Joined", "\[Rule]", "True"}], ",", " ", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<x [mm]\>\"", ",", "\"\<y [\[Mu]m]\>\""}], 
                "}"}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", 
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"Transpose", "@", 
               RowBox[{"{", 
                RowBox[{"x", ",", " ", 
                 RowBox[{"z", "*", "1000"}]}], "}"}]}], ",", " ", 
              RowBox[{"PlotRange", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"All", ",", " ", "All"}], "}"}]}], ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", " ", 
              RowBox[{"Joined", "\[Rule]", "True"}], ",", " ", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<x [mm]\>\"", ",", "\"\<z [\[Mu]m]\>\""}], 
                "}"}]}]}], "]"}]}], "]"}], ";"}], ")"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"s", " ", "\[Equal]", " ", "\"\<y\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", 
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"Transpose", "@", 
               RowBox[{"{", 
                RowBox[{"y", ",", " ", 
                 RowBox[{"x", "*", "1000"}]}], "}"}]}], ",", " ", 
              RowBox[{"PlotRange", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"All", ",", " ", "All"}], "}"}]}], ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", " ", 
              RowBox[{"Joined", "\[Rule]", "True"}], ",", " ", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<y [mm]\>\"", ",", "\"\<x [\[Mu]m]\>\""}], 
                "}"}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", 
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"Transpose", "@", 
               RowBox[{"{", 
                RowBox[{"y", ",", " ", 
                 RowBox[{"z", "*", "1000"}]}], "}"}]}], ",", " ", 
              RowBox[{"PlotRange", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"All", ",", " ", "All"}], "}"}]}], ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", " ", 
              RowBox[{"Joined", "\[Rule]", "True"}], ",", " ", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<y [mm]\>\"", ",", "\"\<z [\[Mu]m]\>\""}], 
                "}"}]}]}], "]"}]}], "]"}], ";"}], ")"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"s", " ", "\[Equal]", " ", "\"\<z\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", 
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"Transpose", "@", 
               RowBox[{"{", 
                RowBox[{"z", ",", " ", 
                 RowBox[{"x", "*", "1000"}]}], "}"}]}], ",", " ", 
              RowBox[{"PlotRange", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"All", ",", " ", "All"}], "}"}]}], ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", " ", 
              RowBox[{"Joined", "\[Rule]", "True"}], ",", " ", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<z [mm]\>\"", ",", "\"\<x [\[Mu]m]\>\""}], 
                "}"}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", 
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"Transpose", "@", 
               RowBox[{"{", 
                RowBox[{"z", ",", " ", 
                 RowBox[{"y", "*", "1000"}]}], "}"}]}], ",", " ", 
              RowBox[{"PlotRange", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"All", ",", " ", "All"}], "}"}]}], ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", " ", 
              RowBox[{"Joined", "\[Rule]", "True"}], ",", " ", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<z [mm]\>\"", ",", "\"\<y [\[Mu]m]\>\""}], 
                "}"}]}]}], "]"}]}], "]"}], ";"}], ")"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<IDPlotRungeKuttaTrajectory: elapsed time = \>\"", ",", 
        RowBox[{"(", 
         RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "plots", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.767447724265257*^9, 3.7674477376412992`*^9}, {
  3.767447904067401*^9, 3.7674479092240562`*^9}, {3.782655746847508*^9, 
  3.782655747097514*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[28]:=",ExpressionUUID->"f697a71f-6997-415d-96c1-093eac60228d"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Auxiliary", "Section",
 CellChangeTimes->{{3.76639811614032*^9, 3.7663981237176037`*^9}, {
  3.8118571543202114`*^9, 
  3.8118571550008917`*^9}},ExpressionUUID->"5ae070d1-0cf0-4ac4-b054-\
32f42780450f"],

Cell[CellGroupData[{

Cell["auxIDCassette", "Subsection",
 CellChangeTimes->{{3.766754730782276*^9, 
  3.7667547560811443`*^9}},ExpressionUUID->"c13b4fd0-95fa-44e0-b443-\
c53463a08608"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"auxIDCassette", "[", 
     RowBox[{
     "\[Lambda]u_", ",", " ", "Np_", ",", " ", "Br_", ",", " ", "\[Delta]_", 
      ",", " ", "BlockShape_", ",", " ", 
      RowBox[{"OptionsPattern", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<Rectangular\>\"", "\[Rule]", " ", "False"}], ",", " ", 
         RowBox[{"\"\<BlockGap\>\"", "\[Rule]", " ", "0"}], ",", " ", 
         RowBox[{"\"\<Termination\>\"", "\[Rule]", " ", "\"\<None\>\""}], ",",
          " ", 
         RowBox[{"\"\<PointingUp\>\"", "\[Rule]", " ", "True"}], ",", " ", 
         RowBox[{"\"\<FirstBlock\>\"", "\[Rule]", " ", "\"\<Up\>\""}], ",", 
         " ", 
         RowBox[{
         "\"\<FieldDirection\>\"", "\[Rule]", " ", "\"\<Vertical\>\""}], ",", 
         " ", 
         RowBox[{"\"\<BlockSubdivision\>\"", "\[Rule]", " ", "\"\<None\>\""}],
          ",", " ", 
         RowBox[{"\"\<Size1\>\"", "\[Rule]", " ", "1"}], ",", " ", 
         RowBox[{"\"\<Size2\>\"", "\[Rule]", "1"}], ",", " ", 
         RowBox[{"\"\<Size3\>\"", "\[Rule]", " ", "1"}], " ", ",", 
         RowBox[{"\"\<Size4\>\"", "\[Rule]", " ", "1"}], " ", ",", " ", 
         RowBox[{"\"\<Gap1\>\"", "\[Rule]", " ", "0"}], ",", " ", 
         RowBox[{"\"\<Gap2\>\"", "\[Rule]", "0"}], ",", " ", 
         RowBox[{"\"\<Gap3\>\"", "\[Rule]", " ", "0"}], ",", " ", 
         RowBox[{"\"\<Gap4\>\"", "\[Rule]", " ", "0"}], ",", " ", 
         RowBox[{"\"\<Shift1\>\"", "\[Rule]", " ", "0"}], ",", " ", 
         RowBox[{"\"\<Shift2\>\"", "\[Rule]", "0"}], ",", " ", 
         RowBox[{"\"\<Shift3\>\"", "\[Rule]", " ", "0"}], ",", 
         RowBox[{"\"\<Shift4\>\"", "\[Rule]", " ", "0"}], ",", " ", 
         RowBox[{"\"\<FourBlocks\>\"", "\[Rule]", " ", "0"}], ",", " ", 
         RowBox[{"\"\<ShiftDirection\>\"", "\[Rule]", " ", "1"}]}], "}"}], 
       "]"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
       "Rectangular", ",", " ", "BlockGap", ",", " ", "Termination", ",", " ",
         "PointingUp", ",", " ", "FirstBlock", ",", " ", "FieldDirection", 
        " ", ",", "BlockSubdivision", ",", "\[IndentingNewLine]", " ", 
        "Shape", ",", " ", "NrTermBlocks", ",", "  ", "AddCoreBlocks", ",", 
        " ", "Wm", ",", " ", "Len", ",", " ", "NrCoreBlocks", ",", "NrBlocks",
         ",", "  ", "Pos", ",", " ", "bl", ",", " ", "LastPos", ",", 
        "\[IndentingNewLine]", "PointingUpList", ",", " ", "PointingDownList",
         ",", " ", "AddIdx", ",", "Mag", ",", " ", "i", ",", " ", "Shift", 
        ",", " ", "RotMag", ",", " ", "Trf", ",", "ShiftDirection", ",", 
        "\[IndentingNewLine]", "BlockCenter", " ", ",", " ", "Lh", ",", " ", 
        "Lv", ",", "Size1", ",", " ", "Size2", ",", " ", "Size3", ",", " ", 
        "Size4", ",", " ", "Gap1", ",", " ", "Gap2", ",", " ", "Gap3", ",", 
        "Gap4", ",", " ", "Shift1", ",", " ", "Shift2", ",", " ", "Shift3", 
        ",", "Shift4", ",", "FourBlocks", ",", "\[IndentingNewLine]", 
        "CassetteBeg", ",", "CassetteBeg1", ",", " ", "CassetteBeg2", ",", 
        " ", "CassetteBeg3", ",", "CassetteBeg4", ",", "\[IndentingNewLine]", 
        "CassetteEnd", ",", "CassetteEnd1", ",", " ", "CassetteEnd2", ",", 
        " ", "CassetteEnd3", ",", "CassetteEnd4", ",", "\[IndentingNewLine]", 
        "CassetteCore", ",", "Cassette"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Optional", " ", "arguments"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Rectangular", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<Rectangular\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"BlockGap", "=", 
        RowBox[{"OptionValue", "[", "\"\<BlockGap\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Termination", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<Termination\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PointingUp", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<PointingUp\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"FirstBlock", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<FirstBlock\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"FieldDirection", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<FieldDirection\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"BlockSubdivision", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<BlockSubdivision\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Size1", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<Size1\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Size2", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<Size2\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Size3", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<Size3\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Size4", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<Size4\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Gap1", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<Gap1\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Gap2", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<Gap2\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Gap3", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<Gap3\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Gap4", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<Gap4\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Shift1", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<Shift1\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Shift2", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<Shift2\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Shift3", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<Shift3\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Shift4", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<Shift4\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ShiftDirection", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<ShiftDirection\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"FourBlocks", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<FourBlocks\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Check", " ", "arguments"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{"\[Lambda]u", " ", "\[LessEqual]", " ", "0"}], ",", " ", 
         RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{"Np", " ", "\[LessEqual]", " ", "0"}], ",", " ", 
         RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{"Br", " ", "\[LessEqual]", " ", "0"}], ",", " ", 
         RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Depth", "[", "BlockShape", "]"}], "\[NotEqual]", " ", 
          "4"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Shape", " ", "=", " ", 
          RowBox[{"{", "BlockShape", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Shape", " ", "=", " ", "BlockShape"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Termination", " ", "Type"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"NrTermBlocks", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"AddCoreBlocks", " ", "=", " ", "0"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Termination", "\[Equal]", " ", "\"\<OneBlockSym\>\""}], 
          "  ", "||", " ", 
          RowBox[{
          "Termination", " ", "\[Equal]", " ", "\"\<OneBlockSymL4\>\""}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NrTermBlocks", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AddCoreBlocks", " ", "=", " ", "3"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Termination", "\[Equal]", " ", "\"\<OneBlockAntiSym\>\""}],
           " ", "||", " ", 
          RowBox[{
          "Termination", " ", "\[Equal]", " ", 
           "\"\<OneBlockAntiSymL4\>\""}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NrTermBlocks", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AddCoreBlocks", " ", "=", " ", "1"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Termination", "\[Equal]", " ", "\"\<ThreeBlocksSym\>\""}], 
          " ", "||", " ", 
          RowBox[{"Termination", "\[Equal]", "\"\<VarSizesSym\>\""}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NrTermBlocks", "=", " ", "3"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AddCoreBlocks", " ", "=", "3"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "Termination", "\[Equal]", " ", "\"\<ThreeBlocksAntiSym\>\""}], 
          "  ", "||", " ", 
          RowBox[{"Termination", "\[Equal]", "\"\<VarSizesAntiSym\>\""}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NrTermBlocks", "=", " ", "3"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AddCoreBlocks", " ", "=", "1"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Block", " ", "length"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Wm", "=", " ", 
        RowBox[{"\[Lambda]u", "/", "4"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Len", " ", "=", " ", 
        RowBox[{"Wm", " ", "-", " ", "BlockGap"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Position", " ", "of", " ", "blocks"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"NrCoreBlocks", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"4", "*", "Np"}], ")"}], " ", "+", " ", "AddCoreBlocks"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"NrBlocks", " ", "=", " ", 
        RowBox[{"NrCoreBlocks", "+", " ", 
         RowBox[{"(", 
          RowBox[{"2", "*", "NrTermBlocks"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Pos", " ", "=", " ", 
        RowBox[{"Wm", "*", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", 
           RowBox[{"NrBlocks", " ", "-", " ", "1"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Magnetization", " ", "direction"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
         "FieldDirection", " ", "\[Equal]", " ", "\"\<Horizontal\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"PointingUpList", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Br", ",", "0", ",", "0"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "0", ",", " ", 
               RowBox[{"-", "Br"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "Br"}], ",", "0", ",", "0"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "0", ",", "Br"}], "}"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"PointingDownList", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Br", ",", "0", ",", "0"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "0", ",", " ", "Br"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "Br"}], ",", "0", ",", "0"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", "  ", "0", ",", 
               RowBox[{"-", "Br"}]}], "}"}]}], "}"}]}], ";"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"PointingUpList", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "Br", ",", "0"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "0", ",", " ", 
               RowBox[{"-", "Br"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "Br"}], ",", " ", "0"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "0", ",", "Br"}], "}"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"PointingDownList", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "Br", ",", "0"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "0", ",", " ", "Br"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "Br"}], ",", " ", "0"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "0", ",", 
               RowBox[{"-", "Br"}]}], "}"}]}], "}"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"AddIdx", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{"FirstBlock", " ", "\[Equal]", " ", "\"\<Up\>\""}], ",", " ", 
         RowBox[{"AddIdx", " ", "=", "0"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{"FirstBlock", " ", "\[Equal]", " ", "\"\<Down\>\""}], ",", 
         " ", 
         RowBox[{"AddIdx", "=", "2"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FirstBlock", " ", "\[Equal]", " ", "\"\<Foward\>\""}], " ",
           "&&", " ", "PointingUp"}], ",", " ", 
         RowBox[{"AddIdx", "=", "3"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FirstBlock", " ", "\[Equal]", " ", "\"\<Foward\>\""}], " ",
           "&&", " ", 
          RowBox[{"Not", " ", "PointingUp"}]}], ",", " ", 
         RowBox[{"AddIdx", "=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FirstBlock", " ", "\[Equal]", " ", "\"\<Backward\>\""}], 
          " ", "&&", " ", "PointingUp"}], ",", " ", 
         RowBox[{"AddIdx", "=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FirstBlock", " ", "\[Equal]", " ", "\"\<Backward\>\""}], 
          " ", "&&", " ", 
          RowBox[{"Not", " ", "PointingUp"}]}], ",", " ", 
         RowBox[{"AddIdx", "=", "3"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{"PointingUp", ",", "  ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Mag", "[", "idx_", "]"}], " ", ":=", " ", 
          RowBox[{"PointingUpList", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Divisible", "[", 
               RowBox[{
                RowBox[{"idx", " ", "+", " ", "AddIdx"}], ",", " ", "4"}], 
               "]"}], " ", ",", " ", "4", " ", ",", " ", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"idx", "+", " ", "AddIdx"}], ",", " ", "4"}], "]"}]}],
              " ", "]"}], "]"}], "]"}]}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Mag", "[", "idx_", "]"}], " ", ":=", " ", 
          RowBox[{"PointingDownList", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Divisible", "[", 
               RowBox[{
                RowBox[{"idx", " ", "+", " ", "AddIdx"}], ",", " ", "4"}], 
               "]"}], ",", " ", "4", " ", ",", " ", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"idx", "+", " ", "AddIdx"}], ",", " ", "4"}], "]"}]}],
              " ", "]"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";",
        " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
        "Rectangular", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Creates", " ", "parallelepipedic", " ", "blocks", " ", "with", " ",
            "magnetization"}], "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"BlockCenter", " ", "=", " ", 
           RowBox[{"RegionCentroid", "[", 
            RowBox[{"Polygon", "[", 
             RowBox[{"Shape", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Lh", " ", "=", " ", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"Shape", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", " ", "All", ",", " ", "1"}], "]"}], "]"}], 
             "]"}], " ", "-", " ", 
            RowBox[{"Min", "[", 
             RowBox[{"Shape", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", " ", "All", ",", " ", "1"}], "]"}], "]"}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Lv", " ", "=", " ", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"Shape", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", " ", "All", ",", " ", "2"}], "]"}], "]"}], 
             "]"}], " ", "-", " ", 
            RowBox[{"Min", "[", 
             RowBox[{"Shape", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", " ", "All", ",", " ", "2"}], "]"}], "]"}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Termination", " ", "blocks"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"CassetteBeg", " ", "=", " ", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"CassetteEnd", " ", "=", " ", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Termination", "\[Equal]", " ", "\"\<OneBlockSym\>\""}], 
             " ", "||", " ", 
             RowBox[{
             "Termination", "\[Equal]", " ", "\"\<OneBlockAntiSym\>\""}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"CassetteBeg", " ", "=", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", 
                   RowBox[{"Wm", "/", "4"}], " ", "+", " ", "\[Delta]"}]}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", "Lv", ",", " ", 
                  RowBox[{"Len", "/", "2"}]}], "}"}], ",", 
                RowBox[{"Mag", "[", "1", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd", " ", "=", " ", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "NrBlocks", "]"}], "]"}], "-", " ", 
                   RowBox[{"Wm", "/", "4"}], " ", "+", " ", "\[Delta]"}]}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", "Lv", ",", 
                  RowBox[{"Len", "/", "2"}]}], "}"}], ",", 
                RowBox[{"Mag", "[", "NrBlocks", "]"}]}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "Termination", "\[Equal]", " ", "\"\<OneBlockSymL4\>\""}], " ", "||",
              " ", 
             RowBox[{
             "Termination", "\[Equal]", " ", "\"\<OneBlockAntiSymL4\>\""}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"CassetteBeg", " ", "=", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", 
                   RowBox[{"5", 
                    RowBox[{"Wm", "/", "8"}]}], " ", "+", " ", "\[Delta]"}]}],
                  "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", "Lv", ",", " ", 
                  RowBox[{"Len", "/", "4"}]}], "}"}], ",", 
                RowBox[{"Mag", "[", "1", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd", " ", "=", " ", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "NrBlocks", "]"}], "]"}], "-", " ", 
                   RowBox[{"5", 
                    RowBox[{"Wm", "/", "8"}]}], " ", "+", " ", "\[Delta]"}]}],
                  "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", "Lv", ",", 
                  RowBox[{"Len", "/", "4"}]}], "}"}], ",", 
                RowBox[{"Mag", "[", "NrBlocks", "]"}]}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "Termination", "\[Equal]", " ", "\"\<ThreeBlocksSym\>\""}], " ", 
             "||", " ", 
             RowBox[{
             "Termination", "\[Equal]", " ", "\"\<ThreeBlocksAntiSym\>\""}]}],
             ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"CassetteBeg1", " ", "=", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", " ", 
                   RowBox[{"3", "*", 
                    RowBox[{"Wm", "/", "8"}]}], " ", "+", " ", "\[Delta]"}]}],
                  "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", "Lv", ",", 
                  RowBox[{"Len", "/", "4"}]}], "}"}], ",", 
                RowBox[{"Mag", "[", "1", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg2", " ", "=", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", "  ", 
                   RowBox[{"Wm", "/", "4"}], " ", "+", " ", "\[Delta]"}]}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", "Lv", ",", 
                  RowBox[{"Len", "/", "2"}]}], "}"}], ",", 
                RowBox[{"Mag", "[", "2", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg3", " ", "=", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "+", "   ", 
                   RowBox[{"Wm", "/", "8"}], "+", " ", "\[Delta]"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", "Lv", ",", 
                  RowBox[{"3", "*", 
                   RowBox[{"Len", "/", "4"}]}]}], "}"}], ",", 
                RowBox[{"Mag", "[", "3", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg", " ", "=", " ", 
              RowBox[{"{", 
               RowBox[{
               "CassetteBeg1", ",", " ", "CassetteBeg2", ",", " ", 
                "CassetteBeg3"}], "}"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd3", " ", "=", " ", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", 
                    RowBox[{"NrBlocks", "-", "2"}], "]"}], "]"}], "-", "  ", 
                   RowBox[{"Wm", "/", "8"}], "+", " ", "\[Delta]"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", " ", "Lv", ",", " ", 
                  RowBox[{"3", "*", 
                   RowBox[{"Len", "/", "4"}]}]}], "}"}], ",", 
                RowBox[{"Mag", "[", 
                 RowBox[{"NrBlocks", "-", "2"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd2", " ", "=", " ", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", 
                    RowBox[{"NrBlocks", "-", "1"}], "]"}], "]"}], "-", "  ", 
                   RowBox[{"Wm", "/", "4"}], " ", "+", " ", "\[Delta]"}]}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", "Lv", ",", 
                  RowBox[{"Len", "/", "2"}]}], "}"}], ",", 
                RowBox[{"Mag", "[", 
                 RowBox[{"NrBlocks", "-", "1"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd1", " ", "=", " ", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "NrBlocks", "]"}], "]"}], "-", " ", 
                   RowBox[{"3", "*", 
                    RowBox[{"Wm", "/", "8"}]}], " ", "+", " ", "\[Delta]"}]}],
                  "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", "Lv", ",", 
                  RowBox[{"Len", "/", "4"}]}], "}"}], ",", 
                RowBox[{"Mag", "[", "NrBlocks", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd", " ", "=", " ", 
              RowBox[{"{", 
               RowBox[{
               "CassetteEnd3", ",", " ", "CassetteEnd2", ",", " ", 
                "CassetteEnd1"}], "}"}]}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Termination", "\[Equal]", " ", "\"\<VarSizesSym\>\""}], 
             " ", "||", " ", 
             RowBox[{
             "Termination", "\[Equal]", " ", "\"\<VarSizesAntiSym\>\""}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"LastPos", " ", "=", " ", 
              RowBox[{
               RowBox[{"Pos", "[", 
                RowBox[{"[", "4", "]"}], "]"}], " ", "-", " ", 
               RowBox[{"0.5", "*", "Wm"}], " ", "-", " ", 
               RowBox[{"(", 
                RowBox[{"Size3", "/", "2"}], ")"}], " ", "-", " ", "Gap3"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg3", " ", "=", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"LastPos", "+", " ", "\[Delta]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", "Lv", ",", "Size3"}], "}"}], ",", 
                RowBox[{"Mag", "[", "3", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"LastPos", " ", "=", " ", 
              RowBox[{"LastPos", " ", "-", 
               RowBox[{"(", 
                RowBox[{"Size3", "/", "2"}], ")"}], " ", "-", " ", 
               RowBox[{"(", 
                RowBox[{"Size2", "/", "2"}], ")"}], " ", "-", " ", "Gap2"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg2", " ", "=", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"LastPos", " ", "+", " ", "\[Delta]"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", "Lv", ",", "Size2"}], "}"}], ",", 
                RowBox[{"Mag", "[", "2", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"LastPos", " ", "=", " ", 
              RowBox[{"LastPos", " ", "-", " ", 
               RowBox[{"(", 
                RowBox[{"Size2", "/", "2"}], ")"}], " ", "-", " ", 
               RowBox[{"(", 
                RowBox[{"Size1", "/", "2"}], ")"}], " ", "-", " ", "Gap1"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg1", " ", "=", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"LastPos", " ", "+", " ", "\[Delta]"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", "Lv", ",", "Size1"}], "}"}], ",", 
                RowBox[{"Mag", "[", "1", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"FourBlocks", " ", "\[Equal]", " ", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"LastPos", " ", "=", " ", 
                 RowBox[{"LastPos", " ", "-", " ", 
                  RowBox[{"(", 
                   RowBox[{"Size1", "/", "2"}], ")"}], " ", "-", 
                  RowBox[{"(", 
                   RowBox[{"Size4", "/", "2"}], ")"}], " ", "-", " ", 
                  "Gap4"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"CassetteBeg4", " ", "=", " ", 
                 RowBox[{"radObjRecMag", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"BlockCenter", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"BlockCenter", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"LastPos", " ", "+", " ", "\[Delta]"}]}], "}"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{"Lh", ",", "Lv", ",", "Size4"}], "}"}], ",", 
                   RowBox[{"Mag", "[", "4", "]"}]}], "]"}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"LastPos", " ", "=", " ", 
              RowBox[{
               RowBox[{"Pos", "[", 
                RowBox[{"[", 
                 RowBox[{"NrBlocks", "-", "3"}], "]"}], "]"}], " ", "+", " ", 
               RowBox[{"0.5", "*", "Wm"}], " ", "+", "  ", 
               RowBox[{"(", 
                RowBox[{"Size3", "/", "2"}], ")"}], " ", "+", " ", "Gap3"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd3", " ", "=", " ", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                  RowBox[{"LastPos", "+", " ", "\[Delta]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", " ", "Lv", ",", " ", "Size3"}], "}"}], 
                ",", 
                RowBox[{"Mag", "[", 
                 RowBox[{"NrBlocks", "-", "2"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"LastPos", " ", "=", " ", 
              RowBox[{"LastPos", " ", "+", " ", 
               RowBox[{"(", 
                RowBox[{"Size3", "/", "2"}], ")"}], " ", "+", " ", 
               RowBox[{"(", 
                RowBox[{"Size2", "/", "2"}], ")"}], " ", "+", " ", "Gap2"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd2", " ", "=", " ", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"LastPos", "+", " ", "\[Delta]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", "Lv", ",", "Size2"}], "}"}], ",", 
                RowBox[{"Mag", "[", 
                 RowBox[{"NrBlocks", "-", "1"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"LastPos", " ", "=", " ", 
              RowBox[{"LastPos", " ", "+", 
               RowBox[{"(", 
                RowBox[{"Size2", "/", "2"}], ")"}], " ", "+", 
               RowBox[{"(", 
                RowBox[{"Size1", "/", "2"}], ")"}], " ", "+", " ", "Gap1"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd1", " ", "=", " ", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"LastPos", " ", "+", " ", "\[Delta]"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", "Lv", ",", "Size1"}], "}"}], ",", 
                RowBox[{"Mag", "[", "NrBlocks", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"FourBlocks", " ", "\[Equal]", " ", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"LastPos", " ", "=", " ", 
                 RowBox[{"LastPos", "  ", "+", " ", 
                  RowBox[{"(", 
                   RowBox[{"Size1", "/", "2"}], ")"}], " ", "+", 
                  RowBox[{"(", 
                   RowBox[{"Size4", "/", "2"}], ")"}], " ", "+", " ", 
                  "Gap4"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"CassetteEnd4", " ", "=", 
                 RowBox[{"radObjRecMag", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"BlockCenter", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"BlockCenter", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"LastPos", " ", "+", " ", "\[Delta]"}]}], "}"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{"Lh", ",", "Lv", ",", "Size4"}], "}"}], ",", 
                   RowBox[{"Mag", "[", 
                    RowBox[{"NrBlocks", "-", "3"}], "]"}]}], "]"}]}], ";"}]}],
               " ", "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
               "FieldDirection", " ", "\[Equal]", " ", "\"\<Horizontal\>\""}],
                ",", " ", 
               RowBox[{"Trf", " ", "=", " ", 
                RowBox[{"radTrfTrsl", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Shift3", "*", "ShiftDirection"}], ",", " ", "0", 
                   ",", " ", "0"}], "}"}], "]"}]}], ",", " ", 
               RowBox[{"Trf", " ", "=", " ", 
                RowBox[{"radTrfTrsl", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"Shift3", "*", "ShiftDirection"}], ",", " ", "0"}],
                   "}"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg3", " ", "=", 
              RowBox[{"radTrfOrnt", "[", 
               RowBox[{"CassetteBeg3", ",", " ", "Trf"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd3", " ", "=", 
              RowBox[{"radTrfOrnt", "[", 
               RowBox[{"CassetteEnd3", ",", " ", "Trf"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
               "FieldDirection", " ", "\[Equal]", " ", "\"\<Horizontal\>\""}],
                ",", " ", 
               RowBox[{"Trf", " ", "=", " ", 
                RowBox[{"radTrfTrsl", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Shift2", "*", "ShiftDirection"}], ",", " ", "0", 
                   ",", " ", "0"}], "}"}], "]"}]}], ",", " ", 
               RowBox[{"Trf", " ", "=", " ", 
                RowBox[{"radTrfTrsl", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"Shift2", "*", "ShiftDirection"}], ",", " ", "0"}],
                   "}"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg2", " ", "=", 
              RowBox[{"radTrfOrnt", "[", 
               RowBox[{"CassetteBeg2", ",", " ", "Trf"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd2", " ", "=", 
              RowBox[{"radTrfOrnt", "[", 
               RowBox[{"CassetteEnd2", ",", " ", "Trf"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
               "FieldDirection", " ", "\[Equal]", " ", "\"\<Horizontal\>\""}],
                ",", " ", 
               RowBox[{"Trf", " ", "=", " ", 
                RowBox[{"radTrfTrsl", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Shift1", "*", "ShiftDirection"}], ",", " ", "0", 
                   ",", " ", "0"}], "}"}], "]"}]}], ",", " ", 
               RowBox[{"Trf", " ", "=", " ", 
                RowBox[{"radTrfTrsl", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"Shift1", "*", "ShiftDirection"}], ",", " ", "0"}],
                   "}"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg1", " ", "=", 
              RowBox[{"radTrfOrnt", "[", 
               RowBox[{"CassetteBeg1", ",", " ", "Trf"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd1", " ", "=", 
              RowBox[{"radTrfOrnt", "[", 
               RowBox[{"CassetteEnd1", ",", " ", "Trf"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg", " ", "=", " ", 
              RowBox[{"{", 
               RowBox[{
               "CassetteBeg1", ",", " ", "CassetteBeg2", ",", " ", 
                "CassetteBeg3"}], "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd", " ", "=", " ", 
              RowBox[{"{", 
               RowBox[{
               "CassetteEnd3", ",", " ", "CassetteEnd2", ",", " ", 
                "CassetteEnd1"}], "}"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", " ", 
              RowBox[{
               RowBox[{"FourBlocks", " ", "\[Equal]", " ", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                  "FieldDirection", " ", "\[Equal]", " ", 
                   "\"\<Horizontal\>\""}], ",", " ", 
                  RowBox[{"Trf", " ", "=", " ", 
                   RowBox[{"radTrfTrsl", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", " ", 
                    RowBox[{"Shift4", "*", "ShiftDirection"}], ",", " ", 
                    "0"}], "}"}], "]"}]}], ",", " ", 
                  RowBox[{"Trf", " ", "=", " ", 
                   RowBox[{"radTrfTrsl", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", " ", 
                    RowBox[{"Shift4", "*", "ShiftDirection"}]}], "}"}], 
                    "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"CassetteBeg4", " ", "=", 
                 RowBox[{"radTrfOrnt", "[", 
                  RowBox[{"CassetteBeg4", ",", " ", "Trf"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"CassetteEnd4", " ", "=", 
                 RowBox[{"radTrfOrnt", "[", 
                  RowBox[{"CassetteEnd4", ",", " ", "Trf"}], "]"}]}], ";", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"CassetteBeg", ",", " ", "CassetteBeg4"}], "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"CassetteEnd", ",", " ", "CassetteEnd4"}], "]"}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", "Core", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"CassetteCore", " ", "=", " ", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", " ", "[", 
           RowBox[{
            RowBox[{"i", "=", 
             RowBox[{"(", 
              RowBox[{"NrTermBlocks", "+", "1"}], ")"}]}], ",", " ", 
            RowBox[{"i", "\[LessEqual]", " ", 
             RowBox[{"NrBlocks", " ", "-", " ", "NrTermBlocks"}]}], ",", " ", 
            RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"CassetteCore", ",", " ", 
               RowBox[{"radObjRecMag", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"BlockCenter", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"BlockCenter", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"Pos", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "+", " ", "\[Delta]"}]}], 
                  "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Lh", ",", "Lv", ",", "Len"}], "}"}], ",", 
                 RowBox[{"Mag", "[", "i", "]"}]}], "]"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Cassette", "   ", "=", "  ", 
           RowBox[{"radObjCnt", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
              "CassetteBeg", ",", " ", "CassetteCore", ",", "CassetteEnd"}], 
              "}"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "BlockSubdivision", "]"}], ">", " ", 
             "0"}], ",", " ", "\[IndentingNewLine]", 
            RowBox[{"Cassette", " ", "=", " ", 
             RowBox[{"radObjDivMag", "[", 
              RowBox[{"Cassette", ",", " ", 
               RowBox[{"BlockSubdivision", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Shift", " ", "the", " ", "cassette"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Shift", "=", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Pos", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "+", " ", 
               RowBox[{"Pos", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}]}], "/", "2"}]}], 
          " ", ";", "\[IndentingNewLine]", 
          RowBox[{"Cassette", " ", "=", " ", 
           RowBox[{"radTrfOrnt", "[", 
            RowBox[{"Cassette", ",", 
             RowBox[{"radTrfTrsl", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "Shift"}], "}"}], "]"}]}], "]"}]}],
           ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "Creates", " ", "extruded", " ", "polygon", " ", "blocks", " ", 
            "with", " ", "magnetization", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", " ", "The", " ", "permanent", " ", 
            "blocks", " ", "are", " ", "created", " ", "with", " ", "a", " ", 
            "extrusion", " ", "of", " ", "the", " ", "cross", " ", "section", 
            " ", "of", " ", "the", " ", "block", " ", "and", " ", "the", " ", 
            "magnetization", " ", "vector", " ", "must", " ", "be", " ", 
            "specified", " ", "in", " ", "the", " ", "block", " ", 
            RowBox[{
            "creation", ".", " ", "\[IndentingNewLine]", "However"}]}], ",", 
           " ", 
           RowBox[{
           "the", " ", "extrusion", " ", "is", " ", "done", " ", "in", " ", 
            "the", " ", "x", " ", "direction"}], ",", " ", 
           RowBox[{
           "so", " ", "for", " ", "blocks", " ", "with", " ", "a", " ", 
            "constant", " ", "cross", " ", "section", " ", "in", " ", "the", 
            " ", "longitudinal", " ", "direction"}], ",", " ", 
           RowBox[{
           "the", " ", "objects", " ", "must", " ", "be", " ", "rotated", " ",
             "after", " ", 
            RowBox[{"creation", ".", " ", "\[IndentingNewLine]", "The"}], " ",
             "magnetization", " ", "vector", " ", "is", " ", "affected", " ", 
            "by", " ", "this", " ", "rotation"}], ",", " ", 
           RowBox[{
           "so", " ", "a", " ", "inverse", " ", "transformation", " ", "must",
             " ", "be", " ", "applied", " ", "to", " ", "the", " ", "vector", 
            " ", "before", " ", "the", " ", "block", " ", "is", " ", 
            RowBox[{"created", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "Counterclockwise", " ", "rotations", " ", "of", " ", "the", " ", 
            "magnetization", " ", "vector", " ", "by", " ", 
            RowBox[{"\[Pi]", "/", "2"}], " ", "around", " ", "the", " ", 
            "y"}], "-", 
           RowBox[{"axis", " ", "and", " ", "by", " ", 
            RowBox[{"\[Pi]", "/", "2"}], " ", "around", " ", "the", " ", 
            "x"}], "-", "axis"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"RotMag", "[", "idx_", "]"}], " ", ":=", " ", 
           RowBox[{"Dot", "[", 
            RowBox[{
             RowBox[{"RotationMatrix", "[", 
              RowBox[{
               RowBox[{"\[Pi]", "/", "2"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], ",", " ", 
             RowBox[{"Dot", "[", 
              RowBox[{
               RowBox[{"RotationMatrix", "[", 
                RowBox[{
                 RowBox[{"\[Pi]", "/", "2"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}], ",", " ", 
               RowBox[{"Mag", "[", "idx", "]"}]}], "]"}]}], "]"}]}], " ", ";",
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Termination", " ", "blocks"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"CassetteBeg", " ", "=", " ", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"CassetteEnd", " ", "=", " ", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "BlockSubdivision", "]"}], " ", "<", 
             "1"}], ",", " ", "\[IndentingNewLine]", 
            RowBox[{"BlockSubdivision", " ", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", " ", "1", ",", " ", "1"}], "}"}], ",", 
               RowBox[{"Length", "[", "Shape", "]"}]}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Termination", "\[Equal]", " ", "\"\<OneBlockSym\>\""}], 
             " ", "||", " ", 
             RowBox[{
             "Termination", "\[Equal]", " ", "\"\<OneBlockAntiSym\>\""}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"CassetteBeg", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", 
                   RowBox[{"Wm", "/", "4"}], " ", "+", " ", "\[Delta]"}], ",",
                   "   ", 
                  RowBox[{"Len", "/", "2"}], ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", "1", "]"}]}], "]"}], "&"}], "/@", 
               " ", "Shape"}]}], " ", ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteBeg", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "NrBlocks", "]"}], "]"}], "-", "  ", 
                   RowBox[{"Wm", "/", "4"}], "+", " ", "\[Delta]"}], ",", " ", 
                  RowBox[{"Len", "/", "2"}], ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", "NrBlocks", "]"}]}], "]"}], "&"}], "/@",
                "Shape"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteEnd", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "Termination", "\[Equal]", " ", "\"\<OneBlockSymL4\>\""}], " ", "||",
              " ", 
             RowBox[{
             "Termination", "\[Equal]", " ", "\"\<OneBlockAntiSymL4\>\""}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"CassetteBeg", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", 
                   RowBox[{"5", 
                    RowBox[{"Wm", "/", "8"}]}], " ", "+", " ", "\[Delta]"}], 
                  ",", "   ", 
                  RowBox[{"Len", "/", "4"}], ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", "1", "]"}]}], "]"}], "&"}], "/@", 
               " ", "Shape"}]}], " ", ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteBeg", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "NrBlocks", "]"}], "]"}], "-", " ", 
                   RowBox[{"5", " ", 
                    RowBox[{"Wm", "/", "8"}]}], "+", " ", "\[Delta]"}], ",", 
                  " ", 
                  RowBox[{"Len", "/", "4"}], ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", "NrBlocks", "]"}]}], "]"}], "&"}], "/@",
                "Shape"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteEnd", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "Termination", "\[Equal]", " ", "\"\<ThreeBlocksSym\>\""}], " ", 
             "||", " ", 
             RowBox[{
             "Termination", "\[Equal]", " ", "\"\<ThreeBlocksAntiSym\>\""}]}],
             ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"CassetteBeg1", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", 
                   RowBox[{"3", 
                    RowBox[{"Wm", "/", "8"}]}], " ", "+", " ", "\[Delta]"}], 
                  ",", " ", 
                  RowBox[{"Len", "/", "4"}], ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", "1", "]"}]}], "]"}], "&"}], "/@", 
               "Shape"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg2", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", " ", 
                   RowBox[{"Wm", "/", "4"}], "+", " ", "\[Delta]"}], ",", " ", 
                  RowBox[{"Len", "/", "2"}], ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", "2", "]"}]}], "]"}], "&"}], "/@", 
               "Shape"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg3", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], " ", "+", " ", 
                   RowBox[{"Wm", "/", "8"}], "+", " ", "\[Delta]"}], ",", " ", 
                  RowBox[{"3", 
                   RowBox[{"Len", "/", "4"}]}], ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", "3", "]"}]}], "]"}], "&"}], "/@", 
               " ", "Shape"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg1", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteBeg1", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg2", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteBeg2", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg3", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteBeg3", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg", " ", "=", " ", 
              RowBox[{"{", 
               RowBox[{
               "CassetteBeg1", ",", " ", "CassetteBeg2", ",", " ", 
                "CassetteBeg3"}], "}"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd3", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", 
                    RowBox[{"NrBlocks", "-", "2"}], "]"}], "]"}], " ", "-", 
                   " ", 
                   RowBox[{"Wm", "/", "8"}], "+", " ", "\[Delta]"}], ",", " ", 
                  RowBox[{"3", 
                   RowBox[{"Len", "/", "4"}]}], ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", 
                   RowBox[{"NrBlocks", "-", "2"}], "]"}]}], "]"}], "&"}], "/@",
                "Shape"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd2", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", 
                    RowBox[{"NrBlocks", "-", "1"}], "]"}], "]"}], " ", "-", 
                   " ", 
                   RowBox[{"Wm", "/", "4"}], "+", " ", "\[Delta]"}], ",", " ", 
                  RowBox[{"Len", "/", "2"}], ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", 
                   RowBox[{"NrBlocks", "-", "1"}], "]"}]}], "]"}], "&"}], "/@",
                "Shape"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd1", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "NrBlocks", "]"}], "]"}], " ", "-", 
                   RowBox[{"3", 
                    RowBox[{"Wm", "/", "8"}]}], "+", " ", "\[Delta]"}], ",", 
                  " ", 
                  RowBox[{"Len", "/", "4"}], ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", "NrBlocks", "]"}]}], "]"}], "&"}], "/@",
                "Shape"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd3", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteEnd3", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd2", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteEnd2", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd1", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteEnd1", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd", " ", "=", " ", 
              RowBox[{"{", 
               RowBox[{
               "CassetteEnd3", ",", " ", "CassetteEnd2", ",", " ", 
                "CassetteEnd1"}], "}"}]}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Termination", "\[Equal]", " ", "\"\<VarSizesSym\>\""}], 
             " ", "||", " ", 
             RowBox[{
             "Termination", "\[Equal]", " ", "\"\<VarSizesAntiSym\>\""}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"LastPos", " ", "=", " ", 
              RowBox[{
               RowBox[{"Pos", "[", 
                RowBox[{"[", "4", "]"}], "]"}], " ", "-", " ", 
               RowBox[{"0.5", "*", "Wm"}], " ", "-", " ", 
               RowBox[{"(", 
                RowBox[{"Size3", "/", "2"}], ")"}], " ", "-", " ", "Gap3"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg3", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{"LastPos", "+", " ", "\[Delta]"}], ",", " ", 
                  "Size3", ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", "3", "]"}]}], "]"}], "&"}], "/@", 
               " ", "Shape"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"LastPos", " ", "=", " ", 
              RowBox[{"LastPos", " ", "-", " ", 
               RowBox[{"(", 
                RowBox[{"Size3", "/", "2"}], ")"}], " ", "-", " ", 
               RowBox[{"(", 
                RowBox[{"Size2", "/", "2"}], ")"}], " ", "-", " ", "Gap2"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg2", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{"LastPos", "+", " ", "\[Delta]"}], ",", " ", 
                  "Size2", ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", "2", "]"}]}], "]"}], "&"}], "/@", 
               "Shape"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"LastPos", " ", "=", " ", 
              RowBox[{"LastPos", " ", "-", " ", 
               RowBox[{"(", 
                RowBox[{"Size2", "/", "2"}], ")"}], " ", "-", 
               RowBox[{"(", 
                RowBox[{"Size1", "/", "2"}], ")"}], " ", "-", " ", "Gap1"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg1", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{"LastPos", "+", " ", "\[Delta]"}], ",", " ", 
                  "Size1", ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", "1", "]"}]}], "]"}], "&"}], "/@", 
               "Shape"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"FourBlocks", " ", "\[Equal]", " ", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"LastPos", " ", "=", " ", 
                 RowBox[{"LastPos", " ", "-", " ", 
                  RowBox[{"(", 
                   RowBox[{"Size1", "/", "2"}], ")"}], " ", "-", 
                  RowBox[{"(", 
                   RowBox[{"Size4", "/", "2"}], ")"}], " ", "-", " ", 
                  "Gap4"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"CassetteBeg4", " ", "=", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"radObjThckPgn", "[", 
                    RowBox[{
                    RowBox[{"LastPos", "+", " ", "\[Delta]"}], ",", " ", 
                    "Size4", ",", "#", ",", " ", 
                    RowBox[{"RotMag", "[", "4", "]"}]}], "]"}], "&"}], "/@", 
                  " ", "Shape"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
             ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"LastPos", " ", "=", " ", 
              RowBox[{
               RowBox[{"Pos", "[", 
                RowBox[{"[", 
                 RowBox[{"NrBlocks", "-", "3"}], "]"}], "]"}], " ", "+", " ", 
               RowBox[{"0.5", "*", "Wm"}], " ", "+", " ", 
               RowBox[{"(", 
                RowBox[{"Size3", "/", "2"}], ")"}], " ", "+", " ", "Gap3"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd3", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{"LastPos", "+", " ", "\[Delta]"}], ",", " ", 
                  "Size3", ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", 
                   RowBox[{"NrBlocks", "-", "2"}], "]"}]}], "]"}], "&"}], "/@",
                "Shape"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"LastPos", " ", "=", " ", 
              RowBox[{"LastPos", " ", "+", 
               RowBox[{"(", 
                RowBox[{"Size3", "/", "2"}], ")"}], " ", "+", " ", 
               RowBox[{"(", 
                RowBox[{"Size2", "/", "2"}], ")"}], " ", "+", " ", "Gap2"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd2", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{"LastPos", "+", " ", "\[Delta]"}], ",", " ", 
                  "Size2", ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", 
                   RowBox[{"NrBlocks", "-", "1"}], "]"}]}], "]"}], "&"}], "/@",
                "Shape"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"LastPos", " ", "=", " ", 
              RowBox[{"LastPos", " ", "+", " ", 
               RowBox[{"(", 
                RowBox[{"Size2", "/", "2"}], ")"}], " ", "+", 
               RowBox[{"(", 
                RowBox[{"Size1", "/", "2"}], ")"}], " ", "+", " ", "Gap1"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd1", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{"LastPos", "+", " ", "\[Delta]"}], ",", " ", 
                  "Size1", ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", "NrBlocks", "]"}]}], "]"}], "&"}], "/@",
                "Shape"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"FourBlocks", " ", "\[Equal]", " ", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"LastPos", " ", "=", " ", 
                 RowBox[{"LastPos", "  ", "+", " ", 
                  RowBox[{"(", 
                   RowBox[{"Size1", "/", "2"}], ")"}], " ", "+", 
                  RowBox[{"(", 
                   RowBox[{"Size4", "/", "2"}], ")"}], " ", "+", " ", 
                  "Gap4"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"CassetteEnd4", " ", "=", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"radObjThckPgn", "[", 
                    RowBox[{
                    RowBox[{"LastPos", "+", " ", "\[Delta]"}], ",", " ", 
                    "Size4", ",", "#", ",", " ", 
                    RowBox[{"RotMag", "[", 
                    RowBox[{"NrBlocks", "-", "3"}], "]"}]}], "]"}], "&"}], "/@",
                   "Shape"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
               "FieldDirection", " ", "\[Equal]", " ", "\"\<Horizontal\>\""}],
                ",", " ", 
               RowBox[{"Trf", " ", "=", " ", 
                RowBox[{"radTrfTrsl", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", " ", 
                   RowBox[{"Shift3", "*", "ShiftDirection"}], ",", " ", "0"}],
                   "}"}], "]"}]}], ",", " ", 
               RowBox[{"Trf", " ", "=", " ", 
                RowBox[{"radTrfTrsl", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", " ", 
                   RowBox[{"Shift3", "*", "ShiftDirection"}]}], "}"}], 
                 "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg3", " ", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"radTrfOrnt", "[", 
                 RowBox[{"#", ",", "  ", "Trf"}], "]"}], "&"}], "/@", 
               "CassetteBeg3"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd3", " ", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"radTrfOrnt", "[", 
                 RowBox[{"#", ",", "  ", "Trf"}], "]"}], "&"}], "/@", 
               "CassetteEnd3"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
               "FieldDirection", " ", "\[Equal]", " ", "\"\<Horizontal\>\""}],
                ",", " ", 
               RowBox[{"Trf", " ", "=", " ", 
                RowBox[{"radTrfTrsl", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", " ", 
                   RowBox[{"Shift2", "*", "ShiftDirection"}], ",", " ", "0"}],
                   "}"}], "]"}]}], ",", " ", 
               RowBox[{"Trf", " ", "=", " ", 
                RowBox[{"radTrfTrsl", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", " ", 
                   RowBox[{"Shift2", "*", "ShiftDirection"}]}], "}"}], 
                 "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg2", " ", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"radTrfOrnt", "[", 
                 RowBox[{"#", ",", " ", "Trf"}], "]"}], "&"}], "/@", 
               "CassetteBeg2"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd2", " ", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"radTrfOrnt", "[", 
                 RowBox[{"#", ",", " ", "Trf"}], "]"}], "&"}], "/@", 
               "CassetteEnd2"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
               "FieldDirection", " ", "\[Equal]", " ", "\"\<Horizontal\>\""}],
                ",", " ", 
               RowBox[{"Trf", " ", "=", " ", 
                RowBox[{"radTrfTrsl", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", " ", 
                   RowBox[{"Shift1", "*", "ShiftDirection"}], ",", " ", "0"}],
                   "}"}], "]"}]}], ",", " ", 
               RowBox[{"Trf", " ", "=", " ", 
                RowBox[{"radTrfTrsl", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", " ", 
                   RowBox[{"Shift1", "*", "ShiftDirection"}]}], "}"}], 
                 "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg1", " ", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"radTrfOrnt", "[", 
                 RowBox[{"#", ",", " ", "Trf"}], "]"}], "&"}], "/@", 
               "CassetteBeg1"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd1", " ", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"radTrfOrnt", "[", 
                 RowBox[{"#", ",", " ", "Trf"}], "]"}], "&"}], "/@", 
               "CassetteEnd1"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg1", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteBeg1", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg2", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteBeg2", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg3", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteBeg3", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg", " ", "=", " ", 
              RowBox[{"{", 
               RowBox[{
               "CassetteBeg1", ",", " ", "CassetteBeg2", ",", " ", 
                "CassetteBeg3"}], "}"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd3", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteEnd3", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd2", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteEnd2", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd1", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteEnd1", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd", " ", "=", " ", 
              RowBox[{"{", 
               RowBox[{
               "CassetteEnd3", ",", " ", "CassetteEnd2", ",", " ", 
                "CassetteEnd1"}], "}"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", " ", 
              RowBox[{
               RowBox[{"FourBlocks", " ", "\[Equal]", " ", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                  "FieldDirection", " ", "\[Equal]", " ", 
                   "\"\<Horizontal\>\""}], ",", " ", 
                  RowBox[{"Trf", " ", "=", " ", 
                   RowBox[{"radTrfTrsl", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", " ", 
                    RowBox[{"Shift4", "*", "ShiftDirection"}], ",", " ", 
                    "0"}], "}"}], "]"}]}], ",", " ", 
                  RowBox[{"Trf", " ", "=", " ", 
                   RowBox[{"radTrfTrsl", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", " ", 
                    RowBox[{"Shift4", "*", "ShiftDirection"}]}], "}"}], 
                    "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"CassetteBeg4", " ", "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"radTrfOrnt", "[", 
                    RowBox[{"#", ",", " ", "Trf"}], "]"}], "&"}], "/@", 
                  "CassetteBeg4"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"CassetteEnd4", " ", "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"radTrfOrnt", "[", 
                    RowBox[{"#", ",", " ", "Trf"}], "]"}], "&"}], "/@", 
                  "CassetteEnd4"}]}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"CassetteBeg4", " ", "=", " ", 
                 RowBox[{"MapThread", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"radObjDivMag", "[", 
                    RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"CassetteBeg4", ",", " ", "BlockSubdivision"}], 
                    "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"CassetteEnd4", " ", "=", " ", 
                 RowBox[{"MapThread", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"radObjDivMag", "[", 
                    RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"CassetteEnd4", ",", " ", "BlockSubdivision"}], 
                    "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"CassetteBeg", ",", " ", "CassetteBeg4"}], "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"CassetteEnd", ",", " ", "CassetteEnd4"}], "]"}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", "Core", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"CassetteCore", " ", "=", " ", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", " ", "[", 
           RowBox[{
            RowBox[{"i", "=", 
             RowBox[{"(", 
              RowBox[{"NrTermBlocks", "+", "1"}], ")"}]}], ",", " ", 
            RowBox[{"i", "\[LessEqual]", " ", 
             RowBox[{"NrBlocks", " ", "-", " ", "NrTermBlocks"}]}], ",", " ", 
            RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"bl", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "+", " ", "\[Delta]"}], 
                  ",", "Len", ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", "i", "]"}]}], "]"}], "&"}], "/@", 
               "Shape"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"bl", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"bl", ",", " ", "BlockSubdivision"}], "}"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"CassetteCore", ",", " ", "bl"}], "]"}], " ", ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Cassette", "   ", "=", " ", 
           RowBox[{"radObjCnt", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
              "CassetteBeg", " ", ",", " ", "CassetteCore", ",", 
               "CassetteEnd"}], "}"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Shift", " ", "the", " ", "cassette"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Shift", "=", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Pos", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "+", " ", 
               RowBox[{"Pos", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}]}], "/", "2"}]}], 
          " ", ";", "\[IndentingNewLine]", 
          RowBox[{"Cassette", " ", "=", " ", 
           RowBox[{"radTrfOrnt", "[", 
            RowBox[{"Cassette", ",", 
             RowBox[{"radTrfTrsl", "[", 
              RowBox[{"{", 
               RowBox[{"Shift", ",", "0", ",", "0"}], "}"}], "]"}]}], "]"}]}],
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "Counterclockwise", " ", "rotation", " ", "of", " ", "the", " ", 
             "cassette", " ", "by"}], " ", "-", 
            RowBox[{
             RowBox[{"\[Pi]", "/", "2"}], " ", "around", " ", "the", " ", 
             "x"}], "-", "axis"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Cassette", "=", " ", 
           RowBox[{"radTrfOrnt", "[", 
            RowBox[{"Cassette", ",", " ", 
             RowBox[{"radTrfRot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{
                RowBox[{"-", "\[Pi]"}], "/", "2"}]}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "Counterclockwise", " ", "rotation", " ", "of", " ", "the", " ", 
             "cassette", " ", "by"}], " ", "-", 
            RowBox[{
             RowBox[{"\[Pi]", "/", "2"}], " ", "around", " ", "the", " ", 
             "y"}], "-", "axis"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Cassette", "=", " ", 
           RowBox[{"radTrfOrnt", "[", 
            RowBox[{"Cassette", ",", " ", 
             RowBox[{"radTrfRot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
               RowBox[{
                RowBox[{"-", "\[Pi]"}], "/", "2"}]}], "]"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Cassette", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7667563716198864`*^9, 3.76675637607336*^9}, {
   3.7667564210925236`*^9, 3.7667565039740367`*^9}, {3.767445221866372*^9, 
   3.7674452499623413`*^9}, 3.7674492825809617`*^9, {3.7826372836996193`*^9, 
   3.782637315936621*^9}, {3.782637359577076*^9, 3.7826374825765934`*^9}, {
   3.782637552607568*^9, 3.78263768450115*^9}, {3.782637743188423*^9, 
   3.7826378222055535`*^9}, {3.782637856189788*^9, 3.782637902285347*^9}, {
   3.782637956646202*^9, 3.7826379589118185`*^9}, {3.7826379963510313`*^9, 
   3.7826380522744694`*^9}, {3.7826380832169104`*^9, 3.782638439756551*^9}, {
   3.7826384823501635`*^9, 3.7826385761329775`*^9}, {3.782638608587835*^9, 
   3.782638715809715*^9}, {3.7826388457671947`*^9, 3.7826390394108934`*^9}, {
   3.7826391010200243`*^9, 3.782639101770018*^9}, {3.782639166051016*^9, 
   3.782639483428545*^9}, {3.782639556287635*^9, 3.782639561334486*^9}, {
   3.7826396491173325`*^9, 3.7826398286009946`*^9}, {3.7826399117901325`*^9, 
   3.7826400534547825`*^9}, {3.782640090532792*^9, 3.7826405585668488`*^9}, {
   3.782640594521858*^9, 3.782640772400242*^9}, {3.7826408291968937`*^9, 
   3.782641220744748*^9}, {3.782641266900818*^9, 3.782641439540758*^9}, {
   3.7826415380716205`*^9, 3.782641576430842*^9}, {3.7826416069325433`*^9, 
   3.782641900267953*^9}, {3.782642091536579*^9, 3.7826421241301994`*^9}, {
   3.782642159770681*^9, 3.782642183333087*^9}, {3.782642768258963*^9, 
   3.7826428182481303`*^9}, {3.7826428851853724`*^9, 
   3.7826429424839563`*^9}, {3.782642980298272*^9, 3.7826429824232635`*^9}, {
   3.7826430294252024`*^9, 3.782643045909505*^9}, {3.782643084190604*^9, 
   3.782643129690423*^9}, {3.7826432037264595`*^9, 3.7826433699932384`*^9}, {
   3.782643405307832*^9, 3.782643478420932*^9}, {3.782643611689359*^9, 
   3.7826438111124973`*^9}, {3.782644897374318*^9, 3.782644921501483*^9}, {
   3.7826450171885633`*^9, 3.782645044032238*^9}, 3.7826450852820787`*^9, {
   3.7826451379869146`*^9, 3.782645156986842*^9}, {3.7834337430222216`*^9, 
   3.7834337438503695`*^9}, {3.7834338345867214`*^9, 3.783433837758585*^9}, {
   3.7849719852731423`*^9, 3.784971987038904*^9}, {3.8006905477684984`*^9, 
   3.8006906423307467`*^9}, {3.800690756221059*^9, 3.800690766236659*^9}, {
   3.8006909297238693`*^9, 3.8006910255517483`*^9}, 3.8006912303535028`*^9, {
   3.8045059921675367`*^9, 3.804505996669073*^9}, {3.804850797352042*^9, 
   3.804850807477048*^9}, {3.8049517589196978`*^9, 3.8049517615685425`*^9}, {
   3.8062286811290216`*^9, 3.806228721202465*^9}, {3.806228979261788*^9, 
   3.8062290170507536`*^9}, {3.8062291180831394`*^9, 3.80622916799267*^9}, {
   3.8062292322098484`*^9, 3.8062293461602297`*^9}, {3.806230986856161*^9, 
   3.8062309872205615`*^9}, {3.806231021987795*^9, 3.8062310387314997`*^9}, 
   3.8062310746834383`*^9, {3.8062311117960773`*^9, 3.8062311267617693`*^9}, {
   3.806231197379216*^9, 3.8062313083139057`*^9}, {3.806231354665861*^9, 
   3.806231359055117*^9}, {3.8062313929050198`*^9, 3.806231398383541*^9}, {
   3.8062314489701333`*^9, 3.8062314964060936`*^9}, {3.806231649251237*^9, 
   3.806231652025425*^9}, {3.8062317279393225`*^9, 3.8062317396088457`*^9}, {
   3.806231974992104*^9, 3.806231975324426*^9}, {3.8062321842108383`*^9, 
   3.80623219202647*^9}, 3.8062322825326595`*^9, {3.806232352649621*^9, 
   3.806232387879024*^9}, {3.8062324469851923`*^9, 3.806232511381152*^9}, {
   3.806232544003265*^9, 3.806232588714759*^9}, {3.8062326239026313`*^9, 
   3.8062326400794697`*^9}, {3.8062326931090703`*^9, 3.806232717248754*^9}, {
   3.806232848010804*^9, 3.8062328589514856`*^9}, {3.8062329608016596`*^9, 
   3.8062329717030077`*^9}, {3.806233107012436*^9, 3.8062331071380606`*^9}, {
   3.806233213092393*^9, 3.806233243495797*^9}, 3.806234151752848*^9, {
   3.811790973348828*^9, 3.81179100069236*^9}, {3.811791034750472*^9, 
   3.8117918513521185`*^9}, {3.811821899399679*^9, 3.811821912870348*^9}, {
   3.8118219737455*^9, 3.811822031222424*^9}, {3.8118220718652563`*^9, 
   3.811822110434097*^9}, {3.8118221498110332`*^9, 3.811822379446498*^9}, 
   3.811822412301318*^9, {3.811822598318445*^9, 3.8118226064557867`*^9}, {
   3.8118236629202824`*^9, 3.811823666303432*^9}, {3.8118536066983304`*^9, 
   3.811853628423772*^9}, {3.8125360888714266`*^9, 3.812536115075982*^9}, {
   3.8125362241527753`*^9, 3.8125362243227973`*^9}, {3.8125362689155827`*^9, 
   3.812536357981106*^9}, {3.8125368905814185`*^9, 3.812536942974682*^9}, {
   3.8125371437134495`*^9, 3.8125371631846704`*^9}, 3.81253729351833*^9, {
   3.8125376101392884`*^9, 3.8125376239801445`*^9}, {3.812537684383421*^9, 
   3.812537841361286*^9}, {3.81253803235649*^9, 3.8125380890700197`*^9}, {
   3.8125382022470665`*^9, 3.8125382524901934`*^9}, {3.812538309483726*^9, 
   3.812538316174163*^9}, {3.8125383476761227`*^9, 3.812538430481282*^9}, {
   3.812538499316957*^9, 3.812538570231386*^9}, {3.8125386112639303`*^9, 
   3.8125386137440615`*^9}, {3.8125386808282604`*^9, 3.812538734463213*^9}, {
   3.8125387952170124`*^9, 3.812538796667104*^9}, {3.812538929406506*^9, 
   3.812538939967165*^9}, {3.812538975559382*^9, 3.812538976679451*^9}, {
   3.8125392861109715`*^9, 3.8125393135226855`*^9}, {3.8125393440945807`*^9, 
   3.812539362055702*^9}, {3.8125394140889397`*^9, 3.812539486052806*^9}, {
   3.8125395280254173`*^9, 3.8125395869290843`*^9}, {3.81254011903574*^9, 
   3.812540161078357*^9}, {3.8125402002707767`*^9, 3.8125402135216017`*^9}, {
   3.8125402523840218`*^9, 3.81254026043453*^9}, {3.8125403715414453`*^9, 
   3.812540473097768*^9}, {3.812540511900181*^9, 3.8125405877695456`*^9}, {
   3.8125406375926485`*^9, 3.8125406401728096`*^9}, 3.8125409888186436`*^9, {
   3.8161781061534595`*^9, 3.8161781816375327`*^9}, {3.8161782517015753`*^9, 
   3.8161782537484426`*^9}, {3.816180407779239*^9, 3.816180445466555*^9}, {
   3.816180792419794*^9, 3.8161807987791433`*^9}, {3.8161808354664993`*^9, 
   3.8161808403258495`*^9}, {3.8161809798409276`*^9, 
   3.8161810150283203`*^9}, {3.8161889397634106`*^9, 3.81618908146509*^9}, {
   3.8161891162204165`*^9, 3.816189364138302*^9}, {3.8161899024986024`*^9, 
   3.8161899764607897`*^9}, {3.816190016294608*^9, 3.816190017216479*^9}, {
   3.816190108478877*^9, 3.816190385809641*^9}, {3.816190519527711*^9, 
   3.8161905348104925`*^9}, {3.8161905702519407`*^9, 
   3.8161905732519293`*^9}, {3.816190623055337*^9, 3.8161906416986494`*^9}, {
   3.8161907314903755`*^9, 3.8161907542447243`*^9}, {3.816190796201868*^9, 
   3.8161908013282037`*^9}, {3.816190838324855*^9, 3.8161908438730707`*^9}, {
   3.816190926859888*^9, 3.8161909307192464`*^9}, {3.816612848368778*^9, 
   3.816612929305269*^9}, {3.8166130846927524`*^9, 3.816613231109089*^9}, {
   3.8166135535337315`*^9, 3.8166136584210224`*^9}, 3.816614204079871*^9, {
   3.816629081579727*^9, 3.8166291978863153`*^9}, {3.816629232772005*^9, 
   3.8166295026830626`*^9}, {3.816629555534605*^9, 3.8166297371760917`*^9}, {
   3.816629951096596*^9, 3.8166299826530952`*^9}, {3.816630661452345*^9, 
   3.816630662083006*^9}, {3.816630729595662*^9, 3.8166307485575027`*^9}, {
   3.816689523978589*^9, 3.816689526877671*^9}, {3.8166895597138705`*^9, 
   3.8166895615751925`*^9}, {3.8166989873184624`*^9, 
   3.8166990361209087`*^9}, {3.8166992608883195`*^9, 
   3.8166993279952765`*^9}, {3.8187637986771817`*^9, 
   3.8187638012972775`*^9}, {3.8187638459525676`*^9, 
   3.8187639719259357`*^9}, {3.818764014538122*^9, 3.8187640757616796`*^9}, {
   3.8188452591640754`*^9, 3.8188453011321845`*^9}, {3.818845341928625*^9, 
   3.818845343633266*^9}, {3.818845387624538*^9, 3.8188454153953238`*^9}, {
   3.8188454679220333`*^9, 3.8188455578771753`*^9}, {3.818845593376182*^9, 
   3.8188456421994534`*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[30]:=",ExpressionUUID->"88230ced-7ab0-4c04-8a67-eb24bb06a7fd"]
}, Closed]],

Cell[CellGroupData[{

Cell["auxIDNumberToString", "Subsection",
 CellChangeTimes->{3.7667546801064196`*^9, 
  3.7667549456130934`*^9},ExpressionUUID->"ed6540fc-c052-4b41-a1d1-\
11fc8d3448cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"auxIDNumberToString", "[", "num_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "sf", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sf", " ", "=", " ", 
       RowBox[{"ScientificForm", "[", 
        RowBox[{
         RowBox[{"N", "[", "num", "]"}], ",", " ", "10", ",", " ", 
         RowBox[{"NumberFormat", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{"#1", ",", "\"\<e\>\"", ",", "#3"}], "}"}], "]"}], 
            "&"}], ")"}]}], ",", " ", 
         RowBox[{"ExponentFunction", "->", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "5"}], "<", "#", "<", "5"}], ",", "Null", ",", 
              "#"}], "]"}], "&"}], ")"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sf", " ", "=", " ", 
       RowBox[{"ToString", "[", "sf", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"StringEndsQ", "[", 
         RowBox[{"sf", ",", " ", "\"\<e\>\""}], "]"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"ToString", "[", 
          RowBox[{
           RowBox[{"StringSplit", "[", 
            RowBox[{"sf", ",", " ", "\"\<e\>\""}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"Return", "[", "sf", "]"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.820155773441057*^9, 3.8201557742611485`*^9}, {
  3.8201558525362673`*^9, 3.820155893078945*^9}, {3.82015615217033*^9, 
  3.8201561574406567`*^9}, {3.820156190742879*^9, 3.820156257597144*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[31]:=",ExpressionUUID->"dbe544c3-e306-475e-8f6f-f45de39e73df"]
}, Closed]],

Cell[CellGroupData[{

Cell["auxIDNewtonLorentzEquation", "Subsection",
 CellChangeTimes->{3.7667546801064196`*^9, 3.7667549456130934`*^9, 
  3.766755008805561*^9},ExpressionUUID->"07ebf3db-cb91-4b84-a9a7-\
c807351444a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"auxIDNewtonLorentzEquation", "[", 
    RowBox[{"a_", ",", "r_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "drds", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"drds", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"drds", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"r", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"drds", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "=", 
       RowBox[{"r", "[", 
        RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"drds", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "=", 
       RowBox[{"r", "[", 
        RowBox[{"[", "6", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"drds", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"-", "a"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"[", "5", "]"}], "]"}], "*", 
           RowBox[{"b", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"[", "6", "]"}], "]"}], "*", 
           RowBox[{"b", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"drds", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"-", "a"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"[", "6", "]"}], "]"}], "*", 
           RowBox[{"b", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "*", 
           RowBox[{"b", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"drds", "[", 
        RowBox[{"[", "6", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"-", "a"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "*", 
           RowBox[{"b", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"[", "5", "]"}], "]"}], "*", 
           RowBox[{"b", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "drds", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[32]:=",ExpressionUUID->"55cadbff-321c-415c-8140-4da3fa8ee30a"]
}, Closed]],

Cell[CellGroupData[{

Cell["auxIDBlockArrow", "Subsection",
 CellChangeTimes->{
  3.766754730782276*^9},ExpressionUUID->"5bb9eb47-9ccd-4f6a-96cc-\
a524dcee03b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"auxIDBlockArrow", "[", 
    RowBox[{"BlockCenter_", ",", " ", "BlockMag_", ",", " ", "ArrowSize_"}], 
    "]"}], ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"MagArrow", ",", " ", "MagDirection"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MagDirection", " ", "=", " ", 
       RowBox[{"Normalize", "[", "BlockMag", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"MagArrow", " ", "=", " ", 
       RowBox[{"Arrow", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"BlockCenter", " ", "-", " ", 
           RowBox[{"MagDirection", " ", "*", 
            RowBox[{"ArrowSize", "/", "2"}]}]}], ",", " ", 
          RowBox[{"BlockCenter", " ", "+", " ", 
           RowBox[{"MagDirection", " ", "*", 
            RowBox[{"ArrowSize", "/", "2"}]}]}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "MagArrow", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[33]:=",ExpressionUUID->"a1dde243-caf9-45aa-b999-a81e2e28e907"]
}, Closed]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Set Directory", "Chapter",
 CellChangeTimes->{{3.7144752481299753`*^9, 3.7144752644163694`*^9}, {
  3.724769257493918*^9, 
  3.724769260400402*^9}},ExpressionUUID->"62a97ffb-394e-4e84-afed-\
3b5318232eab"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "SetDirectory", "[", 
   "\"\<C:\\\\Users\\\\luana.vilela\\\\lnls-ima\\\\id-sabia\\\\model-02\\\\\
simulation\\\\magnetic\\\\fieldmap\\\\src\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7247692641975746`*^9, 3.7247693030912867`*^9}, 
   3.7247693360001373`*^9, 3.7320053568775253`*^9, 3.732349690257825*^9, {
   3.732871709479047*^9, 3.7328717118852863`*^9}, {3.7329567238206897`*^9, 
   3.7329567258363123`*^9}, 3.748957419661892*^9, {3.7489624425948105`*^9, 
   3.7489624446418552`*^9}, {3.7489767421165304`*^9, 
   3.7489767440073037`*^9}, {3.7511001230276623`*^9, 3.75110012579725*^9}, 
   3.7511411057661276`*^9, {3.7571464911653185`*^9, 3.757146493384221*^9}, 
   3.7876561315405025`*^9, 3.7876676883664165`*^9, 3.7982006252779846`*^9, {
   3.7984654527917624`*^9, 3.7984654540105295`*^9}, 3.7984663899212046`*^9, {
   3.798466466390125*^9, 3.7984664684994793`*^9}, 3.800036087694026*^9, {
   3.800038304096528*^9, 3.8000383140652494`*^9}, 3.8003047290105705`*^9, {
   3.813666547262052*^9, 3.8136665743061132`*^9}, 3.815744536042758*^9, 
   3.815913537512823*^9, {3.8160848576375723`*^9, 3.8160848605750694`*^9}, 
   3.819099815172518*^9, 3.819444458879774*^9, 3.81998746749841*^9, 
   3.8200531624537296`*^9, 3.820156726151952*^9, 3.8202355839373245`*^9, {
   3.820318665285944*^9, 3.82031866746607*^9}, 3.820571966825166*^9},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[34]:=",ExpressionUUID->"4c139ebb-aba3-4042-8355-2160f9f0f573"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Delta Sabi\[AAcute] ", "Chapter",
 CellChangeTimes->{{3.681300194179221*^9, 3.6813002033832407`*^9}, {
   3.681305983976405*^9, 3.6813059853359213`*^9}, {3.6813176225703306`*^9, 
   3.6813176235079107`*^9}, {3.6813177175941257`*^9, 3.68131771915676*^9}, {
   3.708272177122472*^9, 3.708272189394394*^9}, {3.708272239370994*^9, 
   3.708272253185425*^9}, {3.7247626663439655`*^9, 3.724762668594143*^9}, 
   3.724763762181196*^9, {3.725974849294973*^9, 3.725974857279992*^9}, {
   3.7316800228814087`*^9, 3.7316800249126425`*^9}, {3.731761928333893*^9, 
   3.731761928740137*^9}, {3.7377345647344294`*^9, 3.7377345664687967`*^9}, {
   3.737994165253688*^9, 3.7379941653786864`*^9}, {3.7489625392900763`*^9, 
   3.7489625531505637`*^9}, {3.749318816981333*^9, 3.749318817559469*^9}, {
   3.7656382216793394`*^9, 3.7656382261328287`*^9}, {3.7662401432029853`*^9, 
   3.766240154985159*^9}, {3.7663282678653297`*^9, 3.766328270484855*^9}, {
   3.766331146283388*^9, 3.7663311568355923`*^9}, {3.7663982782306576`*^9, 
   3.7663982795028768`*^9}, {3.7664037488989267`*^9, 
   3.7664037535714073`*^9}, {3.76675425955847*^9, 3.766754260902328*^9}, {
   3.767446029232342*^9, 3.7674460297011285`*^9}, {3.7675176217294626`*^9, 
   3.767517621841589*^9}, {3.7685471006341314`*^9, 3.7685471031625986`*^9}, {
   3.782651674525923*^9, 3.7826516762290554`*^9}, {3.7827472341594315`*^9, 
   3.7827472344406757`*^9}, {3.7845390971377993`*^9, 
   3.7845390993098416`*^9}, {3.7846213628789454`*^9, 
   3.7846213635508842`*^9}, {3.784971285415371*^9, 3.784971285852929*^9}, {
   3.80003815573755*^9, 3.8000381597687845`*^9}, {3.8049514458306084`*^9, 
   3.804951448440013*^9}, {3.8062446719465714`*^9, 3.8062446751540537`*^9}, {
   3.811791929593967*^9, 3.8117919321569138`*^9}, {3.8117920042649097`*^9, 
   3.811792032147236*^9}, {3.8118212232455654`*^9, 3.8118212243258395`*^9}, {
   3.811855173078432*^9, 3.8118551748205085`*^9}, {3.813666226120046*^9, 
   3.8136662293236427`*^9}, {3.8157445404480095`*^9, 3.815744553217987*^9}, 
   3.8194444635501432`*^9},ExpressionUUID->"14114740-1747-4179-b27c-\
fc3a885d635f"],

Cell[CellGroupData[{

Cell["Parameters", "Section",
 CellChangeTimes->{{3.76639811614032*^9, 3.7663981237176037`*^9}, {
  3.8117926979894156`*^9, 3.811792703856547*^9}, {3.8118552160849347`*^9, 
  3.811855218607912*^9}},ExpressionUUID->"203cdc6e-83ea-4360-b14c-\
6ae2bef4e227"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"ID", " ", "main", " ", "parameters"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]u", " ", "=", " ", "52.5"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Np", " ", "=", " ", "21"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Gap", " ", "=", " ", "13.6"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockGap", " ", "=", " ", "0.125"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"PM", " ", "material", " ", "parameters"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Mr", " ", "=", " ", "1.37"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Block", " ", "shape"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockShapeA", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "5.25"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "22.5"}], ",", "19.3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "22.5"}], ",", " ", "29.2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "17.8"}], ",", " ", "33.2"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"17.8", ",", " ", "33.2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"22.5", ",", "29.2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"22.5", ",", "19.3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5.25", ",", "0"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockShapeB", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "17.8"}], ",", " ", "33.2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "17.8"}], ",", "38.4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"17.8", ",", " ", "38.4"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"17.8", ",", " ", "33.2"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockShapeC", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "17.8"}], ",", "38.4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "22.5"}], ",", "42.4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "22.5"}], ",", "49"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "21.5"}], ",", "50"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"21.5", ",", "50"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"22.5", ",", "49"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"22.5", ",", "42.4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"17.8", ",", "38.4"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockShape", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"BlockShapeA", ",", " ", "BlockShapeB", ",", "BlockShapeC"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockSubdivisionA", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"3", ",", " ", "3", ",", " ", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockSubdivisionB", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"3", ",", " ", "1", ",", " ", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockSubdivisionC", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"3", ",", " ", "1", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockSubdivision", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "BlockSubdivisionA", ",", " ", "BlockSubdivisionB", ",", " ", 
       "BlockSubdivisionC"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Solver", " ", "options"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Prec", " ", "=", " ", 
     RowBox[{"10", "^", 
      RowBox[{"-", "8"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MaxIter", " ", "=", " ", 
     RowBox[{"10", "^", "6"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Longitudinal", " ", 
     RowBox[{"range", " ", "[", "mm", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Lstep", " ", "=", " ", "0.5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Li", " ", "=", " ", 
     RowBox[{"-", "800"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Lf", " ", "=", " ", "800"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Lnpts", " ", "=", 
     RowBox[{
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Lf", " ", "-", " ", "Li"}], ")"}], "/", "Lstep"}], " ", 
       "]"}], "+", " ", "1"}]}], ";"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Horizontal", " ", 
     RowBox[{"range", " ", "[", "mm", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hstep", " ", "=", "0.25"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hi", " ", "=", " ", 
     RowBox[{"-", "1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hf", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hnpts", " ", "=", " ", 
     RowBox[{
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Hf", " ", "-", " ", "Hi"}], ")"}], "/", "Hstep"}], " ", 
       "]"}], "+", " ", "1"}]}], ";"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Vertical", " ", 
     RowBox[{"range", " ", "[", "mm", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vstep", " ", "=", "0.25"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vi", " ", "=", " ", 
     RowBox[{"-", "1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vf", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vnpts", " ", "=", " ", 
     RowBox[{
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Vf", " ", "-", " ", "Vi"}], ")"}], "/", "Vstep"}], " ", 
       "]"}], "+", " ", "1"}]}], ";"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Particle", " ", 
     RowBox[{"energy", " ", "[", "GeV", "]"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Energy", " ", "=", " ", "3"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Radia", " ", "randomization", " ", "magnitudes"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"radFldLenTol", "[", 
     RowBox[{
      RowBox[{"10", "^", 
       RowBox[{"-", "12"}]}], ",", 
      RowBox[{"10", "^", 
       RowBox[{"-", "12"}]}]}], " ", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"ID", " ", "label"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MagnetName", "=", "\"\<DeltaSabia_Model02\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Silent", " ", "flag"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Silent", " ", "=", " ", "True"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "Termination", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Termination", " ", "=", " ", "\"\<VarSizesAntiSym\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Size1", " ", "=", "  ", "3.25"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Size2", " ", "=", " ", "9.75"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Size3", " ", "=", " ", "9.75"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Size4", " ", "=", " ", "3.25"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Gap1", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Gap2", "=", " ", "4.5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Gap3", " ", "=", " ", "1.1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Gap4", " ", "=", " ", "6.8"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Shift1", " ", "=", "0"}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Shift2", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Shift3", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Shift4", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MagnetLength", " ", "=", " ", 
     RowBox[{
      RowBox[{"Np", "*", "\[Lambda]u"}], " ", "+", 
      RowBox[{"\[Lambda]u", "/", "4"}], "+", " ", 
      RowBox[{"2", "Size1"}], "+", 
      RowBox[{"2", "Size2"}], "+", 
      RowBox[{"2", "Size3"}], "+", 
      RowBox[{"2", "Size4"}], "+", 
      RowBox[{"2", "Gap1"}], "+", 
      RowBox[{"2", "Gap2"}], "+", 
      RowBox[{"2", "Gap3"}], "+", 
      RowBox[{"2", "Gap4"}], " ", "-", " ", "BlockGap"}]}], ";"}], 
   " "}]}]], "Input",
 CellChangeTimes->{
  3.811855207172743*^9, {3.8118552376751156`*^9, 3.811855275314695*^9}, {
   3.811855308364966*^9, 3.811855346532337*^9}, {3.8118557027938423`*^9, 
   3.811855702925171*^9}, {3.8118558092389507`*^9, 3.8118558093790627`*^9}, {
   3.811855908058054*^9, 3.811855908459084*^9}, {3.811856081254526*^9, 
   3.8118561692498074`*^9}, {3.811856273232277*^9, 3.81185627338993*^9}, {
   3.81185722712294*^9, 3.8118572605837917`*^9}, {3.811858735804346*^9, 
   3.811858779588729*^9}, {3.8118589053674154`*^9, 3.8118589062479534`*^9}, {
   3.8118595391736546`*^9, 3.811859547778454*^9}, {3.8118596833788958`*^9, 
   3.811859685326743*^9}, {3.8118597441516953`*^9, 3.8118597495638866`*^9}, {
   3.811859784644433*^9, 3.811859794582543*^9}, {3.811859829052552*^9, 
   3.811859871760453*^9}, {3.8118600609322777`*^9, 3.8118601507438817`*^9}, {
   3.811860581708088*^9, 3.811860582338484*^9}, {3.811861410043792*^9, 
   3.8118614169696198`*^9}, {3.811862208244576*^9, 3.8118622113284826`*^9}, {
   3.8118641025775394`*^9, 3.8118641610648546`*^9}, {3.8118643600561056`*^9, 
   3.8118643828865585`*^9}, {3.811864443079011*^9, 3.811864512881933*^9}, {
   3.811993905187863*^9, 3.811993923288112*^9}, {3.8119946982651463`*^9, 
   3.811994816826828*^9}, {3.8119949571054792`*^9, 3.8119949806237135`*^9}, {
   3.8119954359278374`*^9, 3.811995465916664*^9}, {3.8119958892166176`*^9, 
   3.811995889626624*^9}, {3.811996963630056*^9, 3.8119969651118603`*^9}, {
   3.812096164248562*^9, 3.8120961661986866`*^9}, {3.8124426592342777`*^9, 
   3.812442745989946*^9}, {3.8124428389174237`*^9, 3.8124428391074553`*^9}, {
   3.812527230138237*^9, 3.812527230458268*^9}, {3.81252799770525*^9, 
   3.8125280007054453`*^9}, {3.812535550024563*^9, 3.812535643410362*^9}, {
   3.812542457566344*^9, 3.8125425541923804`*^9}, {3.81254258608436*^9, 
   3.8125425973350773`*^9}, {3.812542911852826*^9, 3.8125429231335464`*^9}, {
   3.812606154017066*^9, 3.812606155067148*^9}, {3.813666249289554*^9, 
   3.8136663337349753`*^9}, {3.813666404159743*^9, 3.813666406213176*^9}, {
   3.813666864813153*^9, 3.813666873654956*^9}, {3.815744558107267*^9, 
   3.8157445876424084`*^9}, {3.8157451165219603`*^9, 3.815745128888291*^9}, {
   3.815745541424957*^9, 3.815745542130571*^9}, {3.8157504810312405`*^9, 
   3.815750486790907*^9}, {3.815750925612025*^9, 3.8157509331318073`*^9}, {
   3.815751189024087*^9, 3.815751189254117*^9}, {3.8157512493682775`*^9, 
   3.8157512494783783`*^9}, {3.8157514619795437`*^9, 
   3.8157514626808777`*^9}, {3.815752239682006*^9, 3.815752241191635*^9}, {
   3.8157526903683243`*^9, 3.815752691711067*^9}, {3.8157532348434033`*^9, 
   3.815753246959155*^9}, {3.815913804285653*^9, 3.8159138070900755`*^9}, {
   3.815914182298482*^9, 3.815914183480729*^9}, {3.8159154784810677`*^9, 
   3.8159154895651927`*^9}, {3.8160826167214503`*^9, 3.816082685268034*^9}, 
   3.8160829737316103`*^9, {3.816083195405877*^9, 3.816083196780873*^9}, {
   3.8160848672625313`*^9, 3.816084887231207*^9}, {3.8161799487633095`*^9, 
   3.816179968028837*^9}, {3.816180472249189*^9, 3.8161804748898354`*^9}, {
   3.8161806475453415`*^9, 3.816180647701652*^9}, {3.8161807052326756`*^9, 
   3.816180705779517*^9}, {3.816181147277858*^9, 3.8161811530590982`*^9}, {
   3.8161895617390995`*^9, 3.8161895742859335`*^9}, {3.8166134361251383`*^9, 
   3.8166134427239065`*^9}, {3.8166136799002304`*^9, 
   3.8166137121822486`*^9}, {3.8166306364786444`*^9, 3.816630637331376*^9}, {
   3.8168857523176584`*^9, 3.8168857582357388`*^9}, {3.816888759688429*^9, 
   3.8168887601415772`*^9}, {3.816889323456911*^9, 3.816889328441248*^9}, {
   3.8170522610742545`*^9, 3.8170522682555227`*^9}, {3.817072726354745*^9, 
   3.817072733472889*^9}, {3.8187660745340295`*^9, 3.81876607486409*^9}, {
   3.8187685262503304`*^9, 3.818768531890706*^9}, {3.818773918503582*^9, 
   3.818773919763671*^9}, {3.81877698759726*^9, 3.8187769963178053`*^9}, {
   3.818842228899935*^9, 3.8188422339376554`*^9}, 3.8189269780774603`*^9, {
   3.8189273043443546`*^9, 3.8189273045746384`*^9}, {3.81892790363011*^9, 
   3.8189279037372627`*^9}, {3.818936369734997*^9, 3.8189363701456203`*^9}, {
   3.8190998487545567`*^9, 3.819099882068619*^9}, {3.8190999149706125`*^9, 
   3.8190999481525745`*^9}, {3.8191002169088745`*^9, 
   3.8191002171488485`*^9}, {3.819102699213158*^9, 3.81910270546364*^9}, {
   3.8199874779991627`*^9, 3.819987492440054*^9}, {3.820049291477436*^9, 
   3.820049293316618*^9}, 3.820063419672714*^9, {3.820149912382104*^9, 
   3.8201499631654477`*^9}, {3.820150070192515*^9, 3.820150155418107*^9}, {
   3.8201508467785945`*^9, 3.8201508719402676`*^9}, {3.820152861296486*^9, 
   3.820152892098501*^9}, {3.8201530031870017`*^9, 3.8201530043770795`*^9}, {
   3.8201567348525677`*^9, 3.8201567529037657`*^9}, {3.82015743805989*^9, 
   3.8201574409301023`*^9}, {3.820158045451233*^9, 3.820158093084323*^9}, {
   3.820219988458577*^9, 3.8202199931465425`*^9}, 3.8202204274060993`*^9, {
   3.820235408539823*^9, 3.8202354091295204`*^9}, {3.8202357627763214`*^9, 
   3.820235846084488*^9}, {3.820236144270729*^9, 3.820236147239374*^9}, {
   3.8202365693571186`*^9, 3.820236574574421*^9}, {3.8202385969806156`*^9, 
   3.820238601198448*^9}, {3.820247621092806*^9, 3.8202476288588147`*^9}, {
   3.8205719733956523`*^9, 3.8205720024775515`*^9}, {3.8205722895681815`*^9, 
   3.8205722908182755`*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[35]:=",ExpressionUUID->"7e941638-cf76-41c4-b8fa-d0bc095ce284"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Function", "Chapter",
 CellChangeTimes->{{3.681300194179221*^9, 3.6813002033832407`*^9}, {
   3.681305983976405*^9, 3.6813059853359213`*^9}, {3.6813176225703306`*^9, 
   3.6813176235079107`*^9}, {3.6813177175941257`*^9, 3.68131771915676*^9}, {
   3.708272177122472*^9, 3.708272189394394*^9}, {3.708272239370994*^9, 
   3.708272253185425*^9}, {3.7247626663439655`*^9, 3.724762668594143*^9}, 
   3.724763762181196*^9, {3.725974849294973*^9, 3.725974857279992*^9}, {
   3.7316800228814087`*^9, 3.7316800249126425`*^9}, {3.731761928333893*^9, 
   3.731761928740137*^9}, {3.7377345647344294`*^9, 3.7377345664687967`*^9}, {
   3.737994165253688*^9, 3.7379941653786864`*^9}, {3.7489625392900763`*^9, 
   3.7489625531505637`*^9}, {3.749318816981333*^9, 3.749318817559469*^9}, {
   3.7656382216793394`*^9, 3.7656382261328287`*^9}, {3.7662401432029853`*^9, 
   3.766240154985159*^9}, {3.7663282678653297`*^9, 3.766328270484855*^9}, {
   3.766331146283388*^9, 3.7663311568355923`*^9}, {3.7663982782306576`*^9, 
   3.7663982795028768`*^9}, {3.7664037488989267`*^9, 
   3.7664037535714073`*^9}, {3.76675425955847*^9, 3.766754260902328*^9}, {
   3.767446029232342*^9, 3.7674460297011285`*^9}, {3.7675176217294626`*^9, 
   3.767517621841589*^9}, {3.7685471006341314`*^9, 3.7685471031625986`*^9}, {
   3.782651674525923*^9, 3.7826516762290554`*^9}, {3.7827472341594315`*^9, 
   3.7827472344406757`*^9}, {3.7845390971377993`*^9, 
   3.7845390993098416`*^9}, {3.7846213628789454`*^9, 
   3.7846213635508842`*^9}, {3.784971285415371*^9, 3.784971285852929*^9}, {
   3.80003815573755*^9, 3.8000381597687845`*^9}, {3.8049514458306084`*^9, 
   3.804951448440013*^9}, {3.8062446719465714`*^9, 3.8062446751540537`*^9}, {
   3.811791929593967*^9, 3.8117919321569138`*^9}, {3.8117920042649097`*^9, 
   3.811792032147236*^9}, {3.8118212232455654`*^9, 3.8118212243258395`*^9}, {
   3.811855173078432*^9, 3.8118551748205085`*^9}, {3.813666226120046*^9, 
   3.8136662293236427`*^9}, {3.8157445404480095`*^9, 3.815744553217987*^9}, 
   3.8194444635501432`*^9, {3.8200470241049037`*^9, 3.8200470540438976`*^9}, {
   3.8200479202353115`*^9, 3.8200479218146176`*^9}, {3.820063087622788*^9, 
   3.8200630909436483`*^9}, {3.8205726524724765`*^9, 
   3.8205726562327375`*^9}},ExpressionUUID->"0b4dbfda-6ff1-4250-b4d3-\
782d1be812a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IDCalcFieldmap3D", "[", 
     RowBox[{
     "\[Delta]P_", ",", " ", "\[Delta]CP_", ",", " ", "\[Delta]GV_", ",", " ",
       "\[Delta]GH_", ",", " ", "Polarization_", ",", " ", "PhaseName_"}], 
     "]"}], ":=", " ", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t0", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Device", "=", " ", 
       RowBox[{"IDDelta", "[", 
        RowBox[{
        "\[Lambda]u", ",", " ", "Np", ",", " ", "Mr", ",", " ", "Gap", ",", 
         "  ", 
         RowBox[{"\"\<\[Delta]P\>\"", "\[Rule]", " ", "\[Delta]P"}], ",", " ", 
         RowBox[{"\"\<\[Delta]GV\>\"", "\[Rule]", " ", "\[Delta]GV"}], ",", 
         " ", 
         RowBox[{"\"\<\[Delta]GH\>\"", "\[Rule]", " ", "\[Delta]GH"}], ",", 
         " ", 
         RowBox[{"\"\<\[Delta]CP\>\"", "\[Rule]", " ", "\[Delta]CP"}], ",", 
         " ", 
         RowBox[{"\"\<BlockShape\>\"", " ", "\[Rule]", " ", "BlockShape"}], 
         " ", ",", " ", 
         RowBox[{"\"\<BlockGap\>\"", " ", "\[Rule]", " ", "BlockGap"}], " ", 
         ",", 
         RowBox[{"\"\<Termination\>\"", "\[Rule]", " ", "Termination"}], ",", 
         " ", 
         RowBox[{
         "\"\<BlockSubdivision\>\"", "\[Rule]", " ", "BlockSubdivision"}], 
         ",", " ", 
         RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "Silent"}], ",", "  ", 
         RowBox[{"\"\<Size1\>\"", "\[Rule]", " ", "Size1"}], ",", " ", 
         RowBox[{"\"\<Size2\>\"", "\[Rule]", " ", "Size2"}], ",", " ", 
         RowBox[{"\"\<Size3\>\"", "\[Rule]", " ", "Size3"}], ",", " ", 
         RowBox[{"\"\<Size4\>\"", "\[Rule]", " ", "Size4"}], ",", 
         RowBox[{"\"\<Gap1\>\"", "\[Rule]", " ", "Gap1"}], ",", " ", 
         RowBox[{"\"\<Gap2\>\"", "\[Rule]", " ", "Gap2"}], ",", " ", 
         RowBox[{"\"\<Gap3\>\"", "\[Rule]", " ", "Gap3"}], ",", 
         RowBox[{"\"\<Gap4\>\"", "\[Rule]", " ", "Gap4"}], ",", " ", 
         RowBox[{"\"\<Shift1\>\"", "\[Rule]", " ", "Shift1"}], ",", " ", 
         RowBox[{"\"\<Shift2\>\"", "\[Rule]", " ", "Shift2"}], ",", " ", 
         RowBox[{"\"\<Shift3\>\"", "\[Rule]", " ", "Shift3"}], ",", " ", 
         RowBox[{"\"\<Shift4\>\"", "\[Rule]", " ", "Shift4"}], ",", " ", 
         RowBox[{"\"\<FourBlocks\>\"", "\[Rule]", " ", "1"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Mat", "=", " ", 
       RowBox[{"RadMatNdFeB", "[", "Mr", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Device", "=", " ", 
       RowBox[{"radMatApl", "[", 
        RowBox[{"Device", ",", " ", "Mat"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"IDSolve", "[", 
       RowBox[{"Device", ",", " ", "Prec", ",", " ", "MaxIter", ",", " ", 
        RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "Silent"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"IDFieldMapWithHeader", "[", 
       RowBox[{"Device", ",", " ", 
        RowBox[{"{", 
         RowBox[{"Hi", ",", " ", "Hf"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"Vi", ",", " ", "Vf"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"Li", ",", " ", "Lf"}], "}"}], ",", " ", "Hnpts", ",", " ", 
        "Vnpts", ",", " ", "Lnpts", ",", " ", "MagnetName", ",", " ", 
        "Polarization", ",", " ", "PhaseName", ",", " ", "MagnetLength", ",", 
        "\[Lambda]u", ",", " ", "Gap", ",", " ", "\[Delta]P", ",", " ", 
        "\[Delta]GV", ",", " ", "\[Delta]GH", ",", " ", "\[Delta]CP"}], "]"}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Elapsed time = \>\"", ",", 
        RowBox[{"(", 
         RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], ";"}], 
     "\[IndentingNewLine]", ")"}]}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.820572375513872*^9, 3.820572434297716*^9}, {
  3.820572482323104*^9, 3.820572512906892*^9}, {3.820572593046945*^9, 
  3.820572626227853*^9}, {3.8205726610829926`*^9, 3.820572667373452*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[80]:=",ExpressionUUID->"dc5dfff3-cc0b-4f6d-b8c7-2c40314888c3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Horizontal Polarization", "Chapter",
 CellChangeTimes->{{3.681300194179221*^9, 3.6813002033832407`*^9}, {
   3.681305983976405*^9, 3.6813059853359213`*^9}, {3.6813176225703306`*^9, 
   3.6813176235079107`*^9}, {3.6813177175941257`*^9, 3.68131771915676*^9}, {
   3.708272177122472*^9, 3.708272189394394*^9}, {3.708272239370994*^9, 
   3.708272253185425*^9}, {3.7247626663439655`*^9, 3.724762668594143*^9}, 
   3.724763762181196*^9, {3.725974849294973*^9, 3.725974857279992*^9}, {
   3.7316800228814087`*^9, 3.7316800249126425`*^9}, {3.731761928333893*^9, 
   3.731761928740137*^9}, {3.7377345647344294`*^9, 3.7377345664687967`*^9}, {
   3.737994165253688*^9, 3.7379941653786864`*^9}, {3.7489625392900763`*^9, 
   3.7489625531505637`*^9}, {3.749318816981333*^9, 3.749318817559469*^9}, {
   3.7656382216793394`*^9, 3.7656382261328287`*^9}, {3.7662401432029853`*^9, 
   3.766240154985159*^9}, {3.7663282678653297`*^9, 3.766328270484855*^9}, {
   3.766331146283388*^9, 3.7663311568355923`*^9}, {3.7663982782306576`*^9, 
   3.7663982795028768`*^9}, {3.7664037488989267`*^9, 
   3.7664037535714073`*^9}, {3.76675425955847*^9, 3.766754260902328*^9}, {
   3.767446029232342*^9, 3.7674460297011285`*^9}, {3.7675176217294626`*^9, 
   3.767517621841589*^9}, {3.7685471006341314`*^9, 3.7685471031625986`*^9}, {
   3.782651674525923*^9, 3.7826516762290554`*^9}, {3.7827472341594315`*^9, 
   3.7827472344406757`*^9}, {3.7845390971377993`*^9, 
   3.7845390993098416`*^9}, {3.7846213628789454`*^9, 
   3.7846213635508842`*^9}, {3.784971285415371*^9, 3.784971285852929*^9}, {
   3.80003815573755*^9, 3.8000381597687845`*^9}, {3.8049514458306084`*^9, 
   3.804951448440013*^9}, {3.8062446719465714`*^9, 3.8062446751540537`*^9}, {
   3.811791929593967*^9, 3.8117919321569138`*^9}, {3.8117920042649097`*^9, 
   3.811792032147236*^9}, {3.8118212232455654`*^9, 3.8118212243258395`*^9}, {
   3.811855173078432*^9, 3.8118551748205085`*^9}, {3.813666226120046*^9, 
   3.8136662293236427`*^9}, {3.8157445404480095`*^9, 3.815744553217987*^9}, 
   3.8194444635501432`*^9, {3.8200470241049037`*^9, 3.8200470540438976`*^9}, {
   3.8200479202353115`*^9, 3.8200479218146176`*^9}, {3.820063087622788*^9, 
   3.8200630909436483`*^9}},ExpressionUUID->"1093adc8-81a2-4d0f-9b14-\
0bb8a553561a"],

Cell[CellGroupData[{

Cell["\[Delta]GH", "Section",
 CellChangeTimes->{{3.8201580063786097`*^9, 
  3.820158019009424*^9}},ExpressionUUID->"053c45df-8ca5-4967-baf7-\
b8ccd3a87258"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]P", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]CP", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GV", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GH", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Polarization", "=", "\"\<LinearPolarization\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PhaseName", " ", "=", " ", "\"\<dGH\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IDCalcFieldmap3D", "[", 
   RowBox[{
   "\[Delta]P", ",", " ", "\[Delta]CP", ",", " ", "\[Delta]GV", ",", " ", 
    "\[Delta]GH", ",", " ", "Polarization", ",", " ", "PhaseName"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8200481107642474`*^9, 3.8200481587837424`*^9}, {
   3.820048197117392*^9, 3.820048197937029*^9}, {3.8200509409117136`*^9, 
   3.820050944440159*^9}, {3.820051064048478*^9, 3.8200510642184086`*^9}, {
   3.8200512480184298`*^9, 3.8200512573242693`*^9}, {3.8200521112218113`*^9, 
   3.820052115329935*^9}, {3.8200630689414687`*^9, 3.8200631054369073`*^9}, {
   3.8200633049361115`*^9, 3.820063306815239*^9}, {3.820063371675081*^9, 
   3.8200633761430044`*^9}, {3.82006390421078*^9, 3.820063904720542*^9}, {
   3.8201495538865643`*^9, 3.8201495542966237`*^9}, {3.8201497915822363`*^9, 
   3.820149983546794*^9}, 3.8201500276496797`*^9, {3.8201501945306916`*^9, 
   3.8201501959708023`*^9}, {3.8201508544391437`*^9, 
   3.8201508593694563`*^9}, {3.820152769570441*^9, 3.820152771470558*^9}, {
   3.820152848715656*^9, 3.8201529443319683`*^9}, {3.820152999816786*^9, 
   3.8201530180679955`*^9}, {3.8201536575874186`*^9, 3.8201536681081467`*^9}, 
   3.8201539351575203`*^9, {3.8201568830223465`*^9, 3.8201568873025694`*^9}, {
   3.8201576175133305`*^9, 3.820157623623746*^9}, {3.820158038650758*^9, 
   3.8201580409408894`*^9}, {3.8201581036150494`*^9, 3.820158219334298*^9}, {
   3.820158294020669*^9, 3.820158317492241*^9}, {3.820158522885709*^9, 
   3.820158523105774*^9}, {3.820247605310929*^9, 3.820247673298539*^9}, {
   3.820572026569154*^9, 3.820572035259694*^9}, {3.8205722860079327`*^9, 
   3.8205723198401775`*^9}, {3.8205726831044655`*^9, 3.820572697955476*^9}, 
   3.8205730516978197`*^9},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[81]:=",ExpressionUUID->"f4b38c68-7e12-42de-8041-808a089820a4"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-25_DeltaSabia_Model02_LinearPolarization_Kh=5.99_Kv=0.0_X=-1_1mm_\
Y=-1_1mm_Z=-800_800mm_dGH.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-25_DeltaSabia_Model02_LinearPolarization_Kh=5.99_Kv=0.0_X=-1_1mm_\
Y=-1_1mm_Z=-800_800mm_dGH.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820574849673868*^9},
 CellLabel->
  "During evaluation of \
In[81]:=",ExpressionUUID->"54328c87-db73-476b-9789-89a87fbed31d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "1689.5689227`10.679320906172592", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 1689.5689227`10.679320906172592, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8205748496938586`*^9},
 CellLabel->
  "During evaluation of \
In[81]:=",ExpressionUUID->"7319b119-23ee-45be-9911-1dc89bacc846"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Elapsed time = \"\>", "\[InvisibleSpace]", 
   "1730.4416178`10.689701945005337", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm["Elapsed time = ", 1730.4416178`10.689701945005337, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8205748496938586`*^9},
 CellLabel->
  "During evaluation of \
In[81]:=",ExpressionUUID->"ed5e8b9e-db35-4e6a-9505-c348e76e8001"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Delta]GV", "Section",
 CellChangeTimes->{{3.8201580063786097`*^9, 3.820158019009424*^9}, {
  3.8201621504380217`*^9, 
  3.820162151958124*^9}},ExpressionUUID->"293453a5-abcf-4424-a928-\
43ea6fecda5f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]P", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]CP", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GV", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GH", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Polarization", "=", "\"\<LinearPolarization\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PhaseName", " ", "=", " ", "\"\<dGV\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IDCalcFieldmap3D", "[", 
   RowBox[{
   "\[Delta]P", ",", " ", "\[Delta]CP", ",", " ", "\[Delta]GV", ",", " ", 
    "\[Delta]GH", ",", " ", "Polarization", ",", " ", "PhaseName"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8200481107642474`*^9, 3.8200481587837424`*^9}, {
   3.820048197117392*^9, 3.820048197937029*^9}, {3.8200509409117136`*^9, 
   3.820050944440159*^9}, {3.820051064048478*^9, 3.8200510642184086`*^9}, {
   3.8200512480184298`*^9, 3.8200512573242693`*^9}, {3.8200521112218113`*^9, 
   3.820052115329935*^9}, {3.8200630689414687`*^9, 3.8200631054369073`*^9}, {
   3.8200633049361115`*^9, 3.820063306815239*^9}, {3.820063371675081*^9, 
   3.8200633761430044`*^9}, {3.82006390421078*^9, 3.820063904720542*^9}, {
   3.8201495538865643`*^9, 3.8201495542966237`*^9}, {3.8201497915822363`*^9, 
   3.820149983546794*^9}, 3.8201500276496797`*^9, {3.8201501945306916`*^9, 
   3.8201501959708023`*^9}, {3.8201508544391437`*^9, 
   3.8201508593694563`*^9}, {3.820152769570441*^9, 3.820152771470558*^9}, {
   3.820152848715656*^9, 3.8201529443319683`*^9}, {3.820152999816786*^9, 
   3.8201530180679955`*^9}, {3.8201536575874186`*^9, 3.8201536681081467`*^9}, 
   3.8201539351575203`*^9, {3.8201568830223465`*^9, 3.8201568873025694`*^9}, {
   3.8201576175133305`*^9, 3.820157623623746*^9}, {3.820158038650758*^9, 
   3.8201580409408894`*^9}, {3.8201581036150494`*^9, 3.820158219334298*^9}, {
   3.820158294020669*^9, 3.820158317492241*^9}, {3.820158522885709*^9, 
   3.820158523105774*^9}, {3.8201621548682823`*^9, 3.820162159680563*^9}, {
   3.820247612867053*^9, 3.820247615825527*^9}, {3.8202476848225994`*^9, 
   3.820247686131924*^9}, {3.8205720446603527`*^9, 3.820572049560661*^9}, 
   3.8205723268205996`*^9, 3.820573056998167*^9},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[88]:=",ExpressionUUID->"4a778b85-2da4-4f4c-95b0-759decc84ff8"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-25_DeltaSabia_Model02_LinearPolarization_Kh=5.99_Kv=0.0_X=-1_1mm_\
Y=-1_1mm_Z=-800_800mm_dGV.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-25_DeltaSabia_Model02_LinearPolarization_Kh=5.99_Kv=0.0_X=-1_1mm_\
Y=-1_1mm_Z=-800_800mm_dGV.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8205765775945697`*^9},
 CellLabel->
  "During evaluation of \
In[88]:=",ExpressionUUID->"c2c681ea-3f05-4f8b-a8ea-028f1ba527e0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "1686.9679656`10.678651829199952", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 1686.9679656`10.678651829199952, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8205765776045327`*^9},
 CellLabel->
  "During evaluation of \
In[88]:=",ExpressionUUID->"86dc2eb0-bda9-4b73-ac19-45ec8d7fc4c6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Elapsed time = \"\>", "\[InvisibleSpace]", 
   "1727.8607289`10.689053727525549", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm["Elapsed time = ", 1727.8607289`10.689053727525549, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8205765776045327`*^9},
 CellLabel->
  "During evaluation of \
In[88]:=",ExpressionUUID->"874c522b-a9eb-4df2-9a1b-184af23d3610"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vertical Polarization", "Chapter",
 CellChangeTimes->{{3.681300194179221*^9, 3.6813002033832407`*^9}, {
   3.681305983976405*^9, 3.6813059853359213`*^9}, {3.6813176225703306`*^9, 
   3.6813176235079107`*^9}, {3.6813177175941257`*^9, 3.68131771915676*^9}, {
   3.708272177122472*^9, 3.708272189394394*^9}, {3.708272239370994*^9, 
   3.708272253185425*^9}, {3.7247626663439655`*^9, 3.724762668594143*^9}, 
   3.724763762181196*^9, {3.725974849294973*^9, 3.725974857279992*^9}, {
   3.7316800228814087`*^9, 3.7316800249126425`*^9}, {3.731761928333893*^9, 
   3.731761928740137*^9}, {3.7377345647344294`*^9, 3.7377345664687967`*^9}, {
   3.737994165253688*^9, 3.7379941653786864`*^9}, {3.7489625392900763`*^9, 
   3.7489625531505637`*^9}, {3.749318816981333*^9, 3.749318817559469*^9}, {
   3.7656382216793394`*^9, 3.7656382261328287`*^9}, {3.7662401432029853`*^9, 
   3.766240154985159*^9}, {3.7663282678653297`*^9, 3.766328270484855*^9}, {
   3.766331146283388*^9, 3.7663311568355923`*^9}, {3.7663982782306576`*^9, 
   3.7663982795028768`*^9}, {3.7664037488989267`*^9, 
   3.7664037535714073`*^9}, {3.76675425955847*^9, 3.766754260902328*^9}, {
   3.767446029232342*^9, 3.7674460297011285`*^9}, {3.7675176217294626`*^9, 
   3.767517621841589*^9}, {3.7685471006341314`*^9, 3.7685471031625986`*^9}, {
   3.782651674525923*^9, 3.7826516762290554`*^9}, {3.7827472341594315`*^9, 
   3.7827472344406757`*^9}, {3.7845390971377993`*^9, 
   3.7845390993098416`*^9}, {3.7846213628789454`*^9, 
   3.7846213635508842`*^9}, {3.784971285415371*^9, 3.784971285852929*^9}, {
   3.80003815573755*^9, 3.8000381597687845`*^9}, {3.8049514458306084`*^9, 
   3.804951448440013*^9}, {3.8062446719465714`*^9, 3.8062446751540537`*^9}, {
   3.811791929593967*^9, 3.8117919321569138`*^9}, {3.8117920042649097`*^9, 
   3.811792032147236*^9}, {3.8118212232455654`*^9, 3.8118212243258395`*^9}, {
   3.811855173078432*^9, 3.8118551748205085`*^9}, {3.813666226120046*^9, 
   3.8136662293236427`*^9}, {3.8157445404480095`*^9, 3.815744553217987*^9}, 
   3.8194444635501432`*^9, {3.8200470241049037`*^9, 3.8200470540438976`*^9}, {
   3.8200479202353115`*^9, 3.8200479218146176`*^9}, {3.820063087622788*^9, 
   3.8200630909436483`*^9}, {3.820162369245296*^9, 
   3.820162370625386*^9}},ExpressionUUID->"1b06b555-66f5-4d5e-bd16-\
da67c7332007"],

Cell[CellGroupData[{

Cell["\[Delta]GH", "Section",
 CellChangeTimes->{{3.8201580063786097`*^9, 
  3.820158019009424*^9}},ExpressionUUID->"1e5882e0-f91f-42df-9307-\
d3db53d41218"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]P", " ", "=", 
   RowBox[{"\[Lambda]u", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]CP", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GV", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GH", "=", " ", 
   RowBox[{
    RowBox[{"-", "3"}], 
    RowBox[{"\[Lambda]u", "/", "8"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Polarization", "=", "\"\<LinearPolarization\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PhaseName", " ", "=", " ", "\"\<dGH\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IDCalcFieldmap3D", "[", 
   RowBox[{
   "\[Delta]P", ",", " ", "\[Delta]CP", ",", " ", "\[Delta]GV", ",", " ", 
    "\[Delta]GH", ",", " ", "Polarization", ",", " ", "PhaseName"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8200481107642474`*^9, 3.8200481587837424`*^9}, {
   3.820048197117392*^9, 3.820048197937029*^9}, {3.8200509409117136`*^9, 
   3.820050944440159*^9}, {3.820051064048478*^9, 3.8200510642184086`*^9}, {
   3.8200512480184298`*^9, 3.8200512573242693`*^9}, {3.8200521112218113`*^9, 
   3.820052115329935*^9}, {3.8200630689414687`*^9, 3.8200631054369073`*^9}, {
   3.8200633049361115`*^9, 3.820063306815239*^9}, {3.820063371675081*^9, 
   3.8200633761430044`*^9}, {3.82006390421078*^9, 3.820063904720542*^9}, {
   3.8201495538865643`*^9, 3.8201495542966237`*^9}, {3.8201497915822363`*^9, 
   3.820149983546794*^9}, 3.8201500276496797`*^9, {3.8201501945306916`*^9, 
   3.8201501959708023`*^9}, {3.8201508544391437`*^9, 
   3.8201508593694563`*^9}, {3.820152769570441*^9, 3.820152771470558*^9}, {
   3.820152848715656*^9, 3.8201529443319683`*^9}, {3.820152999816786*^9, 
   3.8201530180679955`*^9}, {3.8201536575874186`*^9, 3.8201536681081467`*^9}, 
   3.8201539351575203`*^9, {3.8201568830223465`*^9, 3.8201568873025694`*^9}, {
   3.8201576175133305`*^9, 3.820157623623746*^9}, {3.820158038650758*^9, 
   3.8201580409408894`*^9}, {3.8201581036150494`*^9, 3.820158219334298*^9}, {
   3.820158294020669*^9, 3.820158317492241*^9}, {3.820158522885709*^9, 
   3.820158523105774*^9}, {3.8201623771057973`*^9, 3.8201623793259583`*^9}, 
   3.8202476941677322`*^9, {3.8205720979638405`*^9, 3.8205721335462055`*^9}, 
   3.8205723298708377`*^9, 3.820573060438425*^9},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[95]:=",ExpressionUUID->"6a42638e-6281-4e3d-a895-b99fabcf5636"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-25_DeltaSabia_Model02_LinearPolarization_Kh=0.0_Kv=2.29_X=-1_1mm_\
Y=-1_1mm_Z=-800_800mm_dGH.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-25_DeltaSabia_Model02_LinearPolarization_Kh=0.0_Kv=2.29_X=-1_1mm_\
Y=-1_1mm_Z=-800_800mm_dGH.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.82057830517082*^9},
 CellLabel->
  "During evaluation of \
In[95]:=",ExpressionUUID->"71308055-9a47-454c-9ddc-0f7b2d312656"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "1686.6217038`10.678562678115025", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 1686.6217038`10.678562678115025, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820578305180818*^9},
 CellLabel->
  "During evaluation of \
In[95]:=",ExpressionUUID->"31933027-80bc-4ffc-9df4-a29d99fafe57"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Elapsed time = \"\>", "\[InvisibleSpace]", 
   "1727.5362912`10.688972173074681", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm["Elapsed time = ", 1727.5362912`10.688972173074681, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820578305180818*^9},
 CellLabel->
  "During evaluation of \
In[95]:=",ExpressionUUID->"0f2f7a99-2362-4d7b-8404-47769ee1db23"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Delta]GV", "Section",
 CellChangeTimes->{{3.8201580063786097`*^9, 3.820158019009424*^9}, {
  3.8201621504380217`*^9, 
  3.820162151958124*^9}},ExpressionUUID->"2d0dd69f-9c7b-4d0f-afc6-\
dd6cd943a1ea"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]P", " ", "=", 
   RowBox[{"\[Lambda]u", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]CP", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GV", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", "3"}], 
    RowBox[{"\[Lambda]u", "/", "8"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GH", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Polarization", "=", "\"\<LinearPolarization\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PhaseName", " ", "=", " ", "\"\<dGV\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IDCalcFieldmap3D", "[", 
   RowBox[{
   "\[Delta]P", ",", " ", "\[Delta]CP", ",", " ", "\[Delta]GV", ",", " ", 
    "\[Delta]GH", ",", " ", "Polarization", ",", " ", "PhaseName"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8200481107642474`*^9, 3.8200481587837424`*^9}, {
   3.820048197117392*^9, 3.820048197937029*^9}, {3.8200509409117136`*^9, 
   3.820050944440159*^9}, {3.820051064048478*^9, 3.8200510642184086`*^9}, {
   3.8200512480184298`*^9, 3.8200512573242693`*^9}, {3.8200521112218113`*^9, 
   3.820052115329935*^9}, {3.8200630689414687`*^9, 3.8200631054369073`*^9}, {
   3.8200633049361115`*^9, 3.820063306815239*^9}, {3.820063371675081*^9, 
   3.8200633761430044`*^9}, {3.82006390421078*^9, 3.820063904720542*^9}, {
   3.8201495538865643`*^9, 3.8201495542966237`*^9}, {3.8201497915822363`*^9, 
   3.820149983546794*^9}, 3.8201500276496797`*^9, {3.8201501945306916`*^9, 
   3.8201501959708023`*^9}, {3.8201508544391437`*^9, 
   3.8201508593694563`*^9}, {3.820152769570441*^9, 3.820152771470558*^9}, {
   3.820152848715656*^9, 3.8201529443319683`*^9}, {3.820152999816786*^9, 
   3.8201530180679955`*^9}, {3.8201536575874186`*^9, 3.8201536681081467`*^9}, 
   3.8201539351575203`*^9, {3.8201568830223465`*^9, 3.8201568873025694`*^9}, {
   3.8201576175133305`*^9, 3.820157623623746*^9}, {3.820158038650758*^9, 
   3.8201580409408894`*^9}, {3.8201581036150494`*^9, 3.820158219334298*^9}, {
   3.820158294020669*^9, 3.820158317492241*^9}, {3.820158522885709*^9, 
   3.820158523105774*^9}, {3.8201621548682823`*^9, 3.820162159680563*^9}, {
   3.8201623862764215`*^9, 3.8201623866464415`*^9}, 3.8202477013540115`*^9, {
   3.820572143806877*^9, 3.820572152597458*^9}, 3.820572333851123*^9, 
   3.820573065828796*^9},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[102]:=",ExpressionUUID->"71e8d84d-ccda-4306-9525-06142fb93633"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-25_DeltaSabia_Model02_LinearPolarization_Kh=0.0_Kv=2.2_X=-1_1mm_\
Y=-1_1mm_Z=-800_800mm_dGV.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-25_DeltaSabia_Model02_LinearPolarization_Kh=0.0_Kv=2.2_X=-1_1mm_Y=\
-1_1mm_Z=-800_800mm_dGV.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820580041484229*^9},
 CellLabel->
  "During evaluation of \
In[102]:=",ExpressionUUID->"0ef54cc4-d259-45e5-9db5-2a8f9cd0cec6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "1695.0313981`10.68072274081105", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 1695.0313981`10.68072274081105, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820580041484229*^9},
 CellLabel->
  "During evaluation of \
In[102]:=",ExpressionUUID->"f41b531b-0fd5-4775-be0b-f7377e7c2d6c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Elapsed time = \"\>", "\[InvisibleSpace]", 
   "1736.2834134`10.691165609975618", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm["Elapsed time = ", 1736.2834134`10.691165609975618, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820580041484229*^9},
 CellLabel->
  "During evaluation of \
In[102]:=",ExpressionUUID->"ac9f5853-9243-4869-bf2c-61a8b4c86779"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Circular Polarization", "Chapter",
 CellChangeTimes->{{3.681300194179221*^9, 3.6813002033832407`*^9}, {
   3.681305983976405*^9, 3.6813059853359213`*^9}, {3.6813176225703306`*^9, 
   3.6813176235079107`*^9}, {3.6813177175941257`*^9, 3.68131771915676*^9}, {
   3.708272177122472*^9, 3.708272189394394*^9}, {3.708272239370994*^9, 
   3.708272253185425*^9}, {3.7247626663439655`*^9, 3.724762668594143*^9}, 
   3.724763762181196*^9, {3.725974849294973*^9, 3.725974857279992*^9}, {
   3.7316800228814087`*^9, 3.7316800249126425`*^9}, {3.731761928333893*^9, 
   3.731761928740137*^9}, {3.7377345647344294`*^9, 3.7377345664687967`*^9}, {
   3.737994165253688*^9, 3.7379941653786864`*^9}, {3.7489625392900763`*^9, 
   3.7489625531505637`*^9}, {3.749318816981333*^9, 3.749318817559469*^9}, {
   3.7656382216793394`*^9, 3.7656382261328287`*^9}, {3.7662401432029853`*^9, 
   3.766240154985159*^9}, {3.7663282678653297`*^9, 3.766328270484855*^9}, {
   3.766331146283388*^9, 3.7663311568355923`*^9}, {3.7663982782306576`*^9, 
   3.7663982795028768`*^9}, {3.7664037488989267`*^9, 
   3.7664037535714073`*^9}, {3.76675425955847*^9, 3.766754260902328*^9}, {
   3.767446029232342*^9, 3.7674460297011285`*^9}, {3.7675176217294626`*^9, 
   3.767517621841589*^9}, {3.7685471006341314`*^9, 3.7685471031625986`*^9}, {
   3.782651674525923*^9, 3.7826516762290554`*^9}, {3.7827472341594315`*^9, 
   3.7827472344406757`*^9}, {3.7845390971377993`*^9, 
   3.7845390993098416`*^9}, {3.7846213628789454`*^9, 
   3.7846213635508842`*^9}, {3.784971285415371*^9, 3.784971285852929*^9}, {
   3.80003815573755*^9, 3.8000381597687845`*^9}, {3.8049514458306084`*^9, 
   3.804951448440013*^9}, {3.8062446719465714`*^9, 3.8062446751540537`*^9}, {
   3.811791929593967*^9, 3.8117919321569138`*^9}, {3.8117920042649097`*^9, 
   3.811792032147236*^9}, {3.8118212232455654`*^9, 3.8118212243258395`*^9}, {
   3.811855173078432*^9, 3.8118551748205085`*^9}, {3.813666226120046*^9, 
   3.8136662293236427`*^9}, {3.8157445404480095`*^9, 3.815744553217987*^9}, 
   3.8194444635501432`*^9, {3.8200470241049037`*^9, 3.8200470540438976`*^9}, {
   3.8200479202353115`*^9, 3.8200479218146176`*^9}, {3.820063087622788*^9, 
   3.8200630909436483`*^9}, {3.820162369245296*^9, 3.820162370625386*^9}, {
   3.820171705419344*^9, 
   3.8201717076095247`*^9}},ExpressionUUID->"5917cd86-5516-4bb5-8b29-\
ce4be1a5c9f7"],

Cell[CellGroupData[{

Cell["\[Delta]GH", "Section",
 CellChangeTimes->{{3.8201580063786097`*^9, 
  3.820158019009424*^9}},ExpressionUUID->"0e2d6539-eb6e-4db1-9262-\
0c2debe616e3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]P", " ", "=", 
   RowBox[{"\[Lambda]u", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]CP", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GV", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GH", "=", " ", 
   RowBox[{
    RowBox[{"-", "\[Lambda]u"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Polarization", "=", "\"\<EllipticalPolarization\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PhaseName", " ", "=", " ", "\"\<dGH\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IDCalcFieldmap3D", "[", 
   RowBox[{
   "\[Delta]P", ",", " ", "\[Delta]CP", ",", " ", "\[Delta]GV", ",", " ", 
    "\[Delta]GH", ",", " ", "Polarization", ",", " ", "PhaseName"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8200481107642474`*^9, 3.8200481587837424`*^9}, {
   3.820048197117392*^9, 3.820048197937029*^9}, {3.8200509409117136`*^9, 
   3.820050944440159*^9}, {3.820051064048478*^9, 3.8200510642184086`*^9}, {
   3.8200512480184298`*^9, 3.8200512573242693`*^9}, {3.8200521112218113`*^9, 
   3.820052115329935*^9}, {3.8200630689414687`*^9, 3.8200631054369073`*^9}, {
   3.8200633049361115`*^9, 3.820063306815239*^9}, {3.820063371675081*^9, 
   3.8200633761430044`*^9}, {3.82006390421078*^9, 3.820063904720542*^9}, {
   3.8201495538865643`*^9, 3.8201495542966237`*^9}, {3.8201497915822363`*^9, 
   3.820149983546794*^9}, 3.8201500276496797`*^9, {3.8201501945306916`*^9, 
   3.8201501959708023`*^9}, {3.8201508544391437`*^9, 
   3.8201508593694563`*^9}, {3.820152769570441*^9, 3.820152771470558*^9}, {
   3.820152848715656*^9, 3.8201529443319683`*^9}, {3.820152999816786*^9, 
   3.8201530180679955`*^9}, {3.8201536575874186`*^9, 3.8201536681081467`*^9}, 
   3.8201539351575203`*^9, {3.8201568830223465`*^9, 3.8201568873025694`*^9}, {
   3.8201576175133305`*^9, 3.820157623623746*^9}, {3.820158038650758*^9, 
   3.8201580409408894`*^9}, {3.8201581036150494`*^9, 3.820158219334298*^9}, {
   3.820158294020669*^9, 3.820158317492241*^9}, {3.820158522885709*^9, 
   3.820158523105774*^9}, {3.8201623771057973`*^9, 3.8201623793259583`*^9}, {
   3.820171768247072*^9, 3.8201717774821677`*^9}, 3.8202477064813905`*^9, {
   3.820572161958043*^9, 3.8205721732788363`*^9}, 3.820572337951374*^9, 
   3.820573069779042*^9},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[109]:=",ExpressionUUID->"2c3c149e-6544-4629-b690-8405eca4c41f"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-25_DeltaSabia_Model02_EllipticalPolarization_Kh=3.04_Kv=2.97_X=-\
1_1mm_Y=-1_1mm_Z=-800_800mm_dGH.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-25_DeltaSabia_Model02_EllipticalPolarization_Kh=3.04_Kv=2.97_X=-1_\
1mm_Y=-1_1mm_Z=-800_800mm_dGH.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8205817671136813`*^9},
 CellLabel->
  "During evaluation of \
In[109]:=",ExpressionUUID->"94d02fad-f823-4667-aa93-381fa4d87288"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "1684.1524122`10.677926385162118", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 1684.1524122`10.677926385162118, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8205817671136813`*^9},
 CellLabel->
  "During evaluation of \
In[109]:=",ExpressionUUID->"f554934b-1e38-4d44-9721-185ecf9142a8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Elapsed time = \"\>", "\[InvisibleSpace]", 
   "1725.609436`10.688487500411696", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm["Elapsed time = ", 1725.609436`10.688487500411696, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8205817671136813`*^9},
 CellLabel->
  "During evaluation of \
In[109]:=",ExpressionUUID->"64729c22-9168-44ba-8aa3-3752cd000eed"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Delta]GV", "Section",
 CellChangeTimes->{{3.8201580063786097`*^9, 3.820158019009424*^9}, {
  3.8201621504380217`*^9, 
  3.820162151958124*^9}},ExpressionUUID->"5e4b8abd-3ed5-4456-894c-\
11b2aed96dc0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]P", " ", "=", 
   RowBox[{"\[Lambda]u", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]CP", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GV", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", "\[Lambda]u"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GH", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Polarization", "=", "\"\<EllipticalPolarization\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PhaseName", " ", "=", " ", "\"\<dGV\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IDCalcFieldmap3D", "[", 
   RowBox[{
   "\[Delta]P", ",", " ", "\[Delta]CP", ",", " ", "\[Delta]GV", ",", " ", 
    "\[Delta]GH", ",", " ", "Polarization", ",", " ", "PhaseName"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8200481107642474`*^9, 3.8200481587837424`*^9}, {
   3.820048197117392*^9, 3.820048197937029*^9}, {3.8200509409117136`*^9, 
   3.820050944440159*^9}, {3.820051064048478*^9, 3.8200510642184086`*^9}, {
   3.8200512480184298`*^9, 3.8200512573242693`*^9}, {3.8200521112218113`*^9, 
   3.820052115329935*^9}, {3.8200630689414687`*^9, 3.8200631054369073`*^9}, {
   3.8200633049361115`*^9, 3.820063306815239*^9}, {3.820063371675081*^9, 
   3.8200633761430044`*^9}, {3.82006390421078*^9, 3.820063904720542*^9}, {
   3.8201495538865643`*^9, 3.8201495542966237`*^9}, {3.8201497915822363`*^9, 
   3.820149983546794*^9}, 3.8201500276496797`*^9, {3.8201501945306916`*^9, 
   3.8201501959708023`*^9}, {3.8201508544391437`*^9, 
   3.8201508593694563`*^9}, {3.820152769570441*^9, 3.820152771470558*^9}, {
   3.820152848715656*^9, 3.8201529443319683`*^9}, {3.820152999816786*^9, 
   3.8201530180679955`*^9}, {3.8201536575874186`*^9, 3.8201536681081467`*^9}, 
   3.8201539351575203`*^9, {3.8201568830223465`*^9, 3.8201568873025694`*^9}, {
   3.8201576175133305`*^9, 3.820157623623746*^9}, {3.820158038650758*^9, 
   3.8201580409408894`*^9}, {3.8201581036150494`*^9, 3.820158219334298*^9}, {
   3.820158294020669*^9, 3.820158317492241*^9}, {3.820158522885709*^9, 
   3.820158523105774*^9}, {3.8201621548682823`*^9, 3.820162159680563*^9}, {
   3.8201623862764215`*^9, 3.8201623866464415`*^9}, {3.820171784694354*^9, 
   3.8201717876365805`*^9}, 3.820247713987523*^9, {3.820572177289085*^9, 
   3.8205721895399055`*^9}, 3.820572341971628*^9, 3.8205730732792253`*^9},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[116]:=",ExpressionUUID->"3ce3934f-8311-42bf-a0d7-9854e8c54457"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-25_DeltaSabia_Model02_EllipticalPolarization_Kh=2.97_Kv=3.04_X=-\
1_1mm_Y=-1_1mm_Z=-800_800mm_dGV.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-25_DeltaSabia_Model02_EllipticalPolarization_Kh=2.97_Kv=3.04_X=-1_\
1mm_Y=-1_1mm_Z=-800_800mm_dGV.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8205834927400765`*^9},
 CellLabel->
  "During evaluation of \
In[116]:=",ExpressionUUID->"ccaeb1e9-cf87-4457-8af7-d84a1846108d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "1685.7529051`10.678338910275798", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 1685.7529051`10.678338910275798, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820583492750072*^9},
 CellLabel->
  "During evaluation of \
In[116]:=",ExpressionUUID->"cfe2a0d6-258a-4ba5-b494-d1ebd12724fd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Elapsed time = \"\>", "\[InvisibleSpace]", 
   "1725.6063869`10.688486733025725", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm["Elapsed time = ", 1725.6063869`10.688486733025725, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820583492750072*^9},
 CellLabel->
  "During evaluation of \
In[116]:=",ExpressionUUID->"38fd47e1-3b75-4669-a7cc-59c2ac699706"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Elliptical Polarization 3\[Lambda]u/8", "Chapter",
 CellChangeTimes->{{3.681300194179221*^9, 3.6813002033832407`*^9}, {
   3.681305983976405*^9, 3.6813059853359213`*^9}, {3.6813176225703306`*^9, 
   3.6813176235079107`*^9}, {3.6813177175941257`*^9, 3.68131771915676*^9}, {
   3.708272177122472*^9, 3.708272189394394*^9}, {3.708272239370994*^9, 
   3.708272253185425*^9}, {3.7247626663439655`*^9, 3.724762668594143*^9}, 
   3.724763762181196*^9, {3.725974849294973*^9, 3.725974857279992*^9}, {
   3.7316800228814087`*^9, 3.7316800249126425`*^9}, {3.731761928333893*^9, 
   3.731761928740137*^9}, {3.7377345647344294`*^9, 3.7377345664687967`*^9}, {
   3.737994165253688*^9, 3.7379941653786864`*^9}, {3.7489625392900763`*^9, 
   3.7489625531505637`*^9}, {3.749318816981333*^9, 3.749318817559469*^9}, {
   3.7656382216793394`*^9, 3.7656382261328287`*^9}, {3.7662401432029853`*^9, 
   3.766240154985159*^9}, {3.7663282678653297`*^9, 3.766328270484855*^9}, {
   3.766331146283388*^9, 3.7663311568355923`*^9}, {3.7663982782306576`*^9, 
   3.7663982795028768`*^9}, {3.7664037488989267`*^9, 
   3.7664037535714073`*^9}, {3.76675425955847*^9, 3.766754260902328*^9}, {
   3.767446029232342*^9, 3.7674460297011285`*^9}, {3.7675176217294626`*^9, 
   3.767517621841589*^9}, {3.7685471006341314`*^9, 3.7685471031625986`*^9}, {
   3.782651674525923*^9, 3.7826516762290554`*^9}, {3.7827472341594315`*^9, 
   3.7827472344406757`*^9}, {3.7845390971377993`*^9, 
   3.7845390993098416`*^9}, {3.7846213628789454`*^9, 
   3.7846213635508842`*^9}, {3.784971285415371*^9, 3.784971285852929*^9}, {
   3.80003815573755*^9, 3.8000381597687845`*^9}, {3.8049514458306084`*^9, 
   3.804951448440013*^9}, {3.8062446719465714`*^9, 3.8062446751540537`*^9}, {
   3.811791929593967*^9, 3.8117919321569138`*^9}, {3.8117920042649097`*^9, 
   3.811792032147236*^9}, {3.8118212232455654`*^9, 3.8118212243258395`*^9}, {
   3.811855173078432*^9, 3.8118551748205085`*^9}, {3.813666226120046*^9, 
   3.8136662293236427`*^9}, {3.8157445404480095`*^9, 3.815744553217987*^9}, 
   3.8194444635501432`*^9, {3.8200470241049037`*^9, 3.8200470540438976`*^9}, {
   3.8200479202353115`*^9, 3.8200479218146176`*^9}, {3.820063087622788*^9, 
   3.8200630909436483`*^9}, {3.820162369245296*^9, 3.820162370625386*^9}, {
   3.820171705419344*^9, 3.8201717076095247`*^9}, {3.8202009861404676`*^9, 
   3.8202009909207892`*^9}, {3.820233286369794*^9, 
   3.820233296424614*^9}},ExpressionUUID->"1f878c74-c86b-4f64-a3cd-\
19b138092c7c"],

Cell[CellGroupData[{

Cell["\[Delta]GH", "Section",
 CellChangeTimes->{{3.8201580063786097`*^9, 
  3.820158019009424*^9}},ExpressionUUID->"a4d8a82d-2df6-44be-9cb5-\
af8e7e1a5f9b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]P", " ", "=", 
   RowBox[{"3", 
    RowBox[{"\[Lambda]u", "/", "8"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]CP", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GV", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GH", "=", " ", 
   RowBox[{
    RowBox[{"-", "3"}], 
    RowBox[{"\[Lambda]u", "/", "8"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Polarization", "=", "\"\<EllipticalPolarization\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PhaseName", " ", "=", " ", "\"\<dGH\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IDCalcFieldmap3D", "[", 
   RowBox[{
   "\[Delta]P", ",", " ", "\[Delta]CP", ",", " ", "\[Delta]GV", ",", " ", 
    "\[Delta]GH", ",", " ", "Polarization", ",", " ", "PhaseName"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8200481107642474`*^9, 3.8200481587837424`*^9}, {
   3.820048197117392*^9, 3.820048197937029*^9}, {3.8200509409117136`*^9, 
   3.820050944440159*^9}, {3.820051064048478*^9, 3.8200510642184086`*^9}, {
   3.8200512480184298`*^9, 3.8200512573242693`*^9}, {3.8200521112218113`*^9, 
   3.820052115329935*^9}, {3.8200630689414687`*^9, 3.8200631054369073`*^9}, {
   3.8200633049361115`*^9, 3.820063306815239*^9}, {3.820063371675081*^9, 
   3.8200633761430044`*^9}, {3.82006390421078*^9, 3.820063904720542*^9}, {
   3.8201495538865643`*^9, 3.8201495542966237`*^9}, {3.8201497915822363`*^9, 
   3.820149983546794*^9}, 3.8201500276496797`*^9, {3.8201501945306916`*^9, 
   3.8201501959708023`*^9}, {3.8201508544391437`*^9, 
   3.8201508593694563`*^9}, {3.820152769570441*^9, 3.820152771470558*^9}, {
   3.820152848715656*^9, 3.8201529443319683`*^9}, {3.820152999816786*^9, 
   3.8201530180679955`*^9}, {3.8201536575874186`*^9, 3.8201536681081467`*^9}, 
   3.8201539351575203`*^9, {3.8201568830223465`*^9, 3.8201568873025694`*^9}, {
   3.8201576175133305`*^9, 3.820157623623746*^9}, {3.820158038650758*^9, 
   3.8201580409408894`*^9}, {3.8201581036150494`*^9, 3.820158219334298*^9}, {
   3.820158294020669*^9, 3.820158317492241*^9}, {3.820158522885709*^9, 
   3.820158523105774*^9}, {3.8201623771057973`*^9, 3.8201623793259583`*^9}, {
   3.820171768247072*^9, 3.8201717774821677`*^9}, {3.820200993600941*^9, 
   3.8202009943409896`*^9}, 3.820233299882825*^9, 3.820247732527953*^9, {
   3.820572240973251*^9, 3.820572250043892*^9}, {3.820572345541853*^9, 
   3.8205723471520023`*^9}, 3.8205730774995513`*^9},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[123]:=",ExpressionUUID->"8dea78c3-e942-4fa2-a6e9-ef1476b6bb5a"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-25_DeltaSabia_Model02_EllipticalPolarization_Kh=0.91_Kv=2.17_X=-\
1_1mm_Y=-1_1mm_Z=-800_800mm_dGH.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-25_DeltaSabia_Model02_EllipticalPolarization_Kh=0.91_Kv=2.17_X=-1_\
1mm_Y=-1_1mm_Z=-800_800mm_dGH.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820585221935013*^9},
 CellLabel->
  "During evaluation of \
In[123]:=",ExpressionUUID->"be103e0f-5acf-4592-85c5-c83b605664e7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "1688.2526829`10.678982442051224", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 1688.2526829`10.678982442051224, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8205852219450083`*^9},
 CellLabel->
  "During evaluation of \
In[123]:=",ExpressionUUID->"699d6cb8-78d9-4385-8aaa-bc3c194985a3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Elapsed time = \"\>", "\[InvisibleSpace]", 
   "1729.1449582`10.689376396201633", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm["Elapsed time = ", 1729.1449582`10.689376396201633, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8205852219450083`*^9},
 CellLabel->
  "During evaluation of \
In[123]:=",ExpressionUUID->"b9a6b0f8-655d-4deb-8743-0b52ffb9a065"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Delta]GV", "Section",
 CellChangeTimes->{{3.8201580063786097`*^9, 3.820158019009424*^9}, {
  3.8201621504380217`*^9, 
  3.820162151958124*^9}},ExpressionUUID->"71874014-ed78-4af7-8eb7-\
6b9584f50b63"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]P", " ", "=", 
   RowBox[{"3", 
    RowBox[{"\[Lambda]u", "/", "8"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]CP", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GV", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", "3"}], 
    RowBox[{"\[Lambda]u", "/", "8"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GH", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Polarization", "=", "\"\<EllipticalPolarization\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PhaseName", " ", "=", " ", "\"\<dGV\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IDCalcFieldmap3D", "[", 
   RowBox[{
   "\[Delta]P", ",", " ", "\[Delta]CP", ",", " ", "\[Delta]GV", ",", " ", 
    "\[Delta]GH", ",", " ", "Polarization", ",", " ", "PhaseName"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8200481107642474`*^9, 3.8200481587837424`*^9}, {
   3.820048197117392*^9, 3.820048197937029*^9}, {3.8200509409117136`*^9, 
   3.820050944440159*^9}, {3.820051064048478*^9, 3.8200510642184086`*^9}, {
   3.8200512480184298`*^9, 3.8200512573242693`*^9}, {3.8200521112218113`*^9, 
   3.820052115329935*^9}, {3.8200630689414687`*^9, 3.8200631054369073`*^9}, {
   3.8200633049361115`*^9, 3.820063306815239*^9}, {3.820063371675081*^9, 
   3.8200633761430044`*^9}, {3.82006390421078*^9, 3.820063904720542*^9}, {
   3.8201495538865643`*^9, 3.8201495542966237`*^9}, {3.8201497915822363`*^9, 
   3.820149983546794*^9}, 3.8201500276496797`*^9, {3.8201501945306916`*^9, 
   3.8201501959708023`*^9}, {3.8201508544391437`*^9, 
   3.8201508593694563`*^9}, {3.820152769570441*^9, 3.820152771470558*^9}, {
   3.820152848715656*^9, 3.8201529443319683`*^9}, {3.820152999816786*^9, 
   3.8201530180679955`*^9}, {3.8201536575874186`*^9, 3.8201536681081467`*^9}, 
   3.8201539351575203`*^9, {3.8201568830223465`*^9, 3.8201568873025694`*^9}, {
   3.8201576175133305`*^9, 3.820157623623746*^9}, {3.820158038650758*^9, 
   3.8201580409408894`*^9}, {3.8201581036150494`*^9, 3.820158219334298*^9}, {
   3.820158294020669*^9, 3.820158317492241*^9}, {3.820158522885709*^9, 
   3.820158523105774*^9}, {3.8201621548682823`*^9, 3.820162159680563*^9}, {
   3.8201623862764215`*^9, 3.8201623866464415`*^9}, {3.820171784694354*^9, 
   3.8201717876365805`*^9}, {3.8202010023315287`*^9, 3.8202010027215433`*^9}, 
   3.8202333041906033`*^9, 3.820247738214993*^9, {3.8205722538641*^9, 
   3.82057226351478*^9}, 3.820572358242703*^9, 3.8205730809397874`*^9},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[130]:=",ExpressionUUID->"1b23cff8-b2cb-4916-89b2-000eb8cd33a1"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-25_DeltaSabia_Model02_EllipticalPolarization_Kh=0.82_Kv=2.13_X=-\
1_1mm_Y=-1_1mm_Z=-800_800mm_dGV.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-25_DeltaSabia_Model02_EllipticalPolarization_Kh=0.82_Kv=2.13_X=-1_\
1mm_Y=-1_1mm_Z=-800_800mm_dGV.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8205869505821877`*^9},
 CellLabel->
  "During evaluation of \
In[130]:=",ExpressionUUID->"a6cbee31-e458-4806-a61e-c684020df5e7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "1685.2965121`10.678221315462935", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 1685.2965121`10.678221315462935, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820586950592182*^9},
 CellLabel->
  "During evaluation of \
In[130]:=",ExpressionUUID->"179155df-8967-4c97-aa5b-e9e3427b74b3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Elapsed time = \"\>", "\[InvisibleSpace]", 
   "1728.5971968`10.68923879788184", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm["Elapsed time = ", 1728.5971968`10.68923879788184, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820586950592182*^9},
 CellLabel->
  "During evaluation of \
In[130]:=",ExpressionUUID->"0176b445-fefc-49ac-b8b2-4b109743aaaa"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1234, 663},
WindowMargins->{{117, Automatic}, {5, Automatic}},
Magnification:>0.9 Inherited,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 2897, 40, 87, "Title",ExpressionUUID->"6afd2076-4493-4f08-b468-fa4711877d85"],
Cell[CellGroupData[{
Cell[3502, 66, 156, 3, 62, "Chapter",ExpressionUUID->"d737e070-6f97-4607-ac28-30ab012a12aa"],
Cell[CellGroupData[{
Cell[3683, 73, 206, 4, 60, "Section",ExpressionUUID->"0e22e4d4-c6dd-44c6-aced-c34f7308122d"],
Cell[CellGroupData[{
Cell[3914, 81, 339, 7, 59, "Input",ExpressionUUID->"3eccabbd-bb9c-4e0e-b532-6f6408da7c58"],
Cell[CellGroupData[{
Cell[4278, 92, 404, 9, 21, "Print",ExpressionUUID->"679f2714-c812-4c73-94fc-c1e7d62bde46"],
Cell[4685, 103, 236, 4, 21, "Print",ExpressionUUID->"97c5c2ac-84d7-47d8-ad61-a2254c3025fd"],
Cell[4924, 109, 250, 5, 21, "Print",ExpressionUUID->"321f5d75-0acb-4ab8-a4c2-57203c95bbca"],
Cell[5177, 116, 243, 4, 21, "Print",ExpressionUUID->"3dcd0ec8-62a1-4db7-ae90-26ad438fd92f"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[5481, 127, 154, 3, 60, "Section",ExpressionUUID->"3b9f4df9-b498-4bb2-a855-8df473489a1f"],
Cell[CellGroupData[{
Cell[5660, 134, 254, 4, 48, "Subsection",ExpressionUUID->"edd14911-287c-45ca-b6c8-e5cb4d8bede9"],
Cell[5917, 140, 37260, 732, 2255, "Input",ExpressionUUID->"d4295d6b-5e5f-4955-8ce4-9cdda100a50e"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[43226, 878, 209, 4, 48, "Section",ExpressionUUID->"f4366deb-1b60-41eb-9dc8-6ebd3361a7fc"],
Cell[CellGroupData[{
Cell[43460, 886, 185, 4, 48, "Subsection",ExpressionUUID->"2ad9b229-e14f-4a3a-8e5f-2858a5e5451b"],
Cell[43648, 892, 3939, 92, 560, "Input",ExpressionUUID->"068e143d-bd0f-46f2-9082-ce6f19ee2c7b"]
}, Closed]],
Cell[CellGroupData[{
Cell[47624, 989, 130, 3, 34, "Subsection",ExpressionUUID->"80d519b9-e0f1-46b9-b652-4e226e79bc05"],
Cell[47757, 994, 4998, 108, 680, "Input",ExpressionUUID->"d01a001e-9065-45b4-8e73-d9728b90eeea"]
}, Closed]],
Cell[CellGroupData[{
Cell[52792, 1107, 204, 4, 34, "Subsection",ExpressionUUID->"53ad71eb-17b9-4d6d-ac98-0730df07584e"],
Cell[52999, 1113, 4695, 104, 419, "Input",ExpressionUUID->"f619c123-566c-42f1-a68a-7bbe2814a613"]
}, Closed]],
Cell[CellGroupData[{
Cell[57731, 1222, 138, 3, 34, "Subsection",ExpressionUUID->"75a7f740-ea21-4afe-8108-05b029f59846"],
Cell[57872, 1227, 14397, 321, 707, "Input",ExpressionUUID->"bd41ff99-499b-46be-91ce-555d82436805"]
}, Closed]],
Cell[CellGroupData[{
Cell[72306, 1553, 142, 3, 34, "Subsection",ExpressionUUID->"bb19f30a-f850-414b-b3be-1dd929f5855c"],
Cell[72451, 1558, 6904, 156, 824, "Input",ExpressionUUID->"24664741-e07d-4598-8b68-6b4113008b82"]
}, Closed]],
Cell[CellGroupData[{
Cell[79392, 1719, 300, 5, 34, "Subsection",ExpressionUUID->"cdeaf6fe-40fd-4cda-8432-a30fc6389d80"],
Cell[79695, 1726, 6016, 135, 776, "Input",ExpressionUUID->"a88e2988-4885-46a3-ab3f-cbf916edb31d"]
}, Closed]],
Cell[CellGroupData[{
Cell[85748, 1866, 190, 4, 34, "Subsection",ExpressionUUID->"c7130cda-35d4-4dfa-aec2-ed9d1e576d19"],
Cell[85941, 1872, 4495, 104, 383, "Input",ExpressionUUID->"aa4fa799-86cd-462b-b44a-5bf06a051ea2"]
}, Closed]],
Cell[CellGroupData[{
Cell[90473, 1981, 210, 4, 34, "Subsection",ExpressionUUID->"316b54f4-260c-4ab7-bc23-0da6dd39fb46"],
Cell[90686, 1987, 8895, 190, 851, "Input",ExpressionUUID->"40008148-2423-4d1a-aa09-6e0b7f4651d7"]
}, Closed]],
Cell[CellGroupData[{
Cell[99618, 2182, 266, 4, 34, "Subsection",ExpressionUUID->"b5d71522-78aa-4e39-b901-2b1c796bfe78"],
Cell[99887, 2188, 22812, 482, 2507, "Input",ExpressionUUID->"1691ba71-b213-4cf8-94e8-cd5d10f95e49"]
}, Closed]],
Cell[CellGroupData[{
Cell[122736, 2675, 190, 2, 34, "Subsection",ExpressionUUID->"dc98927d-e916-471e-b538-f605e04d23e3"],
Cell[122929, 2679, 12242, 294, 1103, "Input",ExpressionUUID->"494c7822-7765-4f5f-bf96-15e4412f31ad"]
}, Closed]],
Cell[CellGroupData[{
Cell[135208, 2978, 312, 5, 34, "Subsection",ExpressionUUID->"ba0c27f7-7afe-4d7f-bf71-31b954642dee"],
Cell[135523, 2985, 17814, 368, 1949, "Input",ExpressionUUID->"ee2a2080-707a-4eb3-87d9-c28ada49e95e"]
}, Closed]],
Cell[CellGroupData[{
Cell[153374, 3358, 248, 4, 34, "Subsection",ExpressionUUID->"157ca7c9-6722-4d5a-ad5b-229aadb8b0bc"],
Cell[153625, 3364, 7832, 177, 680, "Input",ExpressionUUID->"f697a71f-6997-415d-96c1-093eac60228d"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[161506, 3547, 208, 4, 48, "Section",ExpressionUUID->"5ae070d1-0cf0-4ac4-b054-32f42780450f"],
Cell[CellGroupData[{
Cell[161739, 3555, 163, 3, 48, "Subsection",ExpressionUUID->"c13b4fd0-95fa-44e0-b443-c53463a08608"],
Cell[161905, 3560, 96698, 2009, 8011, "Input",ExpressionUUID->"88230ced-7ab0-4c04-8a67-eb24bb06a7fd"]
}, Closed]],
Cell[CellGroupData[{
Cell[258640, 5574, 169, 3, 34, "Subsection",ExpressionUUID->"ed6540fc-c052-4b41-a1d1-11fc8d3448cf"],
Cell[258812, 5579, 1926, 46, 113, "Input",ExpressionUUID->"dbe544c3-e306-475e-8f6f-f45de39e73df"]
}, Closed]],
Cell[CellGroupData[{
Cell[260775, 5630, 198, 3, 34, "Subsection",ExpressionUUID->"07ebf3db-cb91-4b84-a9a7-c807351444a8"],
Cell[260976, 5635, 2995, 85, 280, "Input",ExpressionUUID->"55cadbff-321c-415c-8140-4da3fa8ee30a"]
}, Closed]],
Cell[CellGroupData[{
Cell[264008, 5725, 139, 3, 34, "Subsection",ExpressionUUID->"5bb9eb47-9ccd-4f6a-96cc-a524dcee03b5"],
Cell[264150, 5730, 1192, 29, 168, "Input",ExpressionUUID->"a1dde243-caf9-45aa-b999-a81e2e28e907"]
}, Closed]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[265403, 5766, 211, 4, 62, "Chapter",ExpressionUUID->"62a97ffb-394e-4e84-afed-3b5318232eab"],
Cell[265617, 5772, 1495, 23, 40, "Input",ExpressionUUID->"4c139ebb-aba3-4042-8355-2160f9f0f573"]
}, Open  ]],
Cell[CellGroupData[{
Cell[267149, 5800, 2103, 29, 62, "Chapter",ExpressionUUID->"14114740-1747-4179-b27c-fc3a885d635f"],
Cell[CellGroupData[{
Cell[269277, 5833, 255, 4, 60, "Section",ExpressionUUID->"203cdc6e-83ea-4360-b14c-6ae2bef4e227"],
Cell[269535, 5839, 14685, 328, 1283, "Input",ExpressionUUID->"7e941638-cf76-41c4-b8fa-d0bc095ce284"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[284269, 6173, 2301, 32, 62, "Chapter",ExpressionUUID->"0b4dbfda-6ff1-4250-b4d3-782d1be812a7"],
Cell[286573, 6207, 4313, 84, 329, "Input",ExpressionUUID->"dc5dfff3-cc0b-4f6d-b8c7-2c40314888c3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[290923, 6296, 2262, 31, 62, "Chapter",ExpressionUUID->"1093adc8-81a2-4d0f-9b14-0bb8a553561a"],
Cell[CellGroupData[{
Cell[293210, 6331, 157, 3, 60, "Section",ExpressionUUID->"053c45df-8ca5-4967-baf7-b8ccd3a87258"],
Cell[CellGroupData[{
Cell[293392, 6338, 2418, 43, 149, "Input",ExpressionUUID->"f4b38c68-7e12-42de-8041-808a089820a4"],
Cell[CellGroupData[{
Cell[295835, 6385, 560, 14, 21, "Print",ExpressionUUID->"54328c87-db73-476b-9789-89a87fbed31d"],
Cell[296398, 6401, 447, 10, 21, "Print",ExpressionUUID->"7319b119-23ee-45be-9911-1dc89bacc846"],
Cell[296848, 6413, 420, 9, 21, "Print",ExpressionUUID->"ed5e8b9e-db35-4e6a-9505-c348e76e8001"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[297329, 6429, 208, 4, 60, "Section",ExpressionUUID->"293453a5-abcf-4424-a928-43ea6fecda5f"],
Cell[CellGroupData[{
Cell[297562, 6437, 2440, 43, 149, "Input",ExpressionUUID->"4a778b85-2da4-4f4c-95b0-759decc84ff8"],
Cell[CellGroupData[{
Cell[300027, 6484, 562, 14, 21, "Print",ExpressionUUID->"c2c681ea-3f05-4f8b-a8ea-028f1ba527e0"],
Cell[300592, 6500, 447, 10, 21, "Print",ExpressionUUID->"86dc2eb0-bda9-4b73-ac19-45ec8d7fc4c6"],
Cell[301042, 6512, 420, 9, 21, "Print",ExpressionUUID->"874c522b-a9eb-4df2-9a1b-184af23d3610"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[301535, 6529, 2310, 32, 62, "Chapter",ExpressionUUID->"1b06b555-66f5-4d5e-bd16-da67c7332007"],
Cell[CellGroupData[{
Cell[303870, 6565, 157, 3, 60, "Section",ExpressionUUID->"1e5882e0-f91f-42df-9307-d3db53d41218"],
Cell[CellGroupData[{
Cell[304052, 6572, 2476, 46, 149, "Input",ExpressionUUID->"6a42638e-6281-4e3d-a895-b99fabcf5636"],
Cell[CellGroupData[{
Cell[306553, 6622, 559, 14, 21, "Print",ExpressionUUID->"71308055-9a47-454c-9ddc-0f7b2d312656"],
Cell[307115, 6638, 445, 10, 21, "Print",ExpressionUUID->"31933027-80bc-4ffc-9df4-a29d99fafe57"],
Cell[307563, 6650, 418, 9, 21, "Print",ExpressionUUID->"0f2f7a99-2362-4d7b-8404-47769ee1db23"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[308042, 6666, 208, 4, 60, "Section",ExpressionUUID->"2d0dd69f-9c7b-4d0f-afc6-dd6cd943a1ea"],
Cell[CellGroupData[{
Cell[308275, 6674, 2526, 48, 149, "Input",ExpressionUUID->"71e8d84d-ccda-4306-9525-06142fb93633"],
Cell[CellGroupData[{
Cell[310826, 6726, 559, 14, 21, "Print",ExpressionUUID->"0ef54cc4-d259-45e5-9db5-2a8f9cd0cec6"],
Cell[311388, 6742, 444, 10, 21, "Print",ExpressionUUID->"f41b531b-0fd5-4775-be0b-f7377e7c2d6c"],
Cell[311835, 6754, 419, 9, 21, "Print",ExpressionUUID->"ac9f5853-9243-4869-bf2c-61a8b4c86779"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[312327, 6771, 2362, 33, 62, "Chapter",ExpressionUUID->"5917cd86-5516-4bb5-8b29-ce4be1a5c9f7"],
Cell[CellGroupData[{
Cell[314714, 6808, 157, 3, 60, "Section",ExpressionUUID->"0e2d6539-eb6e-4db1-9262-0c2debe616e3"],
Cell[CellGroupData[{
Cell[314896, 6815, 2512, 47, 149, "Input",ExpressionUUID->"2c3c149e-6544-4629-b690-8405eca4c41f"],
Cell[CellGroupData[{
Cell[317433, 6866, 573, 14, 21, "Print",ExpressionUUID->"94d02fad-f823-4667-aa93-381fa4d87288"],
Cell[318009, 6882, 448, 10, 21, "Print",ExpressionUUID->"f554934b-1e38-4d44-9721-185ecf9142a8"],
Cell[318460, 6894, 419, 9, 21, "Print",ExpressionUUID->"64729c22-9168-44ba-8aa3-3752cd000eed"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[318940, 6910, 208, 4, 60, "Section",ExpressionUUID->"5e4b8abd-3ed5-4456-894c-11b2aed96dc0"],
Cell[CellGroupData[{
Cell[319173, 6918, 2560, 47, 149, "Input",ExpressionUUID->"3ce3934f-8311-42bf-a0d7-9854e8c54457"],
Cell[CellGroupData[{
Cell[321758, 6969, 573, 14, 21, "Print",ExpressionUUID->"ccaeb1e9-cf87-4457-8af7-d84a1846108d"],
Cell[322334, 6985, 446, 10, 21, "Print",ExpressionUUID->"cfe2a0d6-258a-4ba5-b494-d1ebd12724fd"],
Cell[322783, 6997, 419, 9, 21, "Print",ExpressionUUID->"38fd47e1-3b75-4669-a7cc-59c2ac699706"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[323275, 7014, 2478, 34, 62, "Chapter",ExpressionUUID->"1f878c74-c86b-4f64-a3cd-19b138092c7c"],
Cell[CellGroupData[{
Cell[325778, 7052, 157, 3, 60, "Section",ExpressionUUID->"a4d8a82d-2df6-44be-9cb5-af8e7e1a5f9b"],
Cell[CellGroupData[{
Cell[325960, 7059, 2650, 50, 149, "Input",ExpressionUUID->"8dea78c3-e942-4fa2-a6e9-ef1476b6bb5a"],
Cell[CellGroupData[{
Cell[328635, 7113, 571, 14, 21, "Print",ExpressionUUID->"be103e0f-5acf-4592-85c5-c83b605664e7"],
Cell[329209, 7129, 448, 10, 21, "Print",ExpressionUUID->"699d6cb8-78d9-4385-8aaa-bc3c194985a3"],
Cell[329660, 7141, 421, 9, 21, "Print",ExpressionUUID->"b9a6b0f8-655d-4deb-8743-0b52ffb9a065"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[330142, 7157, 208, 4, 60, "Section",ExpressionUUID->"71874014-ed78-4af7-8eb7-6b9584f50b63"],
Cell[CellGroupData[{
Cell[330375, 7165, 2673, 50, 149, "Input",ExpressionUUID->"1b23cff8-b2cb-4916-89b2-000eb8cd33a1"],
Cell[CellGroupData[{
Cell[333073, 7219, 573, 14, 21, "Print",ExpressionUUID->"a6cbee31-e458-4806-a61e-c684020df5e7"],
Cell[333649, 7235, 446, 10, 21, "Print",ExpressionUUID->"179155df-8967-4c97-aa5b-e9e3427b74b3"],
Cell[334098, 7247, 417, 9, 21, "Print",ExpressionUUID->"0176b445-fefc-49ac-b8b2-4b109743aaaa"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

