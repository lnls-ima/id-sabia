(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    485378,      10709]
NotebookOptionsPosition[    460522,      10322]
NotebookOutlinePosition[    460893,      10338]
CellTagsIndexPosition[    460850,      10335]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Delta Sabia (last update: 21/01/21)", "Title",
 CellChangeTimes->{{3.681300194179221*^9, 3.6813002033832407`*^9}, {
   3.681305983976405*^9, 3.6813059853359213`*^9}, {3.6813176225703306`*^9, 
   3.6813176235079107`*^9}, {3.6813177175941257`*^9, 3.68131771915676*^9}, {
   3.708272177122472*^9, 3.708272189394394*^9}, {3.708272239370994*^9, 
   3.708272253185425*^9}, {3.7247626663439655`*^9, 3.724762668594143*^9}, 
   3.724763762181196*^9, {3.725974849294973*^9, 3.725974857279992*^9}, {
   3.7316800228814087`*^9, 3.7316800249126425`*^9}, {3.731761928333893*^9, 
   3.731761928740137*^9}, {3.7377345647344294`*^9, 3.7377345664687967`*^9}, {
   3.737994165253688*^9, 3.7379941653786864`*^9}, {3.7489625392900763`*^9, 
   3.7489625531505637`*^9}, {3.749318816981333*^9, 3.749318817559469*^9}, {
   3.7656382216793394`*^9, 3.7656382261328287`*^9}, {3.7662401432029853`*^9, 
   3.766240154985159*^9}, {3.7663282678653297`*^9, 3.766328270484855*^9}, {
   3.766331146283388*^9, 3.7663311568355923`*^9}, {3.7663982782306576`*^9, 
   3.7663982795028768`*^9}, {3.7664037488989267`*^9, 
   3.7664037535714073`*^9}, {3.76675425955847*^9, 3.766754260902328*^9}, {
   3.767446029232342*^9, 3.7674460297011285`*^9}, {3.7675176217294626`*^9, 
   3.767517621841589*^9}, {3.7685471006341314`*^9, 3.7685471031625986`*^9}, {
   3.782651674525923*^9, 3.7826516762290554`*^9}, {3.7827472341594315`*^9, 
   3.7827472344406757`*^9}, {3.7845390971377993`*^9, 
   3.7845390993098416`*^9}, {3.7846213628789454`*^9, 
   3.7846213635508842`*^9}, {3.784971285415371*^9, 3.784971285852929*^9}, {
   3.80003815573755*^9, 3.8000381597687845`*^9}, {3.8049514458306084`*^9, 
   3.804951448440013*^9}, {3.8062446719465714`*^9, 3.8062446751540537`*^9}, {
   3.811791929593967*^9, 3.8117919321569138`*^9}, {3.8117920042649097`*^9, 
   3.811792032147236*^9}, {3.8118211262516327`*^9, 3.8118211320157013`*^9}, {
   3.811821179647152*^9, 3.8118211867633*^9}, {3.811860188752576*^9, 
   3.811860258482793*^9}, {3.811993829198284*^9, 3.811993830379608*^9}, {
   3.812527211310811*^9, 3.812527222117728*^9}, {3.812606129475505*^9, 
   3.8126061346758695`*^9}, {3.8136661285689297`*^9, 
   3.8136661439784617`*^9}, {3.813666203027869*^9, 3.81366621078681*^9}, {
   3.8140077054911613`*^9, 3.8140077058612165`*^9}, {3.8157444601701145`*^9, 
   3.815744485115374*^9}, {3.8159135249298954`*^9, 3.815913527874877*^9}, {
   3.8160829516889467`*^9, 3.816082959653524*^9}, {3.816084844383486*^9, 
   3.8160848526688385`*^9}, {3.819099771529953*^9, 3.8190997841007185`*^9}, {
   3.8199874177798595`*^9, 3.81998742196014*^9}, {3.8200640099715233`*^9, 
   3.8200640101014977`*^9}, {3.8201328050621567`*^9, 
   3.8201328054521856`*^9}, {3.8202199532315683`*^9, 
   3.820219953313529*^9}},ExpressionUUID->"6afd2076-4493-4f08-b468-\
fa4711877d85"],

Cell[CellGroupData[{

Cell["Functions", "Chapter",
 CellChangeTimes->{{3.8118211945703535`*^9, 
  3.811821216548972*^9}},ExpressionUUID->"d737e070-6f97-4607-ac28-\
30ab012a12aa"],

Cell[CellGroupData[{

Cell["Load Radia", "Section",
 CellChangeTimes->{{3.766397988602113*^9, 3.766398000439457*^9}, {
  3.784905891255539*^9, 
  3.7849058937557244`*^9}},ExpressionUUID->"0e22e4d4-c6dd-44c6-aced-\
c34f7308122d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"<<", "Radia`"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RadPlot3DOptions", "[", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6818148953014574`*^9, 3.6818148962234063`*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[1]:=",ExpressionUUID->"3eccabbd-bb9c-4e0e-b532-6f6408da7c58"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Radia Version: \"\>", "\[InvisibleSpace]", "4.31`", 
   "\[InvisibleSpace]", "\<\" is loaded\"\>"}],
  SequenceForm["Radia Version: ", 4.31, " is loaded"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820240959847167*^9, 3.820247821809454*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"3d364ba5-65da-47ce-a437-88bb72ee250a"],

Cell[BoxData["\<\"Radia is copyright ESRF, France.\"\>"], "Print",
 CellChangeTimes->{3.820240959847167*^9, 3.8202478218194404`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"580e8cc3-6795-4535-828b-c73a64713c7c"],

Cell[BoxData["\<\"Portions copyright Synchrotron SOLEIL, France.\"\>"], \
"Print",
 CellChangeTimes->{3.820240959847167*^9, 3.8202478218294277`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"1465ff4b-d002-403e-b748-6ac96e8fd977"],

Cell[BoxData["\<\"Portions copyright Wolfram Research, Inc.\"\>"], "Print",
 CellChangeTimes->{3.820240959847167*^9, 3.8202478218294277`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"e77cf66a-c0df-45b5-aefe-a3826f3559b9"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Delta", "Section",
 CellChangeTimes->{{3.7663980194296393`*^9, 
  3.7663980316884046`*^9}},ExpressionUUID->"3b9f4df9-b498-4bb2-a855-\
8df473489a1f"],

Cell[CellGroupData[{

Cell["IDDelta", "Subsection",
 CellChangeTimes->{{3.766754518453103*^9, 3.766754525359883*^9}, {
  3.767534951344644*^9, 3.767534995136586*^9}, {3.7826516660103407`*^9, 
  3.7826516661978397`*^9}},ExpressionUUID->"edd14911-287c-45ca-b6c8-\
e5cb4d8bede9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IDDelta", "::", "usage"}], "=", 
    "\"\<IDDelta[\[Lambda]u, Np, Br, Gap, Len1, Len2, Len3, \
\\\"\[Delta]P\\\":0, \\\"\[Delta]GV\\\":0, \\\"\[Delta]GH\\\":0, \
\\\"\[Delta]CP\\\":0, \\\"BlockGap\\\":0, \\\"Termination\\\":\\\"None\\\", \
\\\"BlockShape\\\"\[Rule] \\\"DeltaSabia\\\", \\\"BlockSubdivision\\\"\[Rule] \
\\\"None\\\"]: Returns the ID model. \\n\\nArgs: \\n\[Lambda]u [mm] is the ID \
period, \\nNp is the number of periods, \\nBr [T] is the remanent \
magnetization of the permanent magnet blocks, \\nGap [mm] is the length of \
the minimum gap between the cassettes. \\n\\nOptional args: \\n\[Delta]P \
[mm], \[Delta]GV [mm], \[Delta]GH [mm] and \[Delta]CP [mm] are four types of \
longitudinal movements between the cassettes, \[Delta]P is the phase \
adjustement, \[Delta]GV and \[Delta]GH control the amplitude of the \
longitudinal field component and \[Delta]CP is the inclined-polarization \
adjustment, \\nBlockGap [mm] is the longitudinal gap between the blocks, \
\\nTermination is the termination type (one of the following: None, \
OneBlockSym, OneBlockAntiSym, ThreeBlocksSym, ThreeBlocksAntiSym), \
\\nBlockShape is the shape of the permanent magnet blocks (one of the \
following: Prototype, DeltaSabia or list of block shapes),  \
\\nBlockSubdivision is the subdivision to be apply to the blocks (must have \
the same length as BlockShape).\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDDelta", "[", 
    RowBox[{
    "\[Lambda]u_", ",", " ", "Np_", ",", " ", "Br_", ",", " ", "Gap_", ",", 
     "  ", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<\[Delta]P\>\"", "\[Rule]", " ", "0"}], ",", " ", 
        RowBox[{"\"\<\[Delta]GV\>\"", "\[Rule]", " ", "0"}], ",", " ", 
        RowBox[{"\"\<\[Delta]GH\>\"", "\[Rule]", " ", "0"}], ",", " ", 
        RowBox[{"\"\<\[Delta]CP\>\"", "\[Rule]", " ", "0"}], ",", " ", 
        RowBox[{"\"\<BlockGap\>\"", "->", "0"}], ",", "  ", 
        RowBox[{"\"\<Termination\>\"", "\[Rule]", " ", "\"\<None\>\""}], ",", 
        " ", 
        RowBox[{"\"\<BlockShape\>\"", "\[Rule]", " ", "\"\<DeltaSabia\>\""}], 
        ",", " ", 
        RowBox[{"\"\<BlockSubdivision\>\"", "\[Rule]", " ", "\"\<None\>\""}], 
        ",", " ", 
        RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "False"}], ",", "  ", 
        RowBox[{"\"\<Size1\>\"", "\[Rule]", " ", "1"}], ",", " ", 
        RowBox[{"\"\<Size2\>\"", "\[Rule]", "1"}], ",", " ", 
        RowBox[{"\"\<Size3\>\"", "\[Rule]", " ", "1"}], " ", ",", 
        RowBox[{"\"\<Size4\>\"", "\[Rule]", " ", "1"}], " ", ",", " ", 
        RowBox[{"\"\<Gap1\>\"", "\[Rule]", " ", "0"}], ",", " ", 
        RowBox[{"\"\<Gap2\>\"", "\[Rule]", "0"}], ",", " ", 
        RowBox[{"\"\<Gap3\>\"", "\[Rule]", " ", "0"}], ",", " ", 
        RowBox[{"\"\<Gap4\>\"", "\[Rule]", " ", "0"}], ",", " ", 
        RowBox[{"\"\<Shift1\>\"", "\[Rule]", " ", "0"}], ",", " ", 
        RowBox[{"\"\<Shift2\>\"", "\[Rule]", "0"}], ",", " ", 
        RowBox[{"\"\<Shift3\>\"", "\[Rule]", " ", "0"}], ",", 
        RowBox[{"\"\<Shift4\>\"", "\[Rule]", " ", "0"}], ",", " ", 
        RowBox[{"\"\<FourBlocks\>\"", "\[Rule]", " ", "0"}]}], "}"}], "]"}]}],
     "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "f", ",", " ", "Blocka", " ", ",", " ", "Blockb", ",", "Blockc", ",", 
       "Blockd", ",", " ", "Blocke", ",", " ", "Blocks", ",", "BlockShape", 
       ",", "BlockSubdivision", ",", "\[IndentingNewLine]", "BRCBlockShape", 
       ",", " ", "BLCBlockShape", ",", " ", "ULCBlockShape", ",", " ", 
       "URCBlockShape", ",", " ", "\[IndentingNewLine]", "BRCSubdivision", 
       ",", " ", "BLCSubdivision", ",", "ULCSubdivision", ",", " ", 
       "URCSubdivision", ",", "Silent", ",", "\[IndentingNewLine]", 
       "\[Delta]P", ",", " ", "\[Delta]GV", ",", " ", "\[Delta]GH", ",", " ", 
       "\[Delta]CP", ",", " ", "Termination", ",", "Size1", ",", " ", "Size2",
        ",", " ", "Size3", ",", " ", "Size4", ",", " ", "Gap1", ",", " ", 
       "Gap2", ",", " ", "Gap3", ",", "Gap4", ",", "Shift1", ",", " ", 
       "Shift2", ",", " ", "Shift3", ",", "Shift4", ",", " ", "FourBlocks", 
       ",", "\[IndentingNewLine]", "BlockGap", ",", " ", "\[Delta]BRC", ",", 
       " ", "BRC", ",", " ", "\[Delta]BLC", ",", " ", "BLC", ",", " ", 
       "\[Delta]ULC", ",", " ", "ULC", ",", " ", "\[Delta]URC", ",", " ", 
       "URC", ",", "Device", ",", " ", "Cassettes", ",", " ", "t0", ",", " ", 
       "t1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "The", " ", "insertion", " ", "device", " ", "is", " ", "created", " ",
         "rotated", " ", "by", " ", 
        RowBox[{"\[Pi]", "/", "4"}], " ", "about", " ", "the", " ", "y"}], 
       "-", 
       RowBox[{
       "axis", " ", "to", " ", "simplified", " ", "the", " ", "magnetization",
         " ", 
        RowBox[{"functions", ".", " ", "The"}], " ", "entire", " ", "device", 
        " ", "is", " ", "rotated", " ", "to", " ", "the", " ", "correct", " ",
         "position", " ", "at", " ", "the", " ", "end", " ", "of", " ", "the",
         " ", 
        RowBox[{"function", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t0", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Delete", " ", "previous", " ", "Radia", " ", "objects"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"radUtiDelAll", "[", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Check", " ", "arguments"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{"\[Lambda]u", " ", "\[LessEqual]", " ", "0"}], ",", " ", 
        RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{"Np", " ", "\[LessEqual]", " ", "0"}], ",", " ", 
        RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{"Br", " ", "\[LessEqual]", " ", "0"}], ",", " ", 
        RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{"Gap", " ", "\[LessEqual]", " ", "0"}], ",", " ", 
        RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Gap", " ", "between", " ", "blocks"}], "*)"}], 
      "\[IndentingNewLine]", " ", 
      RowBox[{"BlockGap", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<BlockGap\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Cassettes", " ", "longitudinal", " ", 
        RowBox[{"displacement", " ", "[", "mm", "]"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"\[Delta]P", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<\[Delta]P\>\"", "]"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"Phase", " ", "adjustment"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Delta]GV", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<\[Delta]GV\>\"", "]"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Vertical", " ", "field", " ", "amplitude", " ", "to", " ", 
         "longitudinal", " ", "field", " ", "amplitude"}], ",", " ", 
        RowBox[{
        "also", " ", "decreases", " ", "horizontal", " ", "field", " ", 
         "amplitude"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Delta]GH", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<\[Delta]GH\>\"", "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Horizontal", " ", "field", " ", "amplitude", " ", "to", " ", 
         "longitudinal", " ", "field", " ", "amplitude"}], ",", " ", 
        RowBox[{
        "also", " ", "decreases", " ", "vertical", " ", "field", " ", 
         "amplitude"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Delta]CP", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<\[Delta]CP\>\"", "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"Inclined", " ", "polarization", " ", "adjustment"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Termination", " ", "Type"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Termination", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Termination\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Block", " ", "vertices"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"BlockShape", "=", "  ", 
       RowBox[{"OptionValue", "[", "\"\<BlockShape\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"BlockSubdivision", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<BlockSubdivision\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Silent", " ", "flag"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Silent", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Silent\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Size1", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Size1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Size2", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Size2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Size3", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Size3\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Size4", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Size4\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Gap1", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Gap1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Gap2", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Gap2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Gap3", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Gap3\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Gap4", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Gap4\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Shift1", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Shift1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Shift2", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Shift2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Shift3", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Shift3\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Shift4", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Shift4\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"FourBlocks", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<FourBlocks\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Blocks", " ", "=", " ", "BlockShape"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"BlockShape", "\[Equal]", " ", "\"\<Prototype\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Blocka", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "2.75"}], ",", " ", "0"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "11.2662"}], ",", "8.9645"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "7.73071"}], ",", "12.5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"7.73071", ",", " ", "12.5"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"11.2662", ",", " ", "8.9645"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"2.75", ",", "0"}], "}"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Blockb", " ", "=", " ", 
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "7.73071"}], ",", "12.5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "11.2662"}], ",", " ", "16.0355"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "2.75"}], ",", "25"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"2.75", ",", "25"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"11.2662", ",", "16.0355"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"7.73071", ",", " ", "12.5"}], "}"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Blocks", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"Blocka", ",", " ", "Blockb"}], "}"}]}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"BlockShape", " ", "\[Equal]", " ", "\"\<DeltaSabia\>\""}], 
        " ", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Blocka", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "5.25"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "22.5"}], ",", "19.3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "22.5"}], ",", " ", "29.2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "17.8"}], ",", " ", "33.2"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"17.8", ",", " ", "33.2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"22.5", ",", "29.2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"22.5", ",", "19.3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"5.25", ",", "0"}], "}"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Blockc", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "17.8"}], ",", " ", "33.2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "17.8"}], ",", "38.4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"17.8", ",", " ", "38.4"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"17.8", ",", " ", "33.2"}], "}"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Blockb", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "17.8"}], ",", "38.4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "22.5"}], ",", "42.4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "22.5"}], ",", "49"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "21.5"}], ",", "50"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"21.5", ",", "50"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"22.5", ",", "49"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"22.5", ",", "42.4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"17.8", ",", "38.4"}], "}"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Blocks", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"Blocka", ",", " ", "Blockc", ",", "Blockb"}], "}"}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Blocks", " ", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", " ", "All", ",", " ", "2"}], "]"}], "]"}], "=", 
       " ", 
       RowBox[{
        RowBox[{"Blocks", " ", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", " ", "All", ",", " ", "2"}], "]"}], "]"}], "+", 
        " ", 
        RowBox[{"Gap", "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Block", " ", "vertices", " ", "for", " ", "each", " ", "cassette", 
        " ", 
        RowBox[{"(", 
         RowBox[{
         "cross", " ", "section", " ", "in", " ", "the", " ", "xy", " ", 
          "plane"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"URCBlockShape", " ", "=", "Blocks"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ULCBlockShape", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Dot", "[", 
            RowBox[{
             RowBox[{"RotationMatrix", "[", 
              RowBox[{"\[Pi]", "/", "2"}], "]"}], ",", "#"}], "]"}], "&"}], "/@",
           "#"}], "&"}], "/@", "URCBlockShape"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"BLCBlockShape", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Dot", "[", 
            RowBox[{
             RowBox[{"RotationMatrix", "[", 
              RowBox[{"\[Pi]", "/", "2"}], "]"}], ",", "#"}], "]"}], "&"}], "/@",
           "#"}], "&"}], "/@", "ULCBlockShape"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"BRCBlockShape", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Dot", "[", 
            RowBox[{
             RowBox[{"RotationMatrix", "[", 
              RowBox[{"\[Pi]", "/", "2"}], "]"}], ",", "#"}], "]"}], "&"}], "/@",
           "#"}], "&"}], "/@", "BLCBlockShape"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"URCSubdivision", "  ", "=", 
       RowBox[{"ULCSubdivision", "=", 
        RowBox[{"BLCSubdivision", "=", 
         RowBox[{"BRCSubdivision", " ", "=", "BlockSubdivision"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "BlockSubdivision", "]"}], ">", " ", "0"}], 
        ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"URCSubdivision", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", " ", 
           "BlockSubdivision"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ULCSubdivision", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", " ", 
             RowBox[{"Dot", "[", 
              RowBox[{
               RowBox[{"RotationMatrix", "[", 
                RowBox[{
                 RowBox[{"\[Pi]", "/", "2"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0", ",", " ", "0"}], "}"}]}], "]"}], ",",
                "#"}], "]"}], "]"}], "&"}], "/@", " ", "URCSubdivision"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"BLCSubdivision", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", " ", 
             RowBox[{"Dot", "[", 
              RowBox[{
               RowBox[{"RotationMatrix", "[", 
                RowBox[{
                 RowBox[{"\[Pi]", "/", "2"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0", ",", " ", "0"}], "}"}]}], "]"}], ",",
                "#"}], "]"}], "]"}], "&"}], "/@", " ", "ULCSubdivision"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"BRCSubdivision", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", " ", 
             RowBox[{"Dot", "[", 
              RowBox[{
               RowBox[{"RotationMatrix", "[", 
                RowBox[{
                 RowBox[{"\[Pi]", "/", "2"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0", ",", " ", "0"}], "}"}]}], "]"}], ",",
                "#"}], "]"}], "]"}], "&"}], "/@", "BLCSubdivision"}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "Cassettes", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Delta]URC", " ", "=", "\[Delta]GV"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"URC", " ", "=", " ", 
       RowBox[{"auxIDCassette", "[", 
        RowBox[{
        "\[Lambda]u", ",", " ", "Np", ",", " ", "Br", ",", "\[Delta]URC", ",",
          " ", "URCBlockShape", ",", 
         RowBox[{"\"\<BlockGap\>\"", "\[Rule]", " ", "BlockGap"}], ",", " ", 
         RowBox[{"\"\<Termination\>\"", "\[Rule]", " ", "Termination"}], ",", 
         " ", " ", 
         RowBox[{"\"\<PointingUp\>\"", "\[Rule]", " ", "False"}], ",", 
         RowBox[{"\"\<FirstBlock\>\"", "\[Rule]", " ", "\"\<Up\>\""}], ",", 
         RowBox[{
         "\"\<FieldDirection\>\"", "\[Rule]", " ", "\"\<Vertical\>\""}], ",", 
         " ", 
         RowBox[{
         "\"\<BlockSubdivision\>\"", "\[Rule]", " ", "URCSubdivision"}], ",", 
         " ", 
         RowBox[{"\"\<Size1\>\"", "\[Rule]", " ", "Size1"}], ",", " ", 
         RowBox[{"\"\<Size2\>\"", "\[Rule]", " ", "Size2"}], ",", " ", 
         RowBox[{"\"\<Size3\>\"", "\[Rule]", " ", "Size3"}], ",", 
         RowBox[{"\"\<Size4\>\"", "\[Rule]", " ", "Size4"}], ",", " ", 
         RowBox[{"\"\<Gap1\>\"", "\[Rule]", " ", "Gap1"}], ",", "  ", 
         RowBox[{"\"\<Gap2\>\"", "\[Rule]", " ", "Gap2"}], ",", "  ", 
         RowBox[{"\"\<Gap3\>\"", "\[Rule]", " ", "Gap3"}], ",", 
         RowBox[{"\"\<Gap4\>\"", "\[Rule]", " ", "Gap4"}], ",", " ", 
         RowBox[{"\"\<Shift1\>\"", "\[Rule]", " ", "Shift1"}], ",", " ", 
         RowBox[{"\"\<Shift2\>\"", "\[Rule]", " ", "Shift2"}], ",", " ", 
         RowBox[{"\"\<Shift3\>\"", "\[Rule]", " ", "Shift3"}], ",", 
         RowBox[{"\"\<Shift4\>\"", "\[Rule]", " ", "Shift4"}], ",", " ", 
         RowBox[{"\"\<FourBlocks\>\"", "\[Rule]", " ", "FourBlocks"}], ",", 
         " ", 
         RowBox[{"\"\<ShiftDirection\>\"", "\[Rule]", " ", "1"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\[Delta]ULC", " ", "=", " ", 
       RowBox[{
       "\[Delta]GV", "+", " ", "\[Delta]GH", "+", " ", "\[Delta]P", "+", 
        "\[Delta]CP"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ULC", " ", "=", " ", 
       RowBox[{"auxIDCassette", "[", 
        RowBox[{
        "\[Lambda]u", ",", " ", "Np", ",", " ", "Br", ",", "\[Delta]ULC", ",",
          " ", "ULCBlockShape", ",", " ", 
         RowBox[{"\"\<BlockGap\>\"", "\[Rule]", " ", "BlockGap"}], ",", " ", 
         RowBox[{"\"\<Termination\>\"", "\[Rule]", " ", "Termination"}], ",", 
         " ", " ", 
         RowBox[{"\"\<PointingUp\>\"", "\[Rule]", " ", "True"}], ",", 
         RowBox[{"\"\<FirstBlock\>\"", "\[Rule]", " ", "\"\<Down\>\""}], ",", 
         " ", 
         RowBox[{
         "\"\<FieldDirection\>\"", "\[Rule]", " ", "\"\<Horizontal\>\""}], 
         ",", " ", 
         RowBox[{"\"\<BlockSubdivision\>\"", "\[Rule]", "ULCSubdivision"}], 
         ",", " ", 
         RowBox[{"\"\<Size1\>\"", "\[Rule]", " ", "Size1"}], ",", " ", 
         RowBox[{"\"\<Size2\>\"", "\[Rule]", " ", "Size2"}], ",", " ", 
         RowBox[{"\"\<Size3\>\"", "\[Rule]", " ", "Size3"}], ",", 
         RowBox[{"\"\<Size4\>\"", "\[Rule]", " ", "Size4"}], ",", " ", 
         RowBox[{"\"\<Gap1\>\"", "\[Rule]", " ", "Gap1"}], ",", "  ", 
         RowBox[{"\"\<Gap2\>\"", "\[Rule]", " ", "Gap2"}], ",", "  ", 
         RowBox[{"\"\<Gap3\>\"", "\[Rule]", " ", "Gap3"}], ",", 
         RowBox[{"\"\<Gap4\>\"", "\[Rule]", " ", "Gap4"}], ",", " ", 
         RowBox[{"\"\<Shift1\>\"", "\[Rule]", " ", "Shift1"}], ",", " ", 
         RowBox[{"\"\<Shift2\>\"", "\[Rule]", " ", "Shift2"}], ",", " ", 
         RowBox[{"\"\<Shift3\>\"", "\[Rule]", " ", "Shift3"}], ",", 
         RowBox[{"\"\<Shift4\>\"", "\[Rule]", " ", "Shift4"}], ",", " ", 
         RowBox[{"\"\<FourBlocks\>\"", "\[Rule]", " ", "FourBlocks"}], ",", 
         " ", " ", 
         RowBox[{"\"\<ShiftDirection\>\"", "\[Rule]", " ", 
          RowBox[{"-", "1"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Delta]BLC", " ", "=", "\[Delta]GH"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"BLC", " ", "=", " ", 
       RowBox[{"auxIDCassette", "[", 
        RowBox[{
        "\[Lambda]u", ",", " ", "Np", ",", " ", "Br", ",", "\[Delta]BLC", ",",
          " ", "BLCBlockShape", ",", "  ", 
         RowBox[{"\"\<BlockGap\>\"", "\[Rule]", " ", "BlockGap"}], ",", " ", 
         RowBox[{"\"\<Termination\>\"", "\[Rule]", " ", "Termination"}], ",", 
         " ", " ", 
         RowBox[{"\"\<PointingUp\>\"", "\[Rule]", " ", "True"}], ",", 
         RowBox[{"\"\<FirstBlock\>\"", "\[Rule]", " ", "\"\<Up\>\""}], ",", 
         " ", 
         RowBox[{
         "\"\<FieldDirection\>\"", "\[Rule]", " ", "\"\<Vertical\>\""}], ",", 
         " ", 
         RowBox[{
         "\"\<BlockSubdivision\>\"", "\[Rule]", " ", "BLCSubdivision"}], ",", 
         RowBox[{"\"\<Size1\>\"", "\[Rule]", " ", "Size1"}], ",", " ", 
         RowBox[{"\"\<Size2\>\"", "\[Rule]", " ", "Size2"}], ",", " ", 
         RowBox[{"\"\<Size3\>\"", "\[Rule]", " ", "Size3"}], ",", 
         RowBox[{"\"\<Size4\>\"", "\[Rule]", " ", "Size4"}], ",", " ", 
         RowBox[{"\"\<Gap1\>\"", "\[Rule]", " ", "Gap1"}], ",", "  ", 
         RowBox[{"\"\<Gap2\>\"", "\[Rule]", " ", "Gap2"}], ",", "  ", 
         RowBox[{"\"\<Gap3\>\"", "\[Rule]", " ", "Gap3"}], ",", 
         RowBox[{"\"\<Gap4\>\"", "\[Rule]", " ", "Gap4"}], ",", " ", 
         RowBox[{"\"\<Shift1\>\"", "\[Rule]", " ", "Shift1"}], ",", " ", 
         RowBox[{"\"\<Shift2\>\"", "\[Rule]", " ", "Shift2"}], ",", " ", 
         RowBox[{"\"\<Shift3\>\"", "\[Rule]", " ", "Shift3"}], ",", 
         RowBox[{"\"\<Shift4\>\"", "\[Rule]", " ", "Shift4"}], ",", " ", 
         RowBox[{"\"\<FourBlocks\>\"", "\[Rule]", " ", "FourBlocks"}], ",", 
         " ", " ", 
         RowBox[{"\"\<ShiftDirection\>\"", "\[Rule]", " ", 
          RowBox[{"-", "1"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Delta]BRC", " ", "=", 
       RowBox[{"\[Delta]P", "-", "\[Delta]CP"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"BRC", " ", "=", 
       RowBox[{"auxIDCassette", "[", 
        RowBox[{
        "\[Lambda]u", ",", " ", "Np", ",", " ", "Br", ",", " ", "\[Delta]BRC",
          ",", "BRCBlockShape", ",", " ", 
         RowBox[{"\"\<BlockGap\>\"", "\[Rule]", " ", "BlockGap"}], ",", " ", 
         RowBox[{"\"\<Termination\>\"", "\[Rule]", " ", "Termination"}], ",", 
         " ", " ", 
         RowBox[{"\"\<PointingUp\>\"", "\[Rule]", "False"}], ",", " ", 
         RowBox[{"\"\<FirstBlock\>\"", "\[Rule]", " ", "\"\<Down\>\""}], ",", 
         " ", 
         RowBox[{
         "\"\<FieldDirection\>\"", "\[Rule]", " ", "\"\<Horizontal\>\""}], 
         ",", " ", 
         RowBox[{
         "\"\<BlockSubdivision\>\"", "\[Rule]", " ", "BRCSubdivision"}], ",", 
         " ", 
         RowBox[{"\"\<Size1\>\"", "\[Rule]", " ", "Size1"}], ",", " ", 
         RowBox[{"\"\<Size2\>\"", "\[Rule]", " ", "Size2"}], ",", " ", 
         RowBox[{"\"\<Size3\>\"", "\[Rule]", " ", "Size3"}], ",", 
         RowBox[{"\"\<Size4\>\"", "\[Rule]", " ", "Size4"}], ",", " ", 
         RowBox[{"\"\<Gap1\>\"", "\[Rule]", " ", "Gap1"}], ",", "  ", 
         RowBox[{"\"\<Gap2\>\"", "\[Rule]", " ", "Gap2"}], ",", "  ", 
         RowBox[{"\"\<Gap3\>\"", "\[Rule]", " ", "Gap3"}], ",", 
         RowBox[{"\"\<Gap4\>\"", "\[Rule]", " ", "Gap4"}], ",", " ", 
         RowBox[{"\"\<Shift1\>\"", "\[Rule]", " ", "Shift1"}], ",", " ", 
         RowBox[{"\"\<Shift2\>\"", "\[Rule]", " ", "Shift2"}], ",", " ", 
         RowBox[{"\"\<Shift3\>\"", "\[Rule]", " ", "Shift3"}], ",", 
         RowBox[{"\"\<Shift4\>\"", "\[Rule]", " ", "Shift4"}], ",", " ", 
         RowBox[{"\"\<FourBlocks\>\"", "\[Rule]", " ", "FourBlocks"}], ",", 
         " ", " ", 
         RowBox[{"\"\<ShiftDirection\>\"", "\[Rule]", " ", "1"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Insertion", " ", "device"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Device", " ", "=", 
       RowBox[{"radObjCnt", "[", 
        RowBox[{"{", 
         RowBox[{"BRC", ",", " ", "BLC", ",", " ", "ULC", ",", " ", "URC"}], 
         "}"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Counterclockwise", " ", "rotation", " ", "of", " ", "insertion", " ",
          "device", " ", "by"}], " ", "-", 
        RowBox[{
         RowBox[{"\[Pi]", "/", "4"}], " ", "around", " ", "the", " ", "z"}], 
        "-", "axis"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Device", "=", " ", 
       RowBox[{"radTrfOrnt", "[", 
        RowBox[{"Device", ",", 
         RowBox[{"radTrfRot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
           RowBox[{
            RowBox[{"-", "\[Pi]"}], "/", "4"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", " ", "Silent"}], ",", " ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<IDDelta: elapsed time = \>\"", ",", 
          RowBox[{"(", 
           RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "Device", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7667551788345585`*^9, 3.766755219697137*^9}, {
   3.7667552608722496`*^9, 3.766755336956355*^9}, {3.7667553842569494`*^9, 
   3.766755392727988*^9}, {3.7667554904075484`*^9, 3.7667554958142147`*^9}, {
   3.766755533035892*^9, 3.766755536817438*^9}, {3.7667555822585154`*^9, 
   3.766755653420355*^9}, {3.766756597123891*^9, 3.7667567178365045`*^9}, {
   3.766758273756778*^9, 3.7667582858827343`*^9}, {3.766758881931342*^9, 
   3.766758895901193*^9}, {3.7667589294194484`*^9, 3.766759099497465*^9}, {
   3.7667594411382713`*^9, 3.766759474594048*^9}, 3.766759676703664*^9, {
   3.7667597589931507`*^9, 3.7667597604151382`*^9}, {3.767445913038151*^9, 
   3.7674459154914675`*^9}, {3.7674480119644413`*^9, 3.767448037403933*^9}, {
   3.767517216023782*^9, 3.76751735632812*^9}, {3.767517388002474*^9, 
   3.7675175908758945`*^9}, {3.767517710921748*^9, 3.7675177169357166`*^9}, {
   3.7675352221793385`*^9, 3.7675352299784536`*^9}, {3.7826507708075814`*^9, 
   3.7826508410104322`*^9}, {3.7826509152630415`*^9, 
   3.7826509534060044`*^9}, {3.7826509875464926`*^9, 
   3.7826513618482885`*^9}, {3.7826514197543125`*^9, 
   3.7826514691465225`*^9}, {3.782651516571157*^9, 3.7826516281644516`*^9}, {
   3.782651791808872*^9, 3.782651794105769*^9}, {3.782651877699188*^9, 
   3.7826519147927847`*^9}, {3.7826519494332795`*^9, 3.782652148716467*^9}, {
   3.78265266546935*^9, 3.782652666719343*^9}, {3.782659005138482*^9, 
   3.7826590070603485`*^9}, {3.7826592858206563`*^9, 3.78265929694561*^9}, {
   3.7826604221508827`*^9, 3.7826604311977215`*^9}, {3.782660660486992*^9, 
   3.7826607614709654`*^9}, {3.782660802567483*^9, 3.7826608417392*^9}, {
   3.782660872520325*^9, 3.7826610165052404`*^9}, {3.7826610636786795`*^9, 
   3.7826610639755516`*^9}, {3.782723152329569*^9, 3.782723364147324*^9}, {
   3.7827251626917877`*^9, 3.7827253028474708`*^9}, {3.782726489766873*^9, 
   3.782726501032457*^9}, {3.7827273648822813`*^9, 3.7827274629720583`*^9}, {
   3.7827276445539565`*^9, 3.7827276448195767`*^9}, {3.782727745825308*^9, 
   3.7827277459503107`*^9}, 3.7834343693375583`*^9, {3.7834360989694023`*^9, 
   3.783436118125576*^9}, {3.7849708241210814`*^9, 3.7849708397628965`*^9}, {
   3.784970923135537*^9, 3.7849709525780067`*^9}, {3.7849709861275373`*^9, 
   3.7849710402907534`*^9}, {3.78497114577227*^9, 3.784971236235998*^9}, {
   3.7849718913198776`*^9, 3.7849718949763823`*^9}, 3.7849748915670214`*^9, {
   3.784974976765699*^9, 3.7849750359324846`*^9}, {3.7900994598001757`*^9, 
   3.790099463909542*^9}, {3.790099514677552*^9, 3.7900997992215023`*^9}, {
   3.79010000114565*^9, 3.790100003317521*^9}, {3.79010015867902*^9, 
   3.790100158897772*^9}, {3.7901002128664656`*^9, 3.7901003135256205`*^9}, {
   3.7901003717130585`*^9, 3.790100435822373*^9}, {3.790325198838755*^9, 
   3.7903252471519814`*^9}, {3.7903252936050653`*^9, 3.7903253764191914`*^9}, 
   3.7903255200596695`*^9, {3.790325588153353*^9, 3.790325590481475*^9}, {
   3.7905969395027122`*^9, 3.7905969919103193`*^9}, {3.7905970629101562`*^9, 
   3.7905970831444855`*^9}, {3.790597114275004*^9, 3.7905971169312763`*^9}, {
   3.790597181509253*^9, 3.7905973150116053`*^9}, {3.790597381950594*^9, 
   3.7905974064349146`*^9}, {3.790598731815971*^9, 3.7905988024267626`*^9}, {
   3.7905988377079296`*^9, 3.790598873335472*^9}, {3.790599019132003*^9, 
   3.790599019772629*^9}, {3.7905990695098543`*^9, 3.7905990899004335`*^9}, {
   3.8000349773448105`*^9, 3.80003500226662*^9}, {3.8000359490205283`*^9, 
   3.8000359640517445`*^9}, {3.8002673544039755`*^9, 3.80026736304457*^9}, {
   3.8002673945757475`*^9, 3.8002676403442945`*^9}, {3.800267793015761*^9, 
   3.8002679116404524`*^9}, {3.8002682772106752`*^9, 3.800268314054346*^9}, {
   3.8002684873835907`*^9, 3.800268545992809*^9}, {3.8002686718362293`*^9, 
   3.8002687228048415`*^9}, {3.800268770570323*^9, 3.8002688254941435`*^9}, {
   3.800269396639897*^9, 3.8002696335625005`*^9}, {3.8002905604446383`*^9, 
   3.800290563147753*^9}, {3.8002906246007395`*^9, 3.8002906421475267`*^9}, {
   3.80029385478183*^9, 3.800293855188079*^9}, {3.8007804660998197`*^9, 
   3.8007804853653784`*^9}, {3.8049514125963106`*^9, 3.804951432330654*^9}, {
   3.804952168477005*^9, 3.804952170998558*^9}, {3.81179071275385*^9, 
   3.8117909188845043`*^9}, {3.8117909505127134`*^9, 3.811790955939063*^9}, {
   3.8118216752631655`*^9, 3.8118217479403887`*^9}, {3.8118224694406757`*^9, 
   3.8118225353980384`*^9}, {3.8118239228435664`*^9, 3.811823941060009*^9}, 
   3.811853739330413*^9, {3.8118550788946776`*^9, 3.811855113667631*^9}, {
   3.8118553803153696`*^9, 3.8118553860626345`*^9}, {3.811857279645944*^9, 
   3.8118574607078314`*^9}, {3.8118577180665503`*^9, 
   3.8118577323166695`*^9}, {3.81185867535961*^9, 3.8118586848839583`*^9}, {
   3.811858716583386*^9, 3.811858723770481*^9}, {3.811858795287467*^9, 
   3.811858798451473*^9}, {3.8118588957959085`*^9, 3.81185890068201*^9}, {
   3.8118589601334143`*^9, 3.8118589663100467`*^9}, {3.811859006875464*^9, 
   3.811859013942975*^9}, {3.8118590696978855`*^9, 3.8118591333640137`*^9}, {
   3.8118593209471064`*^9, 3.811859331749689*^9}, {3.811859398881408*^9, 
   3.811859413680354*^9}, {3.811859496425479*^9, 3.811859510543769*^9}, {
   3.8125357237153625`*^9, 3.8125357794488344`*^9}, {3.8125358562163982`*^9, 
   3.812536074380492*^9}, {3.8125396170109572`*^9, 3.8125397631918306`*^9}, {
   3.8125399907159967`*^9, 3.812540047231269*^9}, {3.812540706746953*^9, 
   3.812540720717823*^9}, {3.8125408905125217`*^9, 3.812540899033056*^9}, {
   3.8125410026895056`*^9, 3.812541080246192*^9}, {3.8125411109781055`*^9, 
   3.812541115678444*^9}, {3.812541167481624*^9, 3.8125411781623073`*^9}, {
   3.812541253516964*^9, 3.812541279098573*^9}, {3.8125413096804953`*^9, 
   3.812541347942879*^9}, {3.812541381424944*^9, 3.8125414423587456`*^9}, {
   3.812541503182525*^9, 3.8125415046526175`*^9}, {3.8125415399948206`*^9, 
   3.812541556375874*^9}, {3.8125418247047873`*^9, 3.8125418400357428`*^9}, {
   3.812541902069605*^9, 3.8125419268611326`*^9}, {3.81254199810559*^9, 
   3.8125420021458564`*^9}, {3.8125421708663406`*^9, 3.812542187437378*^9}, {
   3.8125422650522037`*^9, 3.8125422751228313`*^9}, {3.815744962481203*^9, 
   3.8157451009659996`*^9}, {3.8157453444181366`*^9, 3.81574534546264*^9}, {
   3.816612809032319*^9, 3.816612834588354*^9}, {3.816612943933936*^9, 
   3.8166130726865044`*^9}, {3.8166137735805607`*^9, 
   3.8166137820592265`*^9}, {3.8166288692602444`*^9, 
   3.8166290677949224`*^9}, {3.8166989638591733`*^9, 3.816698983451342*^9}, {
   3.816699075727983*^9, 3.816699090372263*^9}, 3.8166991243103104`*^9, {
   3.8166991628313665`*^9, 3.8166992271492853`*^9}, {3.816699355516037*^9, 
   3.8166993845153613`*^9}, {3.818845680037689*^9, 3.818845712930765*^9}, {
   3.818845744753772*^9, 3.8188457575292487`*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[3]:=",ExpressionUUID->"d4295d6b-5e5f-4955-8ce4-9cdda100a50e"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Utilities", "Section",
 CellChangeTimes->{{3.7663982103876667`*^9, 3.7663982168978977`*^9}, {
  3.7663982623594646`*^9, 
  3.766398265542498*^9}},ExpressionUUID->"f4366deb-1b60-41eb-9dc8-\
6ebd3361a7fc"],

Cell[CellGroupData[{

Cell["IDSolve", "Subsection",
 CellChangeTimes->{
  3.7667548496524267`*^9, {3.8119940063406706`*^9, 
   3.811994007491991*^9}},ExpressionUUID->"2ad9b229-e14f-4a3a-8e5f-\
2858a5e5451b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IDSolve", "::", "usage"}], " ", "=", " ", 
    "\"\<IDSolve[ID, Prec, MaxIter]: Call RadSolve function and print \
results.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDSolve", "[", 
    RowBox[{"ID_", ",", "  ", "Prec_", ",", " ", "MaxIter_", ",", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"{", 
       RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "False"}], "}"}], "]"}]}], 
    " ", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "sre", ",", " ", "sz", ",", " ", "t0", ",", " ", "t1", ",", " ", 
       "Silent"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t0", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"sre", "=", 
       RowBox[{"RadSolve", "[", 
        RowBox[{"ID", ",", "Prec", ",", "MaxIter"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sz", " ", "=", " ", 
       RowBox[{"radObjDegFre", "[", "ID", "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Silent", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Silent\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", " ", "Silent"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Solved in: \>\"", ",", 
           RowBox[{
            RowBox[{"Round", "[", 
             RowBox[{"t1", "-", "t0"}], "]"}], "/", "60.0"}], ",", 
           "\"\< min\>\""}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Number of Degrees of Freedom = \>\"", ",", "sz"}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Typical Memory Size of Interation Matrix [MBytes] = \>\"", ",", 
           RowBox[{"N", "[", 
            RowBox[{"sz", "*", 
             RowBox[{"(", 
              RowBox[{"sz", "+", "1"}], ")"}], "*", 
             RowBox[{"4", "/", "1000000"}]}], "]"}]}], "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Average absolute change in magnetization between the last two \
iterations = \>\"", ",", 
           RowBox[{"sre", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Maximum absolute value of magnetization over all the objects = \
\>\"", ",", 
           RowBox[{"sre", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Maximum absolute value of magnetic field strength over central \
points of all the objects = \>\"", ",", 
           RowBox[{"sre", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Number of iterations done = \>\"", ",", 
           RowBox[{"sre", "[", 
            RowBox[{"[", "4", "]"}], "]"}], ",", " ", "\"\<\\n\>\""}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.811994080047217*^9, 3.811994158715458*^9}, {
  3.8119942336302195`*^9, 3.8119942569198236`*^9}, {3.811994358880513*^9, 
  3.811994431713492*^9}, {3.8119944656793065`*^9, 3.8119945642559*^9}, {
  3.8157453072264175`*^9, 3.8157453789063025`*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[5]:=",ExpressionUUID->"068e143d-bd0f-46f2-9082-ce6f19ee2c7b"]
}, Closed]],

Cell[CellGroupData[{

Cell["IDShow", "Subsection",
 CellChangeTimes->{
  3.766754821368951*^9},ExpressionUUID->"80d519b9-e0f1-46b9-b652-\
4e226e79bc05"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IDShow", "::", "usage"}], " ", "=", " ", 
    "\"\<IDShow[ID, \\\"MagDirection\\\"\[Rule] False, \\\"ArrowSize\\\"\
\[Rule] 10, \\\"ArrowHeadSize\\\"\[Rule] Medium]: Show the ID model.\>\""}], 
   ";"}], " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDShow", "[", 
    RowBox[{"ID_", ",", " ", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<MagDirection\>\"", "\[Rule]", " ", "False"}], ",", "  ", 
        RowBox[{"\"\<ArrowSize\>\"", "\[Rule]", " ", "10"}], ",", " ", 
        RowBox[{"\"\<ArrowHeadSize\>\"", "\[Rule]", "Medium"}], ",", " ", 
        RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "False"}]}], "}"}], "]"}]}],
     "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "MagDirection", ",", " ", "ArrowSize", " ", ",", " ", "ArrowHeadSize", 
       " ", ",", " ", "ObjM", " ", ",", " ", "ArrowList", ",", " ", "t0", ",",
        " ", "t1", ",", "  ", "Silent"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t0", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"RadPlot3DOptions", "[", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"MagDirection", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<MagDirection\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ArrowSize", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<ArrowSize\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ArrowHeadSize", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<ArrowHeadSize\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"MagDirection", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ObjM", " ", "=", " ", 
          RowBox[{"radObjM", "[", "ID", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ArrowList", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"auxIDBlockArrow", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", " ", "ArrowSize"}], "]"}],
             "&"}], "/@", "ObjM"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"Graphics3D", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Opacity", "[", "0.5", "]"}], ",", " ", 
              RowBox[{"radObjDrw", "[", "ID", "]"}], ",", 
              RowBox[{"Opacity", "[", "1", "]"}], ",", 
              RowBox[{"Arrowheads", "[", "ArrowHeadSize", "]"}], ",", 
              "ArrowList"}], "}"}], ",", " ", 
            RowBox[{"BaseStyle", " ", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{"12", ",", " ", 
               RowBox[{
               "FontFamily", " ", "\[Rule]", " ", "\"\<Calibri\>\""}]}], 
              "}"}]}]}], "]"}], "]"}], ";"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"Graphics3D", "[", 
           RowBox[{
            RowBox[{"radObjDrw", "[", "ID", "]"}], ",", 
            RowBox[{"BaseStyle", " ", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{"16", ",", " ", 
               RowBox[{
               "FontFamily", " ", "\[Rule]", " ", "\"\<Calibri\>\""}]}], 
              "}"}]}]}], "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Silent", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Silent\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", " ", "Silent"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<IDShow: elapsed time = \>\"", ",", 
           RowBox[{"(", 
            RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7667558489826016`*^9, 3.766755892642285*^9}, {
   3.76675595766302*^9, 3.7667561689633245`*^9}, {3.7667562043411093`*^9, 
   3.766756256829613*^9}, 3.7667563179437857`*^9, 3.766757279583788*^9, {
   3.7674475847961235`*^9, 3.7674476020787315`*^9}, {3.767447784535589*^9, 
   3.767447797099101*^9}, {3.8119962560447073`*^9, 3.811996256795929*^9}, {
   3.8157454068773603`*^9, 3.815745432178673*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[7]:=",ExpressionUUID->"d01a001e-9065-45b4-8e73-d9728b90eeea"]
}, Closed]],

Cell[CellGroupData[{

Cell["IDInfo", "Subsection",
 CellChangeTimes->{{3.766754821368951*^9, 3.766754837401464*^9}, {
  3.76744992179731*^9, 
  3.7674499282822175`*^9}},ExpressionUUID->"53ad71eb-17b9-4d6d-ac98-\
0730df07584e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IDInfo", "::", "usage"}], " ", "=", " ", 
    "\"\<IDInfo[ID, \[Lambda]u]: Print the field amplitudes and K values of \
the ID.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDInfo", "[", 
    RowBox[{"ID_", ",", " ", "\[Lambda]u_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Bv", ",", " ", "Bh", ",", " ", "Bs", ",", " ", "Kh", ",", " ", "Kv", 
       ",", " ", "t0", ",", " ", "t1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t0", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Bh", " ", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{"radFldLst", "[", 
          RowBox[{"ID", ",", " ", "\"\<Bx\>\"", ",", " ", 
           RowBox[{"{", " ", 
            RowBox[{"0", ",", "0", ",", " ", 
             RowBox[{"-", "\[Lambda]u"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "\[Lambda]u"}], "}"}], ",", " ", 
           "100", ",", " ", "\"\<noarg\>\"", ",", " ", 
           RowBox[{"-", "\[Lambda]u"}]}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Bv", " ", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{"radFldLst", "[", 
          RowBox[{"ID", ",", " ", "\"\<By\>\"", ",", " ", 
           RowBox[{"{", " ", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "\[Lambda]u"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "\[Lambda]u"}], "}"}], ",", " ", 
           "100", ",", " ", "\"\<noarg\>\"", ",", " ", 
           RowBox[{"-", "\[Lambda]u"}]}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Bs", " ", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{"radFldLst", "[", 
          RowBox[{"ID", ",", " ", "\"\<Bz\>\"", ",", " ", 
           RowBox[{"{", " ", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "\[Lambda]u"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "\[Lambda]u"}], "}"}], ",", " ", 
           "100", ",", " ", "\"\<noarg\>\"", ",", " ", 
           RowBox[{"-", "\[Lambda]u"}]}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<\\nHorizontal field amplitude:    \>\"", ",", " ", "Bh", ",", 
        "  ", "\"\< [T]\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Vertical field amplitude:      \>\"", ",", " ", "Bv", ",", " ", 
        "\"\< [T]\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Longitudinal field amplitude:  \>\"", ",", " ", "Bs", ",", "  ", 
        "\"\< [T]\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Kh", " ", "=", " ", 
       RowBox[{"0.934", "*", "Bv", "*", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]u", "/", "10"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Kv", " ", "=", " ", 
       RowBox[{"0.934", "*", "Bh", "*", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]u", "/", "10"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<\\nHorizontal K: \>\"", ",", " ", "Kh"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Vertical K:   \>\"", ",", " ", "Kv"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<IDInfo: elapsed time = \>\"", ",", 
        RowBox[{"(", 
         RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7674474456397743`*^9, 3.7674474806295147`*^9}, {
  3.7674475680916853`*^9, 3.7674475684823327`*^9}, {3.767447806856612*^9, 
  3.767447814544712*^9}, {3.76744993168874*^9, 3.76744994276999*^9}, {
  3.7826552143586717`*^9, 3.7826552578428774`*^9}, {3.782655290186495*^9, 
  3.782655300623965*^9}, {3.7844725656385136`*^9, 3.7844725686856365`*^9}, {
  3.7845390869807477`*^9, 3.784539088824651*^9}, {3.8118689810124674`*^9, 
  3.811868999379013*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[9]:=",ExpressionUUID->"f619c123-566c-42f1-a68a-7bbe2814a613"]
}, Closed]],

Cell[CellGroupData[{

Cell["IDPlotFields", "Subsection",
 CellChangeTimes->{
  3.7667548496524267`*^9},ExpressionUUID->"75a7f740-ea21-4afe-8108-\
05b029f59846"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IDPlotFields", "::", "usage"}], " ", "=", " ", 
    "\"\<IDPlotFields[ID, p, pRange, p2:0, p3:0, BRange:{All, All}]: Plot the \
ID magnetic field versus the coordinate p ('x', 'y' or 'z').\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDPlotFields", "[", 
    RowBox[{"ID_", ",", " ", "p_", ",", "pRange_", ",", " ", 
     RowBox[{"p2_:", "0"}], ",", " ", 
     RowBox[{"p3_:", "0"}], ",", " ", 
     RowBox[{"BRange_:", 
      RowBox[{"{", 
       RowBox[{"All", ",", " ", "All"}], "}"}]}], " ", ",", " ", 
     RowBox[{"Silent_:", "0"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"plots", ",", " ", "t0", ",", " ", "t1"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t0", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"plots", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"p", " ", "\[Equal]", " ", "\"\<x\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"radFld", "[", 
                RowBox[{"ID", ",", "\"\<Bx\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "p2", ",", "p3"}], "}"}]}], "]"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"pRange", ",", " ", "BRange"}], "}"}]}], ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<x [mm]\>\"", ",", "\"\<Bx[T]\>\""}], "}"}]}], 
              ",", " ", 
              RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", "  ", 
              RowBox[{"PlotLegends", "\[Rule]", " ", 
               RowBox[{"{", "\"\<Bx\>\"", "}"}]}]}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"radFld", "[", 
                RowBox[{"ID", ",", "\"\<By\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "p2", ",", "p3"}], "}"}]}], "]"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"pRange", ",", "  ", "BRange"}], "}"}]}], ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<x [mm]\>\"", ",", "\"\<By[T]\>\""}], "}"}]}], 
              ",", " ", 
              RowBox[{"PlotStyle", "\[Rule]", "Green"}], ",", "  ", 
              RowBox[{"PlotLegends", "\[Rule]", " ", 
               RowBox[{"{", "\"\<By\>\"", "}"}]}]}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"radFld", "[", 
                RowBox[{"ID", ",", "\"\<Bz\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "p2", ",", "p3"}], "}"}]}], "]"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"pRange", ",", " ", "BRange"}], "}"}]}], ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<x [mm]\>\"", ",", "\"\<Bz[T]\>\""}], "}"}]}], 
              ",", " ", 
              RowBox[{"PlotStyle", "\[Rule]", "Blue"}], ",", "  ", 
              RowBox[{"PlotLegends", "\[Rule]", " ", 
               RowBox[{"{", "\"\<Bz\>\"", "}"}]}]}], "]"}]}], "]"}], ";"}], 
         ")"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"p", " ", "\[Equal]", " ", "\"\<y\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"radFld", "[", 
                RowBox[{"ID", ",", "\"\<Bx\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"p2", ",", "y", ",", "p3"}], "}"}]}], "]"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"pRange", ",", " ", "BRange"}], "}"}]}], ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<y [mm]\>\"", ",", "\"\<Bx[T]\>\""}], "}"}]}], 
              ",", " ", 
              RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", "  ", 
              RowBox[{"PlotLegends", "\[Rule]", " ", 
               RowBox[{"{", "\"\<Bx\>\"", "}"}]}]}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"radFld", "[", 
                RowBox[{"ID", ",", "\"\<By\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"p2", ",", "y", ",", "p3"}], "}"}]}], "]"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"pRange", ",", "  ", "BRange"}], "}"}]}], ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<y [mm]\>\"", ",", "\"\<By[T]\>\""}], "}"}]}], 
              ",", " ", 
              RowBox[{"PlotStyle", "\[Rule]", "Green"}], ",", "  ", 
              RowBox[{"PlotLegends", "\[Rule]", " ", 
               RowBox[{"{", "\"\<By\>\"", "}"}]}]}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"radFld", "[", 
                RowBox[{"ID", ",", "\"\<Bz\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"p2", ",", "y", ",", "p3"}], "}"}]}], "]"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"pRange", ",", "BRange"}], "}"}]}], ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<y [mm]\>\"", ",", "\"\<Bz[T]\>\""}], "}"}]}], 
              ",", " ", 
              RowBox[{"PlotStyle", "\[Rule]", "Blue"}], ",", "  ", 
              RowBox[{"PlotLegends", "\[Rule]", " ", 
               RowBox[{"{", "\"\<Bz\>\"", "}"}]}]}], "]"}]}], "]"}], ";"}], 
         ")"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"p", " ", "\[Equal]", " ", "\"\<z\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"radFld", "[", 
                RowBox[{"ID", ",", "\"\<Bx\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"p2", ",", "p3", ",", "z"}], "}"}]}], "]"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"z", ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"pRange", ",", " ", "BRange"}], "}"}]}], ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<z [mm]\>\"", ",", "\"\<Bx[T]\>\""}], "}"}]}], 
              ",", " ", 
              RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", "  ", 
              RowBox[{"PlotLegends", "\[Rule]", " ", 
               RowBox[{"{", "\"\<Bx\>\"", "}"}]}]}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"radFld", "[", 
                RowBox[{"ID", ",", "\"\<By\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"p2", ",", "p3", ",", "z"}], "}"}]}], "]"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"z", ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"pRange", ",", "  ", "BRange"}], "}"}]}], ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<z [mm]\>\"", ",", "\"\<By[T]\>\""}], "}"}]}], 
              ",", " ", 
              RowBox[{"PlotStyle", "\[Rule]", "Green"}], ",", "  ", 
              RowBox[{"PlotLegends", "\[Rule]", " ", 
               RowBox[{"{", "\"\<By\>\"", "}"}]}]}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"radFld", "[", 
                RowBox[{"ID", ",", "\"\<Bz\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{"p2", ",", "p3", ",", "z"}], "}"}]}], "]"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"z", ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"pRange", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PlotRange", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"pRange", ",", "BRange"}], "}"}]}], ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<z [mm]\>\"", ",", "\"\<Bz[T]\>\""}], "}"}]}], 
              ",", " ", 
              RowBox[{"PlotStyle", "\[Rule]", "Blue"}], ",", "  ", 
              RowBox[{"PlotLegends", "\[Rule]", " ", 
               RowBox[{"{", "\"\<Bz\>\"", "}"}]}]}], "]"}]}], "]"}], ";"}], 
         ")"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", " ", "Silent"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<IDPlotFields: elapsed time = \>\"", ",", 
           RowBox[{"(", 
            RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "plots", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7674474943805976`*^9, 3.767447507209737*^9}, 
   3.7674475635600443`*^9, {3.767447820092058*^9, 3.767447829967826*^9}, {
   3.7826561255566607`*^9, 3.7826561994021025`*^9}, {3.7826562490425296`*^9, 
   3.7826562914642067`*^9}, {3.8119938559702997`*^9, 3.811993875414157*^9}, {
   3.8119940298393707`*^9, 3.8119940361520557`*^9}, {3.815746982764694*^9, 
   3.815747004835119*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[11]:=",ExpressionUUID->"bd41ff99-499b-46be-91ce-555d82436805"]
}, Closed]],

Cell[CellGroupData[{

Cell["IDFieldIntegrals", "Subsection",
 CellChangeTimes->{
  3.7667548688726835`*^9},ExpressionUUID->"bb19f30a-f850-414b-b3be-\
1dd929f5855c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IDFieldIntegrals", "::", "usage"}], " ", "=", " ", 
    "\"\<IDFieldIntegrals[ID, field, yrange, ny]: Returns the first and \
second magnetic field integrals. The unit is G.cm for the first integral and \
T.cm\.b2 for the second integral.\>\""}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDFieldIntegrals", "[", 
    RowBox[{
    "ID_", ",", " ", "field_", ",", " ", "lrange_", ",", " ", "nl_", ",", " ", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"{", 
       RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "False"}], "}"}], "]"}]}], 
    "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "llist", ",", " ", "firstintlist", ",", " ", "i", ",", " ", "sfl", ",", 
       " ", "firstint", ",", " ", "secondint", ",", " ", "t0", ",", " ", "t1",
        ",", " ", "Silent"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t0", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Silent", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Silent\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"firstint", " ", "=", " ", 
       RowBox[{"radFldInt", "[", 
        RowBox[{"ID", ",", "\"\<fin\>\"", ",", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"\"\<i\>\"", ",", " ", "field"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0", ",", "  ", 
           RowBox[{"lrange", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0", ",", " ", 
           RowBox[{"lrange", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"llist", " ", "=", " ", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{"#", "&"}], ",", "nl", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"lrange", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"lrange", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"sfl", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"firstintlist", " ", "=", " ", 
       RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", " ", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", " ", 
        RowBox[{"i", "\[LessEqual]", " ", 
         RowBox[{
          RowBox[{"Length", "[", "llist", "]"}], "-", "1"}]}], ",", " ", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sfl", " ", "=", " ", 
          RowBox[{"sfl", " ", "+", " ", 
           RowBox[{"radFldInt", "[", 
            RowBox[{"ID", ",", "\"\<fin\>\"", ",", 
             RowBox[{"StringJoin", "[", 
              RowBox[{"\"\<i\>\"", ",", " ", "field"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "  ", 
               RowBox[{"llist", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "  ", "0", ",", " ", 
               RowBox[{"llist", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"firstintlist", ",", " ", "sfl"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"secondint", " ", "=", " ", 
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Interpolation", "[", 
           RowBox[{
            RowBox[{"Transpose", "@", 
             RowBox[{"{", 
              RowBox[{"llist", ",", " ", "firstintlist"}], "}"}]}], ",", " ", 
            RowBox[{"InterpolationOrder", "\[Rule]", "3"}]}], "]"}], "[", "u",
           "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"u", ",", " ", 
           RowBox[{"lrange", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
           RowBox[{"lrange", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"firstint", " ", "=", " ", 
       RowBox[{"firstint", "*", "1000"}]}], " ", ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"[", 
         RowBox[{"T", ".", "mm"}], "]"}], " ", "\[Rule]", " ", 
        RowBox[{"[", 
         RowBox[{"G", ".", "cm"}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"secondint", " ", "=", " ", 
       RowBox[{"secondint", "*", "100"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"[", 
         RowBox[{"T", ".", "mm\.b2"}], "]"}], " ", "\[Rule]", " ", 
        RowBox[{"[", 
         RowBox[{"G", ".", "cm\.b2"}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", " ", "Silent"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "field", ",", " ", "\"\< First integral: \>\"", ",", " ", 
           "firstint", ",", "\"\< G.cm\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "field", ",", " ", "\"\< Second integral: \>\"", ",", " ", 
           "secondint", ",", "\"\< G.cm\.b2\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<IDFieldIntegrals: elapsed time = \>\"", ",", 
           RowBox[{"(", 
            RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"firstint", ",", " ", "secondint"}], "}"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.767447519038801*^9, 3.7674475570126853`*^9}, {
  3.7674478527196264`*^9, 3.767447856876173*^9}, {3.7674486002357836`*^9, 
  3.7674486471790524`*^9}, {3.782655379174*^9, 3.782655472079883*^9}, {
  3.782655523001548*^9, 3.78265553242339*^9}, {3.8062342296637506`*^9, 
  3.8062342486693964`*^9}, {3.815745479423485*^9, 3.8157455231570635`*^9}, {
  3.8157508495658913`*^9, 3.815750856466805*^9}, {3.8157532035553007`*^9, 
  3.815753204065875*^9}, {3.8157566108675365`*^9, 3.81575661141105*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[13]:=",ExpressionUUID->"24664741-e07d-4598-8b68-6b4113008b82"]
}, Closed]],

Cell[CellGroupData[{

Cell["IDFieldIntegralsFast", "Subsection",
 CellChangeTimes->{
  3.7667548688726835`*^9, {3.816633593553114*^9, 3.8166335941013985`*^9}, {
   3.8167015223022566`*^9, 3.8167015224939375`*^9}, {3.816879986192546*^9, 
   3.8168799863306847`*^9}},ExpressionUUID->"cdeaf6fe-40fd-4cda-8432-\
a30fc6389d80"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IDFieldIntegralsFast", "::", "usage"}], " ", "=", " ", 
    "\"\<IDFieldIntegralsFast[ID, field, yrange, ny]: Returns the first and \
second magnetic field integrals. The unit is G.cm for the first integral and \
T.cm\.b2 for the second integral.\>\""}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDFieldIntegralsFast", "[", 
    RowBox[{
    "ID_", ",", " ", "field_", ",", " ", "lrange_", ",", " ", "nl_", ",", " ", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"{", 
       RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "False"}], "}"}], "]"}]}], 
    "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "llist", ",", " ", "firstintlist", ",", " ", "i", ",", " ", "firstint", 
       ",", " ", "secondint", ",", " ", "t0", ",", " ", "t1", ",", " ", 
       "Silent", ",", " ", "lstep", ",", " ", "IB", ",", " ", "IIB", ",", " ",
        "B", ",", " ", "ibsum", ",", " ", "iibsum"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t0", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Silent", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Silent\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"lstep", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"lrange", "[", 
           RowBox[{"[", "2", "]"}], "]"}], " ", "-", " ", 
          RowBox[{"lrange", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", "nl"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"IB", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"IIB", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"B", " ", "=", " ", 
       RowBox[{"radFldLst", "[", 
        RowBox[{"ID", ",", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"\"\<i\>\"", ",", " ", "field"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0", ",", "  ", 
           RowBox[{"lrange", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0", ",", " ", 
           RowBox[{"lrange", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", " ", "nl", ",", 
         " ", "\"\<noarg\>\"", ",", " ", 
         RowBox[{"lrange", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"IB", " ", "=", " ", 
       RowBox[{"Accumulate", "[", "B", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"IIB", " ", "=", " ", 
       RowBox[{"Accumulate", "[", "IB", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"IB", " ", "=", " ", 
       RowBox[{"IB", "*", "lstep"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"IIB", " ", "=", " ", 
       RowBox[{"IIB", "*", "lstep", "*", "lstep"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"firstint", " ", "=", " ", 
       RowBox[{
        RowBox[{"IB", "[", 
         RowBox[{"[", 
          RowBox[{"Length", "[", "IB", "]"}], "]"}], "]"}], "*", "1000"}]}], 
      " ", ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"[", 
         RowBox[{"T", ".", "mm"}], "]"}], " ", "\[Rule]", " ", 
        RowBox[{"[", 
         RowBox[{"G", ".", "cm"}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"secondint", " ", "=", 
       RowBox[{
        RowBox[{"IIB", "[", 
         RowBox[{"[", 
          RowBox[{"Length", "[", "IIB", "]"}], "]"}], "]"}], "*", "100"}]}], 
      ";", " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"[", 
         RowBox[{"T", ".", "mm\.b2"}], "]"}], " ", "\[Rule]", " ", 
        RowBox[{"[", 
         RowBox[{"G", ".", "cm\.b2"}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", " ", "Silent"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "field", ",", " ", "\"\< First integral: \>\"", ",", " ", 
           "firstint", ",", "\"\< G.cm\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "field", ",", " ", "\"\< Second integral: \>\"", ",", " ", 
           "secondint", ",", "\"\< G.cm\.b2\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<IDFieldIntegrals: elapsed time = \>\"", ",", 
           RowBox[{"(", 
            RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"firstint", ",", " ", "secondint"}], "}"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.767447519038801*^9, 3.7674475570126853`*^9}, {
  3.7674478527196264`*^9, 3.767447856876173*^9}, {3.7674486002357836`*^9, 
  3.7674486471790524`*^9}, {3.782655379174*^9, 3.782655472079883*^9}, {
  3.782655523001548*^9, 3.78265553242339*^9}, {3.8062342296637506`*^9, 
  3.8062342486693964`*^9}, {3.815745479423485*^9, 3.8157455231570635`*^9}, {
  3.8157508495658913`*^9, 3.815750856466805*^9}, {3.8157532035553007`*^9, 
  3.815753204065875*^9}, {3.8157566108675365`*^9, 3.81575661141105*^9}, {
  3.816633607601183*^9, 3.8166336118684316`*^9}, {3.81663364247663*^9, 
  3.816633850091959*^9}, {3.8167015271529093`*^9, 3.8167015653895493`*^9}, {
  3.8168799883918858`*^9, 3.816879993142429*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[15]:=",ExpressionUUID->"a88e2988-4885-46a3-ab3f-cbf916edb31d"]
}, Closed]],

Cell[CellGroupData[{

Cell["IDFieldPhase", "Subsection",
 CellChangeTimes->{
  3.7667548688726835`*^9, {3.814004773706389*^9, 
   3.8140047880793447`*^9}},ExpressionUUID->"c7130cda-35d4-4dfa-aec2-\
ed9d1e576d19"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IDFieldPhase", "::", "usage"}], " ", "=", " ", 
    "\"\<IDFieldPhase[ID, lrange, nl]: Returns the phase between By and Bx \
[radians].\>\""}], ";"}], " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDFieldPhase", "[", 
    RowBox[{"ID_", ",", "lrange_", ",", " ", "nl_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "bx", ",", " ", "by", ",", " ", "phase", ",", "  ", "fftx", ",", " ", 
       "ffty", ",", " ", "max", ",", " ", "pos", ",", "  ", "t0", ",", " ", 
       "t1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t0", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"bx", " ", "=", " ", 
       RowBox[{"radFldLst", "[", 
        RowBox[{"ID", ",", " ", "\"\<bx\>\"", ",", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0", ",", " ", 
           RowBox[{"lrange", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0", ",", " ", 
           RowBox[{"lrange", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", " ", "nl", ",", 
         " ", "\"\<noarg\>\"", ",", " ", 
         RowBox[{"lrange", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"by", " ", "=", " ", 
       RowBox[{"radFldLst", "[", 
        RowBox[{"ID", ",", " ", "\"\<by\>\"", ",", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0", ",", " ", 
           RowBox[{"lrange", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0", ",", " ", 
           RowBox[{"lrange", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", " ", "nl", ",", " ",
          "\"\<noarg\>\"", ",", " ", 
         RowBox[{"lrange", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"fftx", "=", 
       RowBox[{"Fourier", "[", 
        RowBox[{"bx", ",", 
         RowBox[{"FourierParameters", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ffty", "=", 
       RowBox[{"Fourier", "[", 
        RowBox[{"by", ",", 
         RowBox[{"FourierParameters", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"max", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Abs", "[", "ffty", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"First", "[", 
        RowBox[{"First", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Abs", "[", "ffty", "]"}], ",", "max"}], "]"}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phase", " ", "=", " ", 
       RowBox[{
        RowBox[{"Arg", "[", 
         RowBox[{"ffty", "[", 
          RowBox[{"[", "pos", "]"}], "]"}], "]"}], "-", 
        RowBox[{"Arg", "[", 
         RowBox[{"fftx", "[", 
          RowBox[{"[", "pos", "]"}], "]"}], "]"}]}]}], ";", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<IDFieldPhase: elapsed time = \>\"", ",", 
        RowBox[{"(", 
         RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "phase", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.767447519038801*^9, 3.7674475570126853`*^9}, {
  3.7674478527196264`*^9, 3.767447856876173*^9}, {3.7674486002357836`*^9, 
  3.7674486471790524`*^9}, {3.782655379174*^9, 3.782655472079883*^9}, {
  3.782655523001548*^9, 3.78265553242339*^9}, {3.8062342296637506`*^9, 
  3.8062342486693964`*^9}, {3.8140047791487875`*^9, 3.8140048030103016`*^9}, {
  3.814004846343008*^9, 3.8140050344263144`*^9}, {3.8140051047107515`*^9, 
  3.814005147863482*^9}, {3.81400575161285*^9, 3.814005757983315*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[17]:=",ExpressionUUID->"aa4fa799-86cd-462b-b44a-5bf06a051ea2"]
}, Closed]],

Cell[CellGroupData[{

Cell["IDFieldMap", "Subsection",
 CellChangeTimes->{{3.7667548871084976`*^9, 3.76675490671941*^9}, 
   3.767449882481743*^9, 
   3.7826556381260996`*^9},ExpressionUUID->"316b54f4-260c-4ab7-bc23-\
0da6dd39fb46"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IDFieldMap", "::", "usage"}], " ", "=", " ", 
    "\"\<IDFieldMapNoTransf[fieldmapname, ID, xrange, yrange, zrange, nx, ny, \
nz]: Writes the fieldmap to file.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDFieldMap", "[", 
    RowBox[{
    "fieldmapname_", ",", " ", "ID_", ",", "xrange_", ",", " ", "yrange_", 
     ",", " ", "zrange_", ",", " ", "nx_", ",", " ", "ny_", ",", " ", "nz_"}],
     " ", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "fieldmap", ",", " ", "hmin", ",", " ", "hmax", ",", " ", "vmin", ",", 
       " ", "vmax", ",", " ", "smin", ",", " ", "smax", ",", "nh", ",", " ", 
       "nv", ",", " ", "ns", ",", " ", "hstep", ",", " ", "vstep", ",", " ", 
       "sstep", ",", " ", "h", ",", " ", "v", ",", " ", "s", ",", "  ", "i", 
       ",", " ", "j", ",", " ", "k", ",", "field", ",", " ", "line", ",", " ",
        "t0", ",", " ", "t1"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t0", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"fieldmap", "=", 
       RowBox[{"OpenWrite", "[", "fieldmapname", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"hmin", " ", "=", 
       RowBox[{"xrange", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"hmax", " ", "=", 
       RowBox[{"xrange", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nh", " ", "=", " ", "nx"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"vmin", " ", "=", 
       RowBox[{"yrange", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vmax", " ", "=", 
       RowBox[{"yrange", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nv", " ", "=", " ", "ny"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"smin", " ", "=", 
       RowBox[{"zrange", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"smax", " ", "=", 
       RowBox[{"zrange", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ns", " ", "=", "nz"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"hmin", " ", "\[NotEqual]", " ", "hmax"}], ")"}], ",", 
        RowBox[{"hstep", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"hmax", "-", "hmin"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"nh", "-", "1"}], ")"}]}]}], ",", " ", 
        RowBox[{"hstep", "=", "0"}]}], " ", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"vmin", " ", "\[NotEqual]", " ", "vmax"}], ")"}], ",", 
        RowBox[{"vstep", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"vmax", "-", "vmin"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"nv", "-", "1"}], ")"}]}]}], ",", " ", 
        RowBox[{"vstep", "=", "0"}]}], " ", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"smin", " ", "\[NotEqual]", " ", "smax"}], ")"}], ",", 
        RowBox[{"sstep", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"smax", "-", "smin"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"ns", "-", "1"}], ")"}]}]}], ",", " ", 
        RowBox[{"sstep", "=", "0"}]}], " ", "]"}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", " ", 
        RowBox[{
        "\"\<X[mm]\>\"", "<>", " ", "\"\<\\t\>\"", "<>", " ", "\"\<Y[mm]\>\"",
          "<>", " ", "\"\<\\t\>\"", "<>", " ", "\"\<Z[mm]\>\"", "<>", " ", 
         "\"\<\\t\>\"", "<>", " ", "\"\<Bx[T]\>\"", "<>", " ", "\"\<\\t\>\"", 
         "<>", " ", "\"\<By[T]\>\"", "<>", " ", "\"\<\\t\>\"", "<>", " ", 
         "\"\<Bz[T]\>\"", "<>", "\"\<\\n\>\""}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{
       "fieldmap", ",", 
        "\"\<-----------------------------------------------------------------\
------------------------------------------------------------------------------\
-------------------\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "1"}], ",", 
        RowBox[{"k", "\[LessEqual]", "ns"}], ",", 
        RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", "nv"}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"i", "=", "1"}], ",", 
              RowBox[{"i", "\[LessEqual]", "nh"}], ",", 
              RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"h", " ", "=", " ", 
                RowBox[{"hmin", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"i", "-", "1"}], ")"}], "*", "hstep"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"v", " ", "=", " ", 
                RowBox[{"vmax", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"j", "-", "1"}], ")"}], "*", "vstep"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"s", " ", "=", " ", 
                RowBox[{"smin", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"k", "-", "1"}], ")"}], "*", "sstep"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"field", " ", "=", " ", 
                RowBox[{"radFld", "[", 
                 RowBox[{"ID", ",", "\"\<b\>\"", ",", 
                  RowBox[{"{", 
                   RowBox[{"h", ",", "v", ",", " ", "s"}], "}"}]}], "]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"line", " ", "=", 
                RowBox[{
                 RowBox[{"auxIDNumberToString", "[", "h", "]"}], "<>", " ", 
                 "\"\<\\t\>\"", " ", "<>", " ", 
                 RowBox[{"auxIDNumberToString", "[", "v", "]"}], " ", "<>", 
                 " ", "\"\<\\t\>\"", " ", "<>", " ", 
                 RowBox[{"auxIDNumberToString", "[", "s", "]"}], " ", "<>", 
                 "\"\<\\t\>\"", " ", "<>", " ", 
                 RowBox[{"auxIDNumberToString", "[", 
                  RowBox[{"field", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "<>", " ", 
                 "\"\<\\t\>\"", " ", "<>", "  ", 
                 RowBox[{"auxIDNumberToString", "[", 
                  RowBox[{"field", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", " ", 
                 "\"\<\\t\>\"", " ", "<>", "  ", 
                 RowBox[{"auxIDNumberToString", "[", 
                  RowBox[{"field", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", 
                 "\"\<\\n\>\""}]}], "  ", ";", " ", "\[IndentingNewLine]", 
               RowBox[{"WriteString", "[", 
                RowBox[{"fieldmap", ",", "line"}], "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Close", "[", "fieldmap", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Fieldmap saved in file: \>\"", ",", " ", "fieldmapname"}],
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<IDFieldMap: elapsed time = \>\"", ",", 
        RowBox[{"(", 
         RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.767447676712742*^9, 3.7674476901356754`*^9}, {
   3.767447877752833*^9, 3.7674478819250393`*^9}, {3.7674498877634153`*^9, 
   3.7674499000768747`*^9}, {3.782655619766797*^9, 3.7826556288292556`*^9}, {
   3.7826568647102003`*^9, 3.782656886835105*^9}, 3.784621350331092*^9},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[19]:=",ExpressionUUID->"40008148-2423-4d1a-aa09-6e0b7f4651d7"]
}, Closed]],

Cell[CellGroupData[{

Cell["IDFieldMapWithHeader", "Subsection",
 CellChangeTimes->{{3.7667548871084976`*^9, 3.76675490671941*^9}, 
   3.767449882481743*^9, 3.7826556381260996`*^9, {3.820132820008762*^9, 
   3.820132822768936*^9}},ExpressionUUID->"b5d71522-78aa-4e39-b901-\
2b1c796bfe78"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IDFieldMapWithHeader", "::", "usage"}], " ", "=", " ", 
    "\"\<IDFieldMapWithHeader[ID, xrange, yrange, zrange, nx, ny, nz, \
magnetname, polarization, magnetlength, phaselabel, \[Lambda]u, Gap, \
\[Delta]P, \[Delta]GV, \[Delta]GH, \[Delta]CP]: Writes the fieldmap to \
file.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDFieldMapWithHeader", "[", 
    RowBox[{
    "ID_", ",", " ", "xrange_", ",", " ", "yrange_", ",", " ", "zrange_", ",",
      " ", "nx_", ",", " ", "ny_", ",", " ", "nz_", ",", "magnetname_", ",", 
     " ", "polarization_", ",", "phasename_", ",", "  ", "magnetlength_", ",",
      "\[Lambda]u_", ",", " ", "Gap_", ",", "  ", "\[Delta]P_", ",", " ", 
     "\[Delta]GV_", ",", " ", "\[Delta]GH_", ",", " ", "\[Delta]CP_"}], "]"}],
    " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "fieldmap", ",", " ", "fieldmapname", ",", " ", "date", ",", "  ", 
       "timestamp", ",", "  ", "hmin", ",", " ", "hmax", ",", " ", "vmin", 
       ",", " ", "vmax", ",", " ", "smin", ",", " ", "smax", ",", "nh", ",", 
       " ", "nv", ",", " ", "ns", ",", " ", "hstep", ",", " ", "vstep", ",", 
       " ", "sstep", ",", " ", "h", ",", " ", "v", ",", " ", "s", ",", "  ", 
       "i", ",", " ", "j", ",", " ", "k", ",", "field", ",", " ", "line", ",",
        " ", "t0", ",", " ", "t1", ",", " ", "Bh", ",", " ", "Bv", ",", " ", 
       "Kh", ",", " ", "Kv", ",", " ", "K", ",", " ", "PosURC", ",", " ", 
       "PosULC", ",", " ", "PosBLC", ",", " ", "PosBRC"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t0", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"date", " ", "=", " ", 
       RowBox[{"DateString", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Year\>\"", ",", "\"\<-\>\"", ",", "\"\<Month\>\"", ",", 
          "\"\<-\>\"", ",", "\"\<Day\>\""}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"timestamp", " ", "=", " ", 
       RowBox[{"date", " ", "<>", "\"\<_\>\"", "<>", " ", 
        RowBox[{"DateString", "[", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Hour24\>\"", ",", "\"\<-\>\"", ",", "\"\<Minute\>\"", ",", 
           "\"\<-\>\"", ",", " ", "\"\<Second\>\""}], "}"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"PosURC", " ", "=", "\[Delta]GV"}], ";", "\[IndentingNewLine]", 
      RowBox[{"PosULC", " ", "=", " ", 
       RowBox[{
       "\[Delta]GV", "+", " ", "\[Delta]GH", "+", " ", "\[Delta]P", "+", 
        "\[Delta]CP"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"PosBLC", " ", "=", "\[Delta]GH"}], ";", "\[IndentingNewLine]", 
      RowBox[{"PosBRC", " ", "=", 
       RowBox[{"\[Delta]P", "-", "\[Delta]CP"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"Bh", " ", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{"radFldLst", "[", 
          RowBox[{"ID", ",", " ", "\"\<Bx\>\"", ",", " ", 
           RowBox[{"{", " ", 
            RowBox[{"0", ",", "0", ",", " ", 
             RowBox[{"-", "\[Lambda]u"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "\[Lambda]u"}], "}"}], ",", " ", 
           "100", ",", " ", "\"\<noarg\>\"", ",", " ", 
           RowBox[{"-", "\[Lambda]u"}]}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Bv", " ", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{"radFldLst", "[", 
          RowBox[{"ID", ",", " ", "\"\<By\>\"", ",", " ", 
           RowBox[{"{", " ", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "\[Lambda]u"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "\[Lambda]u"}], "}"}], ",", " ", 
           "100", ",", " ", "\"\<noarg\>\"", ",", " ", 
           RowBox[{"-", "\[Lambda]u"}]}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Kh", " ", "=", " ", 
       RowBox[{"0.934", "*", "Bv", "*", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]u", "/", "10"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Kv", " ", "=", " ", 
       RowBox[{"0.934", "*", "Bh", "*", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]u", "/", "10"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"K", " ", "=", " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"Kh", "^", "2"}], " ", "+", " ", 
         RowBox[{"Kv", "^", "2"}]}], " ", "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"Kh", " ", "=", " ", 
       RowBox[{"Round", "[", 
        RowBox[{"Kh", ",", " ", "0.01"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Kv", "=", " ", 
       RowBox[{"Round", "[", 
        RowBox[{"Kv", ",", " ", "0.01"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"K", " ", "=", " ", 
       RowBox[{"Round", "[", 
        RowBox[{"K", ",", " ", "0.01"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"fieldmapname", " ", "=", 
       RowBox[{
        RowBox[{
        "StringTemplate", "[", 
         "\"\<`1`_`2`_`3`_Kh=`4`_Kv=`5`_Z=`6`_`7`mm\>\"", "]"}], "[", 
        RowBox[{
        "date", ",", " ", "magnetname", ",", " ", "polarization", ",", " ", 
         "Kh", ",", " ", "Kv", ",", " ", 
         RowBox[{"zrange", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
         RowBox[{"zrange", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], " ", ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringLength", "[", "phasename", "]"}], " ", "\[NotEqual]", 
         " ", "0"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{"fieldmapname", " ", "=", " ", 
         RowBox[{
         "fieldmapname", " ", "<>", " ", "\"\<_\>\"", " ", "<>", " ", 
          "phasename", "<>", " ", "\"\<.fld\>\""}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"fieldmapname", " ", "=", " ", 
         RowBox[{"fieldmapname", "  ", "<>", " ", "\"\<.fld\>\""}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"fieldmap", "=", 
       RowBox[{"OpenWrite", "[", "fieldmapname", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<timestamp:\\t`1`\\n\>\"", "]"}], 
        "[", "timestamp", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<filename:\\t`1`\\n\>\"", "]"}], 
        "[", "fieldmapname", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<magnet_name:\\t`1`\\n\>\"", "]"}],
         "[", "magnetname", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<gap[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "Gap", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{
        "StringTemplate", "[", "\"\<period_length[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "\[Lambda]u", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{
        "StringTemplate", "[", "\"\<magnet_length[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "magnetlength", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<dP[mm]:\\t\\t`1`\\n\>\"", "]"}], 
        "[", "\[Delta]P", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<dGV[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "\[Delta]GV", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<dGH[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "\[Delta]GH", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<dCP[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "\[Delta]CP", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<posURC[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "PosURC", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<posULC[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "PosULC", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<posBRC[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "PosBRC", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<posBLC[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "PosBLC", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{
        "StringTemplate", "[", "\"\<K_Horizontal:\\t`1`\\n\>\"", "]"}], "[", 
        "Kh", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<K_Vertical:\\t`1`\\n\>\"", "]"}], 
        "[", "Kv", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<K:\\t\\t`1`\\n\>\"", "]"}], "[", 
        "K", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", "\"\<\\n\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"hmin", " ", "=", 
       RowBox[{"xrange", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"hmax", " ", "=", 
       RowBox[{"xrange", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nh", " ", "=", " ", "nx"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"vmin", " ", "=", 
       RowBox[{"yrange", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vmax", " ", "=", 
       RowBox[{"yrange", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nv", " ", "=", " ", "ny"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"smin", " ", "=", 
       RowBox[{"zrange", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"smax", " ", "=", 
       RowBox[{"zrange", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ns", " ", "=", "nz"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"hmin", " ", "\[NotEqual]", " ", "hmax"}], ")"}], ",", 
        RowBox[{"hstep", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"hmax", "-", "hmin"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"nh", "-", "1"}], ")"}]}]}], ",", " ", 
        RowBox[{"hstep", "=", "0"}]}], " ", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"vmin", " ", "\[NotEqual]", " ", "vmax"}], ")"}], ",", 
        RowBox[{"vstep", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"vmax", "-", "vmin"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"nv", "-", "1"}], ")"}]}]}], ",", " ", 
        RowBox[{"vstep", "=", "0"}]}], " ", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"smin", " ", "\[NotEqual]", " ", "smax"}], ")"}], ",", 
        RowBox[{"sstep", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"smax", "-", "smin"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"ns", "-", "1"}], ")"}]}]}], ",", " ", 
        RowBox[{"sstep", "=", "0"}]}], " ", "]"}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"fieldmap", ",", " ", 
        RowBox[{
        "\"\<X[mm]\>\"", "<>", " ", "\"\<\\t\>\"", "<>", " ", "\"\<Y[mm]\>\"",
          "<>", " ", "\"\<\\t\>\"", "<>", " ", "\"\<Z[mm]\>\"", "<>", " ", 
         "\"\<\\t\>\"", "<>", " ", "\"\<Bx[T]\>\"", "<>", " ", "\"\<\\t\>\"", 
         "<>", " ", "\"\<By[T]\>\"", "<>", " ", "\"\<\\t\>\"", "<>", " ", 
         "\"\<Bz[T]\>\"", "<>", "\"\<\\n\>\""}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{
       "fieldmap", ",", 
        "\"\<-----------------------------------------------------------------\
------------------------------------------------------------------------------\
-------------------\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "1"}], ",", 
        RowBox[{"k", "\[LessEqual]", "ns"}], ",", 
        RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", "nv"}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"i", "=", "1"}], ",", 
              RowBox[{"i", "\[LessEqual]", "nh"}], ",", 
              RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"h", " ", "=", " ", 
                RowBox[{"hmin", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"i", "-", "1"}], ")"}], "*", "hstep"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"v", " ", "=", " ", 
                RowBox[{"vmax", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"j", "-", "1"}], ")"}], "*", "vstep"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"s", " ", "=", " ", 
                RowBox[{"smin", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"k", "-", "1"}], ")"}], "*", "sstep"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"field", " ", "=", " ", 
                RowBox[{"radFld", "[", 
                 RowBox[{"ID", ",", "\"\<b\>\"", ",", 
                  RowBox[{"{", 
                   RowBox[{"h", ",", "v", ",", " ", "s"}], "}"}]}], "]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"line", " ", "=", 
                RowBox[{
                 RowBox[{"auxIDNumberToString", "[", "h", "]"}], "<>", " ", 
                 "\"\<\\t\>\"", " ", "<>", " ", 
                 RowBox[{"auxIDNumberToString", "[", "v", "]"}], " ", "<>", 
                 " ", "\"\<\\t\>\"", " ", "<>", " ", 
                 RowBox[{"auxIDNumberToString", "[", "s", "]"}], " ", "<>", 
                 "\"\<\\t\>\"", " ", "<>", " ", 
                 RowBox[{"auxIDNumberToString", "[", 
                  RowBox[{"field", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "<>", " ", 
                 "\"\<\\t\>\"", " ", "<>", "  ", 
                 RowBox[{"auxIDNumberToString", "[", 
                  RowBox[{"field", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", " ", 
                 "\"\<\\t\>\"", " ", "<>", "  ", 
                 RowBox[{"auxIDNumberToString", "[", 
                  RowBox[{"field", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "]"}], "<>", 
                 "\"\<\\n\>\""}]}], "  ", ";", " ", "\[IndentingNewLine]", 
               RowBox[{"WriteString", "[", 
                RowBox[{"fieldmap", ",", "line"}], "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Close", "[", "fieldmap", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Fieldmap saved in file: \>\"", ",", " ", "fieldmapname"}],
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<IDFieldMap: elapsed time = \>\"", ",", 
        RowBox[{"(", 
         RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.767447676712742*^9, 3.7674476901356754`*^9}, {
   3.767447877752833*^9, 3.7674478819250393`*^9}, {3.7674498877634153`*^9, 
   3.7674499000768747`*^9}, {3.782655619766797*^9, 3.7826556288292556`*^9}, {
   3.7826568647102003`*^9, 3.782656886835105*^9}, 3.784621350331092*^9, {
   3.8201328287093325`*^9, 3.8201328301894054`*^9}, {3.8201475833268857`*^9, 
   3.82014772475784*^9}, {3.820147903479143*^9, 3.8201479195002623`*^9}, {
   3.8201479575827456`*^9, 3.8201480152565284`*^9}, {3.820148073780411*^9, 
   3.820148094041765*^9}, {3.8201481578859253`*^9, 3.8201484002139997`*^9}, {
   3.820148442706847*^9, 3.8201489300314655`*^9}, {3.8201489649837694`*^9, 
   3.820148998295968*^9}, {3.8201490518994956`*^9, 3.82014945269989*^9}, {
   3.820149575878006*^9, 3.8201496158606415`*^9}, {3.8201496684041023`*^9, 
   3.8201497274780054`*^9}, {3.8201497623102913`*^9, 
   3.8201497783813515`*^9}, {3.8201499985877542`*^9, 3.820150017769049*^9}, {
   3.820150256796426*^9, 3.820150324490906*^9}, {3.82015038955519*^9, 
   3.820150396285636*^9}, {3.820150623392577*^9, 3.8201506453240223`*^9}, {
   3.8201507623230314`*^9, 3.8201507878947144`*^9}, 3.820151721795121*^9, {
   3.820152623918645*^9, 3.82015263157914*^9}, 3.8201528026126175`*^9, {
   3.8201537926163034`*^9, 3.8201537940663977`*^9}, {3.8201569443179674`*^9, 
   3.8201569486982536`*^9}, {3.8202203671869135`*^9, 3.820220375416733*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[21]:=",ExpressionUUID->"1691ba71-b213-4cf8-94e8-cd5d10f95e49"]
}, Closed]],

Cell[CellGroupData[{

Cell["IDRungeKuttaTrajectory", "Subsection",
 CellChangeTimes->{{3.7667548871084976`*^9, 3.76675490671941*^9}, 
   3.7667549708182*^9},ExpressionUUID->"dc98927d-e916-471e-b538-f605e04d23e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IDRungeKuttaTrajectory", "::", "usage"}], " ", "=", " ", 
    "\"\<IDRungeKuttaTrajectory[ID, energy, r0, smax, rkstep]: Calculates the \
particle trajectory using the Runge-Kutta algorithm. The particle energy must \
be in GeV, r0 is the initial position and normalized momentum vector {x0, y0, \
z0, dx0ds, dy0ds, dz0ds}, smax and rkstep are the final longitudinal position \
and the Runge-Kutta step. All positions are in millimeters.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDRungeKuttaTrajectory", "[", 
    RowBox[{
    "ID_", ",", " ", "energy_", ",", "r0_", ",", "smax_", ",", "rkstep_"}], 
    "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "trajectory", ",", " ", "ElectronRestEnergy", ",", " ", "LightSpeed", 
       ",", " ", "beta", ",", " ", "brho", ",", " ", "a", ",", " ", "b", ",", 
       " ", "b1", ",", " ", "b2", ",", " ", "b3", ",", " ", "r", ",", " ", 
       "r1", ",", " ", "r2", ",", " ", "r3", ",", " ", "drds1", ",", " ", 
       "drds2", ",", " ", "drds3", ",", " ", "drds4", ",", " ", "i", ",", " ",
        "sm", ",", " ", "step", ",", " ", "t0", ",", " ", "t1"}], "}"}], ",", 
     "\n", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t0", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"ElectronRestEnergy", "=", "510998.92811"}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"[", "eV", "]"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"LightSpeed", "=", "299792458"}], ";", 
      RowBox[{"(*", 
       RowBox[{"[", 
        RowBox[{"m", "/", "s"}], "]"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"r1", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"r2", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"r3", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"from", " ", "GeV", " ", "to", " ", "eV"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"beta", "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1.0", "-", 
         RowBox[{"(", 
          RowBox[{"1.0", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"energy", "*", 
               RowBox[{"1000000000", "/", "ElectronRestEnergy"}]}], ")"}], 
             "^", "2"}], ")"}]}], ")"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"brho", "=", 
       RowBox[{"(", 
        RowBox[{"beta", "*", "energy", "*", 
         RowBox[{"1000000000", "/", "LightSpeed"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{
        RowBox[{"1.0", "/", "brho"}], "/", "beta"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"r", "=", " ", "r0"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"from", " ", "mm", " ", "to", " ", "m"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", " ", 
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/", "1000"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "=", " ", 
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "/", "1000"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "=", " ", 
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "/", "1000"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sm", " ", "=", " ", 
       RowBox[{"smax", "/", "1000"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"step", " ", "=", " ", 
       RowBox[{"rkstep", "/", "1000"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"trajectory", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"trajectory", ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "*", "1000"}], ",", " ", 
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "*", "1000"}], ",", " ", 
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "*", "1000"}], ",", " ", 
          RowBox[{"r", "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", " ", 
          RowBox[{"r", "[", 
           RowBox[{"[", "5", "]"}], "]"}], ",", " ", 
          RowBox[{"r", "[", 
           RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"While", " ", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "<", "sm"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"b", "=", 
          RowBox[{"radFld", "[", 
           RowBox[{"ID", ",", " ", "\"\<BxByBz\>\"", ",", " ", 
            RowBox[{"1000", "*", 
             RowBox[{"r", "[", 
              RowBox[{"[", 
               RowBox[{";;", "3"}], "]"}], "]"}]}]}], "]"}]}], ";", "\n", 
         "\t", 
         RowBox[{"drds1", "=", 
          RowBox[{"auxIDNewtonLorentzEquation", "[", 
           RowBox[{"a", ",", "r", ",", "b"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", " ", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", " ", 
           RowBox[{"i", "\[LessEqual]", "6"}], ",", " ", 
           RowBox[{"i", "++"}], ",", 
           RowBox[{
            RowBox[{"r1", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"r", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"step", "/", "2.0"}], ")"}], "*", 
              RowBox[{"drds1", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"b1", "=", 
          RowBox[{"radFld", "[", 
           RowBox[{"ID", ",", " ", "\"\<BxByBz\>\"", ",", " ", 
            RowBox[{"1000", "*", 
             RowBox[{"r1", "[", 
              RowBox[{"[", 
               RowBox[{";;", "3"}], "]"}], "]"}]}]}], "]"}]}], ";", "\n", 
         "\t", 
         RowBox[{"drds2", "=", 
          RowBox[{"auxIDNewtonLorentzEquation", "[", 
           RowBox[{"a", ",", "r1", ",", "b1"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", " ", 
           RowBox[{"i", "\[LessEqual]", "6"}], ",", " ", 
           RowBox[{"i", "++"}], ",", 
           RowBox[{
            RowBox[{"r2", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"r", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"step", "/", "2.0"}], ")"}], "*", 
              RowBox[{"drds2", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"b2", "=", 
          RowBox[{"radFld", "[", 
           RowBox[{"ID", ",", " ", "\"\<BxByBz\>\"", ",", " ", 
            RowBox[{"1000", "*", 
             RowBox[{"r2", "[", 
              RowBox[{"[", 
               RowBox[{";;", "3"}], "]"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"drds3", "=", 
          RowBox[{"auxIDNewtonLorentzEquation", "[", 
           RowBox[{"a", ",", "r2", ",", "b2"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", " ", 
           RowBox[{"i", "\[LessEqual]", " ", "6"}], ",", " ", 
           RowBox[{"i", "++"}], ",", " ", 
           RowBox[{
            RowBox[{"r3", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"r", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", 
             RowBox[{"step", "*", 
              RowBox[{"drds3", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"b3", "=", 
          RowBox[{"radFld", "[", 
           RowBox[{"ID", ",", " ", "\"\<BxByBz\>\"", ",", " ", 
            RowBox[{"1000", "*", 
             RowBox[{"r3", "[", 
              RowBox[{"[", 
               RowBox[{";;", "3"}], "]"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"drds4", "=", 
          RowBox[{"auxIDNewtonLorentzEquation", "[", 
           RowBox[{"a", ",", "r3", ",", "b3"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"For", " ", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", " ", 
           RowBox[{"i", "\[LessEqual]", "6"}], ",", " ", 
           RowBox[{"i", "++"}], ",", " ", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"r", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"step", "/", "6.0"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"drds1", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "+", 
                RowBox[{"2.0", "*", 
                 RowBox[{"drds2", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "+", 
                RowBox[{"2.0", "*", 
                 RowBox[{"drds3", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "+", 
                RowBox[{"drds4", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"trajectory", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"r", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "*", "1000"}], ",", " ", 
             RowBox[{
              RowBox[{"r", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "*", "1000"}], ",", " ", 
             RowBox[{
              RowBox[{"r", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "*", "1000"}], ",", " ", 
             RowBox[{"r", "[", 
              RowBox[{"[", "4", "]"}], "]"}], ",", " ", 
             RowBox[{"r", "[", 
              RowBox[{"[", "5", "]"}], "]"}], ",", " ", 
             RowBox[{"r", "[", 
              RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<IDRungeKuttaTrajectory: elapsed time = \>\"", ",", 
        RowBox[{"(", 
         RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "trajectory", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.76744770185725*^9, 3.767447715061404*^9}, {
  3.7674478894725156`*^9, 3.7674478930665445`*^9}, {3.782655720566373*^9, 
  3.782655720941368*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[23]:=",ExpressionUUID->"494c7822-7765-4f5f-bf96-15e4412f31ad"]
}, Closed]],

Cell[CellGroupData[{

Cell["IDTrajectoryFile", "Subsection",
 CellChangeTimes->{{3.7667548871084976`*^9, 3.76675490671941*^9}, 
   3.767449882481743*^9, 3.7826556381260996`*^9, {3.820132820008762*^9, 
   3.820132822768936*^9}, {3.820151688212949*^9, 
   3.820151693903324*^9}},ExpressionUUID->"ba0c27f7-7afe-4d7f-bf71-\
31b954642dee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IDTrajectoryFile", "::", "usage"}], " ", "=", " ", 
    "\"\<IDTrajectoryFile[ID, energy, r0, smax, rkstep,  xrange, yrange, \
zrange, nx, ny, nz, magnetname, polarization, phasename,  magnetlength, \
\[Lambda]u, Gap, \[Delta]P, \[Delta]GV, \[Delta]GH, \[Delta]CP]: Calculate \
and write the trajectory to file.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDTrajectoryFile", "[", " ", 
    RowBox[{
    "ID_", ",", " ", "energy_", ",", "r0_", ",", "smax_", ",", "rkstep_", ",",
      " ", "magnetname_", ",", " ", "polarization_", ",", "phasename_", ",", 
     "  ", "magnetlength_", ",", "\[Lambda]u_", ",", " ", "Gap_", ",", "  ", 
     "\[Delta]P_", ",", " ", "\[Delta]GV_", ",", " ", "\[Delta]GH_", ",", " ",
      "\[Delta]CP_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "traj", ",", " ", "trajfilename", ",", " ", "trajfile", ",", " ", 
       "date", ",", "  ", "timestamp", ",", "  ", "line", ",", " ", "t0", ",",
        " ", "t1", ",", " ", "Bh", ",", " ", "Bv", ",", " ", "Kh", ",", " ", 
       "Kv", ",", " ", "K", ",", " ", "PosURC", ",", " ", "PosULC", ",", " ", 
       "PosBLC", ",", " ", "PosBRC", ",", " ", "i"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t0", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"traj", " ", "=", " ", 
       RowBox[{"IDRungeKuttaTrajectory", "[", 
        RowBox[{
        "ID", ",", " ", "energy", ",", "r0", ",", "smax", ",", "rkstep"}], 
        "]"}]}], " ", ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"date", " ", "=", " ", 
       RowBox[{"DateString", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Year\>\"", ",", "\"\<-\>\"", ",", "\"\<Month\>\"", ",", 
          "\"\<-\>\"", ",", "\"\<Day\>\""}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"timestamp", " ", "=", " ", 
       RowBox[{"date", " ", "<>", "\"\<_\>\"", "<>", " ", 
        RowBox[{"DateString", "[", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Hour24\>\"", ",", "\"\<-\>\"", ",", "\"\<Minute\>\"", ",", 
           "\"\<-\>\"", ",", " ", "\"\<Second\>\""}], "}"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"PosURC", " ", "=", "\[Delta]GV"}], ";", "\[IndentingNewLine]", 
      RowBox[{"PosULC", " ", "=", " ", 
       RowBox[{
       "\[Delta]GV", "+", " ", "\[Delta]GH", "+", " ", "\[Delta]P", "+", 
        "\[Delta]CP"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"PosBLC", " ", "=", "\[Delta]GH"}], ";", "\[IndentingNewLine]", 
      RowBox[{"PosBRC", " ", "=", 
       RowBox[{"\[Delta]P", "-", "\[Delta]CP"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"Bh", " ", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{"radFldLst", "[", 
          RowBox[{"ID", ",", " ", "\"\<Bx\>\"", ",", " ", 
           RowBox[{"{", " ", 
            RowBox[{"0", ",", "0", ",", " ", 
             RowBox[{"-", "\[Lambda]u"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "\[Lambda]u"}], "}"}], ",", " ", 
           "100", ",", " ", "\"\<noarg\>\"", ",", " ", 
           RowBox[{"-", "\[Lambda]u"}]}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Bv", " ", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{"radFldLst", "[", 
          RowBox[{"ID", ",", " ", "\"\<By\>\"", ",", " ", 
           RowBox[{"{", " ", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "\[Lambda]u"}]}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "\[Lambda]u"}], "}"}], ",", " ", 
           "100", ",", " ", "\"\<noarg\>\"", ",", " ", 
           RowBox[{"-", "\[Lambda]u"}]}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Kh", " ", "=", " ", 
       RowBox[{"0.934", "*", "Bv", "*", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]u", "/", "10"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Kv", " ", "=", " ", 
       RowBox[{"0.934", "*", "Bh", "*", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]u", "/", "10"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"K", " ", "=", " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"Kh", "^", "2"}], " ", "+", " ", 
         RowBox[{"Kv", "^", "2"}]}], " ", "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"Kh", " ", "=", " ", 
       RowBox[{"Round", "[", 
        RowBox[{"Kh", ",", " ", "0.01"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Kv", "=", " ", 
       RowBox[{"Round", "[", 
        RowBox[{"Kv", ",", " ", "0.01"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"K", " ", "=", " ", 
       RowBox[{"Round", "[", 
        RowBox[{"K", ",", " ", "0.01"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"trajfilename", " ", "=", 
       RowBox[{
        RowBox[{
        "StringTemplate", "[", 
         "\"\<`1`_`2`_`3`_Kh=`4`_Kv=`5`_Z=`6`_`7`mm\>\"", "]"}], "[", 
        RowBox[{
        "date", ",", " ", "magnetname", ",", " ", "polarization", ",", " ", 
         "Kh", ",", " ", "Kv", ",", " ", 
         RowBox[{"r0", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", " ", "smax"}], "]"}]}], " ", 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringLength", "[", "phasename", "]"}], " ", "\[NotEqual]", 
         " ", "0"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{"trajfilename", "=", " ", 
         RowBox[{
         "trajfilename", "<>", " ", "\"\<_\>\"", " ", "<>", " ", "phasename", 
          "<>", " ", "\"\<.trj\>\""}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"trajfilename", "=", " ", 
         RowBox[{"trajfilename", "  ", "<>", " ", "\"\<.trj\>\""}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"trajfile", "=", 
       RowBox[{"OpenWrite", "[", "trajfilename", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<timestamp:\\t`1`\\n\>\"", "]"}], 
        "[", "timestamp", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<filename:\\t`1`\\n\>\"", "]"}], 
        "[", "trajfilename", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<magnet_name:\\t`1`\\n\>\"", "]"}],
         "[", "magnetname", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<gap[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "Gap", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{
        "StringTemplate", "[", "\"\<period_length[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "\[Lambda]u", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{
        "StringTemplate", "[", "\"\<magnet_length[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "magnetlength", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<dP[mm]:\\t\\t`1`\\n\>\"", "]"}], 
        "[", "\[Delta]P", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<dGV[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "\[Delta]GV", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<dGH[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "\[Delta]GH", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<dCP[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "\[Delta]CP", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<posURC[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "PosURC", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<posULC[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "PosULC", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<posBRC[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "PosBRC", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<posBLC[mm]:\\t`1`\\n\>\"", "]"}], 
        "[", "PosBLC", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{
        "StringTemplate", "[", "\"\<K_Horizontal:\\t`1`\\n\>\"", "]"}], "[", 
        "Kh", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<K_Vertical:\\t`1`\\n\>\"", "]"}], 
        "[", "Kv", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{"StringTemplate", "[", "\"\<K:\\t\\t`1`\\n\>\"", "]"}], "[", 
        "K", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"line", " ", "=", 
       RowBox[{
        RowBox[{
        "StringTemplate", "[", "\"\<particle_energy[GeV]:\\t`1`\\n\>\"", 
         "]"}], "[", "energy", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "line"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", "\"\<\\n\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{"trajfile", ",", " ", 
        RowBox[{
        "\"\<x[mm]\>\"", "<>", " ", "\"\<\\t\>\"", "<>", " ", "\"\<y[mm]\>\"",
          "<>", " ", "\"\<\\t\>\"", "<>", " ", "\"\<z[mm]\>\"", "<>", " ", 
         "\"\<\\t\>\"", "<>", " ", "\"\<dxds\>\"", "<>", " ", "\"\<\\t\>\"", "<>",
          " ", "\"\<dyds\>\"", "<>", " ", "\"\<\\t\>\"", "<>", " ", 
         "\"\<dzds\>\"", "<>", "\"\<\\n\>\""}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"WriteString", "[", 
       RowBox[{
       "trajfile", ",", 
        "\"\<-----------------------------------------------------------------\
------------------------------------------------------------------------------\
-------------------\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "traj", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"line", " ", "=", 
          RowBox[{
           RowBox[{"auxIDNumberToString", "[", 
            RowBox[{"traj", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "1"}], "]"}], "]"}], "]"}], "<>", " ", 
           "\"\<\\t\>\"", " ", "<>", " ", 
           RowBox[{"auxIDNumberToString", "[", 
            RowBox[{"traj", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "2"}], "]"}], "]"}], "]"}], " ", "<>", 
           " ", "\"\<\\t\>\"", " ", "<>", " ", 
           RowBox[{"auxIDNumberToString", "[", 
            RowBox[{"traj", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "3"}], "]"}], "]"}], "]"}], " ", "<>", 
           "\"\<\\t\>\"", " ", "<>", " ", 
           RowBox[{"auxIDNumberToString", "[", 
            RowBox[{"traj", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "4"}], "]"}], "]"}], "]"}], " ", "<>", 
           " ", "\"\<\\t\>\"", " ", "<>", "  ", 
           RowBox[{"auxIDNumberToString", "[", 
            RowBox[{"traj", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "5"}], "]"}], "]"}], "]"}], "<>", " ", 
           "\"\<\\t\>\"", " ", "<>", "  ", 
           RowBox[{"auxIDNumberToString", "[", 
            RowBox[{"traj", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", " ", "6"}], "]"}], "]"}], "]"}], "<>", 
           "\"\<\\n\>\""}]}], "  ", ";", " ", "\[IndentingNewLine]", 
         RowBox[{"WriteString", "[", 
          RowBox[{"trajfile", ",", "line"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Close", "[", "trajfile", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Trajectory file saved in file: \>\"", ",", " ", "trajfilename"}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<IDTrajectoryFile: elapsed time = \>\"", ",", 
        RowBox[{"(", 
         RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.767447676712742*^9, 3.7674476901356754`*^9}, {
   3.767447877752833*^9, 3.7674478819250393`*^9}, {3.7674498877634153`*^9, 
   3.7674499000768747`*^9}, {3.782655619766797*^9, 3.7826556288292556`*^9}, {
   3.7826568647102003`*^9, 3.782656886835105*^9}, 3.784621350331092*^9, {
   3.8201328287093325`*^9, 3.8201328301894054`*^9}, {3.8201475833268857`*^9, 
   3.82014772475784*^9}, {3.820147903479143*^9, 3.8201479195002623`*^9}, {
   3.8201479575827456`*^9, 3.8201480152565284`*^9}, {3.820148073780411*^9, 
   3.820148094041765*^9}, {3.8201481578859253`*^9, 3.8201484002139997`*^9}, {
   3.820148442706847*^9, 3.8201489300314655`*^9}, {3.8201489649837694`*^9, 
   3.820148998295968*^9}, {3.8201490518994956`*^9, 3.82014945269989*^9}, {
   3.820149575878006*^9, 3.8201496158606415`*^9}, {3.8201496684041023`*^9, 
   3.8201497274780054`*^9}, {3.8201497623102913`*^9, 
   3.8201497783813515`*^9}, {3.8201499985877542`*^9, 3.820150017769049*^9}, {
   3.820150256796426*^9, 3.820150324490906*^9}, {3.82015038955519*^9, 
   3.820150396285636*^9}, {3.820150623392577*^9, 3.8201506453240223`*^9}, {
   3.8201507623230314`*^9, 3.8201507878947144`*^9}, {3.8201517335859165`*^9, 
   3.820151799450259*^9}, {3.8201518480434513`*^9, 3.820152145583065*^9}, {
   3.8201522712813473`*^9, 3.82015233346713*^9}, {3.8201523901208687`*^9, 
   3.820152605577426*^9}, {3.820152645900069*^9, 3.8201527467889404`*^9}, 
   3.8201527920919256`*^9, 3.820152834384712*^9, 3.820152919720341*^9, {
   3.820154318037429*^9, 3.8201543256479316`*^9}, {3.820154709585966*^9, 
   3.8201547108860326`*^9}, {3.820155081922237*^9, 3.8201551083140097`*^9}, {
   3.8201569614891415`*^9, 3.820156965759404*^9}, {3.820220398988186*^9, 
   3.820220405875295*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[25]:=",ExpressionUUID->"ee2a2080-707a-4eb3-87d9-c28ada49e95e"]
}, Closed]],

Cell[CellGroupData[{

Cell["IDPlotRungeKuttaTrajectory", "Subsection",
 CellChangeTimes->{{3.7667548871084976`*^9, 3.76675490671941*^9}, 
   3.7667549708182*^9, {3.766755041776903*^9, 
   3.7667550428863707`*^9}},ExpressionUUID->"157ca7c9-6722-4d5a-ad5b-\
229aadb8b0bc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IDPlotRungeKuttaTrajectory", "::", "usage"}], " ", "=", " ", 
    "\"\<IDPlotRungeKuttaTrajectory[trajectory, s:\\\"y\\\"]: Plot the \
electron trajectory.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDPlotRungeKuttaTrajectory", "[", 
    RowBox[{"trajectory_", ",", " ", 
     RowBox[{"s_:", "\"\<z\>\""}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "plots", ",", " ", "x", ",", " ", "y", ",", " ", "z", ",", " ", "t0", 
       ",", " ", "t1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t0", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"plots", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"x", "=", " ", 
       RowBox[{"trajectory", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", " ", "1"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"y", " ", "=", " ", 
       RowBox[{"trajectory", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", " ", "2"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"z", " ", "=", " ", 
       RowBox[{"trajectory", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", " ", "3"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"s", " ", "\[Equal]", " ", "\"\<x\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", 
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"Transpose", "@", 
               RowBox[{"{", 
                RowBox[{"x", ",", " ", 
                 RowBox[{"y", "*", "1000"}]}], "}"}]}], ",", " ", 
              RowBox[{"PlotRange", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"All", ",", " ", "All"}], "}"}]}], ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", " ", 
              RowBox[{"Joined", "\[Rule]", "True"}], ",", " ", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<x [mm]\>\"", ",", "\"\<y [\[Mu]m]\>\""}], 
                "}"}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", 
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"Transpose", "@", 
               RowBox[{"{", 
                RowBox[{"x", ",", " ", 
                 RowBox[{"z", "*", "1000"}]}], "}"}]}], ",", " ", 
              RowBox[{"PlotRange", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"All", ",", " ", "All"}], "}"}]}], ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", " ", 
              RowBox[{"Joined", "\[Rule]", "True"}], ",", " ", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<x [mm]\>\"", ",", "\"\<z [\[Mu]m]\>\""}], 
                "}"}]}]}], "]"}]}], "]"}], ";"}], ")"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"s", " ", "\[Equal]", " ", "\"\<y\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", 
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"Transpose", "@", 
               RowBox[{"{", 
                RowBox[{"y", ",", " ", 
                 RowBox[{"x", "*", "1000"}]}], "}"}]}], ",", " ", 
              RowBox[{"PlotRange", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"All", ",", " ", "All"}], "}"}]}], ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", " ", 
              RowBox[{"Joined", "\[Rule]", "True"}], ",", " ", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<y [mm]\>\"", ",", "\"\<x [\[Mu]m]\>\""}], 
                "}"}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", 
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"Transpose", "@", 
               RowBox[{"{", 
                RowBox[{"y", ",", " ", 
                 RowBox[{"z", "*", "1000"}]}], "}"}]}], ",", " ", 
              RowBox[{"PlotRange", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"All", ",", " ", "All"}], "}"}]}], ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", " ", 
              RowBox[{"Joined", "\[Rule]", "True"}], ",", " ", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<y [mm]\>\"", ",", "\"\<z [\[Mu]m]\>\""}], 
                "}"}]}]}], "]"}]}], "]"}], ";"}], ")"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"s", " ", "\[Equal]", " ", "\"\<z\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", 
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"Transpose", "@", 
               RowBox[{"{", 
                RowBox[{"z", ",", " ", 
                 RowBox[{"x", "*", "1000"}]}], "}"}]}], ",", " ", 
              RowBox[{"PlotRange", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"All", ",", " ", "All"}], "}"}]}], ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", " ", 
              RowBox[{"Joined", "\[Rule]", "True"}], ",", " ", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<z [mm]\>\"", ",", "\"\<x [\[Mu]m]\>\""}], 
                "}"}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"plots", ",", 
            RowBox[{"ListPlot", "[", 
             RowBox[{
              RowBox[{"Transpose", "@", 
               RowBox[{"{", 
                RowBox[{"z", ",", " ", 
                 RowBox[{"y", "*", "1000"}]}], "}"}]}], ",", " ", 
              RowBox[{"PlotRange", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"All", ",", " ", "All"}], "}"}]}], ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", " ", 
              RowBox[{"Joined", "\[Rule]", "True"}], ",", " ", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<z [mm]\>\"", ",", "\"\<y [\[Mu]m]\>\""}], 
                "}"}]}]}], "]"}]}], "]"}], ";"}], ")"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<IDPlotRungeKuttaTrajectory: elapsed time = \>\"", ",", 
        RowBox[{"(", 
         RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "plots", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.767447724265257*^9, 3.7674477376412992`*^9}, {
  3.767447904067401*^9, 3.7674479092240562`*^9}, {3.782655746847508*^9, 
  3.782655747097514*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[27]:=",ExpressionUUID->"f697a71f-6997-415d-96c1-093eac60228d"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Auxiliary", "Section",
 CellChangeTimes->{{3.76639811614032*^9, 3.7663981237176037`*^9}, {
  3.8118571543202114`*^9, 
  3.8118571550008917`*^9}},ExpressionUUID->"5ae070d1-0cf0-4ac4-b054-\
32f42780450f"],

Cell[CellGroupData[{

Cell["auxIDCassette", "Subsection",
 CellChangeTimes->{{3.766754730782276*^9, 
  3.7667547560811443`*^9}},ExpressionUUID->"c13b4fd0-95fa-44e0-b443-\
c53463a08608"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"auxIDCassette", "[", 
     RowBox[{
     "\[Lambda]u_", ",", " ", "Np_", ",", " ", "Br_", ",", " ", "\[Delta]_", 
      ",", " ", "BlockShape_", ",", " ", 
      RowBox[{"OptionsPattern", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<Rectangular\>\"", "\[Rule]", " ", "False"}], ",", " ", 
         RowBox[{"\"\<BlockGap\>\"", "\[Rule]", " ", "0"}], ",", " ", 
         RowBox[{"\"\<Termination\>\"", "\[Rule]", " ", "\"\<None\>\""}], ",",
          " ", 
         RowBox[{"\"\<PointingUp\>\"", "\[Rule]", " ", "True"}], ",", " ", 
         RowBox[{"\"\<FirstBlock\>\"", "\[Rule]", " ", "\"\<Up\>\""}], ",", 
         " ", 
         RowBox[{
         "\"\<FieldDirection\>\"", "\[Rule]", " ", "\"\<Vertical\>\""}], ",", 
         " ", 
         RowBox[{"\"\<BlockSubdivision\>\"", "\[Rule]", " ", "\"\<None\>\""}],
          ",", " ", 
         RowBox[{"\"\<Size1\>\"", "\[Rule]", " ", "1"}], ",", " ", 
         RowBox[{"\"\<Size2\>\"", "\[Rule]", "1"}], ",", " ", 
         RowBox[{"\"\<Size3\>\"", "\[Rule]", " ", "1"}], " ", ",", 
         RowBox[{"\"\<Size4\>\"", "\[Rule]", " ", "1"}], " ", ",", " ", 
         RowBox[{"\"\<Gap1\>\"", "\[Rule]", " ", "0"}], ",", " ", 
         RowBox[{"\"\<Gap2\>\"", "\[Rule]", "0"}], ",", " ", 
         RowBox[{"\"\<Gap3\>\"", "\[Rule]", " ", "0"}], ",", " ", 
         RowBox[{"\"\<Gap4\>\"", "\[Rule]", " ", "0"}], ",", " ", 
         RowBox[{"\"\<Shift1\>\"", "\[Rule]", " ", "0"}], ",", " ", 
         RowBox[{"\"\<Shift2\>\"", "\[Rule]", "0"}], ",", " ", 
         RowBox[{"\"\<Shift3\>\"", "\[Rule]", " ", "0"}], ",", 
         RowBox[{"\"\<Shift4\>\"", "\[Rule]", " ", "0"}], ",", " ", 
         RowBox[{"\"\<FourBlocks\>\"", "\[Rule]", " ", "0"}], ",", " ", 
         RowBox[{"\"\<ShiftDirection\>\"", "\[Rule]", " ", "1"}]}], "}"}], 
       "]"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
       "Rectangular", ",", " ", "BlockGap", ",", " ", "Termination", ",", " ",
         "PointingUp", ",", " ", "FirstBlock", ",", " ", "FieldDirection", 
        " ", ",", "BlockSubdivision", ",", "\[IndentingNewLine]", " ", 
        "Shape", ",", " ", "NrTermBlocks", ",", "  ", "AddCoreBlocks", ",", 
        " ", "Wm", ",", " ", "Len", ",", " ", "NrCoreBlocks", ",", "NrBlocks",
         ",", "  ", "Pos", ",", " ", "bl", ",", " ", "LastPos", ",", 
        "\[IndentingNewLine]", "PointingUpList", ",", " ", "PointingDownList",
         ",", " ", "AddIdx", ",", "Mag", ",", " ", "i", ",", " ", "Shift", 
        ",", " ", "RotMag", ",", " ", "Trf", ",", "ShiftDirection", ",", 
        "\[IndentingNewLine]", "BlockCenter", " ", ",", " ", "Lh", ",", " ", 
        "Lv", ",", "Size1", ",", " ", "Size2", ",", " ", "Size3", ",", " ", 
        "Size4", ",", " ", "Gap1", ",", " ", "Gap2", ",", " ", "Gap3", ",", 
        "Gap4", ",", " ", "Shift1", ",", " ", "Shift2", ",", " ", "Shift3", 
        ",", "Shift4", ",", "FourBlocks", ",", "\[IndentingNewLine]", 
        "CassetteBeg", ",", "CassetteBeg1", ",", " ", "CassetteBeg2", ",", 
        " ", "CassetteBeg3", ",", "CassetteBeg4", ",", "\[IndentingNewLine]", 
        "CassetteEnd", ",", "CassetteEnd1", ",", " ", "CassetteEnd2", ",", 
        " ", "CassetteEnd3", ",", "CassetteEnd4", ",", "\[IndentingNewLine]", 
        "CassetteCore", ",", "Cassette"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Optional", " ", "arguments"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Rectangular", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<Rectangular\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"BlockGap", "=", 
        RowBox[{"OptionValue", "[", "\"\<BlockGap\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Termination", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<Termination\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PointingUp", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<PointingUp\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"FirstBlock", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<FirstBlock\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"FieldDirection", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<FieldDirection\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"BlockSubdivision", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<BlockSubdivision\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Size1", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<Size1\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Size2", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<Size2\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Size3", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<Size3\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Size4", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<Size4\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Gap1", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<Gap1\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Gap2", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<Gap2\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Gap3", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<Gap3\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Gap4", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<Gap4\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Shift1", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<Shift1\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Shift2", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<Shift2\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Shift3", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<Shift3\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Shift4", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<Shift4\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ShiftDirection", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<ShiftDirection\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"FourBlocks", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<FourBlocks\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Check", " ", "arguments"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{"\[Lambda]u", " ", "\[LessEqual]", " ", "0"}], ",", " ", 
         RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{"Np", " ", "\[LessEqual]", " ", "0"}], ",", " ", 
         RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{"Br", " ", "\[LessEqual]", " ", "0"}], ",", " ", 
         RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Depth", "[", "BlockShape", "]"}], "\[NotEqual]", " ", 
          "4"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Shape", " ", "=", " ", 
          RowBox[{"{", "BlockShape", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Shape", " ", "=", " ", "BlockShape"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Termination", " ", "Type"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"NrTermBlocks", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"AddCoreBlocks", " ", "=", " ", "0"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Termination", "\[Equal]", " ", "\"\<OneBlockSym\>\""}], 
          "  ", "||", " ", 
          RowBox[{
          "Termination", " ", "\[Equal]", " ", "\"\<OneBlockSymL4\>\""}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NrTermBlocks", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AddCoreBlocks", " ", "=", " ", "3"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Termination", "\[Equal]", " ", "\"\<OneBlockAntiSym\>\""}],
           " ", "||", " ", 
          RowBox[{
          "Termination", " ", "\[Equal]", " ", 
           "\"\<OneBlockAntiSymL4\>\""}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NrTermBlocks", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AddCoreBlocks", " ", "=", " ", "1"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Termination", "\[Equal]", " ", "\"\<ThreeBlocksSym\>\""}], 
          " ", "||", " ", 
          RowBox[{"Termination", "\[Equal]", "\"\<VarSizesSym\>\""}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NrTermBlocks", "=", " ", "3"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AddCoreBlocks", " ", "=", "3"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "Termination", "\[Equal]", " ", "\"\<ThreeBlocksAntiSym\>\""}], 
          "  ", "||", " ", 
          RowBox[{"Termination", "\[Equal]", "\"\<VarSizesAntiSym\>\""}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NrTermBlocks", "=", " ", "3"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AddCoreBlocks", " ", "=", "1"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Block", " ", "length"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Wm", "=", " ", 
        RowBox[{"\[Lambda]u", "/", "4"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Len", " ", "=", " ", 
        RowBox[{"Wm", " ", "-", " ", "BlockGap"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Position", " ", "of", " ", "blocks"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"NrCoreBlocks", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"4", "*", "Np"}], ")"}], " ", "+", " ", "AddCoreBlocks"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"NrBlocks", " ", "=", " ", 
        RowBox[{"NrCoreBlocks", "+", " ", 
         RowBox[{"(", 
          RowBox[{"2", "*", "NrTermBlocks"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Pos", " ", "=", " ", 
        RowBox[{"Wm", "*", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", 
           RowBox[{"NrBlocks", " ", "-", " ", "1"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Magnetization", " ", "direction"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
         "FieldDirection", " ", "\[Equal]", " ", "\"\<Horizontal\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"PointingUpList", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Br", ",", "0", ",", "0"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "0", ",", " ", 
               RowBox[{"-", "Br"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "Br"}], ",", "0", ",", "0"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "0", ",", "Br"}], "}"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"PointingDownList", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Br", ",", "0", ",", "0"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "0", ",", " ", "Br"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "Br"}], ",", "0", ",", "0"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", "  ", "0", ",", 
               RowBox[{"-", "Br"}]}], "}"}]}], "}"}]}], ";"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"PointingUpList", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "Br", ",", "0"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "0", ",", " ", 
               RowBox[{"-", "Br"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "Br"}], ",", " ", "0"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "0", ",", "Br"}], "}"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"PointingDownList", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "Br", ",", "0"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "0", ",", " ", "Br"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "Br"}], ",", " ", "0"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "0", ",", 
               RowBox[{"-", "Br"}]}], "}"}]}], "}"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"AddIdx", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{"FirstBlock", " ", "\[Equal]", " ", "\"\<Up\>\""}], ",", " ", 
         RowBox[{"AddIdx", " ", "=", "0"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{"FirstBlock", " ", "\[Equal]", " ", "\"\<Down\>\""}], ",", 
         " ", 
         RowBox[{"AddIdx", "=", "2"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FirstBlock", " ", "\[Equal]", " ", "\"\<Foward\>\""}], " ",
           "&&", " ", "PointingUp"}], ",", " ", 
         RowBox[{"AddIdx", "=", "3"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FirstBlock", " ", "\[Equal]", " ", "\"\<Foward\>\""}], " ",
           "&&", " ", 
          RowBox[{"Not", " ", "PointingUp"}]}], ",", " ", 
         RowBox[{"AddIdx", "=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FirstBlock", " ", "\[Equal]", " ", "\"\<Backward\>\""}], 
          " ", "&&", " ", "PointingUp"}], ",", " ", 
         RowBox[{"AddIdx", "=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FirstBlock", " ", "\[Equal]", " ", "\"\<Backward\>\""}], 
          " ", "&&", " ", 
          RowBox[{"Not", " ", "PointingUp"}]}], ",", " ", 
         RowBox[{"AddIdx", "=", "3"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{"PointingUp", ",", "  ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Mag", "[", "idx_", "]"}], " ", ":=", " ", 
          RowBox[{"PointingUpList", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Divisible", "[", 
               RowBox[{
                RowBox[{"idx", " ", "+", " ", "AddIdx"}], ",", " ", "4"}], 
               "]"}], " ", ",", " ", "4", " ", ",", " ", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"idx", "+", " ", "AddIdx"}], ",", " ", "4"}], "]"}]}],
              " ", "]"}], "]"}], "]"}]}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Mag", "[", "idx_", "]"}], " ", ":=", " ", 
          RowBox[{"PointingDownList", "[", 
           RowBox[{"[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Divisible", "[", 
               RowBox[{
                RowBox[{"idx", " ", "+", " ", "AddIdx"}], ",", " ", "4"}], 
               "]"}], ",", " ", "4", " ", ",", " ", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"idx", "+", " ", "AddIdx"}], ",", " ", "4"}], "]"}]}],
              " ", "]"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";",
        " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
        "Rectangular", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Creates", " ", "parallelepipedic", " ", "blocks", " ", "with", " ",
            "magnetization"}], "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"BlockCenter", " ", "=", " ", 
           RowBox[{"RegionCentroid", "[", 
            RowBox[{"Polygon", "[", 
             RowBox[{"Shape", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Lh", " ", "=", " ", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"Shape", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", " ", "All", ",", " ", "1"}], "]"}], "]"}], 
             "]"}], " ", "-", " ", 
            RowBox[{"Min", "[", 
             RowBox[{"Shape", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", " ", "All", ",", " ", "1"}], "]"}], "]"}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Lv", " ", "=", " ", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"Shape", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", " ", "All", ",", " ", "2"}], "]"}], "]"}], 
             "]"}], " ", "-", " ", 
            RowBox[{"Min", "[", 
             RowBox[{"Shape", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", " ", "All", ",", " ", "2"}], "]"}], "]"}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Termination", " ", "blocks"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"CassetteBeg", " ", "=", " ", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"CassetteEnd", " ", "=", " ", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Termination", "\[Equal]", " ", "\"\<OneBlockSym\>\""}], 
             " ", "||", " ", 
             RowBox[{
             "Termination", "\[Equal]", " ", "\"\<OneBlockAntiSym\>\""}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"CassetteBeg", " ", "=", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", 
                   RowBox[{"Wm", "/", "4"}], " ", "+", " ", "\[Delta]"}]}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", "Lv", ",", " ", 
                  RowBox[{"Len", "/", "2"}]}], "}"}], ",", 
                RowBox[{"Mag", "[", "1", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd", " ", "=", " ", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "NrBlocks", "]"}], "]"}], "-", " ", 
                   RowBox[{"Wm", "/", "4"}], " ", "+", " ", "\[Delta]"}]}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", "Lv", ",", 
                  RowBox[{"Len", "/", "2"}]}], "}"}], ",", 
                RowBox[{"Mag", "[", "NrBlocks", "]"}]}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "Termination", "\[Equal]", " ", "\"\<OneBlockSymL4\>\""}], " ", "||",
              " ", 
             RowBox[{
             "Termination", "\[Equal]", " ", "\"\<OneBlockAntiSymL4\>\""}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"CassetteBeg", " ", "=", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", 
                   RowBox[{"5", 
                    RowBox[{"Wm", "/", "8"}]}], " ", "+", " ", "\[Delta]"}]}],
                  "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", "Lv", ",", " ", 
                  RowBox[{"Len", "/", "4"}]}], "}"}], ",", 
                RowBox[{"Mag", "[", "1", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd", " ", "=", " ", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "NrBlocks", "]"}], "]"}], "-", " ", 
                   RowBox[{"5", 
                    RowBox[{"Wm", "/", "8"}]}], " ", "+", " ", "\[Delta]"}]}],
                  "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", "Lv", ",", 
                  RowBox[{"Len", "/", "4"}]}], "}"}], ",", 
                RowBox[{"Mag", "[", "NrBlocks", "]"}]}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "Termination", "\[Equal]", " ", "\"\<ThreeBlocksSym\>\""}], " ", 
             "||", " ", 
             RowBox[{
             "Termination", "\[Equal]", " ", "\"\<ThreeBlocksAntiSym\>\""}]}],
             ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"CassetteBeg1", " ", "=", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", " ", 
                   RowBox[{"3", "*", 
                    RowBox[{"Wm", "/", "8"}]}], " ", "+", " ", "\[Delta]"}]}],
                  "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", "Lv", ",", 
                  RowBox[{"Len", "/", "4"}]}], "}"}], ",", 
                RowBox[{"Mag", "[", "1", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg2", " ", "=", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", "  ", 
                   RowBox[{"Wm", "/", "4"}], " ", "+", " ", "\[Delta]"}]}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", "Lv", ",", 
                  RowBox[{"Len", "/", "2"}]}], "}"}], ",", 
                RowBox[{"Mag", "[", "2", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg3", " ", "=", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "+", "   ", 
                   RowBox[{"Wm", "/", "8"}], "+", " ", "\[Delta]"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", "Lv", ",", 
                  RowBox[{"3", "*", 
                   RowBox[{"Len", "/", "4"}]}]}], "}"}], ",", 
                RowBox[{"Mag", "[", "3", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg", " ", "=", " ", 
              RowBox[{"{", 
               RowBox[{
               "CassetteBeg1", ",", " ", "CassetteBeg2", ",", " ", 
                "CassetteBeg3"}], "}"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd3", " ", "=", " ", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", 
                    RowBox[{"NrBlocks", "-", "2"}], "]"}], "]"}], "-", "  ", 
                   RowBox[{"Wm", "/", "8"}], "+", " ", "\[Delta]"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", " ", "Lv", ",", " ", 
                  RowBox[{"3", "*", 
                   RowBox[{"Len", "/", "4"}]}]}], "}"}], ",", 
                RowBox[{"Mag", "[", 
                 RowBox[{"NrBlocks", "-", "2"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd2", " ", "=", " ", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", 
                    RowBox[{"NrBlocks", "-", "1"}], "]"}], "]"}], "-", "  ", 
                   RowBox[{"Wm", "/", "4"}], " ", "+", " ", "\[Delta]"}]}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", "Lv", ",", 
                  RowBox[{"Len", "/", "2"}]}], "}"}], ",", 
                RowBox[{"Mag", "[", 
                 RowBox[{"NrBlocks", "-", "1"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd1", " ", "=", " ", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "NrBlocks", "]"}], "]"}], "-", " ", 
                   RowBox[{"3", "*", 
                    RowBox[{"Wm", "/", "8"}]}], " ", "+", " ", "\[Delta]"}]}],
                  "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", "Lv", ",", 
                  RowBox[{"Len", "/", "4"}]}], "}"}], ",", 
                RowBox[{"Mag", "[", "NrBlocks", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd", " ", "=", " ", 
              RowBox[{"{", 
               RowBox[{
               "CassetteEnd3", ",", " ", "CassetteEnd2", ",", " ", 
                "CassetteEnd1"}], "}"}]}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Termination", "\[Equal]", " ", "\"\<VarSizesSym\>\""}], 
             " ", "||", " ", 
             RowBox[{
             "Termination", "\[Equal]", " ", "\"\<VarSizesAntiSym\>\""}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"LastPos", " ", "=", " ", 
              RowBox[{
               RowBox[{"Pos", "[", 
                RowBox[{"[", "4", "]"}], "]"}], " ", "-", " ", 
               RowBox[{"0.5", "*", "Wm"}], " ", "-", " ", 
               RowBox[{"(", 
                RowBox[{"Size3", "/", "2"}], ")"}], " ", "-", " ", "Gap3"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg3", " ", "=", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"LastPos", "+", " ", "\[Delta]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", "Lv", ",", "Size3"}], "}"}], ",", 
                RowBox[{"Mag", "[", "3", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"LastPos", " ", "=", " ", 
              RowBox[{"LastPos", " ", "-", 
               RowBox[{"(", 
                RowBox[{"Size3", "/", "2"}], ")"}], " ", "-", " ", 
               RowBox[{"(", 
                RowBox[{"Size2", "/", "2"}], ")"}], " ", "-", " ", "Gap2"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg2", " ", "=", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"LastPos", " ", "+", " ", "\[Delta]"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", "Lv", ",", "Size2"}], "}"}], ",", 
                RowBox[{"Mag", "[", "2", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"LastPos", " ", "=", " ", 
              RowBox[{"LastPos", " ", "-", " ", 
               RowBox[{"(", 
                RowBox[{"Size2", "/", "2"}], ")"}], " ", "-", " ", 
               RowBox[{"(", 
                RowBox[{"Size1", "/", "2"}], ")"}], " ", "-", " ", "Gap1"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg1", " ", "=", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"LastPos", " ", "+", " ", "\[Delta]"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", "Lv", ",", "Size1"}], "}"}], ",", 
                RowBox[{"Mag", "[", "1", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"FourBlocks", " ", "\[Equal]", " ", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"LastPos", " ", "=", " ", 
                 RowBox[{"LastPos", " ", "-", " ", 
                  RowBox[{"(", 
                   RowBox[{"Size1", "/", "2"}], ")"}], " ", "-", 
                  RowBox[{"(", 
                   RowBox[{"Size4", "/", "2"}], ")"}], " ", "-", " ", 
                  "Gap4"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"CassetteBeg4", " ", "=", " ", 
                 RowBox[{"radObjRecMag", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"BlockCenter", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"BlockCenter", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"LastPos", " ", "+", " ", "\[Delta]"}]}], "}"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{"Lh", ",", "Lv", ",", "Size4"}], "}"}], ",", 
                   RowBox[{"Mag", "[", "4", "]"}]}], "]"}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"LastPos", " ", "=", " ", 
              RowBox[{
               RowBox[{"Pos", "[", 
                RowBox[{"[", 
                 RowBox[{"NrBlocks", "-", "3"}], "]"}], "]"}], " ", "+", " ", 
               RowBox[{"0.5", "*", "Wm"}], " ", "+", "  ", 
               RowBox[{"(", 
                RowBox[{"Size3", "/", "2"}], ")"}], " ", "+", " ", "Gap3"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd3", " ", "=", " ", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                  RowBox[{"LastPos", "+", " ", "\[Delta]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", " ", "Lv", ",", " ", "Size3"}], "}"}], 
                ",", 
                RowBox[{"Mag", "[", 
                 RowBox[{"NrBlocks", "-", "2"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"LastPos", " ", "=", " ", 
              RowBox[{"LastPos", " ", "+", " ", 
               RowBox[{"(", 
                RowBox[{"Size3", "/", "2"}], ")"}], " ", "+", " ", 
               RowBox[{"(", 
                RowBox[{"Size2", "/", "2"}], ")"}], " ", "+", " ", "Gap2"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd2", " ", "=", " ", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"LastPos", "+", " ", "\[Delta]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", "Lv", ",", "Size2"}], "}"}], ",", 
                RowBox[{"Mag", "[", 
                 RowBox[{"NrBlocks", "-", "1"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"LastPos", " ", "=", " ", 
              RowBox[{"LastPos", " ", "+", 
               RowBox[{"(", 
                RowBox[{"Size2", "/", "2"}], ")"}], " ", "+", 
               RowBox[{"(", 
                RowBox[{"Size1", "/", "2"}], ")"}], " ", "+", " ", "Gap1"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd1", " ", "=", " ", 
              RowBox[{"radObjRecMag", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                  RowBox[{"BlockCenter", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"LastPos", " ", "+", " ", "\[Delta]"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"Lh", ",", "Lv", ",", "Size1"}], "}"}], ",", 
                RowBox[{"Mag", "[", "NrBlocks", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"FourBlocks", " ", "\[Equal]", " ", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"LastPos", " ", "=", " ", 
                 RowBox[{"LastPos", "  ", "+", " ", 
                  RowBox[{"(", 
                   RowBox[{"Size1", "/", "2"}], ")"}], " ", "+", 
                  RowBox[{"(", 
                   RowBox[{"Size4", "/", "2"}], ")"}], " ", "+", " ", 
                  "Gap4"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"CassetteEnd4", " ", "=", 
                 RowBox[{"radObjRecMag", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"BlockCenter", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"BlockCenter", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"LastPos", " ", "+", " ", "\[Delta]"}]}], "}"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{"Lh", ",", "Lv", ",", "Size4"}], "}"}], ",", 
                   RowBox[{"Mag", "[", 
                    RowBox[{"NrBlocks", "-", "3"}], "]"}]}], "]"}]}], ";"}]}],
               " ", "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
               "FieldDirection", " ", "\[Equal]", " ", "\"\<Horizontal\>\""}],
                ",", " ", 
               RowBox[{"Trf", " ", "=", " ", 
                RowBox[{"radTrfTrsl", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Shift3", "*", "ShiftDirection"}], ",", " ", "0", 
                   ",", " ", "0"}], "}"}], "]"}]}], ",", " ", 
               RowBox[{"Trf", " ", "=", " ", 
                RowBox[{"radTrfTrsl", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"Shift3", "*", "ShiftDirection"}], ",", " ", "0"}],
                   "}"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg3", " ", "=", 
              RowBox[{"radTrfOrnt", "[", 
               RowBox[{"CassetteBeg3", ",", " ", "Trf"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd3", " ", "=", 
              RowBox[{"radTrfOrnt", "[", 
               RowBox[{"CassetteEnd3", ",", " ", "Trf"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
               "FieldDirection", " ", "\[Equal]", " ", "\"\<Horizontal\>\""}],
                ",", " ", 
               RowBox[{"Trf", " ", "=", " ", 
                RowBox[{"radTrfTrsl", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Shift2", "*", "ShiftDirection"}], ",", " ", "0", 
                   ",", " ", "0"}], "}"}], "]"}]}], ",", " ", 
               RowBox[{"Trf", " ", "=", " ", 
                RowBox[{"radTrfTrsl", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"Shift2", "*", "ShiftDirection"}], ",", " ", "0"}],
                   "}"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg2", " ", "=", 
              RowBox[{"radTrfOrnt", "[", 
               RowBox[{"CassetteBeg2", ",", " ", "Trf"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd2", " ", "=", 
              RowBox[{"radTrfOrnt", "[", 
               RowBox[{"CassetteEnd2", ",", " ", "Trf"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
               "FieldDirection", " ", "\[Equal]", " ", "\"\<Horizontal\>\""}],
                ",", " ", 
               RowBox[{"Trf", " ", "=", " ", 
                RowBox[{"radTrfTrsl", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Shift1", "*", "ShiftDirection"}], ",", " ", "0", 
                   ",", " ", "0"}], "}"}], "]"}]}], ",", " ", 
               RowBox[{"Trf", " ", "=", " ", 
                RowBox[{"radTrfTrsl", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"Shift1", "*", "ShiftDirection"}], ",", " ", "0"}],
                   "}"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg1", " ", "=", 
              RowBox[{"radTrfOrnt", "[", 
               RowBox[{"CassetteBeg1", ",", " ", "Trf"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd1", " ", "=", 
              RowBox[{"radTrfOrnt", "[", 
               RowBox[{"CassetteEnd1", ",", " ", "Trf"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg", " ", "=", " ", 
              RowBox[{"{", 
               RowBox[{
               "CassetteBeg1", ",", " ", "CassetteBeg2", ",", " ", 
                "CassetteBeg3"}], "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd", " ", "=", " ", 
              RowBox[{"{", 
               RowBox[{
               "CassetteEnd3", ",", " ", "CassetteEnd2", ",", " ", 
                "CassetteEnd1"}], "}"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", " ", 
              RowBox[{
               RowBox[{"FourBlocks", " ", "\[Equal]", " ", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                  "FieldDirection", " ", "\[Equal]", " ", 
                   "\"\<Horizontal\>\""}], ",", " ", 
                  RowBox[{"Trf", " ", "=", " ", 
                   RowBox[{"radTrfTrsl", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", " ", 
                    RowBox[{"Shift4", "*", "ShiftDirection"}], ",", " ", 
                    "0"}], "}"}], "]"}]}], ",", " ", 
                  RowBox[{"Trf", " ", "=", " ", 
                   RowBox[{"radTrfTrsl", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", " ", 
                    RowBox[{"Shift4", "*", "ShiftDirection"}]}], "}"}], 
                    "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"CassetteBeg4", " ", "=", 
                 RowBox[{"radTrfOrnt", "[", 
                  RowBox[{"CassetteBeg4", ",", " ", "Trf"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"CassetteEnd4", " ", "=", 
                 RowBox[{"radTrfOrnt", "[", 
                  RowBox[{"CassetteEnd4", ",", " ", "Trf"}], "]"}]}], ";", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"CassetteBeg", ",", " ", "CassetteBeg4"}], "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"CassetteEnd", ",", " ", "CassetteEnd4"}], "]"}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", "Core", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"CassetteCore", " ", "=", " ", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", " ", "[", 
           RowBox[{
            RowBox[{"i", "=", 
             RowBox[{"(", 
              RowBox[{"NrTermBlocks", "+", "1"}], ")"}]}], ",", " ", 
            RowBox[{"i", "\[LessEqual]", " ", 
             RowBox[{"NrBlocks", " ", "-", " ", "NrTermBlocks"}]}], ",", " ", 
            RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"CassetteCore", ",", " ", 
               RowBox[{"radObjRecMag", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"BlockCenter", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"BlockCenter", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"Pos", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "+", " ", "\[Delta]"}]}], 
                  "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Lh", ",", "Lv", ",", "Len"}], "}"}], ",", 
                 RowBox[{"Mag", "[", "i", "]"}]}], "]"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Cassette", "   ", "=", "  ", 
           RowBox[{"radObjCnt", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
              "CassetteBeg", ",", " ", "CassetteCore", ",", "CassetteEnd"}], 
              "}"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "BlockSubdivision", "]"}], ">", " ", 
             "0"}], ",", " ", "\[IndentingNewLine]", 
            RowBox[{"Cassette", " ", "=", " ", 
             RowBox[{"radObjDivMag", "[", 
              RowBox[{"Cassette", ",", " ", 
               RowBox[{"BlockSubdivision", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Shift", " ", "the", " ", "cassette"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Shift", "=", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Pos", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "+", " ", 
               RowBox[{"Pos", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}]}], "/", "2"}]}], 
          " ", ";", "\[IndentingNewLine]", 
          RowBox[{"Cassette", " ", "=", " ", 
           RowBox[{"radTrfOrnt", "[", 
            RowBox[{"Cassette", ",", 
             RowBox[{"radTrfTrsl", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "Shift"}], "}"}], "]"}]}], "]"}]}],
           ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "Creates", " ", "extruded", " ", "polygon", " ", "blocks", " ", 
            "with", " ", "magnetization", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", " ", "The", " ", "permanent", " ", 
            "blocks", " ", "are", " ", "created", " ", "with", " ", "a", " ", 
            "extrusion", " ", "of", " ", "the", " ", "cross", " ", "section", 
            " ", "of", " ", "the", " ", "block", " ", "and", " ", "the", " ", 
            "magnetization", " ", "vector", " ", "must", " ", "be", " ", 
            "specified", " ", "in", " ", "the", " ", "block", " ", 
            RowBox[{
            "creation", ".", " ", "\[IndentingNewLine]", "However"}]}], ",", 
           " ", 
           RowBox[{
           "the", " ", "extrusion", " ", "is", " ", "done", " ", "in", " ", 
            "the", " ", "x", " ", "direction"}], ",", " ", 
           RowBox[{
           "so", " ", "for", " ", "blocks", " ", "with", " ", "a", " ", 
            "constant", " ", "cross", " ", "section", " ", "in", " ", "the", 
            " ", "longitudinal", " ", "direction"}], ",", " ", 
           RowBox[{
           "the", " ", "objects", " ", "must", " ", "be", " ", "rotated", " ",
             "after", " ", 
            RowBox[{"creation", ".", " ", "\[IndentingNewLine]", "The"}], " ",
             "magnetization", " ", "vector", " ", "is", " ", "affected", " ", 
            "by", " ", "this", " ", "rotation"}], ",", " ", 
           RowBox[{
           "so", " ", "a", " ", "inverse", " ", "transformation", " ", "must",
             " ", "be", " ", "applied", " ", "to", " ", "the", " ", "vector", 
            " ", "before", " ", "the", " ", "block", " ", "is", " ", 
            RowBox[{"created", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "Counterclockwise", " ", "rotations", " ", "of", " ", "the", " ", 
            "magnetization", " ", "vector", " ", "by", " ", 
            RowBox[{"\[Pi]", "/", "2"}], " ", "around", " ", "the", " ", 
            "y"}], "-", 
           RowBox[{"axis", " ", "and", " ", "by", " ", 
            RowBox[{"\[Pi]", "/", "2"}], " ", "around", " ", "the", " ", 
            "x"}], "-", "axis"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"RotMag", "[", "idx_", "]"}], " ", ":=", " ", 
           RowBox[{"Dot", "[", 
            RowBox[{
             RowBox[{"RotationMatrix", "[", 
              RowBox[{
               RowBox[{"\[Pi]", "/", "2"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], ",", " ", 
             RowBox[{"Dot", "[", 
              RowBox[{
               RowBox[{"RotationMatrix", "[", 
                RowBox[{
                 RowBox[{"\[Pi]", "/", "2"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}], ",", " ", 
               RowBox[{"Mag", "[", "idx", "]"}]}], "]"}]}], "]"}]}], " ", ";",
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Termination", " ", "blocks"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"CassetteBeg", " ", "=", " ", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"CassetteEnd", " ", "=", " ", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "BlockSubdivision", "]"}], " ", "<", 
             "1"}], ",", " ", "\[IndentingNewLine]", 
            RowBox[{"BlockSubdivision", " ", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", " ", "1", ",", " ", "1"}], "}"}], ",", 
               RowBox[{"Length", "[", "Shape", "]"}]}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Termination", "\[Equal]", " ", "\"\<OneBlockSym\>\""}], 
             " ", "||", " ", 
             RowBox[{
             "Termination", "\[Equal]", " ", "\"\<OneBlockAntiSym\>\""}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"CassetteBeg", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", 
                   RowBox[{"Wm", "/", "4"}], " ", "+", " ", "\[Delta]"}], ",",
                   "   ", 
                  RowBox[{"Len", "/", "2"}], ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", "1", "]"}]}], "]"}], "&"}], "/@", 
               " ", "Shape"}]}], " ", ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteBeg", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "NrBlocks", "]"}], "]"}], "-", "  ", 
                   RowBox[{"Wm", "/", "4"}], "+", " ", "\[Delta]"}], ",", " ", 
                  RowBox[{"Len", "/", "2"}], ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", "NrBlocks", "]"}]}], "]"}], "&"}], "/@",
                "Shape"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteEnd", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "Termination", "\[Equal]", " ", "\"\<OneBlockSymL4\>\""}], " ", "||",
              " ", 
             RowBox[{
             "Termination", "\[Equal]", " ", "\"\<OneBlockAntiSymL4\>\""}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"CassetteBeg", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", 
                   RowBox[{"5", 
                    RowBox[{"Wm", "/", "8"}]}], " ", "+", " ", "\[Delta]"}], 
                  ",", "   ", 
                  RowBox[{"Len", "/", "4"}], ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", "1", "]"}]}], "]"}], "&"}], "/@", 
               " ", "Shape"}]}], " ", ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteBeg", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "NrBlocks", "]"}], "]"}], "-", " ", 
                   RowBox[{"5", " ", 
                    RowBox[{"Wm", "/", "8"}]}], "+", " ", "\[Delta]"}], ",", 
                  " ", 
                  RowBox[{"Len", "/", "4"}], ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", "NrBlocks", "]"}]}], "]"}], "&"}], "/@",
                "Shape"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteEnd", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "Termination", "\[Equal]", " ", "\"\<ThreeBlocksSym\>\""}], " ", 
             "||", " ", 
             RowBox[{
             "Termination", "\[Equal]", " ", "\"\<ThreeBlocksAntiSym\>\""}]}],
             ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"CassetteBeg1", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", 
                   RowBox[{"3", 
                    RowBox[{"Wm", "/", "8"}]}], " ", "+", " ", "\[Delta]"}], 
                  ",", " ", 
                  RowBox[{"Len", "/", "4"}], ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", "1", "]"}]}], "]"}], "&"}], "/@", 
               "Shape"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg2", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", " ", 
                   RowBox[{"Wm", "/", "4"}], "+", " ", "\[Delta]"}], ",", " ", 
                  RowBox[{"Len", "/", "2"}], ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", "2", "]"}]}], "]"}], "&"}], "/@", 
               "Shape"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg3", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], " ", "+", " ", 
                   RowBox[{"Wm", "/", "8"}], "+", " ", "\[Delta]"}], ",", " ", 
                  RowBox[{"3", 
                   RowBox[{"Len", "/", "4"}]}], ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", "3", "]"}]}], "]"}], "&"}], "/@", 
               " ", "Shape"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg1", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteBeg1", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg2", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteBeg2", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg3", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteBeg3", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg", " ", "=", " ", 
              RowBox[{"{", 
               RowBox[{
               "CassetteBeg1", ",", " ", "CassetteBeg2", ",", " ", 
                "CassetteBeg3"}], "}"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd3", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", 
                    RowBox[{"NrBlocks", "-", "2"}], "]"}], "]"}], " ", "-", 
                   " ", 
                   RowBox[{"Wm", "/", "8"}], "+", " ", "\[Delta]"}], ",", " ", 
                  RowBox[{"3", 
                   RowBox[{"Len", "/", "4"}]}], ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", 
                   RowBox[{"NrBlocks", "-", "2"}], "]"}]}], "]"}], "&"}], "/@",
                "Shape"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd2", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", 
                    RowBox[{"NrBlocks", "-", "1"}], "]"}], "]"}], " ", "-", 
                   " ", 
                   RowBox[{"Wm", "/", "4"}], "+", " ", "\[Delta]"}], ",", " ", 
                  RowBox[{"Len", "/", "2"}], ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", 
                   RowBox[{"NrBlocks", "-", "1"}], "]"}]}], "]"}], "&"}], "/@",
                "Shape"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd1", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "NrBlocks", "]"}], "]"}], " ", "-", 
                   RowBox[{"3", 
                    RowBox[{"Wm", "/", "8"}]}], "+", " ", "\[Delta]"}], ",", 
                  " ", 
                  RowBox[{"Len", "/", "4"}], ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", "NrBlocks", "]"}]}], "]"}], "&"}], "/@",
                "Shape"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd3", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteEnd3", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd2", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteEnd2", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd1", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteEnd1", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd", " ", "=", " ", 
              RowBox[{"{", 
               RowBox[{
               "CassetteEnd3", ",", " ", "CassetteEnd2", ",", " ", 
                "CassetteEnd1"}], "}"}]}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Termination", "\[Equal]", " ", "\"\<VarSizesSym\>\""}], 
             " ", "||", " ", 
             RowBox[{
             "Termination", "\[Equal]", " ", "\"\<VarSizesAntiSym\>\""}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"LastPos", " ", "=", " ", 
              RowBox[{
               RowBox[{"Pos", "[", 
                RowBox[{"[", "4", "]"}], "]"}], " ", "-", " ", 
               RowBox[{"0.5", "*", "Wm"}], " ", "-", " ", 
               RowBox[{"(", 
                RowBox[{"Size3", "/", "2"}], ")"}], " ", "-", " ", "Gap3"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg3", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{"LastPos", "+", " ", "\[Delta]"}], ",", " ", 
                  "Size3", ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", "3", "]"}]}], "]"}], "&"}], "/@", 
               " ", "Shape"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"LastPos", " ", "=", " ", 
              RowBox[{"LastPos", " ", "-", " ", 
               RowBox[{"(", 
                RowBox[{"Size3", "/", "2"}], ")"}], " ", "-", " ", 
               RowBox[{"(", 
                RowBox[{"Size2", "/", "2"}], ")"}], " ", "-", " ", "Gap2"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg2", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{"LastPos", "+", " ", "\[Delta]"}], ",", " ", 
                  "Size2", ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", "2", "]"}]}], "]"}], "&"}], "/@", 
               "Shape"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"LastPos", " ", "=", " ", 
              RowBox[{"LastPos", " ", "-", " ", 
               RowBox[{"(", 
                RowBox[{"Size2", "/", "2"}], ")"}], " ", "-", 
               RowBox[{"(", 
                RowBox[{"Size1", "/", "2"}], ")"}], " ", "-", " ", "Gap1"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg1", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{"LastPos", "+", " ", "\[Delta]"}], ",", " ", 
                  "Size1", ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", "1", "]"}]}], "]"}], "&"}], "/@", 
               "Shape"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"FourBlocks", " ", "\[Equal]", " ", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"LastPos", " ", "=", " ", 
                 RowBox[{"LastPos", " ", "-", " ", 
                  RowBox[{"(", 
                   RowBox[{"Size1", "/", "2"}], ")"}], " ", "-", 
                  RowBox[{"(", 
                   RowBox[{"Size4", "/", "2"}], ")"}], " ", "-", " ", 
                  "Gap4"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"CassetteBeg4", " ", "=", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"radObjThckPgn", "[", 
                    RowBox[{
                    RowBox[{"LastPos", "+", " ", "\[Delta]"}], ",", " ", 
                    "Size4", ",", "#", ",", " ", 
                    RowBox[{"RotMag", "[", "4", "]"}]}], "]"}], "&"}], "/@", 
                  " ", "Shape"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
             ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"LastPos", " ", "=", " ", 
              RowBox[{
               RowBox[{"Pos", "[", 
                RowBox[{"[", 
                 RowBox[{"NrBlocks", "-", "3"}], "]"}], "]"}], " ", "+", " ", 
               RowBox[{"0.5", "*", "Wm"}], " ", "+", " ", 
               RowBox[{"(", 
                RowBox[{"Size3", "/", "2"}], ")"}], " ", "+", " ", "Gap3"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd3", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{"LastPos", "+", " ", "\[Delta]"}], ",", " ", 
                  "Size3", ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", 
                   RowBox[{"NrBlocks", "-", "2"}], "]"}]}], "]"}], "&"}], "/@",
                "Shape"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"LastPos", " ", "=", " ", 
              RowBox[{"LastPos", " ", "+", 
               RowBox[{"(", 
                RowBox[{"Size3", "/", "2"}], ")"}], " ", "+", " ", 
               RowBox[{"(", 
                RowBox[{"Size2", "/", "2"}], ")"}], " ", "+", " ", "Gap2"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd2", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{"LastPos", "+", " ", "\[Delta]"}], ",", " ", 
                  "Size2", ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", 
                   RowBox[{"NrBlocks", "-", "1"}], "]"}]}], "]"}], "&"}], "/@",
                "Shape"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"LastPos", " ", "=", " ", 
              RowBox[{"LastPos", " ", "+", " ", 
               RowBox[{"(", 
                RowBox[{"Size2", "/", "2"}], ")"}], " ", "+", 
               RowBox[{"(", 
                RowBox[{"Size1", "/", "2"}], ")"}], " ", "+", " ", "Gap1"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd1", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{"LastPos", "+", " ", "\[Delta]"}], ",", " ", 
                  "Size1", ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", "NrBlocks", "]"}]}], "]"}], "&"}], "/@",
                "Shape"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"FourBlocks", " ", "\[Equal]", " ", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"LastPos", " ", "=", " ", 
                 RowBox[{"LastPos", "  ", "+", " ", 
                  RowBox[{"(", 
                   RowBox[{"Size1", "/", "2"}], ")"}], " ", "+", 
                  RowBox[{"(", 
                   RowBox[{"Size4", "/", "2"}], ")"}], " ", "+", " ", 
                  "Gap4"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"CassetteEnd4", " ", "=", " ", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"radObjThckPgn", "[", 
                    RowBox[{
                    RowBox[{"LastPos", "+", " ", "\[Delta]"}], ",", " ", 
                    "Size4", ",", "#", ",", " ", 
                    RowBox[{"RotMag", "[", 
                    RowBox[{"NrBlocks", "-", "3"}], "]"}]}], "]"}], "&"}], "/@",
                   "Shape"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
               "FieldDirection", " ", "\[Equal]", " ", "\"\<Horizontal\>\""}],
                ",", " ", 
               RowBox[{"Trf", " ", "=", " ", 
                RowBox[{"radTrfTrsl", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", " ", 
                   RowBox[{"Shift3", "*", "ShiftDirection"}], ",", " ", "0"}],
                   "}"}], "]"}]}], ",", " ", 
               RowBox[{"Trf", " ", "=", " ", 
                RowBox[{"radTrfTrsl", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", " ", 
                   RowBox[{"Shift3", "*", "ShiftDirection"}]}], "}"}], 
                 "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg3", " ", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"radTrfOrnt", "[", 
                 RowBox[{"#", ",", "  ", "Trf"}], "]"}], "&"}], "/@", 
               "CassetteBeg3"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd3", " ", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"radTrfOrnt", "[", 
                 RowBox[{"#", ",", "  ", "Trf"}], "]"}], "&"}], "/@", 
               "CassetteEnd3"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
               "FieldDirection", " ", "\[Equal]", " ", "\"\<Horizontal\>\""}],
                ",", " ", 
               RowBox[{"Trf", " ", "=", " ", 
                RowBox[{"radTrfTrsl", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", " ", 
                   RowBox[{"Shift2", "*", "ShiftDirection"}], ",", " ", "0"}],
                   "}"}], "]"}]}], ",", " ", 
               RowBox[{"Trf", " ", "=", " ", 
                RowBox[{"radTrfTrsl", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", " ", 
                   RowBox[{"Shift2", "*", "ShiftDirection"}]}], "}"}], 
                 "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg2", " ", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"radTrfOrnt", "[", 
                 RowBox[{"#", ",", " ", "Trf"}], "]"}], "&"}], "/@", 
               "CassetteBeg2"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd2", " ", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"radTrfOrnt", "[", 
                 RowBox[{"#", ",", " ", "Trf"}], "]"}], "&"}], "/@", 
               "CassetteEnd2"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
               "FieldDirection", " ", "\[Equal]", " ", "\"\<Horizontal\>\""}],
                ",", " ", 
               RowBox[{"Trf", " ", "=", " ", 
                RowBox[{"radTrfTrsl", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", " ", 
                   RowBox[{"Shift1", "*", "ShiftDirection"}], ",", " ", "0"}],
                   "}"}], "]"}]}], ",", " ", 
               RowBox[{"Trf", " ", "=", " ", 
                RowBox[{"radTrfTrsl", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", " ", 
                   RowBox[{"Shift1", "*", "ShiftDirection"}]}], "}"}], 
                 "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg1", " ", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"radTrfOrnt", "[", 
                 RowBox[{"#", ",", " ", "Trf"}], "]"}], "&"}], "/@", 
               "CassetteBeg1"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd1", " ", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"radTrfOrnt", "[", 
                 RowBox[{"#", ",", " ", "Trf"}], "]"}], "&"}], "/@", 
               "CassetteEnd1"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg1", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteBeg1", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg2", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteBeg2", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg3", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteBeg3", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteBeg", " ", "=", " ", 
              RowBox[{"{", 
               RowBox[{
               "CassetteBeg1", ",", " ", "CassetteBeg2", ",", " ", 
                "CassetteBeg3"}], "}"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd3", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteEnd3", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd2", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteEnd2", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd1", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"CassetteEnd1", ",", " ", "BlockSubdivision"}], 
                 "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"CassetteEnd", " ", "=", " ", 
              RowBox[{"{", 
               RowBox[{
               "CassetteEnd3", ",", " ", "CassetteEnd2", ",", " ", 
                "CassetteEnd1"}], "}"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", " ", 
              RowBox[{
               RowBox[{"FourBlocks", " ", "\[Equal]", " ", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                  "FieldDirection", " ", "\[Equal]", " ", 
                   "\"\<Horizontal\>\""}], ",", " ", 
                  RowBox[{"Trf", " ", "=", " ", 
                   RowBox[{"radTrfTrsl", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", " ", 
                    RowBox[{"Shift4", "*", "ShiftDirection"}], ",", " ", 
                    "0"}], "}"}], "]"}]}], ",", " ", 
                  RowBox[{"Trf", " ", "=", " ", 
                   RowBox[{"radTrfTrsl", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", " ", 
                    RowBox[{"Shift4", "*", "ShiftDirection"}]}], "}"}], 
                    "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"CassetteBeg4", " ", "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"radTrfOrnt", "[", 
                    RowBox[{"#", ",", " ", "Trf"}], "]"}], "&"}], "/@", 
                  "CassetteBeg4"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"CassetteEnd4", " ", "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"radTrfOrnt", "[", 
                    RowBox[{"#", ",", " ", "Trf"}], "]"}], "&"}], "/@", 
                  "CassetteEnd4"}]}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"CassetteBeg4", " ", "=", " ", 
                 RowBox[{"MapThread", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"radObjDivMag", "[", 
                    RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"CassetteBeg4", ",", " ", "BlockSubdivision"}], 
                    "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"CassetteEnd4", " ", "=", " ", 
                 RowBox[{"MapThread", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"radObjDivMag", "[", 
                    RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"CassetteEnd4", ",", " ", "BlockSubdivision"}], 
                    "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"CassetteBeg", ",", " ", "CassetteBeg4"}], "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"CassetteEnd", ",", " ", "CassetteEnd4"}], "]"}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", "Core", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"CassetteCore", " ", "=", " ", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", " ", "[", 
           RowBox[{
            RowBox[{"i", "=", 
             RowBox[{"(", 
              RowBox[{"NrTermBlocks", "+", "1"}], ")"}]}], ",", " ", 
            RowBox[{"i", "\[LessEqual]", " ", 
             RowBox[{"NrBlocks", " ", "-", " ", "NrTermBlocks"}]}], ",", " ", 
            RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"bl", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"radObjThckPgn", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Pos", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "+", " ", "\[Delta]"}], 
                  ",", "Len", ",", "#", ",", " ", 
                  RowBox[{"RotMag", "[", "i", "]"}]}], "]"}], "&"}], "/@", 
               "Shape"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"bl", " ", "=", " ", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"radObjDivMag", "[", 
                  RowBox[{"#1", ",", " ", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"bl", ",", " ", "BlockSubdivision"}], "}"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"CassetteCore", ",", " ", "bl"}], "]"}], " ", ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Cassette", "   ", "=", " ", 
           RowBox[{"radObjCnt", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
              "CassetteBeg", " ", ",", " ", "CassetteCore", ",", 
               "CassetteEnd"}], "}"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Shift", " ", "the", " ", "cassette"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Shift", "=", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Pos", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "+", " ", 
               RowBox[{"Pos", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}]}], "/", "2"}]}], 
          " ", ";", "\[IndentingNewLine]", 
          RowBox[{"Cassette", " ", "=", " ", 
           RowBox[{"radTrfOrnt", "[", 
            RowBox[{"Cassette", ",", 
             RowBox[{"radTrfTrsl", "[", 
              RowBox[{"{", 
               RowBox[{"Shift", ",", "0", ",", "0"}], "}"}], "]"}]}], "]"}]}],
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "Counterclockwise", " ", "rotation", " ", "of", " ", "the", " ", 
             "cassette", " ", "by"}], " ", "-", 
            RowBox[{
             RowBox[{"\[Pi]", "/", "2"}], " ", "around", " ", "the", " ", 
             "x"}], "-", "axis"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Cassette", "=", " ", 
           RowBox[{"radTrfOrnt", "[", 
            RowBox[{"Cassette", ",", " ", 
             RowBox[{"radTrfRot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{
                RowBox[{"-", "\[Pi]"}], "/", "2"}]}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "Counterclockwise", " ", "rotation", " ", "of", " ", "the", " ", 
             "cassette", " ", "by"}], " ", "-", 
            RowBox[{
             RowBox[{"\[Pi]", "/", "2"}], " ", "around", " ", "the", " ", 
             "y"}], "-", "axis"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Cassette", "=", " ", 
           RowBox[{"radTrfOrnt", "[", 
            RowBox[{"Cassette", ",", " ", 
             RowBox[{"radTrfRot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
               RowBox[{
                RowBox[{"-", "\[Pi]"}], "/", "2"}]}], "]"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Cassette", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7667563716198864`*^9, 3.76675637607336*^9}, {
   3.7667564210925236`*^9, 3.7667565039740367`*^9}, {3.767445221866372*^9, 
   3.7674452499623413`*^9}, 3.7674492825809617`*^9, {3.7826372836996193`*^9, 
   3.782637315936621*^9}, {3.782637359577076*^9, 3.7826374825765934`*^9}, {
   3.782637552607568*^9, 3.78263768450115*^9}, {3.782637743188423*^9, 
   3.7826378222055535`*^9}, {3.782637856189788*^9, 3.782637902285347*^9}, {
   3.782637956646202*^9, 3.7826379589118185`*^9}, {3.7826379963510313`*^9, 
   3.7826380522744694`*^9}, {3.7826380832169104`*^9, 3.782638439756551*^9}, {
   3.7826384823501635`*^9, 3.7826385761329775`*^9}, {3.782638608587835*^9, 
   3.782638715809715*^9}, {3.7826388457671947`*^9, 3.7826390394108934`*^9}, {
   3.7826391010200243`*^9, 3.782639101770018*^9}, {3.782639166051016*^9, 
   3.782639483428545*^9}, {3.782639556287635*^9, 3.782639561334486*^9}, {
   3.7826396491173325`*^9, 3.7826398286009946`*^9}, {3.7826399117901325`*^9, 
   3.7826400534547825`*^9}, {3.782640090532792*^9, 3.7826405585668488`*^9}, {
   3.782640594521858*^9, 3.782640772400242*^9}, {3.7826408291968937`*^9, 
   3.782641220744748*^9}, {3.782641266900818*^9, 3.782641439540758*^9}, {
   3.7826415380716205`*^9, 3.782641576430842*^9}, {3.7826416069325433`*^9, 
   3.782641900267953*^9}, {3.782642091536579*^9, 3.7826421241301994`*^9}, {
   3.782642159770681*^9, 3.782642183333087*^9}, {3.782642768258963*^9, 
   3.7826428182481303`*^9}, {3.7826428851853724`*^9, 
   3.7826429424839563`*^9}, {3.782642980298272*^9, 3.7826429824232635`*^9}, {
   3.7826430294252024`*^9, 3.782643045909505*^9}, {3.782643084190604*^9, 
   3.782643129690423*^9}, {3.7826432037264595`*^9, 3.7826433699932384`*^9}, {
   3.782643405307832*^9, 3.782643478420932*^9}, {3.782643611689359*^9, 
   3.7826438111124973`*^9}, {3.782644897374318*^9, 3.782644921501483*^9}, {
   3.7826450171885633`*^9, 3.782645044032238*^9}, 3.7826450852820787`*^9, {
   3.7826451379869146`*^9, 3.782645156986842*^9}, {3.7834337430222216`*^9, 
   3.7834337438503695`*^9}, {3.7834338345867214`*^9, 3.783433837758585*^9}, {
   3.7849719852731423`*^9, 3.784971987038904*^9}, {3.8006905477684984`*^9, 
   3.8006906423307467`*^9}, {3.800690756221059*^9, 3.800690766236659*^9}, {
   3.8006909297238693`*^9, 3.8006910255517483`*^9}, 3.8006912303535028`*^9, {
   3.8045059921675367`*^9, 3.804505996669073*^9}, {3.804850797352042*^9, 
   3.804850807477048*^9}, {3.8049517589196978`*^9, 3.8049517615685425`*^9}, {
   3.8062286811290216`*^9, 3.806228721202465*^9}, {3.806228979261788*^9, 
   3.8062290170507536`*^9}, {3.8062291180831394`*^9, 3.80622916799267*^9}, {
   3.8062292322098484`*^9, 3.8062293461602297`*^9}, {3.806230986856161*^9, 
   3.8062309872205615`*^9}, {3.806231021987795*^9, 3.8062310387314997`*^9}, 
   3.8062310746834383`*^9, {3.8062311117960773`*^9, 3.8062311267617693`*^9}, {
   3.806231197379216*^9, 3.8062313083139057`*^9}, {3.806231354665861*^9, 
   3.806231359055117*^9}, {3.8062313929050198`*^9, 3.806231398383541*^9}, {
   3.8062314489701333`*^9, 3.8062314964060936`*^9}, {3.806231649251237*^9, 
   3.806231652025425*^9}, {3.8062317279393225`*^9, 3.8062317396088457`*^9}, {
   3.806231974992104*^9, 3.806231975324426*^9}, {3.8062321842108383`*^9, 
   3.80623219202647*^9}, 3.8062322825326595`*^9, {3.806232352649621*^9, 
   3.806232387879024*^9}, {3.8062324469851923`*^9, 3.806232511381152*^9}, {
   3.806232544003265*^9, 3.806232588714759*^9}, {3.8062326239026313`*^9, 
   3.8062326400794697`*^9}, {3.8062326931090703`*^9, 3.806232717248754*^9}, {
   3.806232848010804*^9, 3.8062328589514856`*^9}, {3.8062329608016596`*^9, 
   3.8062329717030077`*^9}, {3.806233107012436*^9, 3.8062331071380606`*^9}, {
   3.806233213092393*^9, 3.806233243495797*^9}, 3.806234151752848*^9, {
   3.811790973348828*^9, 3.81179100069236*^9}, {3.811791034750472*^9, 
   3.8117918513521185`*^9}, {3.811821899399679*^9, 3.811821912870348*^9}, {
   3.8118219737455*^9, 3.811822031222424*^9}, {3.8118220718652563`*^9, 
   3.811822110434097*^9}, {3.8118221498110332`*^9, 3.811822379446498*^9}, 
   3.811822412301318*^9, {3.811822598318445*^9, 3.8118226064557867`*^9}, {
   3.8118236629202824`*^9, 3.811823666303432*^9}, {3.8118536066983304`*^9, 
   3.811853628423772*^9}, {3.8125360888714266`*^9, 3.812536115075982*^9}, {
   3.8125362241527753`*^9, 3.8125362243227973`*^9}, {3.8125362689155827`*^9, 
   3.812536357981106*^9}, {3.8125368905814185`*^9, 3.812536942974682*^9}, {
   3.8125371437134495`*^9, 3.8125371631846704`*^9}, 3.81253729351833*^9, {
   3.8125376101392884`*^9, 3.8125376239801445`*^9}, {3.812537684383421*^9, 
   3.812537841361286*^9}, {3.81253803235649*^9, 3.8125380890700197`*^9}, {
   3.8125382022470665`*^9, 3.8125382524901934`*^9}, {3.812538309483726*^9, 
   3.812538316174163*^9}, {3.8125383476761227`*^9, 3.812538430481282*^9}, {
   3.812538499316957*^9, 3.812538570231386*^9}, {3.8125386112639303`*^9, 
   3.8125386137440615`*^9}, {3.8125386808282604`*^9, 3.812538734463213*^9}, {
   3.8125387952170124`*^9, 3.812538796667104*^9}, {3.812538929406506*^9, 
   3.812538939967165*^9}, {3.812538975559382*^9, 3.812538976679451*^9}, {
   3.8125392861109715`*^9, 3.8125393135226855`*^9}, {3.8125393440945807`*^9, 
   3.812539362055702*^9}, {3.8125394140889397`*^9, 3.812539486052806*^9}, {
   3.8125395280254173`*^9, 3.8125395869290843`*^9}, {3.81254011903574*^9, 
   3.812540161078357*^9}, {3.8125402002707767`*^9, 3.8125402135216017`*^9}, {
   3.8125402523840218`*^9, 3.81254026043453*^9}, {3.8125403715414453`*^9, 
   3.812540473097768*^9}, {3.812540511900181*^9, 3.8125405877695456`*^9}, {
   3.8125406375926485`*^9, 3.8125406401728096`*^9}, 3.8125409888186436`*^9, {
   3.8161781061534595`*^9, 3.8161781816375327`*^9}, {3.8161782517015753`*^9, 
   3.8161782537484426`*^9}, {3.816180407779239*^9, 3.816180445466555*^9}, {
   3.816180792419794*^9, 3.8161807987791433`*^9}, {3.8161808354664993`*^9, 
   3.8161808403258495`*^9}, {3.8161809798409276`*^9, 
   3.8161810150283203`*^9}, {3.8161889397634106`*^9, 3.81618908146509*^9}, {
   3.8161891162204165`*^9, 3.816189364138302*^9}, {3.8161899024986024`*^9, 
   3.8161899764607897`*^9}, {3.816190016294608*^9, 3.816190017216479*^9}, {
   3.816190108478877*^9, 3.816190385809641*^9}, {3.816190519527711*^9, 
   3.8161905348104925`*^9}, {3.8161905702519407`*^9, 
   3.8161905732519293`*^9}, {3.816190623055337*^9, 3.8161906416986494`*^9}, {
   3.8161907314903755`*^9, 3.8161907542447243`*^9}, {3.816190796201868*^9, 
   3.8161908013282037`*^9}, {3.816190838324855*^9, 3.8161908438730707`*^9}, {
   3.816190926859888*^9, 3.8161909307192464`*^9}, {3.816612848368778*^9, 
   3.816612929305269*^9}, {3.8166130846927524`*^9, 3.816613231109089*^9}, {
   3.8166135535337315`*^9, 3.8166136584210224`*^9}, 3.816614204079871*^9, {
   3.816629081579727*^9, 3.8166291978863153`*^9}, {3.816629232772005*^9, 
   3.8166295026830626`*^9}, {3.816629555534605*^9, 3.8166297371760917`*^9}, {
   3.816629951096596*^9, 3.8166299826530952`*^9}, {3.816630661452345*^9, 
   3.816630662083006*^9}, {3.816630729595662*^9, 3.8166307485575027`*^9}, {
   3.816689523978589*^9, 3.816689526877671*^9}, {3.8166895597138705`*^9, 
   3.8166895615751925`*^9}, {3.8166989873184624`*^9, 
   3.8166990361209087`*^9}, {3.8166992608883195`*^9, 
   3.8166993279952765`*^9}, {3.8187637986771817`*^9, 
   3.8187638012972775`*^9}, {3.8187638459525676`*^9, 
   3.8187639719259357`*^9}, {3.818764014538122*^9, 3.8187640757616796`*^9}, {
   3.8188452591640754`*^9, 3.8188453011321845`*^9}, {3.818845341928625*^9, 
   3.818845343633266*^9}, {3.818845387624538*^9, 3.8188454153953238`*^9}, {
   3.8188454679220333`*^9, 3.8188455578771753`*^9}, {3.818845593376182*^9, 
   3.8188456421994534`*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[29]:=",ExpressionUUID->"88230ced-7ab0-4c04-8a67-eb24bb06a7fd"]
}, Closed]],

Cell[CellGroupData[{

Cell["auxIDNumberToString", "Subsection",
 CellChangeTimes->{3.7667546801064196`*^9, 
  3.7667549456130934`*^9},ExpressionUUID->"ed6540fc-c052-4b41-a1d1-\
11fc8d3448cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"auxIDNumberToString", "[", "num_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "sf", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sf", " ", "=", " ", 
       RowBox[{"ScientificForm", "[", 
        RowBox[{
         RowBox[{"N", "[", "num", "]"}], ",", " ", "10", ",", " ", 
         RowBox[{"NumberFormat", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{"#1", ",", "\"\<e\>\"", ",", "#3"}], "}"}], "]"}], 
            "&"}], ")"}]}], ",", " ", 
         RowBox[{"ExponentFunction", "->", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "5"}], "<", "#", "<", "5"}], ",", "Null", ",", 
              "#"}], "]"}], "&"}], ")"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sf", " ", "=", " ", 
       RowBox[{"ToString", "[", "sf", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"StringEndsQ", "[", 
         RowBox[{"sf", ",", " ", "\"\<e\>\""}], "]"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"ToString", "[", 
          RowBox[{
           RowBox[{"StringSplit", "[", 
            RowBox[{"sf", ",", " ", "\"\<e\>\""}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"Return", "[", "sf", "]"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.820155773441057*^9, 3.8201557742611485`*^9}, {
  3.8201558525362673`*^9, 3.820155893078945*^9}, {3.82015615217033*^9, 
  3.8201561574406567`*^9}, {3.820156190742879*^9, 3.820156257597144*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[30]:=",ExpressionUUID->"dbe544c3-e306-475e-8f6f-f45de39e73df"]
}, Closed]],

Cell[CellGroupData[{

Cell["auxIDNewtonLorentzEquation", "Subsection",
 CellChangeTimes->{3.7667546801064196`*^9, 3.7667549456130934`*^9, 
  3.766755008805561*^9},ExpressionUUID->"07ebf3db-cb91-4b84-a9a7-\
c807351444a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"auxIDNewtonLorentzEquation", "[", 
    RowBox[{"a_", ",", "r_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "drds", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"drds", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"drds", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"r", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"drds", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "=", 
       RowBox[{"r", "[", 
        RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"drds", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "=", 
       RowBox[{"r", "[", 
        RowBox[{"[", "6", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"drds", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"-", "a"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"[", "5", "]"}], "]"}], "*", 
           RowBox[{"b", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"[", "6", "]"}], "]"}], "*", 
           RowBox[{"b", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"drds", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"-", "a"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"[", "6", "]"}], "]"}], "*", 
           RowBox[{"b", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "*", 
           RowBox[{"b", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"drds", "[", 
        RowBox[{"[", "6", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"-", "a"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "*", 
           RowBox[{"b", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"[", "5", "]"}], "]"}], "*", 
           RowBox[{"b", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "drds", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[31]:=",ExpressionUUID->"55cadbff-321c-415c-8140-4da3fa8ee30a"]
}, Closed]],

Cell[CellGroupData[{

Cell["auxIDBlockArrow", "Subsection",
 CellChangeTimes->{
  3.766754730782276*^9},ExpressionUUID->"5bb9eb47-9ccd-4f6a-96cc-\
a524dcee03b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"auxIDBlockArrow", "[", 
    RowBox[{"BlockCenter_", ",", " ", "BlockMag_", ",", " ", "ArrowSize_"}], 
    "]"}], ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"MagArrow", ",", " ", "MagDirection"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MagDirection", " ", "=", " ", 
       RowBox[{"Normalize", "[", "BlockMag", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"MagArrow", " ", "=", " ", 
       RowBox[{"Arrow", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"BlockCenter", " ", "-", " ", 
           RowBox[{"MagDirection", " ", "*", 
            RowBox[{"ArrowSize", "/", "2"}]}]}], ",", " ", 
          RowBox[{"BlockCenter", " ", "+", " ", 
           RowBox[{"MagDirection", " ", "*", 
            RowBox[{"ArrowSize", "/", "2"}]}]}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "MagArrow", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[32]:=",ExpressionUUID->"a1dde243-caf9-45aa-b999-a81e2e28e907"]
}, Closed]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Set Directory", "Chapter",
 CellChangeTimes->{{3.7144752481299753`*^9, 3.7144752644163694`*^9}, {
  3.724769257493918*^9, 
  3.724769260400402*^9}},ExpressionUUID->"62a97ffb-394e-4e84-afed-\
3b5318232eab"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "SetDirectory", "[", 
   "\"\<C:\\\\Users\\\\luana.vilela\\\\Desktop\\\\delta_onaxis_fieldmaps\\\\\
model02\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7247692641975746`*^9, 3.7247693030912867`*^9}, 
   3.7247693360001373`*^9, 3.7320053568775253`*^9, 3.732349690257825*^9, {
   3.732871709479047*^9, 3.7328717118852863`*^9}, {3.7329567238206897`*^9, 
   3.7329567258363123`*^9}, 3.748957419661892*^9, {3.7489624425948105`*^9, 
   3.7489624446418552`*^9}, {3.7489767421165304`*^9, 
   3.7489767440073037`*^9}, {3.7511001230276623`*^9, 3.75110012579725*^9}, 
   3.7511411057661276`*^9, {3.7571464911653185`*^9, 3.757146493384221*^9}, 
   3.7876561315405025`*^9, 3.7876676883664165`*^9, 3.7982006252779846`*^9, {
   3.7984654527917624`*^9, 3.7984654540105295`*^9}, 3.7984663899212046`*^9, {
   3.798466466390125*^9, 3.7984664684994793`*^9}, 3.800036087694026*^9, {
   3.800038304096528*^9, 3.8000383140652494`*^9}, 3.8003047290105705`*^9, {
   3.813666547262052*^9, 3.8136665743061132`*^9}, 3.815744536042758*^9, 
   3.815913537512823*^9, {3.8160848576375723`*^9, 3.8160848605750694`*^9}, 
   3.819099815172518*^9, 3.819444458879774*^9, 3.81998746749841*^9, 
   3.8200531624537296`*^9, 3.820156726151952*^9, 3.8202355839373245`*^9},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[33]:=",ExpressionUUID->"4c139ebb-aba3-4042-8355-2160f9f0f573"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Delta Sabi\[AAcute] ", "Chapter",
 CellChangeTimes->{{3.681300194179221*^9, 3.6813002033832407`*^9}, {
   3.681305983976405*^9, 3.6813059853359213`*^9}, {3.6813176225703306`*^9, 
   3.6813176235079107`*^9}, {3.6813177175941257`*^9, 3.68131771915676*^9}, {
   3.708272177122472*^9, 3.708272189394394*^9}, {3.708272239370994*^9, 
   3.708272253185425*^9}, {3.7247626663439655`*^9, 3.724762668594143*^9}, 
   3.724763762181196*^9, {3.725974849294973*^9, 3.725974857279992*^9}, {
   3.7316800228814087`*^9, 3.7316800249126425`*^9}, {3.731761928333893*^9, 
   3.731761928740137*^9}, {3.7377345647344294`*^9, 3.7377345664687967`*^9}, {
   3.737994165253688*^9, 3.7379941653786864`*^9}, {3.7489625392900763`*^9, 
   3.7489625531505637`*^9}, {3.749318816981333*^9, 3.749318817559469*^9}, {
   3.7656382216793394`*^9, 3.7656382261328287`*^9}, {3.7662401432029853`*^9, 
   3.766240154985159*^9}, {3.7663282678653297`*^9, 3.766328270484855*^9}, {
   3.766331146283388*^9, 3.7663311568355923`*^9}, {3.7663982782306576`*^9, 
   3.7663982795028768`*^9}, {3.7664037488989267`*^9, 
   3.7664037535714073`*^9}, {3.76675425955847*^9, 3.766754260902328*^9}, {
   3.767446029232342*^9, 3.7674460297011285`*^9}, {3.7675176217294626`*^9, 
   3.767517621841589*^9}, {3.7685471006341314`*^9, 3.7685471031625986`*^9}, {
   3.782651674525923*^9, 3.7826516762290554`*^9}, {3.7827472341594315`*^9, 
   3.7827472344406757`*^9}, {3.7845390971377993`*^9, 
   3.7845390993098416`*^9}, {3.7846213628789454`*^9, 
   3.7846213635508842`*^9}, {3.784971285415371*^9, 3.784971285852929*^9}, {
   3.80003815573755*^9, 3.8000381597687845`*^9}, {3.8049514458306084`*^9, 
   3.804951448440013*^9}, {3.8062446719465714`*^9, 3.8062446751540537`*^9}, {
   3.811791929593967*^9, 3.8117919321569138`*^9}, {3.8117920042649097`*^9, 
   3.811792032147236*^9}, {3.8118212232455654`*^9, 3.8118212243258395`*^9}, {
   3.811855173078432*^9, 3.8118551748205085`*^9}, {3.813666226120046*^9, 
   3.8136662293236427`*^9}, {3.8157445404480095`*^9, 3.815744553217987*^9}, 
   3.8194444635501432`*^9},ExpressionUUID->"14114740-1747-4179-b27c-\
fc3a885d635f"],

Cell[CellGroupData[{

Cell["Parameters", "Section",
 CellChangeTimes->{{3.76639811614032*^9, 3.7663981237176037`*^9}, {
  3.8117926979894156`*^9, 3.811792703856547*^9}, {3.8118552160849347`*^9, 
  3.811855218607912*^9}},ExpressionUUID->"203cdc6e-83ea-4360-b14c-\
6ae2bef4e227"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"ID", " ", "main", " ", "parameters"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]u", " ", "=", " ", "52.5"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Np", " ", "=", " ", "21"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Gap", " ", "=", " ", "13.6"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockGap", " ", "=", " ", "0.125"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"PM", " ", "material", " ", "parameters"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Mr", " ", "=", " ", "1.37"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Block", " ", "shape"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockShapeA", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "5.25"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "22.5"}], ",", "19.3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "22.5"}], ",", " ", "29.2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "17.8"}], ",", " ", "33.2"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"17.8", ",", " ", "33.2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"22.5", ",", "29.2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"22.5", ",", "19.3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5.25", ",", "0"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockShapeB", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "17.8"}], ",", " ", "33.2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "17.8"}], ",", "38.4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"17.8", ",", " ", "38.4"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"17.8", ",", " ", "33.2"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockShapeC", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "17.8"}], ",", "38.4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "22.5"}], ",", "42.4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "22.5"}], ",", "49"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "21.5"}], ",", "50"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"21.5", ",", "50"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"22.5", ",", "49"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"22.5", ",", "42.4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"17.8", ",", "38.4"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockShape", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"BlockShapeA", ",", " ", "BlockShapeB", ",", "BlockShapeC"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockSubdivisionA", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"3", ",", " ", "3", ",", " ", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockSubdivisionB", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"3", ",", " ", "1", ",", " ", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockSubdivisionC", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"3", ",", " ", "1", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockSubdivision", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "BlockSubdivisionA", ",", " ", "BlockSubdivisionB", ",", " ", 
       "BlockSubdivisionC"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Solver", " ", "options"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Prec", " ", "=", " ", 
     RowBox[{"10", "^", 
      RowBox[{"-", "8"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MaxIter", " ", "=", " ", 
     RowBox[{"10", "^", "6"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Longitudinal", " ", 
     RowBox[{"range", " ", "[", "mm", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Lstep", " ", "=", " ", "0.5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Li", " ", "=", " ", 
     RowBox[{"-", "800"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Lf", " ", "=", " ", "800"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Lnpts", " ", "=", 
     RowBox[{
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Lf", " ", "-", " ", "Li"}], ")"}], "/", "Lstep"}], " ", 
       "]"}], "+", " ", "1"}]}], ";"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Horizontal", " ", 
     RowBox[{"range", " ", "[", "mm", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hstep", " ", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hi", " ", "=", " ", 
     RowBox[{"-", "5"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hf", " ", "=", " ", "5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hnpts", " ", "=", " ", 
     RowBox[{
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Hf", " ", "-", " ", "Hi"}], ")"}], "/", "Hstep"}], " ", 
       "]"}], "+", " ", "1"}]}], ";"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Vertical", " ", 
     RowBox[{"range", " ", "[", "mm", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vstep", " ", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vi", " ", "=", " ", 
     RowBox[{"-", "3"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vf", " ", "=", " ", "3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vnpts", " ", "=", " ", 
     RowBox[{
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Vf", " ", "-", " ", "Vi"}], ")"}], "/", "Vstep"}], " ", 
       "]"}], "+", " ", "1"}]}], ";"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Particle", " ", 
     RowBox[{"energy", " ", "[", "GeV", "]"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Energy", " ", "=", " ", "3"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Radia", " ", "randomization", " ", "magnitudes"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"radFldLenTol", "[", 
     RowBox[{
      RowBox[{"10", "^", 
       RowBox[{"-", "12"}]}], ",", 
      RowBox[{"10", "^", 
       RowBox[{"-", "12"}]}]}], " ", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"ID", " ", "label"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MagnetName", "=", "\"\<DeltaSabia_Model02\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Silent", " ", "flag"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Silent", " ", "=", " ", "True"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "Termination", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Termination", " ", "=", " ", "\"\<VarSizesAntiSym\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Size1", " ", "=", "  ", "3.25"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Size2", " ", "=", " ", "9.75"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Size3", " ", "=", " ", "9.75"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Size4", " ", "=", " ", "3.25"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Gap1", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Gap2", "=", " ", "4.5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Gap3", " ", "=", " ", "1.1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Gap4", " ", "=", " ", "6.8"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Shift1", " ", "=", "0"}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Shift2", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Shift3", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Shift4", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MagnetLength", " ", "=", " ", 
     RowBox[{
      RowBox[{"Np", "*", "\[Lambda]u"}], " ", "+", 
      RowBox[{"\[Lambda]u", "/", "4"}], "+", " ", 
      RowBox[{"2", "Size1"}], "+", 
      RowBox[{"2", "Size2"}], "+", 
      RowBox[{"2", "Size3"}], "+", 
      RowBox[{"2", "Size4"}], "+", 
      RowBox[{"2", "Gap1"}], "+", 
      RowBox[{"2", "Gap2"}], "+", 
      RowBox[{"2", "Gap3"}], "+", 
      RowBox[{"2", "Gap4"}]}]}], ";"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Delta]GList", " ", "=", " ", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", 
         RowBox[{"1", "/", "8"}], ",", " ", 
         RowBox[{"1", "/", "4"}], ",", " ", 
         RowBox[{"3", "/", "8"}]}], "}"}]}], "*", "\[Lambda]u"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Delta]CPList", " ", "=", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "8"}], ",", " ", 
        RowBox[{"1", "/", "4"}], ",", " ", 
        RowBox[{"3", "/", "8"}]}], "}"}], "*", "\[Lambda]u"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CalcTraj", " ", "=", " ", "False"}], ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.811855207172743*^9, {3.8118552376751156`*^9, 3.811855275314695*^9}, {
   3.811855308364966*^9, 3.811855346532337*^9}, {3.8118557027938423`*^9, 
   3.811855702925171*^9}, {3.8118558092389507`*^9, 3.8118558093790627`*^9}, {
   3.811855908058054*^9, 3.811855908459084*^9}, {3.811856081254526*^9, 
   3.8118561692498074`*^9}, {3.811856273232277*^9, 3.81185627338993*^9}, {
   3.81185722712294*^9, 3.8118572605837917`*^9}, {3.811858735804346*^9, 
   3.811858779588729*^9}, {3.8118589053674154`*^9, 3.8118589062479534`*^9}, {
   3.8118595391736546`*^9, 3.811859547778454*^9}, {3.8118596833788958`*^9, 
   3.811859685326743*^9}, {3.8118597441516953`*^9, 3.8118597495638866`*^9}, {
   3.811859784644433*^9, 3.811859794582543*^9}, {3.811859829052552*^9, 
   3.811859871760453*^9}, {3.8118600609322777`*^9, 3.8118601507438817`*^9}, {
   3.811860581708088*^9, 3.811860582338484*^9}, {3.811861410043792*^9, 
   3.8118614169696198`*^9}, {3.811862208244576*^9, 3.8118622113284826`*^9}, {
   3.8118641025775394`*^9, 3.8118641610648546`*^9}, {3.8118643600561056`*^9, 
   3.8118643828865585`*^9}, {3.811864443079011*^9, 3.811864512881933*^9}, {
   3.811993905187863*^9, 3.811993923288112*^9}, {3.8119946982651463`*^9, 
   3.811994816826828*^9}, {3.8119949571054792`*^9, 3.8119949806237135`*^9}, {
   3.8119954359278374`*^9, 3.811995465916664*^9}, {3.8119958892166176`*^9, 
   3.811995889626624*^9}, {3.811996963630056*^9, 3.8119969651118603`*^9}, {
   3.812096164248562*^9, 3.8120961661986866`*^9}, {3.8124426592342777`*^9, 
   3.812442745989946*^9}, {3.8124428389174237`*^9, 3.8124428391074553`*^9}, {
   3.812527230138237*^9, 3.812527230458268*^9}, {3.81252799770525*^9, 
   3.8125280007054453`*^9}, {3.812535550024563*^9, 3.812535643410362*^9}, {
   3.812542457566344*^9, 3.8125425541923804`*^9}, {3.81254258608436*^9, 
   3.8125425973350773`*^9}, {3.812542911852826*^9, 3.8125429231335464`*^9}, {
   3.812606154017066*^9, 3.812606155067148*^9}, {3.813666249289554*^9, 
   3.8136663337349753`*^9}, {3.813666404159743*^9, 3.813666406213176*^9}, {
   3.813666864813153*^9, 3.813666873654956*^9}, {3.815744558107267*^9, 
   3.8157445876424084`*^9}, {3.8157451165219603`*^9, 3.815745128888291*^9}, {
   3.815745541424957*^9, 3.815745542130571*^9}, {3.8157504810312405`*^9, 
   3.815750486790907*^9}, {3.815750925612025*^9, 3.8157509331318073`*^9}, {
   3.815751189024087*^9, 3.815751189254117*^9}, {3.8157512493682775`*^9, 
   3.8157512494783783`*^9}, {3.8157514619795437`*^9, 
   3.8157514626808777`*^9}, {3.815752239682006*^9, 3.815752241191635*^9}, {
   3.8157526903683243`*^9, 3.815752691711067*^9}, {3.8157532348434033`*^9, 
   3.815753246959155*^9}, {3.815913804285653*^9, 3.8159138070900755`*^9}, {
   3.815914182298482*^9, 3.815914183480729*^9}, {3.8159154784810677`*^9, 
   3.8159154895651927`*^9}, {3.8160826167214503`*^9, 3.816082685268034*^9}, 
   3.8160829737316103`*^9, {3.816083195405877*^9, 3.816083196780873*^9}, {
   3.8160848672625313`*^9, 3.816084887231207*^9}, {3.8161799487633095`*^9, 
   3.816179968028837*^9}, {3.816180472249189*^9, 3.8161804748898354`*^9}, {
   3.8161806475453415`*^9, 3.816180647701652*^9}, {3.8161807052326756`*^9, 
   3.816180705779517*^9}, {3.816181147277858*^9, 3.8161811530590982`*^9}, {
   3.8161895617390995`*^9, 3.8161895742859335`*^9}, {3.8166134361251383`*^9, 
   3.8166134427239065`*^9}, {3.8166136799002304`*^9, 
   3.8166137121822486`*^9}, {3.8166306364786444`*^9, 3.816630637331376*^9}, {
   3.8168857523176584`*^9, 3.8168857582357388`*^9}, {3.816888759688429*^9, 
   3.8168887601415772`*^9}, {3.816889323456911*^9, 3.816889328441248*^9}, {
   3.8170522610742545`*^9, 3.8170522682555227`*^9}, {3.817072726354745*^9, 
   3.817072733472889*^9}, {3.8187660745340295`*^9, 3.81876607486409*^9}, {
   3.8187685262503304`*^9, 3.818768531890706*^9}, {3.818773918503582*^9, 
   3.818773919763671*^9}, {3.81877698759726*^9, 3.8187769963178053`*^9}, {
   3.818842228899935*^9, 3.8188422339376554`*^9}, 3.8189269780774603`*^9, {
   3.8189273043443546`*^9, 3.8189273045746384`*^9}, {3.81892790363011*^9, 
   3.8189279037372627`*^9}, {3.818936369734997*^9, 3.8189363701456203`*^9}, {
   3.8190998487545567`*^9, 3.819099882068619*^9}, {3.8190999149706125`*^9, 
   3.8190999481525745`*^9}, {3.8191002169088745`*^9, 
   3.8191002171488485`*^9}, {3.819102699213158*^9, 3.81910270546364*^9}, {
   3.8199874779991627`*^9, 3.819987492440054*^9}, {3.820049291477436*^9, 
   3.820049293316618*^9}, 3.820063419672714*^9, {3.820149912382104*^9, 
   3.8201499631654477`*^9}, {3.820150070192515*^9, 3.820150155418107*^9}, {
   3.8201508467785945`*^9, 3.8201508719402676`*^9}, {3.820152861296486*^9, 
   3.820152892098501*^9}, {3.8201530031870017`*^9, 3.8201530043770795`*^9}, {
   3.8201567348525677`*^9, 3.8201567529037657`*^9}, {3.82015743805989*^9, 
   3.8201574409301023`*^9}, {3.820158045451233*^9, 3.820158093084323*^9}, {
   3.820219988458577*^9, 3.8202199931465425`*^9}, 3.8202204274060993`*^9, {
   3.820235408539823*^9, 3.8202354091295204`*^9}, {3.8202357627763214`*^9, 
   3.820235846084488*^9}, {3.820236144270729*^9, 3.820236147239374*^9}, {
   3.8202365693571186`*^9, 3.820236574574421*^9}, {3.8202385969806156`*^9, 
   3.820238601198448*^9}, {3.820247621092806*^9, 3.8202476288588147`*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[34]:=",ExpressionUUID->"7e941638-cf76-41c4-b8fa-d0bc095ce284"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Horizontal Polarization", "Chapter",
 CellChangeTimes->{{3.681300194179221*^9, 3.6813002033832407`*^9}, {
   3.681305983976405*^9, 3.6813059853359213`*^9}, {3.6813176225703306`*^9, 
   3.6813176235079107`*^9}, {3.6813177175941257`*^9, 3.68131771915676*^9}, {
   3.708272177122472*^9, 3.708272189394394*^9}, {3.708272239370994*^9, 
   3.708272253185425*^9}, {3.7247626663439655`*^9, 3.724762668594143*^9}, 
   3.724763762181196*^9, {3.725974849294973*^9, 3.725974857279992*^9}, {
   3.7316800228814087`*^9, 3.7316800249126425`*^9}, {3.731761928333893*^9, 
   3.731761928740137*^9}, {3.7377345647344294`*^9, 3.7377345664687967`*^9}, {
   3.737994165253688*^9, 3.7379941653786864`*^9}, {3.7489625392900763`*^9, 
   3.7489625531505637`*^9}, {3.749318816981333*^9, 3.749318817559469*^9}, {
   3.7656382216793394`*^9, 3.7656382261328287`*^9}, {3.7662401432029853`*^9, 
   3.766240154985159*^9}, {3.7663282678653297`*^9, 3.766328270484855*^9}, {
   3.766331146283388*^9, 3.7663311568355923`*^9}, {3.7663982782306576`*^9, 
   3.7663982795028768`*^9}, {3.7664037488989267`*^9, 
   3.7664037535714073`*^9}, {3.76675425955847*^9, 3.766754260902328*^9}, {
   3.767446029232342*^9, 3.7674460297011285`*^9}, {3.7675176217294626`*^9, 
   3.767517621841589*^9}, {3.7685471006341314`*^9, 3.7685471031625986`*^9}, {
   3.782651674525923*^9, 3.7826516762290554`*^9}, {3.7827472341594315`*^9, 
   3.7827472344406757`*^9}, {3.7845390971377993`*^9, 
   3.7845390993098416`*^9}, {3.7846213628789454`*^9, 
   3.7846213635508842`*^9}, {3.784971285415371*^9, 3.784971285852929*^9}, {
   3.80003815573755*^9, 3.8000381597687845`*^9}, {3.8049514458306084`*^9, 
   3.804951448440013*^9}, {3.8062446719465714`*^9, 3.8062446751540537`*^9}, {
   3.811791929593967*^9, 3.8117919321569138`*^9}, {3.8117920042649097`*^9, 
   3.811792032147236*^9}, {3.8118212232455654`*^9, 3.8118212243258395`*^9}, {
   3.811855173078432*^9, 3.8118551748205085`*^9}, {3.813666226120046*^9, 
   3.8136662293236427`*^9}, {3.8157445404480095`*^9, 3.815744553217987*^9}, 
   3.8194444635501432`*^9, {3.8200470241049037`*^9, 3.8200470540438976`*^9}, {
   3.8200479202353115`*^9, 3.8200479218146176`*^9}, {3.820063087622788*^9, 
   3.8200630909436483`*^9}},ExpressionUUID->"1093adc8-81a2-4d0f-9b14-\
0bb8a553561a"],

Cell[CellGroupData[{

Cell["\[Delta]GH", "Section",
 CellChangeTimes->{{3.8201580063786097`*^9, 
  3.820158019009424*^9}},ExpressionUUID->"053c45df-8ca5-4967-baf7-\
b8ccd3a87258"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]P", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]CP", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GV", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GH", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Polarization", "=", "\"\<LinearPolarization\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PhaseName", " ", "=", " ", "\"\<dGH\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t0", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", " ", 
      RowBox[{"Length", "[", "\[Delta]GList", "]"}]}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<shift[mm]: \>\"", ",", " ", 
        RowBox[{"\[Delta]GList", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Delta]GH", " ", "=", " ", 
       RowBox[{"\[Delta]GList", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Device", "=", " ", 
       RowBox[{"IDDelta", "[", 
        RowBox[{
        "\[Lambda]u", ",", " ", "Np", ",", " ", "Mr", ",", " ", "Gap", ",", 
         "  ", 
         RowBox[{"\"\<\[Delta]P\>\"", "\[Rule]", " ", "\[Delta]P"}], ",", " ", 
         RowBox[{"\"\<\[Delta]GV\>\"", "\[Rule]", " ", "\[Delta]GV"}], ",", 
         " ", 
         RowBox[{"\"\<\[Delta]GH\>\"", "\[Rule]", " ", "\[Delta]GH"}], ",", 
         " ", 
         RowBox[{"\"\<\[Delta]CP\>\"", "\[Rule]", " ", "\[Delta]CP"}], ",", 
         " ", 
         RowBox[{"\"\<BlockShape\>\"", " ", "\[Rule]", " ", "BlockShape"}], 
         " ", ",", " ", 
         RowBox[{"\"\<BlockGap\>\"", " ", "\[Rule]", " ", "BlockGap"}], " ", 
         ",", 
         RowBox[{"\"\<Termination\>\"", "\[Rule]", " ", "Termination"}], ",", 
         " ", 
         RowBox[{
         "\"\<BlockSubdivision\>\"", "\[Rule]", " ", "BlockSubdivision"}], 
         ",", " ", 
         RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "Silent"}], ",", "  ", 
         RowBox[{"\"\<Size1\>\"", "\[Rule]", " ", "Size1"}], ",", " ", 
         RowBox[{"\"\<Size2\>\"", "\[Rule]", " ", "Size2"}], ",", " ", 
         RowBox[{"\"\<Size3\>\"", "\[Rule]", " ", "Size3"}], ",", " ", 
         RowBox[{"\"\<Size4\>\"", "\[Rule]", " ", "Size4"}], ",", 
         RowBox[{"\"\<Gap1\>\"", "\[Rule]", " ", "Gap1"}], ",", " ", 
         RowBox[{"\"\<Gap2\>\"", "\[Rule]", " ", "Gap2"}], ",", " ", 
         RowBox[{"\"\<Gap3\>\"", "\[Rule]", " ", "Gap3"}], ",", 
         RowBox[{"\"\<Gap4\>\"", "\[Rule]", " ", "Gap4"}], ",", " ", 
         RowBox[{"\"\<Shift1\>\"", "\[Rule]", " ", "Shift1"}], ",", " ", 
         RowBox[{"\"\<Shift2\>\"", "\[Rule]", " ", "Shift2"}], ",", " ", 
         RowBox[{"\"\<Shift3\>\"", "\[Rule]", " ", "Shift3"}], ",", " ", 
         RowBox[{"\"\<Shift4\>\"", "\[Rule]", " ", "Shift4"}], ",", " ", 
         RowBox[{"\"\<FourBlocks\>\"", "\[Rule]", " ", "1"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Mat", "=", " ", 
       RowBox[{"RadMatNdFeB", "[", "Mr", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Device", "=", " ", 
       RowBox[{"radMatApl", "[", 
        RowBox[{"Device", ",", " ", "Mat"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"IDSolve", "[", 
       RowBox[{"Device", ",", " ", "Prec", ",", " ", "MaxIter", ",", " ", 
        RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "Silent"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"IDFieldMapWithHeader", "[", 
       RowBox[{"Device", ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"Li", ",", " ", "Lf"}], "}"}], ",", " ", "1", ",", " ", "1", 
        ",", " ", "Lnpts", ",", " ", "MagnetName", ",", " ", "Polarization", 
        ",", " ", "PhaseName", ",", " ", "MagnetLength", ",", "\[Lambda]u", 
        ",", " ", "Gap", ",", " ", "\[Delta]P", ",", " ", "\[Delta]GV", ",", 
        " ", "\[Delta]GH", ",", " ", "\[Delta]CP"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"CalcTraj", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"IDTrajectoryFile", "[", 
          RowBox[{"Device", ",", " ", "Energy", ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", " ", "0", ",", " ", "Li", ",", " ", "0", ",", " ", "0", 
             ",", " ", "1"}], "}"}], ",", "Lf", ",", "Lstep", ",", " ", 
           "MagnetName", ",", " ", "Polarization", ",", " ", "PhaseName", ",",
            " ", "MagnetLength", ",", "\[Lambda]u", ",", " ", "Gap", ",", " ",
            "\[Delta]P", ",", " ", "\[Delta]GV", ",", " ", "\[Delta]GH", ",", 
           " ", "\[Delta]CP"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Elapsed time = \>\"", ",", 
    RowBox[{"(", 
     RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8200481107642474`*^9, 3.8200481587837424`*^9}, {
   3.820048197117392*^9, 3.820048197937029*^9}, {3.8200509409117136`*^9, 
   3.820050944440159*^9}, {3.820051064048478*^9, 3.8200510642184086`*^9}, {
   3.8200512480184298`*^9, 3.8200512573242693`*^9}, {3.8200521112218113`*^9, 
   3.820052115329935*^9}, {3.8200630689414687`*^9, 3.8200631054369073`*^9}, {
   3.8200633049361115`*^9, 3.820063306815239*^9}, {3.820063371675081*^9, 
   3.8200633761430044`*^9}, {3.82006390421078*^9, 3.820063904720542*^9}, {
   3.8201495538865643`*^9, 3.8201495542966237`*^9}, {3.8201497915822363`*^9, 
   3.820149983546794*^9}, 3.8201500276496797`*^9, {3.8201501945306916`*^9, 
   3.8201501959708023`*^9}, {3.8201508544391437`*^9, 
   3.8201508593694563`*^9}, {3.820152769570441*^9, 3.820152771470558*^9}, {
   3.820152848715656*^9, 3.8201529443319683`*^9}, {3.820152999816786*^9, 
   3.8201530180679955`*^9}, {3.8201536575874186`*^9, 3.8201536681081467`*^9}, 
   3.8201539351575203`*^9, {3.8201568830223465`*^9, 3.8201568873025694`*^9}, {
   3.8201576175133305`*^9, 3.820157623623746*^9}, {3.820158038650758*^9, 
   3.8201580409408894`*^9}, {3.8201581036150494`*^9, 3.820158219334298*^9}, {
   3.820158294020669*^9, 3.820158317492241*^9}, {3.820158522885709*^9, 
   3.820158523105774*^9}, {3.820247605310929*^9, 3.820247673298539*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[82]:=",ExpressionUUID->"f4b38c68-7e12-42de-8041-808a089820a4"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", "0.`"}],
  SequenceForm["shift[mm]: ", 0.],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202478332235136`*^9},
 CellLabel->
  "During evaluation of \
In[82]:=",ExpressionUUID->"14fce203-3d39-40cf-a214-747e769c1373"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=5.99_Kv=0.0_Z=-800_\
800mm_dGH.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=5.99_Kv=0.0_Z=-800_\
800mm_dGH.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202478957231894`*^9},
 CellLabel->
  "During evaluation of \
In[82]:=",ExpressionUUID->"3e2c1324-e8b7-4df4-8870-a35882a47910"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.6083172`8.805813231296778", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.6083172`8.805813231296778, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202478957331867`*^9},
 CellLabel->
  "During evaluation of \
In[82]:=",ExpressionUUID->"9d61db12-cac8-4573-81df-4ec4bb812416"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "6.5625`"}]}],
  SequenceForm["shift[mm]: ", -6.5625],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202478957432103`*^9},
 CellLabel->
  "During evaluation of \
In[82]:=",ExpressionUUID->"c9641b38-244b-438d-86aa-344b6affb64c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=5.57_Kv=0.0_Z=-800_\
800mm_dGH.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=5.57_Kv=0.0_Z=-800_\
800mm_dGH.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202479579310427`*^9},
 CellLabel->
  "During evaluation of \
In[82]:=",ExpressionUUID->"dc99ab99-59d8-4225-875a-c87026b6639c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.088582`8.795712830266371", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.088582`8.795712830266371, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202479579310427`*^9},
 CellLabel->
  "During evaluation of \
In[82]:=",ExpressionUUID->"47b43f16-afa8-4e6a-92f6-870141fddf9a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "13.125`"}]}],
  SequenceForm["shift[mm]: ", -13.125],
  Editable->False]], "Print",
 CellChangeTimes->{3.820247957941038*^9},
 CellLabel->
  "During evaluation of \
In[82]:=",ExpressionUUID->"1a94137c-5527-4601-b624-278de172bc3e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=4.24_Kv=0.0_Z=-800_\
800mm_dGH.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=4.24_Kv=0.0_Z=-800_\
800mm_dGH.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820248020178878*^9},
 CellLabel->
  "During evaluation of \
In[82]:=",ExpressionUUID->"cee11326-a691-4b92-90ed-8c69b584acfb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.0785899`8.795516326221403", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.0785899`8.795516326221403, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820248020178878*^9},
 CellLabel->
  "During evaluation of \
In[82]:=",ExpressionUUID->"fe6578ac-2b11-4b28-bcb9-7f509efd6c11"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "19.6875`"}]}],
  SequenceForm["shift[mm]: ", -19.6875],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202480201888895`*^9},
 CellLabel->
  "During evaluation of \
In[82]:=",ExpressionUUID->"87bbd9e6-7fbd-4d34-847a-c4ed9c3457aa"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=2.2_Kv=0.0_Z=-800_\
800mm_dGH.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=2.2_Kv=0.0_Z=-800_\
800mm_dGH.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820248082556642*^9},
 CellLabel->
  "During evaluation of \
In[82]:=",ExpressionUUID->"504532fc-1467-410e-b06e-5ac6650517be"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.0785873`8.795516275078382", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.0785873`8.795516275078382, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820248082556642*^9},
 CellLabel->
  "During evaluation of \
In[82]:=",ExpressionUUID->"0d61aa58-8786-4efa-a35d-0443d59e5f03"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Elapsed time = \"\>", "\[InvisibleSpace]", 
   "249.3630719`9.848377132865018", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm["Elapsed time = ", 249.3630719`9.848377132865018, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820248082566663*^9},
 CellLabel->
  "During evaluation of \
In[82]:=",ExpressionUUID->"9dc14c0a-0fc6-4663-b464-fe95ddf82e5f"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Delta]GV", "Section",
 CellChangeTimes->{{3.8201580063786097`*^9, 3.820158019009424*^9}, {
  3.8201621504380217`*^9, 
  3.820162151958124*^9}},ExpressionUUID->"293453a5-abcf-4424-a928-\
43ea6fecda5f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]P", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]CP", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GV", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GH", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Polarization", "=", "\"\<LinearPolarization\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PhaseName", " ", "=", " ", "\"\<dGV\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t0", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", " ", 
      RowBox[{"Length", "[", "\[Delta]GList", "]"}]}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<shift[mm]: \>\"", ",", " ", 
        RowBox[{"\[Delta]GList", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Delta]GV", " ", "=", " ", 
       RowBox[{"\[Delta]GList", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Device", "=", " ", 
       RowBox[{"IDDelta", "[", 
        RowBox[{
        "\[Lambda]u", ",", " ", "Np", ",", " ", "Mr", ",", " ", "Gap", ",", 
         "  ", 
         RowBox[{"\"\<\[Delta]P\>\"", "\[Rule]", " ", "\[Delta]P"}], ",", " ", 
         RowBox[{"\"\<\[Delta]GV\>\"", "\[Rule]", " ", "\[Delta]GV"}], ",", 
         " ", 
         RowBox[{"\"\<\[Delta]GH\>\"", "\[Rule]", " ", "\[Delta]GH"}], ",", 
         " ", 
         RowBox[{"\"\<\[Delta]CP\>\"", "\[Rule]", " ", "\[Delta]CP"}], ",", 
         " ", 
         RowBox[{"\"\<BlockShape\>\"", " ", "\[Rule]", " ", "BlockShape"}], 
         " ", ",", " ", 
         RowBox[{"\"\<BlockGap\>\"", " ", "\[Rule]", " ", "BlockGap"}], " ", 
         ",", 
         RowBox[{"\"\<Termination\>\"", "\[Rule]", " ", "Termination"}], ",", 
         " ", 
         RowBox[{
         "\"\<BlockSubdivision\>\"", "\[Rule]", " ", "BlockSubdivision"}], 
         ",", " ", 
         RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "Silent"}], ",", "  ", 
         RowBox[{"\"\<Size1\>\"", "\[Rule]", " ", "Size1"}], ",", " ", 
         RowBox[{"\"\<Size2\>\"", "\[Rule]", " ", "Size2"}], ",", " ", 
         RowBox[{"\"\<Size3\>\"", "\[Rule]", " ", "Size3"}], ",", " ", 
         RowBox[{"\"\<Size4\>\"", "\[Rule]", " ", "Size4"}], ",", 
         RowBox[{"\"\<Gap1\>\"", "\[Rule]", " ", "Gap1"}], ",", " ", 
         RowBox[{"\"\<Gap2\>\"", "\[Rule]", " ", "Gap2"}], ",", " ", 
         RowBox[{"\"\<Gap3\>\"", "\[Rule]", " ", "Gap3"}], ",", 
         RowBox[{"\"\<Gap4\>\"", "\[Rule]", " ", "Gap4"}], ",", " ", 
         RowBox[{"\"\<Shift1\>\"", "\[Rule]", " ", "Shift1"}], ",", " ", 
         RowBox[{"\"\<Shift2\>\"", "\[Rule]", " ", "Shift2"}], ",", " ", 
         RowBox[{"\"\<Shift3\>\"", "\[Rule]", " ", "Shift3"}], ",", " ", 
         RowBox[{"\"\<Shift4\>\"", "\[Rule]", " ", "Shift4"}], ",", " ", 
         RowBox[{"\"\<FourBlocks\>\"", "\[Rule]", " ", "1"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Mat", "=", " ", 
       RowBox[{"RadMatNdFeB", "[", "Mr", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Device", "=", " ", 
       RowBox[{"radMatApl", "[", 
        RowBox[{"Device", ",", " ", "Mat"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"IDSolve", "[", 
       RowBox[{"Device", ",", " ", "Prec", ",", " ", "MaxIter", ",", " ", 
        RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "Silent"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"IDFieldMapWithHeader", "[", 
       RowBox[{"Device", ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"Li", ",", " ", "Lf"}], "}"}], ",", " ", "1", ",", " ", "1", 
        ",", " ", "Lnpts", ",", " ", "MagnetName", ",", " ", "Polarization", 
        ",", " ", "PhaseName", ",", " ", "MagnetLength", ",", "\[Lambda]u", 
        ",", " ", "Gap", ",", " ", "\[Delta]P", ",", " ", "\[Delta]GV", ",", 
        " ", "\[Delta]GH", ",", " ", "\[Delta]CP"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"CalcTraj", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"IDTrajectoryFile", "[", 
          RowBox[{"Device", ",", " ", "Energy", ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", " ", "0", ",", " ", "Li", ",", " ", "0", ",", " ", "0", 
             ",", " ", "1"}], "}"}], ",", "Lf", ",", "Lstep", ",", " ", 
           "MagnetName", ",", " ", "Polarization", ",", " ", "PhaseName", ",",
            " ", "MagnetLength", ",", "\[Lambda]u", ",", " ", "Gap", ",", " ",
            "\[Delta]P", ",", " ", "\[Delta]GV", ",", " ", "\[Delta]GH", ",", 
           " ", "\[Delta]CP"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Elapsed time = \>\"", ",", 
    RowBox[{"(", 
     RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8200481107642474`*^9, 3.8200481587837424`*^9}, {
   3.820048197117392*^9, 3.820048197937029*^9}, {3.8200509409117136`*^9, 
   3.820050944440159*^9}, {3.820051064048478*^9, 3.8200510642184086`*^9}, {
   3.8200512480184298`*^9, 3.8200512573242693`*^9}, {3.8200521112218113`*^9, 
   3.820052115329935*^9}, {3.8200630689414687`*^9, 3.8200631054369073`*^9}, {
   3.8200633049361115`*^9, 3.820063306815239*^9}, {3.820063371675081*^9, 
   3.8200633761430044`*^9}, {3.82006390421078*^9, 3.820063904720542*^9}, {
   3.8201495538865643`*^9, 3.8201495542966237`*^9}, {3.8201497915822363`*^9, 
   3.820149983546794*^9}, 3.8201500276496797`*^9, {3.8201501945306916`*^9, 
   3.8201501959708023`*^9}, {3.8201508544391437`*^9, 
   3.8201508593694563`*^9}, {3.820152769570441*^9, 3.820152771470558*^9}, {
   3.820152848715656*^9, 3.8201529443319683`*^9}, {3.820152999816786*^9, 
   3.8201530180679955`*^9}, {3.8201536575874186`*^9, 3.8201536681081467`*^9}, 
   3.8201539351575203`*^9, {3.8201568830223465`*^9, 3.8201568873025694`*^9}, {
   3.8201576175133305`*^9, 3.820157623623746*^9}, {3.820158038650758*^9, 
   3.8201580409408894`*^9}, {3.8201581036150494`*^9, 3.820158219334298*^9}, {
   3.820158294020669*^9, 3.820158317492241*^9}, {3.820158522885709*^9, 
   3.820158523105774*^9}, {3.8201621548682823`*^9, 3.820162159680563*^9}, {
   3.820247612867053*^9, 3.820247615825527*^9}, {3.8202476848225994`*^9, 
   3.820247686131924*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[92]:=",ExpressionUUID->"4a778b85-2da4-4f4c-95b0-759decc84ff8"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", "0.`"}],
  SequenceForm["shift[mm]: ", 0.],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202480826366014`*^9},
 CellLabel->
  "During evaluation of \
In[92]:=",ExpressionUUID->"499c0dd5-6071-4cba-a6d3-af5ef34de2d8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=5.99_Kv=0.0_Z=-800_\
800mm_dGV.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=5.99_Kv=0.0_Z=-800_\
800mm_dGV.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820248145973898*^9},
 CellLabel->
  "During evaluation of \
In[92]:=",ExpressionUUID->"c478c19a-99f5-4b1b-a9c3-3a7edfca5035"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.0586253`8.795123437083948", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.0586253`8.795123437083948, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202481459838676`*^9},
 CellLabel->
  "During evaluation of \
In[92]:=",ExpressionUUID->"d3b99824-d366-4d0f-b48c-2e90c427c5e1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "6.5625`"}]}],
  SequenceForm["shift[mm]: ", -6.5625],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202481459838676`*^9},
 CellLabel->
  "During evaluation of \
In[92]:=",ExpressionUUID->"a38c11d6-4021-40af-a07e-32b026d5f191"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=5.61_Kv=0.0_Z=-800_\
800mm_dGV.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=5.61_Kv=0.0_Z=-800_\
800mm_dGV.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820248207701997*^9},
 CellLabel->
  "During evaluation of \
In[92]:=",ExpressionUUID->"a9d5d437-499a-4d4e-9ff2-cc7190a0c0f3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.0686204`8.795320177976404", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.0686204`8.795320177976404, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820248207701997*^9},
 CellLabel->
  "During evaluation of \
In[92]:=",ExpressionUUID->"5c87a11c-7fd4-4295-b42a-44ede4f34886"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "13.125`"}]}],
  SequenceForm["shift[mm]: ", -13.125],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202482077119675`*^9},
 CellLabel->
  "During evaluation of \
In[92]:=",ExpressionUUID->"c5808032-a3b1-48ff-8b10-254d056563ad"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=4.34_Kv=0.0_Z=-800_\
800mm_dGV.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=4.34_Kv=0.0_Z=-800_\
800mm_dGV.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202482700597486`*^9},
 CellLabel->
  "During evaluation of \
In[92]:=",ExpressionUUID->"c2a7cbe5-eb14-4fd9-a3a8-f26b700206fd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "21.918667`8.792359132170183", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 21.918667`8.792359132170183, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202482700597486`*^9},
 CellLabel->
  "During evaluation of \
In[92]:=",ExpressionUUID->"67cff6c8-c53a-4176-9e76-94eb12c9cc2b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "19.6875`"}]}],
  SequenceForm["shift[mm]: ", -19.6875],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202482700697436`*^9},
 CellLabel->
  "During evaluation of \
In[92]:=",ExpressionUUID->"adbb446e-3f4f-415a-a043-8a008072d0cd"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=2.29_Kv=0.0_Z=-800_\
800mm_dGV.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=2.29_Kv=0.0_Z=-800_\
800mm_dGV.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202483331283083`*^9},
 CellLabel->
  "During evaluation of \
In[92]:=",ExpressionUUID->"85d3b6c9-116d-4ea4-8850-968d0c88ad1e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.1085821`8.796105884157377", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.1085821`8.796105884157377, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202483331283083`*^9},
 CellLabel->
  "During evaluation of \
In[92]:=",ExpressionUUID->"40708665-3ca5-4687-984f-a02793b30137"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Elapsed time = \"\>", "\[InvisibleSpace]", 
   "250.5016778`9.850355632508982", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm["Elapsed time = ", 250.5016778`9.850355632508982, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202483331383057`*^9},
 CellLabel->
  "During evaluation of \
In[92]:=",ExpressionUUID->"14e44b42-c042-4694-9ade-d0d616a64990"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vertical Polarization", "Chapter",
 CellChangeTimes->{{3.681300194179221*^9, 3.6813002033832407`*^9}, {
   3.681305983976405*^9, 3.6813059853359213`*^9}, {3.6813176225703306`*^9, 
   3.6813176235079107`*^9}, {3.6813177175941257`*^9, 3.68131771915676*^9}, {
   3.708272177122472*^9, 3.708272189394394*^9}, {3.708272239370994*^9, 
   3.708272253185425*^9}, {3.7247626663439655`*^9, 3.724762668594143*^9}, 
   3.724763762181196*^9, {3.725974849294973*^9, 3.725974857279992*^9}, {
   3.7316800228814087`*^9, 3.7316800249126425`*^9}, {3.731761928333893*^9, 
   3.731761928740137*^9}, {3.7377345647344294`*^9, 3.7377345664687967`*^9}, {
   3.737994165253688*^9, 3.7379941653786864`*^9}, {3.7489625392900763`*^9, 
   3.7489625531505637`*^9}, {3.749318816981333*^9, 3.749318817559469*^9}, {
   3.7656382216793394`*^9, 3.7656382261328287`*^9}, {3.7662401432029853`*^9, 
   3.766240154985159*^9}, {3.7663282678653297`*^9, 3.766328270484855*^9}, {
   3.766331146283388*^9, 3.7663311568355923`*^9}, {3.7663982782306576`*^9, 
   3.7663982795028768`*^9}, {3.7664037488989267`*^9, 
   3.7664037535714073`*^9}, {3.76675425955847*^9, 3.766754260902328*^9}, {
   3.767446029232342*^9, 3.7674460297011285`*^9}, {3.7675176217294626`*^9, 
   3.767517621841589*^9}, {3.7685471006341314`*^9, 3.7685471031625986`*^9}, {
   3.782651674525923*^9, 3.7826516762290554`*^9}, {3.7827472341594315`*^9, 
   3.7827472344406757`*^9}, {3.7845390971377993`*^9, 
   3.7845390993098416`*^9}, {3.7846213628789454`*^9, 
   3.7846213635508842`*^9}, {3.784971285415371*^9, 3.784971285852929*^9}, {
   3.80003815573755*^9, 3.8000381597687845`*^9}, {3.8049514458306084`*^9, 
   3.804951448440013*^9}, {3.8062446719465714`*^9, 3.8062446751540537`*^9}, {
   3.811791929593967*^9, 3.8117919321569138`*^9}, {3.8117920042649097`*^9, 
   3.811792032147236*^9}, {3.8118212232455654`*^9, 3.8118212243258395`*^9}, {
   3.811855173078432*^9, 3.8118551748205085`*^9}, {3.813666226120046*^9, 
   3.8136662293236427`*^9}, {3.8157445404480095`*^9, 3.815744553217987*^9}, 
   3.8194444635501432`*^9, {3.8200470241049037`*^9, 3.8200470540438976`*^9}, {
   3.8200479202353115`*^9, 3.8200479218146176`*^9}, {3.820063087622788*^9, 
   3.8200630909436483`*^9}, {3.820162369245296*^9, 
   3.820162370625386*^9}},ExpressionUUID->"1b06b555-66f5-4d5e-bd16-\
da67c7332007"],

Cell[CellGroupData[{

Cell["\[Delta]GH", "Section",
 CellChangeTimes->{{3.8201580063786097`*^9, 
  3.820158019009424*^9}},ExpressionUUID->"1e5882e0-f91f-42df-9307-\
d3db53d41218"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]P", " ", "=", 
   RowBox[{"\[Lambda]u", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]CP", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GV", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GH", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Polarization", "=", "\"\<LinearPolarization\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PhaseName", " ", "=", " ", "\"\<dGH\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t0", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", " ", 
      RowBox[{"Length", "[", "\[Delta]GList", "]"}]}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<shift[mm]: \>\"", ",", " ", 
        RowBox[{"\[Delta]GList", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Delta]GH", " ", "=", " ", 
       RowBox[{"\[Delta]GList", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Device", "=", " ", 
       RowBox[{"IDDelta", "[", 
        RowBox[{
        "\[Lambda]u", ",", " ", "Np", ",", " ", "Mr", ",", " ", "Gap", ",", 
         "  ", 
         RowBox[{"\"\<\[Delta]P\>\"", "\[Rule]", " ", "\[Delta]P"}], ",", " ", 
         RowBox[{"\"\<\[Delta]GV\>\"", "\[Rule]", " ", "\[Delta]GV"}], ",", 
         " ", 
         RowBox[{"\"\<\[Delta]GH\>\"", "\[Rule]", " ", "\[Delta]GH"}], ",", 
         " ", 
         RowBox[{"\"\<\[Delta]CP\>\"", "\[Rule]", " ", "\[Delta]CP"}], ",", 
         " ", 
         RowBox[{"\"\<BlockShape\>\"", " ", "\[Rule]", " ", "BlockShape"}], 
         " ", ",", " ", 
         RowBox[{"\"\<BlockGap\>\"", " ", "\[Rule]", " ", "BlockGap"}], " ", 
         ",", 
         RowBox[{"\"\<Termination\>\"", "\[Rule]", " ", "Termination"}], ",", 
         " ", 
         RowBox[{
         "\"\<BlockSubdivision\>\"", "\[Rule]", " ", "BlockSubdivision"}], 
         ",", " ", 
         RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "Silent"}], ",", "  ", 
         RowBox[{"\"\<Size1\>\"", "\[Rule]", " ", "Size1"}], ",", " ", 
         RowBox[{"\"\<Size2\>\"", "\[Rule]", " ", "Size2"}], ",", " ", 
         RowBox[{"\"\<Size3\>\"", "\[Rule]", " ", "Size3"}], ",", " ", 
         RowBox[{"\"\<Size4\>\"", "\[Rule]", " ", "Size4"}], ",", 
         RowBox[{"\"\<Gap1\>\"", "\[Rule]", " ", "Gap1"}], ",", " ", 
         RowBox[{"\"\<Gap2\>\"", "\[Rule]", " ", "Gap2"}], ",", " ", 
         RowBox[{"\"\<Gap3\>\"", "\[Rule]", " ", "Gap3"}], ",", 
         RowBox[{"\"\<Gap4\>\"", "\[Rule]", " ", "Gap4"}], ",", " ", 
         RowBox[{"\"\<Shift1\>\"", "\[Rule]", " ", "Shift1"}], ",", " ", 
         RowBox[{"\"\<Shift2\>\"", "\[Rule]", " ", "Shift2"}], ",", " ", 
         RowBox[{"\"\<Shift3\>\"", "\[Rule]", " ", "Shift3"}], ",", " ", 
         RowBox[{"\"\<Shift4\>\"", "\[Rule]", " ", "Shift4"}], ",", " ", 
         RowBox[{"\"\<FourBlocks\>\"", "\[Rule]", " ", "1"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Mat", "=", " ", 
       RowBox[{"RadMatNdFeB", "[", "Mr", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Device", "=", " ", 
       RowBox[{"radMatApl", "[", 
        RowBox[{"Device", ",", " ", "Mat"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"IDSolve", "[", 
       RowBox[{"Device", ",", " ", "Prec", ",", " ", "MaxIter", ",", " ", 
        RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "Silent"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"IDFieldMapWithHeader", "[", 
       RowBox[{"Device", ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"Li", ",", " ", "Lf"}], "}"}], ",", " ", "1", ",", " ", "1", 
        ",", " ", "Lnpts", ",", " ", "MagnetName", ",", " ", "Polarization", 
        ",", " ", "PhaseName", ",", " ", "MagnetLength", ",", "\[Lambda]u", 
        ",", " ", "Gap", ",", " ", "\[Delta]P", ",", " ", "\[Delta]GV", ",", 
        " ", "\[Delta]GH", ",", " ", "\[Delta]CP"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"CalcTraj", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"IDTrajectoryFile", "[", 
          RowBox[{"Device", ",", " ", "Energy", ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", " ", "0", ",", " ", "Li", ",", " ", "0", ",", " ", "0", 
             ",", " ", "1"}], "}"}], ",", "Lf", ",", "Lstep", ",", " ", 
           "MagnetName", ",", " ", "Polarization", ",", " ", "PhaseName", ",",
            " ", "MagnetLength", ",", "\[Lambda]u", ",", " ", "Gap", ",", " ",
            "\[Delta]P", ",", " ", "\[Delta]GV", ",", " ", "\[Delta]GH", ",", 
           " ", "\[Delta]CP"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Elapsed time = \>\"", ",", 
    RowBox[{"(", 
     RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8200481107642474`*^9, 3.8200481587837424`*^9}, {
   3.820048197117392*^9, 3.820048197937029*^9}, {3.8200509409117136`*^9, 
   3.820050944440159*^9}, {3.820051064048478*^9, 3.8200510642184086`*^9}, {
   3.8200512480184298`*^9, 3.8200512573242693`*^9}, {3.8200521112218113`*^9, 
   3.820052115329935*^9}, {3.8200630689414687`*^9, 3.8200631054369073`*^9}, {
   3.8200633049361115`*^9, 3.820063306815239*^9}, {3.820063371675081*^9, 
   3.8200633761430044`*^9}, {3.82006390421078*^9, 3.820063904720542*^9}, {
   3.8201495538865643`*^9, 3.8201495542966237`*^9}, {3.8201497915822363`*^9, 
   3.820149983546794*^9}, 3.8201500276496797`*^9, {3.8201501945306916`*^9, 
   3.8201501959708023`*^9}, {3.8201508544391437`*^9, 
   3.8201508593694563`*^9}, {3.820152769570441*^9, 3.820152771470558*^9}, {
   3.820152848715656*^9, 3.8201529443319683`*^9}, {3.820152999816786*^9, 
   3.8201530180679955`*^9}, {3.8201536575874186`*^9, 3.8201536681081467`*^9}, 
   3.8201539351575203`*^9, {3.8201568830223465`*^9, 3.8201568873025694`*^9}, {
   3.8201576175133305`*^9, 3.820157623623746*^9}, {3.820158038650758*^9, 
   3.8201580409408894`*^9}, {3.8201581036150494`*^9, 3.820158219334298*^9}, {
   3.820158294020669*^9, 3.820158317492241*^9}, {3.820158522885709*^9, 
   3.820158523105774*^9}, {3.8201623771057973`*^9, 3.8201623793259583`*^9}, 
   3.8202476941677322`*^9},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[102]:=",ExpressionUUID->"6a42638e-6281-4e3d-a895-b99fabcf5636"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", "0.`"}],
  SequenceForm["shift[mm]: ", 0.],
  Editable->False]], "Print",
 CellChangeTimes->{3.820248333188279*^9},
 CellLabel->
  "During evaluation of \
In[102]:=",ExpressionUUID->"1d7997d7-023b-403e-bc13-18646f567850"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=0.0_Kv=5.99_Z=-800_\
800mm_dGH.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=0.0_Kv=5.99_Z=-800_\
800mm_dGH.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202483962261176`*^9},
 CellLabel->
  "During evaluation of \
In[102]:=",ExpressionUUID->"a917581c-2087-43e5-9ff9-cb79999f8baf"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.2886244`8.799628259198082", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.2886244`8.799628259198082, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202483962361126`*^9},
 CellLabel->
  "During evaluation of \
In[102]:=",ExpressionUUID->"98871d09-6e5a-4bcd-8f8c-9cbd1322eb6e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "6.5625`"}]}],
  SequenceForm["shift[mm]: ", -6.5625],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202483962361126`*^9},
 CellLabel->
  "During evaluation of \
In[102]:=",ExpressionUUID->"350f1194-9a9e-46da-a406-edaef15654fb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=0.0_Kv=5.61_Z=-800_\
800mm_dGH.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=0.0_Kv=5.61_Z=-800_\
800mm_dGH.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820248459125655*^9},
 CellLabel->
  "During evaluation of \
In[102]:=",ExpressionUUID->"e19edec4-44d1-4e69-91fc-b86c6c31709e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.0787374`8.795519227594289", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.0787374`8.795519227594289, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820248459125655*^9},
 CellLabel->
  "During evaluation of \
In[102]:=",ExpressionUUID->"47607753-540c-4079-a4db-389b1a80424c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "13.125`"}]}],
  SequenceForm["shift[mm]: ", -13.125],
  Editable->False]], "Print",
 CellChangeTimes->{3.820248459125655*^9},
 CellLabel->
  "During evaluation of \
In[102]:=",ExpressionUUID->"e6c4275c-900a-4620-884e-b4402edc624d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=0.0_Kv=4.34_Z=-800_\
800mm_dGH.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=0.0_Kv=4.34_Z=-800_\
800mm_dGH.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202485219336133`*^9},
 CellLabel->
  "During evaluation of \
In[102]:=",ExpressionUUID->"639956b6-7fd8-4bf0-8cbe-95be674206f8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.1187165`8.796304915715428", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.1187165`8.796304915715428, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202485219436083`*^9},
 CellLabel->
  "During evaluation of \
In[102]:=",ExpressionUUID->"d99377a3-ca20-4e13-b10a-1923f471c580"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "19.6875`"}]}],
  SequenceForm["shift[mm]: ", -19.6875],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202485219436083`*^9},
 CellLabel->
  "During evaluation of \
In[102]:=",ExpressionUUID->"3dff6eb3-431d-46a8-9875-cb19441a9610"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=0.0_Kv=2.29_Z=-800_\
800mm_dGH.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=0.0_Kv=2.29_Z=-800_\
800mm_dGH.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202485849314747`*^9},
 CellLabel->
  "During evaluation of \
In[102]:=",ExpressionUUID->"c28d271f-484f-4989-a815-0b24ff419b18"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.128707`8.796501031952353", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.128707`8.796501031952353, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202485849415083`*^9},
 CellLabel->
  "During evaluation of \
In[102]:=",ExpressionUUID->"deb744b3-488d-4c8c-a6ec-6e29608bb71f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Elapsed time = \"\>", "\[InvisibleSpace]", 
   "251.7431955`9.852502734104984", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm["Elapsed time = ", 251.7431955`9.852502734104984, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202485849415083`*^9},
 CellLabel->
  "During evaluation of \
In[102]:=",ExpressionUUID->"9c796c64-0546-4398-b9a9-c4ff2523e4a9"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Delta]GV", "Section",
 CellChangeTimes->{{3.8201580063786097`*^9, 3.820158019009424*^9}, {
  3.8201621504380217`*^9, 
  3.820162151958124*^9}},ExpressionUUID->"2d0dd69f-9c7b-4d0f-afc6-\
dd6cd943a1ea"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]P", " ", "=", 
   RowBox[{"\[Lambda]u", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]CP", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GV", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GH", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Polarization", "=", "\"\<LinearPolarization\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PhaseName", " ", "=", " ", "\"\<dGV\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t0", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", " ", 
      RowBox[{"Length", "[", "\[Delta]GList", "]"}]}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<shift[mm]: \>\"", ",", " ", 
        RowBox[{"\[Delta]GList", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Delta]GV", " ", "=", " ", 
       RowBox[{"\[Delta]GList", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Device", "=", " ", 
       RowBox[{"IDDelta", "[", 
        RowBox[{
        "\[Lambda]u", ",", " ", "Np", ",", " ", "Mr", ",", " ", "Gap", ",", 
         "  ", 
         RowBox[{"\"\<\[Delta]P\>\"", "\[Rule]", " ", "\[Delta]P"}], ",", " ", 
         RowBox[{"\"\<\[Delta]GV\>\"", "\[Rule]", " ", "\[Delta]GV"}], ",", 
         " ", 
         RowBox[{"\"\<\[Delta]GH\>\"", "\[Rule]", " ", "\[Delta]GH"}], ",", 
         " ", 
         RowBox[{"\"\<\[Delta]CP\>\"", "\[Rule]", " ", "\[Delta]CP"}], ",", 
         " ", 
         RowBox[{"\"\<BlockShape\>\"", " ", "\[Rule]", " ", "BlockShape"}], 
         " ", ",", " ", 
         RowBox[{"\"\<BlockGap\>\"", " ", "\[Rule]", " ", "BlockGap"}], " ", 
         ",", 
         RowBox[{"\"\<Termination\>\"", "\[Rule]", " ", "Termination"}], ",", 
         " ", 
         RowBox[{
         "\"\<BlockSubdivision\>\"", "\[Rule]", " ", "BlockSubdivision"}], 
         ",", " ", 
         RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "Silent"}], ",", "  ", 
         RowBox[{"\"\<Size1\>\"", "\[Rule]", " ", "Size1"}], ",", " ", 
         RowBox[{"\"\<Size2\>\"", "\[Rule]", " ", "Size2"}], ",", " ", 
         RowBox[{"\"\<Size3\>\"", "\[Rule]", " ", "Size3"}], ",", " ", 
         RowBox[{"\"\<Size4\>\"", "\[Rule]", " ", "Size4"}], ",", 
         RowBox[{"\"\<Gap1\>\"", "\[Rule]", " ", "Gap1"}], ",", " ", 
         RowBox[{"\"\<Gap2\>\"", "\[Rule]", " ", "Gap2"}], ",", " ", 
         RowBox[{"\"\<Gap3\>\"", "\[Rule]", " ", "Gap3"}], ",", 
         RowBox[{"\"\<Gap4\>\"", "\[Rule]", " ", "Gap4"}], ",", " ", 
         RowBox[{"\"\<Shift1\>\"", "\[Rule]", " ", "Shift1"}], ",", " ", 
         RowBox[{"\"\<Shift2\>\"", "\[Rule]", " ", "Shift2"}], ",", " ", 
         RowBox[{"\"\<Shift3\>\"", "\[Rule]", " ", "Shift3"}], ",", " ", 
         RowBox[{"\"\<Shift4\>\"", "\[Rule]", " ", "Shift4"}], ",", " ", 
         RowBox[{"\"\<FourBlocks\>\"", "\[Rule]", " ", "1"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Mat", "=", " ", 
       RowBox[{"RadMatNdFeB", "[", "Mr", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Device", "=", " ", 
       RowBox[{"radMatApl", "[", 
        RowBox[{"Device", ",", " ", "Mat"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"IDSolve", "[", 
       RowBox[{"Device", ",", " ", "Prec", ",", " ", "MaxIter", ",", " ", 
        RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "Silent"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"IDFieldMapWithHeader", "[", 
       RowBox[{"Device", ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"Li", ",", " ", "Lf"}], "}"}], ",", " ", "1", ",", " ", "1", 
        ",", " ", "Lnpts", ",", " ", "MagnetName", ",", " ", "Polarization", 
        ",", " ", "PhaseName", ",", " ", "MagnetLength", ",", "\[Lambda]u", 
        ",", " ", "Gap", ",", " ", "\[Delta]P", ",", " ", "\[Delta]GV", ",", 
        " ", "\[Delta]GH", ",", " ", "\[Delta]CP"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"CalcTraj", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"IDTrajectoryFile", "[", 
          RowBox[{"Device", ",", " ", "Energy", ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", " ", "0", ",", " ", "Li", ",", " ", "0", ",", " ", "0", 
             ",", " ", "1"}], "}"}], ",", "Lf", ",", "Lstep", ",", " ", 
           "MagnetName", ",", " ", "Polarization", ",", " ", "PhaseName", ",",
            " ", "MagnetLength", ",", "\[Lambda]u", ",", " ", "Gap", ",", " ",
            "\[Delta]P", ",", " ", "\[Delta]GV", ",", " ", "\[Delta]GH", ",", 
           " ", "\[Delta]CP"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Elapsed time = \>\"", ",", 
    RowBox[{"(", 
     RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8200481107642474`*^9, 3.8200481587837424`*^9}, {
   3.820048197117392*^9, 3.820048197937029*^9}, {3.8200509409117136`*^9, 
   3.820050944440159*^9}, {3.820051064048478*^9, 3.8200510642184086`*^9}, {
   3.8200512480184298`*^9, 3.8200512573242693`*^9}, {3.8200521112218113`*^9, 
   3.820052115329935*^9}, {3.8200630689414687`*^9, 3.8200631054369073`*^9}, {
   3.8200633049361115`*^9, 3.820063306815239*^9}, {3.820063371675081*^9, 
   3.8200633761430044`*^9}, {3.82006390421078*^9, 3.820063904720542*^9}, {
   3.8201495538865643`*^9, 3.8201495542966237`*^9}, {3.8201497915822363`*^9, 
   3.820149983546794*^9}, 3.8201500276496797`*^9, {3.8201501945306916`*^9, 
   3.8201501959708023`*^9}, {3.8201508544391437`*^9, 
   3.8201508593694563`*^9}, {3.820152769570441*^9, 3.820152771470558*^9}, {
   3.820152848715656*^9, 3.8201529443319683`*^9}, {3.820152999816786*^9, 
   3.8201530180679955`*^9}, {3.8201536575874186`*^9, 3.8201536681081467`*^9}, 
   3.8201539351575203`*^9, {3.8201568830223465`*^9, 3.8201568873025694`*^9}, {
   3.8201576175133305`*^9, 3.820157623623746*^9}, {3.820158038650758*^9, 
   3.8201580409408894`*^9}, {3.8201581036150494`*^9, 3.820158219334298*^9}, {
   3.820158294020669*^9, 3.820158317492241*^9}, {3.820158522885709*^9, 
   3.820158523105774*^9}, {3.8201621548682823`*^9, 3.820162159680563*^9}, {
   3.8201623862764215`*^9, 3.8201623866464415`*^9}, 3.8202477013540115`*^9},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[112]:=",ExpressionUUID->"71e8d84d-ccda-4306-9525-06142fb93633"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", "0.`"}],
  SequenceForm["shift[mm]: ", 0.],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202485849914455`*^9},
 CellLabel->
  "During evaluation of \
In[112]:=",ExpressionUUID->"0ba41a7c-5a22-492b-9a92-58154e5eadff"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=0.0_Kv=5.99_Z=-800_\
800mm_dGV.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=0.0_Kv=5.99_Z=-800_\
800mm_dGV.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202486489288273`*^9},
 CellLabel->
  "During evaluation of \
In[112]:=",ExpressionUUID->"e756d1f8-70c8-42d4-8f03-bf2c2208c3e4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.0687412`8.795322555226495", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.0687412`8.795322555226495, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202486489388213`*^9},
 CellLabel->
  "During evaluation of \
In[112]:=",ExpressionUUID->"ee36e45f-6b9a-4517-b5af-25204a960e36"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "6.5625`"}]}],
  SequenceForm["shift[mm]: ", -6.5625],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202486489388213`*^9},
 CellLabel->
  "During evaluation of \
In[112]:=",ExpressionUUID->"2e259d9b-3136-4380-97d9-fafc60927317"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=0.0_Kv=5.57_Z=-800_\
800mm_dGV.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=0.0_Kv=5.57_Z=-800_\
800mm_dGV.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820248711946681*^9},
 CellLabel->
  "During evaluation of \
In[112]:=",ExpressionUUID->"7462d561-2218-4937-9eb5-2efcb2cec49a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.1087237`8.796108665697204", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.1087237`8.796108665697204, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820248711946681*^9},
 CellLabel->
  "During evaluation of \
In[112]:=",ExpressionUUID->"6d4e48b5-8328-4357-8383-86421fa64a41"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "13.125`"}]}],
  SequenceForm["shift[mm]: ", -13.125],
  Editable->False]], "Print",
 CellChangeTimes->{3.820248711956679*^9},
 CellLabel->
  "During evaluation of \
In[112]:=",ExpressionUUID->"a640c3b1-0f13-4863-8ee8-85491e928af3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=0.0_Kv=4.24_Z=-800_\
800mm_dGV.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=0.0_Kv=4.24_Z=-800_\
800mm_dGV.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820248775124448*^9},
 CellLabel->
  "During evaluation of \
In[112]:=",ExpressionUUID->"4517c679-9247-4301-bfb1-def254fe35f2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.1087201`8.79610859498031", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.1087201`8.79610859498031, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820248775124448*^9},
 CellLabel->
  "During evaluation of \
In[112]:=",ExpressionUUID->"cc6ef70d-9b6d-4a18-9e12-6478dd8777e5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "19.6875`"}]}],
  SequenceForm["shift[mm]: ", -19.6875],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202487751344423`*^9},
 CellLabel->
  "During evaluation of \
In[112]:=",ExpressionUUID->"4b98350a-e81b-4eeb-9e01-1d5d3fc13f05"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=0.0_Kv=2.2_Z=-800_\
800mm_dGV.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=0.0_Kv=2.2_Z=-800_\
800mm_dGV.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202488382022676`*^9},
 CellLabel->
  "During evaluation of \
In[112]:=",ExpressionUUID->"d32bd10a-488d-4eb3-9301-ccabfdec95ad"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.1886806`8.797676472150902", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.1886806`8.797676472150902, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202488382022676`*^9},
 CellLabel->
  "During evaluation of \
In[112]:=",ExpressionUUID->"4928c091-62d3-4c76-b749-422e71b36e94"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Elapsed time = \"\>", "\[InvisibleSpace]", 
   "253.2208184`9.855044401573394", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm["Elapsed time = ", 253.2208184`9.855044401573394, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820248838212268*^9},
 CellLabel->
  "During evaluation of \
In[112]:=",ExpressionUUID->"6073d814-143b-414e-8259-fbeee181e45d"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Circular Polarization", "Chapter",
 CellChangeTimes->{{3.681300194179221*^9, 3.6813002033832407`*^9}, {
   3.681305983976405*^9, 3.6813059853359213`*^9}, {3.6813176225703306`*^9, 
   3.6813176235079107`*^9}, {3.6813177175941257`*^9, 3.68131771915676*^9}, {
   3.708272177122472*^9, 3.708272189394394*^9}, {3.708272239370994*^9, 
   3.708272253185425*^9}, {3.7247626663439655`*^9, 3.724762668594143*^9}, 
   3.724763762181196*^9, {3.725974849294973*^9, 3.725974857279992*^9}, {
   3.7316800228814087`*^9, 3.7316800249126425`*^9}, {3.731761928333893*^9, 
   3.731761928740137*^9}, {3.7377345647344294`*^9, 3.7377345664687967`*^9}, {
   3.737994165253688*^9, 3.7379941653786864`*^9}, {3.7489625392900763`*^9, 
   3.7489625531505637`*^9}, {3.749318816981333*^9, 3.749318817559469*^9}, {
   3.7656382216793394`*^9, 3.7656382261328287`*^9}, {3.7662401432029853`*^9, 
   3.766240154985159*^9}, {3.7663282678653297`*^9, 3.766328270484855*^9}, {
   3.766331146283388*^9, 3.7663311568355923`*^9}, {3.7663982782306576`*^9, 
   3.7663982795028768`*^9}, {3.7664037488989267`*^9, 
   3.7664037535714073`*^9}, {3.76675425955847*^9, 3.766754260902328*^9}, {
   3.767446029232342*^9, 3.7674460297011285`*^9}, {3.7675176217294626`*^9, 
   3.767517621841589*^9}, {3.7685471006341314`*^9, 3.7685471031625986`*^9}, {
   3.782651674525923*^9, 3.7826516762290554`*^9}, {3.7827472341594315`*^9, 
   3.7827472344406757`*^9}, {3.7845390971377993`*^9, 
   3.7845390993098416`*^9}, {3.7846213628789454`*^9, 
   3.7846213635508842`*^9}, {3.784971285415371*^9, 3.784971285852929*^9}, {
   3.80003815573755*^9, 3.8000381597687845`*^9}, {3.8049514458306084`*^9, 
   3.804951448440013*^9}, {3.8062446719465714`*^9, 3.8062446751540537`*^9}, {
   3.811791929593967*^9, 3.8117919321569138`*^9}, {3.8117920042649097`*^9, 
   3.811792032147236*^9}, {3.8118212232455654`*^9, 3.8118212243258395`*^9}, {
   3.811855173078432*^9, 3.8118551748205085`*^9}, {3.813666226120046*^9, 
   3.8136662293236427`*^9}, {3.8157445404480095`*^9, 3.815744553217987*^9}, 
   3.8194444635501432`*^9, {3.8200470241049037`*^9, 3.8200470540438976`*^9}, {
   3.8200479202353115`*^9, 3.8200479218146176`*^9}, {3.820063087622788*^9, 
   3.8200630909436483`*^9}, {3.820162369245296*^9, 3.820162370625386*^9}, {
   3.820171705419344*^9, 
   3.8201717076095247`*^9}},ExpressionUUID->"5917cd86-5516-4bb5-8b29-\
ce4be1a5c9f7"],

Cell[CellGroupData[{

Cell["\[Delta]GH", "Section",
 CellChangeTimes->{{3.8201580063786097`*^9, 
  3.820158019009424*^9}},ExpressionUUID->"0e2d6539-eb6e-4db1-9262-\
0c2debe616e3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]P", " ", "=", 
   RowBox[{"\[Lambda]u", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]CP", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GV", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GH", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Polarization", "=", "\"\<EllipticalPolarization\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PhaseName", " ", "=", " ", "\"\<dGH\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t0", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", " ", 
      RowBox[{"Length", "[", "\[Delta]GList", "]"}]}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<shift[mm]: \>\"", ",", " ", 
        RowBox[{"\[Delta]GList", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Delta]GH", " ", "=", " ", 
       RowBox[{"\[Delta]GList", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Device", "=", " ", 
       RowBox[{"IDDelta", "[", 
        RowBox[{
        "\[Lambda]u", ",", " ", "Np", ",", " ", "Mr", ",", " ", "Gap", ",", 
         "  ", 
         RowBox[{"\"\<\[Delta]P\>\"", "\[Rule]", " ", "\[Delta]P"}], ",", " ", 
         RowBox[{"\"\<\[Delta]GV\>\"", "\[Rule]", " ", "\[Delta]GV"}], ",", 
         " ", 
         RowBox[{"\"\<\[Delta]GH\>\"", "\[Rule]", " ", "\[Delta]GH"}], ",", 
         " ", 
         RowBox[{"\"\<\[Delta]CP\>\"", "\[Rule]", " ", "\[Delta]CP"}], ",", 
         " ", 
         RowBox[{"\"\<BlockShape\>\"", " ", "\[Rule]", " ", "BlockShape"}], 
         " ", ",", " ", 
         RowBox[{"\"\<BlockGap\>\"", " ", "\[Rule]", " ", "BlockGap"}], " ", 
         ",", 
         RowBox[{"\"\<Termination\>\"", "\[Rule]", " ", "Termination"}], ",", 
         " ", 
         RowBox[{
         "\"\<BlockSubdivision\>\"", "\[Rule]", " ", "BlockSubdivision"}], 
         ",", " ", 
         RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "Silent"}], ",", "  ", 
         RowBox[{"\"\<Size1\>\"", "\[Rule]", " ", "Size1"}], ",", " ", 
         RowBox[{"\"\<Size2\>\"", "\[Rule]", " ", "Size2"}], ",", " ", 
         RowBox[{"\"\<Size3\>\"", "\[Rule]", " ", "Size3"}], ",", " ", 
         RowBox[{"\"\<Size4\>\"", "\[Rule]", " ", "Size4"}], ",", 
         RowBox[{"\"\<Gap1\>\"", "\[Rule]", " ", "Gap1"}], ",", " ", 
         RowBox[{"\"\<Gap2\>\"", "\[Rule]", " ", "Gap2"}], ",", " ", 
         RowBox[{"\"\<Gap3\>\"", "\[Rule]", " ", "Gap3"}], ",", 
         RowBox[{"\"\<Gap4\>\"", "\[Rule]", " ", "Gap4"}], ",", " ", 
         RowBox[{"\"\<Shift1\>\"", "\[Rule]", " ", "Shift1"}], ",", " ", 
         RowBox[{"\"\<Shift2\>\"", "\[Rule]", " ", "Shift2"}], ",", " ", 
         RowBox[{"\"\<Shift3\>\"", "\[Rule]", " ", "Shift3"}], ",", " ", 
         RowBox[{"\"\<Shift4\>\"", "\[Rule]", " ", "Shift4"}], ",", " ", 
         RowBox[{"\"\<FourBlocks\>\"", "\[Rule]", " ", "1"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Mat", "=", " ", 
       RowBox[{"RadMatNdFeB", "[", "Mr", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Device", "=", " ", 
       RowBox[{"radMatApl", "[", 
        RowBox[{"Device", ",", " ", "Mat"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"IDSolve", "[", 
       RowBox[{"Device", ",", " ", "Prec", ",", " ", "MaxIter", ",", " ", 
        RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "Silent"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"IDFieldMapWithHeader", "[", 
       RowBox[{"Device", ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"Li", ",", " ", "Lf"}], "}"}], ",", " ", "1", ",", " ", "1", 
        ",", " ", "Lnpts", ",", " ", "MagnetName", ",", " ", "Polarization", 
        ",", " ", "PhaseName", ",", " ", "MagnetLength", ",", "\[Lambda]u", 
        ",", " ", "Gap", ",", " ", "\[Delta]P", ",", " ", "\[Delta]GV", ",", 
        " ", "\[Delta]GH", ",", " ", "\[Delta]CP"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"CalcTraj", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"IDTrajectoryFile", "[", 
          RowBox[{"Device", ",", " ", "Energy", ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", " ", "0", ",", " ", "Li", ",", " ", "0", ",", " ", "0", 
             ",", " ", "1"}], "}"}], ",", "Lf", ",", "Lstep", ",", " ", 
           "MagnetName", ",", " ", "Polarization", ",", " ", "PhaseName", ",",
            " ", "MagnetLength", ",", "\[Lambda]u", ",", " ", "Gap", ",", " ",
            "\[Delta]P", ",", " ", "\[Delta]GV", ",", " ", "\[Delta]GH", ",", 
           " ", "\[Delta]CP"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Elapsed time = \>\"", ",", 
    RowBox[{"(", 
     RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8200481107642474`*^9, 3.8200481587837424`*^9}, {
   3.820048197117392*^9, 3.820048197937029*^9}, {3.8200509409117136`*^9, 
   3.820050944440159*^9}, {3.820051064048478*^9, 3.8200510642184086`*^9}, {
   3.8200512480184298`*^9, 3.8200512573242693`*^9}, {3.8200521112218113`*^9, 
   3.820052115329935*^9}, {3.8200630689414687`*^9, 3.8200631054369073`*^9}, {
   3.8200633049361115`*^9, 3.820063306815239*^9}, {3.820063371675081*^9, 
   3.8200633761430044`*^9}, {3.82006390421078*^9, 3.820063904720542*^9}, {
   3.8201495538865643`*^9, 3.8201495542966237`*^9}, {3.8201497915822363`*^9, 
   3.820149983546794*^9}, 3.8201500276496797`*^9, {3.8201501945306916`*^9, 
   3.8201501959708023`*^9}, {3.8201508544391437`*^9, 
   3.8201508593694563`*^9}, {3.820152769570441*^9, 3.820152771470558*^9}, {
   3.820152848715656*^9, 3.8201529443319683`*^9}, {3.820152999816786*^9, 
   3.8201530180679955`*^9}, {3.8201536575874186`*^9, 3.8201536681081467`*^9}, 
   3.8201539351575203`*^9, {3.8201568830223465`*^9, 3.8201568873025694`*^9}, {
   3.8201576175133305`*^9, 3.820157623623746*^9}, {3.820158038650758*^9, 
   3.8201580409408894`*^9}, {3.8201581036150494`*^9, 3.820158219334298*^9}, {
   3.820158294020669*^9, 3.820158317492241*^9}, {3.820158522885709*^9, 
   3.820158523105774*^9}, {3.8201623771057973`*^9, 3.8201623793259583`*^9}, {
   3.820171768247072*^9, 3.8201717774821677`*^9}, 3.8202477064813905`*^9},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[122]:=",ExpressionUUID->"2c3c149e-6544-4629-b690-8405eca4c41f"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", "0.`"}],
  SequenceForm["shift[mm]: ", 0.],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202488382622385`*^9},
 CellLabel->
  "During evaluation of \
In[122]:=",ExpressionUUID->"b134a5d8-8f48-4df0-a530-f98212024201"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=4.26_Kv=4.26_Z=-\
800_800mm_dGH.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=4.26_Kv=4.26_Z=-\
800_800mm_dGH.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202489013800373`*^9},
 CellLabel->
  "During evaluation of \
In[122]:=",ExpressionUUID->"f1cff87a-7ddb-45ec-81d0-25a5c7c1bed0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.16869`8.797285023886936", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.16869`8.797285023886936, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202489013800373`*^9},
 CellLabel->
  "During evaluation of \
In[122]:=",ExpressionUUID->"c125984a-f8be-43ad-a5f4-e2985ad1e024"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "6.5625`"}]}],
  SequenceForm["shift[mm]: ", -6.5625],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202489013900547`*^9},
 CellLabel->
  "During evaluation of \
In[122]:=",ExpressionUUID->"fc3907d6-2f1a-468d-b81e-85a84861c3d9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=3.92_Kv=3.89_Z=-\
800_800mm_dGH.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=3.92_Kv=3.89_Z=-\
800_800mm_dGH.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202489642979403`*^9},
 CellLabel->
  "During evaluation of \
In[122]:=",ExpressionUUID->"fd1e9bad-50f2-4e84-bc0b-beee3a580e83"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.1486995`8.796893224436323", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.1486995`8.796893224436323, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202489643079357`*^9},
 CellLabel->
  "During evaluation of \
In[122]:=",ExpressionUUID->"44a006da-4615-45a1-9035-a4eb1e0f033d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "13.125`"}]}],
  SequenceForm["shift[mm]: ", -13.125],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202489643079357`*^9},
 CellLabel->
  "During evaluation of \
In[122]:=",ExpressionUUID->"0a732b2c-6b9a-42f7-b62a-161bf859a552"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=3.04_Kv=2.97_Z=-\
800_800mm_dGH.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=3.04_Kv=2.97_Z=-\
800_800mm_dGH.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820249027557477*^9},
 CellLabel->
  "During evaluation of \
In[122]:=",ExpressionUUID->"db8f4fcb-d47c-45b2-9b4a-c21b7e8ea08e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.1886806`8.797676472150902", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.1886806`8.797676472150902, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202490275674953`*^9},
 CellLabel->
  "During evaluation of \
In[122]:=",ExpressionUUID->"b1e0cc5f-d633-4104-8e51-b6f0aa145a69"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "19.6875`"}]}],
  SequenceForm["shift[mm]: ", -19.6875],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202490275674953`*^9},
 CellLabel->
  "During evaluation of \
In[122]:=",ExpressionUUID->"49573079-013a-47a2-8c9c-5f6a1396bd41"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=1.72_Kv=1.66_Z=-\
800_800mm_dGH.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=1.72_Kv=1.66_Z=-\
800_800mm_dGH.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202490904054146`*^9},
 CellLabel->
  "During evaluation of \
In[122]:=",ExpressionUUID->"9e519a8c-5345-4df9-bc1f-e4b96ff9fcc8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.0887315`8.795715769649503", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.0887315`8.795715769649503, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202490904054146`*^9},
 CellLabel->
  "During evaluation of \
In[122]:=",ExpressionUUID->"489f9a18-f4d5-4a14-9e04-6273f0c999f5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Elapsed time = \"\>", "\[InvisibleSpace]", 
   "252.143176`9.853192212409335", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm["Elapsed time = ", 252.143176`9.853192212409335, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202490904054146`*^9},
 CellLabel->
  "During evaluation of \
In[122]:=",ExpressionUUID->"92df68c5-b35c-4b34-86dc-e265481eb99c"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Delta]GV", "Section",
 CellChangeTimes->{{3.8201580063786097`*^9, 3.820158019009424*^9}, {
  3.8201621504380217`*^9, 
  3.820162151958124*^9}},ExpressionUUID->"5e4b8abd-3ed5-4456-894c-\
11b2aed96dc0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]P", " ", "=", 
   RowBox[{"\[Lambda]u", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]CP", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GV", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GH", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Polarization", "=", "\"\<EllipticalPolarization\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PhaseName", " ", "=", " ", "\"\<dGV\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t0", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", " ", 
      RowBox[{"Length", "[", "\[Delta]GList", "]"}]}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<shift[mm]: \>\"", ",", " ", 
        RowBox[{"\[Delta]GList", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Delta]GV", " ", "=", " ", 
       RowBox[{"\[Delta]GList", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Device", "=", " ", 
       RowBox[{"IDDelta", "[", 
        RowBox[{
        "\[Lambda]u", ",", " ", "Np", ",", " ", "Mr", ",", " ", "Gap", ",", 
         "  ", 
         RowBox[{"\"\<\[Delta]P\>\"", "\[Rule]", " ", "\[Delta]P"}], ",", " ", 
         RowBox[{"\"\<\[Delta]GV\>\"", "\[Rule]", " ", "\[Delta]GV"}], ",", 
         " ", 
         RowBox[{"\"\<\[Delta]GH\>\"", "\[Rule]", " ", "\[Delta]GH"}], ",", 
         " ", 
         RowBox[{"\"\<\[Delta]CP\>\"", "\[Rule]", " ", "\[Delta]CP"}], ",", 
         " ", 
         RowBox[{"\"\<BlockShape\>\"", " ", "\[Rule]", " ", "BlockShape"}], 
         " ", ",", " ", 
         RowBox[{"\"\<BlockGap\>\"", " ", "\[Rule]", " ", "BlockGap"}], " ", 
         ",", 
         RowBox[{"\"\<Termination\>\"", "\[Rule]", " ", "Termination"}], ",", 
         " ", 
         RowBox[{
         "\"\<BlockSubdivision\>\"", "\[Rule]", " ", "BlockSubdivision"}], 
         ",", " ", 
         RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "Silent"}], ",", "  ", 
         RowBox[{"\"\<Size1\>\"", "\[Rule]", " ", "Size1"}], ",", " ", 
         RowBox[{"\"\<Size2\>\"", "\[Rule]", " ", "Size2"}], ",", " ", 
         RowBox[{"\"\<Size3\>\"", "\[Rule]", " ", "Size3"}], ",", " ", 
         RowBox[{"\"\<Size4\>\"", "\[Rule]", " ", "Size4"}], ",", 
         RowBox[{"\"\<Gap1\>\"", "\[Rule]", " ", "Gap1"}], ",", " ", 
         RowBox[{"\"\<Gap2\>\"", "\[Rule]", " ", "Gap2"}], ",", " ", 
         RowBox[{"\"\<Gap3\>\"", "\[Rule]", " ", "Gap3"}], ",", 
         RowBox[{"\"\<Gap4\>\"", "\[Rule]", " ", "Gap4"}], ",", " ", 
         RowBox[{"\"\<Shift1\>\"", "\[Rule]", " ", "Shift1"}], ",", " ", 
         RowBox[{"\"\<Shift2\>\"", "\[Rule]", " ", "Shift2"}], ",", " ", 
         RowBox[{"\"\<Shift3\>\"", "\[Rule]", " ", "Shift3"}], ",", " ", 
         RowBox[{"\"\<Shift4\>\"", "\[Rule]", " ", "Shift4"}], ",", " ", 
         RowBox[{"\"\<FourBlocks\>\"", "\[Rule]", " ", "1"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Mat", "=", " ", 
       RowBox[{"RadMatNdFeB", "[", "Mr", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Device", "=", " ", 
       RowBox[{"radMatApl", "[", 
        RowBox[{"Device", ",", " ", "Mat"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"IDSolve", "[", 
       RowBox[{"Device", ",", " ", "Prec", ",", " ", "MaxIter", ",", " ", 
        RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "Silent"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"IDFieldMapWithHeader", "[", 
       RowBox[{"Device", ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"Li", ",", " ", "Lf"}], "}"}], ",", " ", "1", ",", " ", "1", 
        ",", " ", "Lnpts", ",", " ", "MagnetName", ",", " ", "Polarization", 
        ",", " ", "PhaseName", ",", " ", "MagnetLength", ",", "\[Lambda]u", 
        ",", " ", "Gap", ",", " ", "\[Delta]P", ",", " ", "\[Delta]GV", ",", 
        " ", "\[Delta]GH", ",", " ", "\[Delta]CP"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"CalcTraj", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"IDTrajectoryFile", "[", 
          RowBox[{"Device", ",", " ", "Energy", ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", " ", "0", ",", " ", "Li", ",", " ", "0", ",", " ", "0", 
             ",", " ", "1"}], "}"}], ",", "Lf", ",", "Lstep", ",", " ", 
           "MagnetName", ",", " ", "Polarization", ",", " ", "PhaseName", ",",
            " ", "MagnetLength", ",", "\[Lambda]u", ",", " ", "Gap", ",", " ",
            "\[Delta]P", ",", " ", "\[Delta]GV", ",", " ", "\[Delta]GH", ",", 
           " ", "\[Delta]CP"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Elapsed time = \>\"", ",", 
    RowBox[{"(", 
     RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8200481107642474`*^9, 3.8200481587837424`*^9}, {
   3.820048197117392*^9, 3.820048197937029*^9}, {3.8200509409117136`*^9, 
   3.820050944440159*^9}, {3.820051064048478*^9, 3.8200510642184086`*^9}, {
   3.8200512480184298`*^9, 3.8200512573242693`*^9}, {3.8200521112218113`*^9, 
   3.820052115329935*^9}, {3.8200630689414687`*^9, 3.8200631054369073`*^9}, {
   3.8200633049361115`*^9, 3.820063306815239*^9}, {3.820063371675081*^9, 
   3.8200633761430044`*^9}, {3.82006390421078*^9, 3.820063904720542*^9}, {
   3.8201495538865643`*^9, 3.8201495542966237`*^9}, {3.8201497915822363`*^9, 
   3.820149983546794*^9}, 3.8201500276496797`*^9, {3.8201501945306916`*^9, 
   3.8201501959708023`*^9}, {3.8201508544391437`*^9, 
   3.8201508593694563`*^9}, {3.820152769570441*^9, 3.820152771470558*^9}, {
   3.820152848715656*^9, 3.8201529443319683`*^9}, {3.820152999816786*^9, 
   3.8201530180679955`*^9}, {3.8201536575874186`*^9, 3.8201536681081467`*^9}, 
   3.8201539351575203`*^9, {3.8201568830223465`*^9, 3.8201568873025694`*^9}, {
   3.8201576175133305`*^9, 3.820157623623746*^9}, {3.820158038650758*^9, 
   3.8201580409408894`*^9}, {3.8201581036150494`*^9, 3.820158219334298*^9}, {
   3.820158294020669*^9, 3.820158317492241*^9}, {3.820158522885709*^9, 
   3.820158523105774*^9}, {3.8201621548682823`*^9, 3.820162159680563*^9}, {
   3.8201623862764215`*^9, 3.8201623866464415`*^9}, {3.820171784694354*^9, 
   3.8201717876365805`*^9}, 3.820247713987523*^9},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[132]:=",ExpressionUUID->"3ce3934f-8311-42bf-a0d7-9854e8c54457"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", "0.`"}],
  SequenceForm["shift[mm]: ", 0.],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202490904553905`*^9},
 CellLabel->
  "During evaluation of \
In[132]:=",ExpressionUUID->"244918dd-824c-4e97-b06f-a7af5bfd4779"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=4.26_Kv=4.26_Z=-\
800_800mm_dGV.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=4.26_Kv=4.26_Z=-\
800_800mm_dGV.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202491532033806`*^9},
 CellLabel->
  "During evaluation of \
In[132]:=",ExpressionUUID->"ee9e81a5-dde2-424b-9f4c-e3e2b5c8b134"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.0387579`8.79473210761506", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.0387579`8.79473210761506, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202491532133737`*^9},
 CellLabel->
  "During evaluation of \
In[132]:=",ExpressionUUID->"85abc03b-e1fc-4b07-8399-32e267b5ced6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "6.5625`"}]}],
  SequenceForm["shift[mm]: ", -6.5625],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202491532133737`*^9},
 CellLabel->
  "During evaluation of \
In[132]:=",ExpressionUUID->"6ab162cf-2e4c-4bc6-bf7d-4572e4544feb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=3.89_Kv=3.92_Z=-\
800_800mm_dGV.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=3.89_Kv=3.92_Z=-\
800_800mm_dGV.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202492167123885`*^9},
 CellLabel->
  "During evaluation of \
In[132]:=",ExpressionUUID->"3fbbbb8c-a21b-4f61-8381-a6f46eee3f4b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.1886796`8.797676452578106", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.1886796`8.797676452578106, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202492167123885`*^9},
 CellLabel->
  "During evaluation of \
In[132]:=",ExpressionUUID->"d791a5f0-48ab-4cc1-8a29-748d0dc08c57"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "13.125`"}]}],
  SequenceForm["shift[mm]: ", -13.125],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202492167123885`*^9},
 CellLabel->
  "During evaluation of \
In[132]:=",ExpressionUUID->"c5e493d1-cdea-49e4-9830-2695581a881e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=2.97_Kv=3.04_Z=-\
800_800mm_dGV.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=2.97_Kv=3.04_Z=-\
800_800mm_dGV.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202492797902117`*^9},
 CellLabel->
  "During evaluation of \
In[132]:=",ExpressionUUID->"630041cc-f59a-4867-9b65-8474cb94b58c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.0987266`8.79591224245137", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.0987266`8.79591224245137, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202492797902117`*^9},
 CellLabel->
  "During evaluation of \
In[132]:=",ExpressionUUID->"5933ab74-b6f7-4f6d-a996-cc0061c32a67"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "19.6875`"}]}],
  SequenceForm["shift[mm]: ", -19.6875],
  Editable->False]], "Print",
 CellChangeTimes->{3.820249279800205*^9},
 CellLabel->
  "During evaluation of \
In[132]:=",ExpressionUUID->"242f7897-268b-4b93-baf2-94deb6989d1f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=1.66_Kv=1.72_Z=-\
800_800mm_dGV.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=1.66_Kv=1.72_Z=-\
800_800mm_dGV.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202493427640915`*^9},
 CellLabel->
  "During evaluation of \
In[132]:=",ExpressionUUID->"9c60a640-3af5-465f-8f67-5df0de28aff6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.1247168`8.796422713860888", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.1247168`8.796422713860888, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202493427640915`*^9},
 CellLabel->
  "During evaluation of \
In[132]:=",ExpressionUUID->"e4f9c427-3bc9-4c67-afb3-78c2c54997b3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Elapsed time = \"\>", "\[InvisibleSpace]", 
   "252.3087013`9.853477221664805", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm["Elapsed time = ", 252.3087013`9.853477221664805, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820249342774082*^9},
 CellLabel->
  "During evaluation of \
In[132]:=",ExpressionUUID->"4542b4ce-d1b2-41c4-96c6-599f3ea3f1b0"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Elliptical Polarization \[Lambda]u/8", "Chapter",
 CellChangeTimes->{{3.681300194179221*^9, 3.6813002033832407`*^9}, {
   3.681305983976405*^9, 3.6813059853359213`*^9}, {3.6813176225703306`*^9, 
   3.6813176235079107`*^9}, {3.6813177175941257`*^9, 3.68131771915676*^9}, {
   3.708272177122472*^9, 3.708272189394394*^9}, {3.708272239370994*^9, 
   3.708272253185425*^9}, {3.7247626663439655`*^9, 3.724762668594143*^9}, 
   3.724763762181196*^9, {3.725974849294973*^9, 3.725974857279992*^9}, {
   3.7316800228814087`*^9, 3.7316800249126425`*^9}, {3.731761928333893*^9, 
   3.731761928740137*^9}, {3.7377345647344294`*^9, 3.7377345664687967`*^9}, {
   3.737994165253688*^9, 3.7379941653786864`*^9}, {3.7489625392900763`*^9, 
   3.7489625531505637`*^9}, {3.749318816981333*^9, 3.749318817559469*^9}, {
   3.7656382216793394`*^9, 3.7656382261328287`*^9}, {3.7662401432029853`*^9, 
   3.766240154985159*^9}, {3.7663282678653297`*^9, 3.766328270484855*^9}, {
   3.766331146283388*^9, 3.7663311568355923`*^9}, {3.7663982782306576`*^9, 
   3.7663982795028768`*^9}, {3.7664037488989267`*^9, 
   3.7664037535714073`*^9}, {3.76675425955847*^9, 3.766754260902328*^9}, {
   3.767446029232342*^9, 3.7674460297011285`*^9}, {3.7675176217294626`*^9, 
   3.767517621841589*^9}, {3.7685471006341314`*^9, 3.7685471031625986`*^9}, {
   3.782651674525923*^9, 3.7826516762290554`*^9}, {3.7827472341594315`*^9, 
   3.7827472344406757`*^9}, {3.7845390971377993`*^9, 
   3.7845390993098416`*^9}, {3.7846213628789454`*^9, 
   3.7846213635508842`*^9}, {3.784971285415371*^9, 3.784971285852929*^9}, {
   3.80003815573755*^9, 3.8000381597687845`*^9}, {3.8049514458306084`*^9, 
   3.804951448440013*^9}, {3.8062446719465714`*^9, 3.8062446751540537`*^9}, {
   3.811791929593967*^9, 3.8117919321569138`*^9}, {3.8117920042649097`*^9, 
   3.811792032147236*^9}, {3.8118212232455654`*^9, 3.8118212243258395`*^9}, {
   3.811855173078432*^9, 3.8118551748205085`*^9}, {3.813666226120046*^9, 
   3.8136662293236427`*^9}, {3.8157445404480095`*^9, 3.815744553217987*^9}, 
   3.8194444635501432`*^9, {3.8200470241049037`*^9, 3.8200470540438976`*^9}, {
   3.8200479202353115`*^9, 3.8200479218146176`*^9}, {3.820063087622788*^9, 
   3.8200630909436483`*^9}, {3.820162369245296*^9, 3.820162370625386*^9}, {
   3.820171705419344*^9, 3.8201717076095247`*^9}, {3.8202009861404676`*^9, 
   3.8202009909207892`*^9}, {3.8202333122477064`*^9, 
   3.8202333142366557`*^9}},ExpressionUUID->"0c821744-7c1c-4f36-b521-\
85f8e95aa7dc"],

Cell[CellGroupData[{

Cell["\[Delta]GH", "Section",
 CellChangeTimes->{{3.8201580063786097`*^9, 
  3.820158019009424*^9}},ExpressionUUID->"278e3bb1-c860-4919-b016-\
2a0e35d70ab2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]P", " ", "=", 
   RowBox[{"\[Lambda]u", "/", "8"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]CP", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GV", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GH", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Polarization", "=", "\"\<EllipticalPolarization\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PhaseName", " ", "=", " ", "\"\<dGH\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t0", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", " ", 
      RowBox[{"Length", "[", "\[Delta]GList", "]"}]}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<shift[mm]: \>\"", ",", " ", 
        RowBox[{"\[Delta]GList", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Delta]GH", " ", "=", " ", 
       RowBox[{"\[Delta]GList", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Device", "=", " ", 
       RowBox[{"IDDelta", "[", 
        RowBox[{
        "\[Lambda]u", ",", " ", "Np", ",", " ", "Mr", ",", " ", "Gap", ",", 
         "  ", 
         RowBox[{"\"\<\[Delta]P\>\"", "\[Rule]", " ", "\[Delta]P"}], ",", " ", 
         RowBox[{"\"\<\[Delta]GV\>\"", "\[Rule]", " ", "\[Delta]GV"}], ",", 
         " ", 
         RowBox[{"\"\<\[Delta]GH\>\"", "\[Rule]", " ", "\[Delta]GH"}], ",", 
         " ", 
         RowBox[{"\"\<\[Delta]CP\>\"", "\[Rule]", " ", "\[Delta]CP"}], ",", 
         " ", 
         RowBox[{"\"\<BlockShape\>\"", " ", "\[Rule]", " ", "BlockShape"}], 
         " ", ",", " ", 
         RowBox[{"\"\<BlockGap\>\"", " ", "\[Rule]", " ", "BlockGap"}], " ", 
         ",", 
         RowBox[{"\"\<Termination\>\"", "\[Rule]", " ", "Termination"}], ",", 
         " ", 
         RowBox[{
         "\"\<BlockSubdivision\>\"", "\[Rule]", " ", "BlockSubdivision"}], 
         ",", " ", 
         RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "Silent"}], ",", "  ", 
         RowBox[{"\"\<Size1\>\"", "\[Rule]", " ", "Size1"}], ",", " ", 
         RowBox[{"\"\<Size2\>\"", "\[Rule]", " ", "Size2"}], ",", " ", 
         RowBox[{"\"\<Size3\>\"", "\[Rule]", " ", "Size3"}], ",", " ", 
         RowBox[{"\"\<Size4\>\"", "\[Rule]", " ", "Size4"}], ",", 
         RowBox[{"\"\<Gap1\>\"", "\[Rule]", " ", "Gap1"}], ",", " ", 
         RowBox[{"\"\<Gap2\>\"", "\[Rule]", " ", "Gap2"}], ",", " ", 
         RowBox[{"\"\<Gap3\>\"", "\[Rule]", " ", "Gap3"}], ",", 
         RowBox[{"\"\<Gap4\>\"", "\[Rule]", " ", "Gap4"}], ",", " ", 
         RowBox[{"\"\<Shift1\>\"", "\[Rule]", " ", "Shift1"}], ",", " ", 
         RowBox[{"\"\<Shift2\>\"", "\[Rule]", " ", "Shift2"}], ",", " ", 
         RowBox[{"\"\<Shift3\>\"", "\[Rule]", " ", "Shift3"}], ",", " ", 
         RowBox[{"\"\<Shift4\>\"", "\[Rule]", " ", "Shift4"}], ",", " ", 
         RowBox[{"\"\<FourBlocks\>\"", "\[Rule]", " ", "1"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Mat", "=", " ", 
       RowBox[{"RadMatNdFeB", "[", "Mr", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Device", "=", " ", 
       RowBox[{"radMatApl", "[", 
        RowBox[{"Device", ",", " ", "Mat"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"IDSolve", "[", 
       RowBox[{"Device", ",", " ", "Prec", ",", " ", "MaxIter", ",", " ", 
        RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "Silent"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"IDFieldMapWithHeader", "[", 
       RowBox[{"Device", ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"Li", ",", " ", "Lf"}], "}"}], ",", " ", "1", ",", " ", "1", 
        ",", " ", "Lnpts", ",", " ", "MagnetName", ",", " ", "Polarization", 
        ",", " ", "PhaseName", ",", " ", "MagnetLength", ",", "\[Lambda]u", 
        ",", " ", "Gap", ",", " ", "\[Delta]P", ",", " ", "\[Delta]GV", ",", 
        " ", "\[Delta]GH", ",", " ", "\[Delta]CP"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"CalcTraj", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"IDTrajectoryFile", "[", 
          RowBox[{"Device", ",", " ", "Energy", ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", " ", "0", ",", " ", "Li", ",", " ", "0", ",", " ", "0", 
             ",", " ", "1"}], "}"}], ",", "Lf", ",", "Lstep", ",", " ", 
           "MagnetName", ",", " ", "Polarization", ",", " ", "PhaseName", ",",
            " ", "MagnetLength", ",", "\[Lambda]u", ",", " ", "Gap", ",", " ",
            "\[Delta]P", ",", " ", "\[Delta]GV", ",", " ", "\[Delta]GH", ",", 
           " ", "\[Delta]CP"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Elapsed time = \>\"", ",", 
    RowBox[{"(", 
     RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8200481107642474`*^9, 3.8200481587837424`*^9}, {
   3.820048197117392*^9, 3.820048197937029*^9}, {3.8200509409117136`*^9, 
   3.820050944440159*^9}, {3.820051064048478*^9, 3.8200510642184086`*^9}, {
   3.8200512480184298`*^9, 3.8200512573242693`*^9}, {3.8200521112218113`*^9, 
   3.820052115329935*^9}, {3.8200630689414687`*^9, 3.8200631054369073`*^9}, {
   3.8200633049361115`*^9, 3.820063306815239*^9}, {3.820063371675081*^9, 
   3.8200633761430044`*^9}, {3.82006390421078*^9, 3.820063904720542*^9}, {
   3.8201495538865643`*^9, 3.8201495542966237`*^9}, {3.8201497915822363`*^9, 
   3.820149983546794*^9}, 3.8201500276496797`*^9, {3.8201501945306916`*^9, 
   3.8201501959708023`*^9}, {3.8201508544391437`*^9, 
   3.8201508593694563`*^9}, {3.820152769570441*^9, 3.820152771470558*^9}, {
   3.820152848715656*^9, 3.8201529443319683`*^9}, {3.820152999816786*^9, 
   3.8201530180679955`*^9}, {3.8201536575874186`*^9, 3.8201536681081467`*^9}, 
   3.8201539351575203`*^9, {3.8201568830223465`*^9, 3.8201568873025694`*^9}, {
   3.8201576175133305`*^9, 3.820157623623746*^9}, {3.820158038650758*^9, 
   3.8201580409408894`*^9}, {3.8201581036150494`*^9, 3.820158219334298*^9}, {
   3.820158294020669*^9, 3.820158317492241*^9}, {3.820158522885709*^9, 
   3.820158523105774*^9}, {3.8201623771057973`*^9, 3.8201623793259583`*^9}, {
   3.820171768247072*^9, 3.8201717774821677`*^9}, {3.820200993600941*^9, 
   3.8202009943409896`*^9}, 3.8202477207740316`*^9},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[142]:=",ExpressionUUID->"7e477691-f526-4288-9624-caa408c1c77c"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", "0.`"}],
  SequenceForm["shift[mm]: ", 0.],
  Editable->False]], "Print",
 CellChangeTimes->{3.820249342824047*^9},
 CellLabel->
  "During evaluation of \
In[142]:=",ExpressionUUID->"9bebe6dd-93a3-4af4-ac38-dcbd7a8ad9d5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=5.58_Kv=2.22_Z=-\
800_800mm_dGH.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=5.58_Kv=2.22_Z=-\
800_800mm_dGH.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820249407259593*^9},
 CellLabel->
  "During evaluation of \
In[142]:=",ExpressionUUID->"46b277a6-b846-4b0b-b1a1-ee328ddefcc4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.2757033`8.799376418190846", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.2757033`8.799376418190846, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820249407269582*^9},
 CellLabel->
  "During evaluation of \
In[142]:=",ExpressionUUID->"ffb0b7dd-7d07-4488-99c9-d4d9209959cf"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "6.5625`"}]}],
  SequenceForm["shift[mm]: ", -6.5625],
  Editable->False]], "Print",
 CellChangeTimes->{3.820249407269582*^9},
 CellLabel->
  "During evaluation of \
In[142]:=",ExpressionUUID->"80972ad2-9098-4b7f-a8e2-171088d3dec7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=5.13_Kv=2.12_Z=-\
800_800mm_dGH.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=5.13_Kv=2.12_Z=-\
800_800mm_dGH.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202494690054235`*^9},
 CellLabel->
  "During evaluation of \
In[142]:=",ExpressionUUID->"749c43bb-3f48-43f9-aafd-933d62c1923f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.0941953`8.795823182099252", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.0941953`8.795823182099252, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820249469015417*^9},
 CellLabel->
  "During evaluation of \
In[142]:=",ExpressionUUID->"3d0128ab-5d05-4f42-a3ce-f9ec0e87a13d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "13.125`"}]}],
  SequenceForm["shift[mm]: ", -13.125],
  Editable->False]], "Print",
 CellChangeTimes->{3.820249469015417*^9},
 CellLabel->
  "During evaluation of \
In[142]:=",ExpressionUUID->"a06639c5-fcf3-42b1-95f7-ee0965c71dbe"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=3.9_Kv=1.64_Z=-\
800_800mm_dGH.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=3.9_Kv=1.64_Z=-\
800_800mm_dGH.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202495308725743`*^9},
 CellLabel->
  "During evaluation of \
In[142]:=",ExpressionUUID->"729cfde9-4485-426e-8489-ac596e3f3e1c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.104197`8.796019735999417", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.104197`8.796019735999417, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820249530882571*^9},
 CellLabel->
  "During evaluation of \
In[142]:=",ExpressionUUID->"54b1e933-bbb9-4d7c-94c1-8e2b61e67a82"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "19.6875`"}]}],
  SequenceForm["shift[mm]: ", -19.6875],
  Editable->False]], "Print",
 CellChangeTimes->{3.820249530882571*^9},
 CellLabel->
  "During evaluation of \
In[142]:=",ExpressionUUID->"d751b5c4-5c8f-456a-8156-8127df3e0f00"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=2.13_Kv=0.82_Z=-\
800_800mm_dGH.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=2.13_Kv=0.82_Z=-\
800_800mm_dGH.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820249592678359*^9},
 CellLabel->
  "During evaluation of \
In[142]:=",ExpressionUUID->"8a4b7772-4928-44cf-8eb3-e0f0268bd31d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.1441603`8.796804210110853", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.1441603`8.796804210110853, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202495926883535`*^9},
 CellLabel->
  "During evaluation of \
In[142]:=",ExpressionUUID->"ccdc691e-7dc0-458d-a2fe-18fdfbf52db2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Elapsed time = \"\>", "\[InvisibleSpace]", 
   "249.8643068`9.849249214940803", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm["Elapsed time = ", 249.8643068`9.849249214940803, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202495926883535`*^9},
 CellLabel->
  "During evaluation of \
In[142]:=",ExpressionUUID->"ee499e2a-7ba5-4176-8f93-5a610deaf282"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Delta]GV", "Section",
 CellChangeTimes->{{3.8201580063786097`*^9, 3.820158019009424*^9}, {
  3.8201621504380217`*^9, 
  3.820162151958124*^9}},ExpressionUUID->"8a6af01e-5de7-4476-93dd-\
ba048430b4d9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]P", " ", "=", 
   RowBox[{"\[Lambda]u", "/", "8"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]CP", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GV", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GH", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Polarization", "=", "\"\<EllipticalPolarization\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PhaseName", " ", "=", " ", "\"\<dGV\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t0", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", " ", 
      RowBox[{"Length", "[", "\[Delta]GList", "]"}]}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<shift[mm]: \>\"", ",", " ", 
        RowBox[{"\[Delta]GList", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Delta]GV", " ", "=", " ", 
       RowBox[{"\[Delta]GList", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Device", "=", " ", 
       RowBox[{"IDDelta", "[", 
        RowBox[{
        "\[Lambda]u", ",", " ", "Np", ",", " ", "Mr", ",", " ", "Gap", ",", 
         "  ", 
         RowBox[{"\"\<\[Delta]P\>\"", "\[Rule]", " ", "\[Delta]P"}], ",", " ", 
         RowBox[{"\"\<\[Delta]GV\>\"", "\[Rule]", " ", "\[Delta]GV"}], ",", 
         " ", 
         RowBox[{"\"\<\[Delta]GH\>\"", "\[Rule]", " ", "\[Delta]GH"}], ",", 
         " ", 
         RowBox[{"\"\<\[Delta]CP\>\"", "\[Rule]", " ", "\[Delta]CP"}], ",", 
         " ", 
         RowBox[{"\"\<BlockShape\>\"", " ", "\[Rule]", " ", "BlockShape"}], 
         " ", ",", " ", 
         RowBox[{"\"\<BlockGap\>\"", " ", "\[Rule]", " ", "BlockGap"}], " ", 
         ",", 
         RowBox[{"\"\<Termination\>\"", "\[Rule]", " ", "Termination"}], ",", 
         " ", 
         RowBox[{
         "\"\<BlockSubdivision\>\"", "\[Rule]", " ", "BlockSubdivision"}], 
         ",", " ", 
         RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "Silent"}], ",", "  ", 
         RowBox[{"\"\<Size1\>\"", "\[Rule]", " ", "Size1"}], ",", " ", 
         RowBox[{"\"\<Size2\>\"", "\[Rule]", " ", "Size2"}], ",", " ", 
         RowBox[{"\"\<Size3\>\"", "\[Rule]", " ", "Size3"}], ",", " ", 
         RowBox[{"\"\<Size4\>\"", "\[Rule]", " ", "Size4"}], ",", 
         RowBox[{"\"\<Gap1\>\"", "\[Rule]", " ", "Gap1"}], ",", " ", 
         RowBox[{"\"\<Gap2\>\"", "\[Rule]", " ", "Gap2"}], ",", " ", 
         RowBox[{"\"\<Gap3\>\"", "\[Rule]", " ", "Gap3"}], ",", 
         RowBox[{"\"\<Gap4\>\"", "\[Rule]", " ", "Gap4"}], ",", " ", 
         RowBox[{"\"\<Shift1\>\"", "\[Rule]", " ", "Shift1"}], ",", " ", 
         RowBox[{"\"\<Shift2\>\"", "\[Rule]", " ", "Shift2"}], ",", " ", 
         RowBox[{"\"\<Shift3\>\"", "\[Rule]", " ", "Shift3"}], ",", " ", 
         RowBox[{"\"\<Shift4\>\"", "\[Rule]", " ", "Shift4"}], ",", " ", 
         RowBox[{"\"\<FourBlocks\>\"", "\[Rule]", " ", "1"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Mat", "=", " ", 
       RowBox[{"RadMatNdFeB", "[", "Mr", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Device", "=", " ", 
       RowBox[{"radMatApl", "[", 
        RowBox[{"Device", ",", " ", "Mat"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"IDSolve", "[", 
       RowBox[{"Device", ",", " ", "Prec", ",", " ", "MaxIter", ",", " ", 
        RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "Silent"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"IDFieldMapWithHeader", "[", 
       RowBox[{"Device", ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"Li", ",", " ", "Lf"}], "}"}], ",", " ", "1", ",", " ", "1", 
        ",", " ", "Lnpts", ",", " ", "MagnetName", ",", " ", "Polarization", 
        ",", " ", "PhaseName", ",", " ", "MagnetLength", ",", "\[Lambda]u", 
        ",", " ", "Gap", ",", " ", "\[Delta]P", ",", " ", "\[Delta]GV", ",", 
        " ", "\[Delta]GH", ",", " ", "\[Delta]CP"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"CalcTraj", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"IDTrajectoryFile", "[", 
          RowBox[{"Device", ",", " ", "Energy", ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", " ", "0", ",", " ", "Li", ",", " ", "0", ",", " ", "0", 
             ",", " ", "1"}], "}"}], ",", "Lf", ",", "Lstep", ",", " ", 
           "MagnetName", ",", " ", "Polarization", ",", " ", "PhaseName", ",",
            " ", "MagnetLength", ",", "\[Lambda]u", ",", " ", "Gap", ",", " ",
            "\[Delta]P", ",", " ", "\[Delta]GV", ",", " ", "\[Delta]GH", ",", 
           " ", "\[Delta]CP"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Elapsed time = \>\"", ",", 
    RowBox[{"(", 
     RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8200481107642474`*^9, 3.8200481587837424`*^9}, {
   3.820048197117392*^9, 3.820048197937029*^9}, {3.8200509409117136`*^9, 
   3.820050944440159*^9}, {3.820051064048478*^9, 3.8200510642184086`*^9}, {
   3.8200512480184298`*^9, 3.8200512573242693`*^9}, {3.8200521112218113`*^9, 
   3.820052115329935*^9}, {3.8200630689414687`*^9, 3.8200631054369073`*^9}, {
   3.8200633049361115`*^9, 3.820063306815239*^9}, {3.820063371675081*^9, 
   3.8200633761430044`*^9}, {3.82006390421078*^9, 3.820063904720542*^9}, {
   3.8201495538865643`*^9, 3.8201495542966237`*^9}, {3.8201497915822363`*^9, 
   3.820149983546794*^9}, 3.8201500276496797`*^9, {3.8201501945306916`*^9, 
   3.8201501959708023`*^9}, {3.8201508544391437`*^9, 
   3.8201508593694563`*^9}, {3.820152769570441*^9, 3.820152771470558*^9}, {
   3.820152848715656*^9, 3.8201529443319683`*^9}, {3.820152999816786*^9, 
   3.8201530180679955`*^9}, {3.8201536575874186`*^9, 3.8201536681081467`*^9}, 
   3.8201539351575203`*^9, {3.8201568830223465`*^9, 3.8201568873025694`*^9}, {
   3.8201576175133305`*^9, 3.820157623623746*^9}, {3.820158038650758*^9, 
   3.8201580409408894`*^9}, {3.8201581036150494`*^9, 3.820158219334298*^9}, {
   3.820158294020669*^9, 3.820158317492241*^9}, {3.820158522885709*^9, 
   3.820158523105774*^9}, {3.8201621548682823`*^9, 3.820162159680563*^9}, {
   3.8201623862764215`*^9, 3.8201623866464415`*^9}, {3.820171784694354*^9, 
   3.8201717876365805`*^9}, {3.8202010023315287`*^9, 3.8202010027215433`*^9}, 
   3.8202477267609158`*^9},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[152]:=",ExpressionUUID->"a1749903-7203-4dfa-9708-30cff12a7aa9"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", "0.`"}],
  SequenceForm["shift[mm]: ", 0.],
  Editable->False]], "Print",
 CellChangeTimes->{3.820249592728326*^9},
 CellLabel->
  "During evaluation of \
In[152]:=",ExpressionUUID->"ebec0e90-9a0d-4e74-b337-444945df226b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=5.58_Kv=2.22_Z=-\
800_800mm_dGV.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=5.58_Kv=2.22_Z=-\
800_800mm_dGV.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202496549238596`*^9},
 CellLabel->
  "During evaluation of \
In[152]:=",ExpressionUUID->"ad8a463b-6480-4f6b-8625-3fb1058ea224"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "21.9842975`8.793657585955762", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 21.9842975`8.793657585955762, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202496549238596`*^9},
 CellLabel->
  "During evaluation of \
In[152]:=",ExpressionUUID->"39572aa8-7259-4f68-9d21-981cee9cda11"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "6.5625`"}]}],
  SequenceForm["shift[mm]: ", -6.5625],
  Editable->False]], "Print",
 CellChangeTimes->{3.820249654933831*^9},
 CellLabel->
  "During evaluation of \
In[152]:=",ExpressionUUID->"41798388-95b6-4094-9c37-4d436ba6869e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=5.14_Kv=2.15_Z=-\
800_800mm_dGV.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=5.14_Kv=2.15_Z=-\
800_800mm_dGV.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202497179699802`*^9},
 CellLabel->
  "During evaluation of \
In[152]:=",ExpressionUUID->"02e3d1ed-7f04-45d4-b742-17a28924199b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.1341693`8.796608220954012", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.1341693`8.796608220954012, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202497179699802`*^9},
 CellLabel->
  "During evaluation of \
In[152]:=",ExpressionUUID->"9173dda8-415e-414f-8709-c89a7d9d53b7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "13.125`"}]}],
  SequenceForm["shift[mm]: ", -13.125],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202497179699802`*^9},
 CellLabel->
  "During evaluation of \
In[152]:=",ExpressionUUID->"60b94101-1202-41d1-b2f1-13242bda1c9d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=3.94_Kv=1.73_Z=-\
800_800mm_dGV.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=3.94_Kv=1.73_Z=-\
800_800mm_dGV.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820249781196554*^9},
 CellLabel->
  "During evaluation of \
In[152]:=",ExpressionUUID->"fe226d12-c004-49a6-9d19-ab642ddb2440"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.0642146`8.7952334663643", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.0642146`8.7952334663643, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820249781196554*^9},
 CellLabel->
  "During evaluation of \
In[152]:=",ExpressionUUID->"b50a7ef9-4555-4dca-9372-afff221f0e77"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "19.6875`"}]}],
  SequenceForm["shift[mm]: ", -19.6875],
  Editable->False]], "Print",
 CellChangeTimes->{3.820249781196554*^9},
 CellLabel->
  "During evaluation of \
In[152]:=",ExpressionUUID->"a6c2021a-e64c-4beb-9583-db7111f48a51"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=2.17_Kv=0.91_Z=-\
800_800mm_dGV.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=2.17_Kv=0.91_Z=-\
800_800mm_dGV.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820249844011628*^9},
 CellLabel->
  "During evaluation of \
In[152]:=",ExpressionUUID->"f703f4a1-96e8-4f63-9a67-4a125c1c113c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.0842026`8.795626716190588", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.0842026`8.795626716190588, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820249844011628*^9},
 CellLabel->
  "During evaluation of \
In[152]:=",ExpressionUUID->"42113784-b075-44a7-8213-739bbb4dc52d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Elapsed time = \"\>", "\[InvisibleSpace]", 
   "251.2833027`9.851708625000713", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm["Elapsed time = ", 251.2833027`9.851708625000713, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820249844011628*^9},
 CellLabel->
  "During evaluation of \
In[152]:=",ExpressionUUID->"c4dffb06-fc6a-4eb5-9f49-088baf1d2fcd"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Elliptical Polarization 3\[Lambda]u/8", "Chapter",
 CellChangeTimes->{{3.681300194179221*^9, 3.6813002033832407`*^9}, {
   3.681305983976405*^9, 3.6813059853359213`*^9}, {3.6813176225703306`*^9, 
   3.6813176235079107`*^9}, {3.6813177175941257`*^9, 3.68131771915676*^9}, {
   3.708272177122472*^9, 3.708272189394394*^9}, {3.708272239370994*^9, 
   3.708272253185425*^9}, {3.7247626663439655`*^9, 3.724762668594143*^9}, 
   3.724763762181196*^9, {3.725974849294973*^9, 3.725974857279992*^9}, {
   3.7316800228814087`*^9, 3.7316800249126425`*^9}, {3.731761928333893*^9, 
   3.731761928740137*^9}, {3.7377345647344294`*^9, 3.7377345664687967`*^9}, {
   3.737994165253688*^9, 3.7379941653786864`*^9}, {3.7489625392900763`*^9, 
   3.7489625531505637`*^9}, {3.749318816981333*^9, 3.749318817559469*^9}, {
   3.7656382216793394`*^9, 3.7656382261328287`*^9}, {3.7662401432029853`*^9, 
   3.766240154985159*^9}, {3.7663282678653297`*^9, 3.766328270484855*^9}, {
   3.766331146283388*^9, 3.7663311568355923`*^9}, {3.7663982782306576`*^9, 
   3.7663982795028768`*^9}, {3.7664037488989267`*^9, 
   3.7664037535714073`*^9}, {3.76675425955847*^9, 3.766754260902328*^9}, {
   3.767446029232342*^9, 3.7674460297011285`*^9}, {3.7675176217294626`*^9, 
   3.767517621841589*^9}, {3.7685471006341314`*^9, 3.7685471031625986`*^9}, {
   3.782651674525923*^9, 3.7826516762290554`*^9}, {3.7827472341594315`*^9, 
   3.7827472344406757`*^9}, {3.7845390971377993`*^9, 
   3.7845390993098416`*^9}, {3.7846213628789454`*^9, 
   3.7846213635508842`*^9}, {3.784971285415371*^9, 3.784971285852929*^9}, {
   3.80003815573755*^9, 3.8000381597687845`*^9}, {3.8049514458306084`*^9, 
   3.804951448440013*^9}, {3.8062446719465714`*^9, 3.8062446751540537`*^9}, {
   3.811791929593967*^9, 3.8117919321569138`*^9}, {3.8117920042649097`*^9, 
   3.811792032147236*^9}, {3.8118212232455654`*^9, 3.8118212243258395`*^9}, {
   3.811855173078432*^9, 3.8118551748205085`*^9}, {3.813666226120046*^9, 
   3.8136662293236427`*^9}, {3.8157445404480095`*^9, 3.815744553217987*^9}, 
   3.8194444635501432`*^9, {3.8200470241049037`*^9, 3.8200470540438976`*^9}, {
   3.8200479202353115`*^9, 3.8200479218146176`*^9}, {3.820063087622788*^9, 
   3.8200630909436483`*^9}, {3.820162369245296*^9, 3.820162370625386*^9}, {
   3.820171705419344*^9, 3.8201717076095247`*^9}, {3.8202009861404676`*^9, 
   3.8202009909207892`*^9}, {3.820233286369794*^9, 
   3.820233296424614*^9}},ExpressionUUID->"1f878c74-c86b-4f64-a3cd-\
19b138092c7c"],

Cell[CellGroupData[{

Cell["\[Delta]GH", "Section",
 CellChangeTimes->{{3.8201580063786097`*^9, 
  3.820158019009424*^9}},ExpressionUUID->"a4d8a82d-2df6-44be-9cb5-\
af8e7e1a5f9b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]P", " ", "=", 
   RowBox[{"3", 
    RowBox[{"\[Lambda]u", "/", "8"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]CP", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GV", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GH", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Polarization", "=", "\"\<EllipticalPolarization\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PhaseName", " ", "=", " ", "\"\<dGH\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t0", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", " ", 
      RowBox[{"Length", "[", "\[Delta]GList", "]"}]}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<shift[mm]: \>\"", ",", " ", 
        RowBox[{"\[Delta]GList", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Delta]GH", " ", "=", " ", 
       RowBox[{"\[Delta]GList", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Device", "=", " ", 
       RowBox[{"IDDelta", "[", 
        RowBox[{
        "\[Lambda]u", ",", " ", "Np", ",", " ", "Mr", ",", " ", "Gap", ",", 
         "  ", 
         RowBox[{"\"\<\[Delta]P\>\"", "\[Rule]", " ", "\[Delta]P"}], ",", " ", 
         RowBox[{"\"\<\[Delta]GV\>\"", "\[Rule]", " ", "\[Delta]GV"}], ",", 
         " ", 
         RowBox[{"\"\<\[Delta]GH\>\"", "\[Rule]", " ", "\[Delta]GH"}], ",", 
         " ", 
         RowBox[{"\"\<\[Delta]CP\>\"", "\[Rule]", " ", "\[Delta]CP"}], ",", 
         " ", 
         RowBox[{"\"\<BlockShape\>\"", " ", "\[Rule]", " ", "BlockShape"}], 
         " ", ",", " ", 
         RowBox[{"\"\<BlockGap\>\"", " ", "\[Rule]", " ", "BlockGap"}], " ", 
         ",", 
         RowBox[{"\"\<Termination\>\"", "\[Rule]", " ", "Termination"}], ",", 
         " ", 
         RowBox[{
         "\"\<BlockSubdivision\>\"", "\[Rule]", " ", "BlockSubdivision"}], 
         ",", " ", 
         RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "Silent"}], ",", "  ", 
         RowBox[{"\"\<Size1\>\"", "\[Rule]", " ", "Size1"}], ",", " ", 
         RowBox[{"\"\<Size2\>\"", "\[Rule]", " ", "Size2"}], ",", " ", 
         RowBox[{"\"\<Size3\>\"", "\[Rule]", " ", "Size3"}], ",", " ", 
         RowBox[{"\"\<Size4\>\"", "\[Rule]", " ", "Size4"}], ",", 
         RowBox[{"\"\<Gap1\>\"", "\[Rule]", " ", "Gap1"}], ",", " ", 
         RowBox[{"\"\<Gap2\>\"", "\[Rule]", " ", "Gap2"}], ",", " ", 
         RowBox[{"\"\<Gap3\>\"", "\[Rule]", " ", "Gap3"}], ",", 
         RowBox[{"\"\<Gap4\>\"", "\[Rule]", " ", "Gap4"}], ",", " ", 
         RowBox[{"\"\<Shift1\>\"", "\[Rule]", " ", "Shift1"}], ",", " ", 
         RowBox[{"\"\<Shift2\>\"", "\[Rule]", " ", "Shift2"}], ",", " ", 
         RowBox[{"\"\<Shift3\>\"", "\[Rule]", " ", "Shift3"}], ",", " ", 
         RowBox[{"\"\<Shift4\>\"", "\[Rule]", " ", "Shift4"}], ",", " ", 
         RowBox[{"\"\<FourBlocks\>\"", "\[Rule]", " ", "1"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Mat", "=", " ", 
       RowBox[{"RadMatNdFeB", "[", "Mr", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Device", "=", " ", 
       RowBox[{"radMatApl", "[", 
        RowBox[{"Device", ",", " ", "Mat"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"IDSolve", "[", 
       RowBox[{"Device", ",", " ", "Prec", ",", " ", "MaxIter", ",", " ", 
        RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "Silent"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"IDFieldMapWithHeader", "[", 
       RowBox[{"Device", ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"Li", ",", " ", "Lf"}], "}"}], ",", " ", "1", ",", " ", "1", 
        ",", " ", "Lnpts", ",", " ", "MagnetName", ",", " ", "Polarization", 
        ",", " ", "PhaseName", ",", " ", "MagnetLength", ",", "\[Lambda]u", 
        ",", " ", "Gap", ",", " ", "\[Delta]P", ",", " ", "\[Delta]GV", ",", 
        " ", "\[Delta]GH", ",", " ", "\[Delta]CP"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"CalcTraj", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"IDTrajectoryFile", "[", 
          RowBox[{"Device", ",", " ", "Energy", ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", " ", "0", ",", " ", "Li", ",", " ", "0", ",", " ", "0", 
             ",", " ", "1"}], "}"}], ",", "Lf", ",", "Lstep", ",", " ", 
           "MagnetName", ",", " ", "Polarization", ",", " ", "PhaseName", ",",
            " ", "MagnetLength", ",", "\[Lambda]u", ",", " ", "Gap", ",", " ",
            "\[Delta]P", ",", " ", "\[Delta]GV", ",", " ", "\[Delta]GH", ",", 
           " ", "\[Delta]CP"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Elapsed time = \>\"", ",", 
    RowBox[{"(", 
     RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8200481107642474`*^9, 3.8200481587837424`*^9}, {
   3.820048197117392*^9, 3.820048197937029*^9}, {3.8200509409117136`*^9, 
   3.820050944440159*^9}, {3.820051064048478*^9, 3.8200510642184086`*^9}, {
   3.8200512480184298`*^9, 3.8200512573242693`*^9}, {3.8200521112218113`*^9, 
   3.820052115329935*^9}, {3.8200630689414687`*^9, 3.8200631054369073`*^9}, {
   3.8200633049361115`*^9, 3.820063306815239*^9}, {3.820063371675081*^9, 
   3.8200633761430044`*^9}, {3.82006390421078*^9, 3.820063904720542*^9}, {
   3.8201495538865643`*^9, 3.8201495542966237`*^9}, {3.8201497915822363`*^9, 
   3.820149983546794*^9}, 3.8201500276496797`*^9, {3.8201501945306916`*^9, 
   3.8201501959708023`*^9}, {3.8201508544391437`*^9, 
   3.8201508593694563`*^9}, {3.820152769570441*^9, 3.820152771470558*^9}, {
   3.820152848715656*^9, 3.8201529443319683`*^9}, {3.820152999816786*^9, 
   3.8201530180679955`*^9}, {3.8201536575874186`*^9, 3.8201536681081467`*^9}, 
   3.8201539351575203`*^9, {3.8201568830223465`*^9, 3.8201568873025694`*^9}, {
   3.8201576175133305`*^9, 3.820157623623746*^9}, {3.820158038650758*^9, 
   3.8201580409408894`*^9}, {3.8201581036150494`*^9, 3.820158219334298*^9}, {
   3.820158294020669*^9, 3.820158317492241*^9}, {3.820158522885709*^9, 
   3.820158523105774*^9}, {3.8201623771057973`*^9, 3.8201623793259583`*^9}, {
   3.820171768247072*^9, 3.8201717774821677`*^9}, {3.820200993600941*^9, 
   3.8202009943409896`*^9}, 3.820233299882825*^9, 3.820247732527953*^9},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[162]:=",ExpressionUUID->"8dea78c3-e942-4fa2-a6e9-ef1476b6bb5a"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", "0.`"}],
  SequenceForm["shift[mm]: ", 0.],
  Editable->False]], "Print",
 CellChangeTimes->{3.820249844071585*^9},
 CellLabel->
  "During evaluation of \
In[162]:=",ExpressionUUID->"caa972cf-3209-48a1-ad3a-1542b48c7bb4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=2.22_Kv=5.58_Z=-\
800_800mm_dGH.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=2.22_Kv=5.58_Z=-\
800_800mm_dGH.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820249907176447*^9},
 CellLabel->
  "During evaluation of \
In[162]:=",ExpressionUUID->"fde1fd47-a636-46c7-b09c-4f2958f72913"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.1541554`8.797000191234792", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.1541554`8.797000191234792, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202499071864386`*^9},
 CellLabel->
  "During evaluation of \
In[162]:=",ExpressionUUID->"97426c25-c4c6-47fc-8489-791761652253"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "6.5625`"}]}],
  SequenceForm["shift[mm]: ", -6.5625],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202499071864386`*^9},
 CellLabel->
  "During evaluation of \
In[162]:=",ExpressionUUID->"64af72e9-da0a-43db-87d7-2a3a1c190431"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=2.15_Kv=5.14_Z=-\
800_800mm_dGH.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=2.15_Kv=5.14_Z=-\
800_800mm_dGH.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820249970367407*^9},
 CellLabel->
  "During evaluation of \
In[162]:=",ExpressionUUID->"634d119d-7ffa-4f4d-ac07-1504467f2282"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.1208138`8.79634609363081", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.1208138`8.79634609363081, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820249970367407*^9},
 CellLabel->
  "During evaluation of \
In[162]:=",ExpressionUUID->"eb3cf253-13f6-4a3c-a1e4-74f6cc45dc33"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "13.125`"}]}],
  SequenceForm["shift[mm]: ", -13.125],
  Editable->False]], "Print",
 CellChangeTimes->{3.820249970367407*^9},
 CellLabel->
  "During evaluation of \
In[162]:=",ExpressionUUID->"1f854546-7c36-4125-ad1b-c147d6c012df"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=1.73_Kv=3.94_Z=-\
800_800mm_dGH.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=1.73_Kv=3.94_Z=-\
800_800mm_dGH.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.82025003234519*^9},
 CellLabel->
  "During evaluation of \
In[162]:=",ExpressionUUID->"624f5380-0c3e-4b44-a3f7-b75a7b898512"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.085112`8.795644599529078", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.085112`8.795644599529078, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820250032355183*^9},
 CellLabel->
  "During evaluation of \
In[162]:=",ExpressionUUID->"6e241372-e9ca-43c7-a787-592ce3ed0836"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "19.6875`"}]}],
  SequenceForm["shift[mm]: ", -19.6875],
  Editable->False]], "Print",
 CellChangeTimes->{3.820250032355183*^9},
 CellLabel->
  "During evaluation of \
In[162]:=",ExpressionUUID->"eeaae044-5f88-4157-80d5-ea1aa6e62001"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=0.91_Kv=2.17_Z=-\
800_800mm_dGH.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=0.91_Kv=2.17_Z=-\
800_800mm_dGH.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202500940323696`*^9},
 CellLabel->
  "During evaluation of \
In[162]:=",ExpressionUUID->"92a7b973-6413-48ba-916c-9db5d89564f9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.0742145`8.795430251866298", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.0742145`8.795430251866298, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820250094042386*^9},
 CellLabel->
  "During evaluation of \
In[162]:=",ExpressionUUID->"6d2a6c51-1283-42c2-9f6f-495245dfeed1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Elapsed time = \"\>", "\[InvisibleSpace]", 
   "249.9707803`9.84943423938351", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm["Elapsed time = ", 249.9707803`9.84943423938351, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820250094042386*^9},
 CellLabel->
  "During evaluation of \
In[162]:=",ExpressionUUID->"c9b5c6e1-9b86-4f84-9092-9e12e1c6bd2f"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Delta]GV", "Section",
 CellChangeTimes->{{3.8201580063786097`*^9, 3.820158019009424*^9}, {
  3.8201621504380217`*^9, 
  3.820162151958124*^9}},ExpressionUUID->"71874014-ed78-4af7-8eb7-\
6b9584f50b63"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]P", " ", "=", 
   RowBox[{"3", 
    RowBox[{"\[Lambda]u", "/", "8"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]CP", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GV", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GH", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Polarization", "=", "\"\<EllipticalPolarization\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PhaseName", " ", "=", " ", "\"\<dGV\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t0", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", " ", 
      RowBox[{"Length", "[", "\[Delta]GList", "]"}]}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<shift[mm]: \>\"", ",", " ", 
        RowBox[{"\[Delta]GList", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Delta]GV", " ", "=", " ", 
       RowBox[{"\[Delta]GList", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Device", "=", " ", 
       RowBox[{"IDDelta", "[", 
        RowBox[{
        "\[Lambda]u", ",", " ", "Np", ",", " ", "Mr", ",", " ", "Gap", ",", 
         "  ", 
         RowBox[{"\"\<\[Delta]P\>\"", "\[Rule]", " ", "\[Delta]P"}], ",", " ", 
         RowBox[{"\"\<\[Delta]GV\>\"", "\[Rule]", " ", "\[Delta]GV"}], ",", 
         " ", 
         RowBox[{"\"\<\[Delta]GH\>\"", "\[Rule]", " ", "\[Delta]GH"}], ",", 
         " ", 
         RowBox[{"\"\<\[Delta]CP\>\"", "\[Rule]", " ", "\[Delta]CP"}], ",", 
         " ", 
         RowBox[{"\"\<BlockShape\>\"", " ", "\[Rule]", " ", "BlockShape"}], 
         " ", ",", " ", 
         RowBox[{"\"\<BlockGap\>\"", " ", "\[Rule]", " ", "BlockGap"}], " ", 
         ",", 
         RowBox[{"\"\<Termination\>\"", "\[Rule]", " ", "Termination"}], ",", 
         " ", 
         RowBox[{
         "\"\<BlockSubdivision\>\"", "\[Rule]", " ", "BlockSubdivision"}], 
         ",", " ", 
         RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "Silent"}], ",", "  ", 
         RowBox[{"\"\<Size1\>\"", "\[Rule]", " ", "Size1"}], ",", " ", 
         RowBox[{"\"\<Size2\>\"", "\[Rule]", " ", "Size2"}], ",", " ", 
         RowBox[{"\"\<Size3\>\"", "\[Rule]", " ", "Size3"}], ",", " ", 
         RowBox[{"\"\<Size4\>\"", "\[Rule]", " ", "Size4"}], ",", 
         RowBox[{"\"\<Gap1\>\"", "\[Rule]", " ", "Gap1"}], ",", " ", 
         RowBox[{"\"\<Gap2\>\"", "\[Rule]", " ", "Gap2"}], ",", " ", 
         RowBox[{"\"\<Gap3\>\"", "\[Rule]", " ", "Gap3"}], ",", 
         RowBox[{"\"\<Gap4\>\"", "\[Rule]", " ", "Gap4"}], ",", " ", 
         RowBox[{"\"\<Shift1\>\"", "\[Rule]", " ", "Shift1"}], ",", " ", 
         RowBox[{"\"\<Shift2\>\"", "\[Rule]", " ", "Shift2"}], ",", " ", 
         RowBox[{"\"\<Shift3\>\"", "\[Rule]", " ", "Shift3"}], ",", " ", 
         RowBox[{"\"\<Shift4\>\"", "\[Rule]", " ", "Shift4"}], ",", " ", 
         RowBox[{"\"\<FourBlocks\>\"", "\[Rule]", " ", "1"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Mat", "=", " ", 
       RowBox[{"RadMatNdFeB", "[", "Mr", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Device", "=", " ", 
       RowBox[{"radMatApl", "[", 
        RowBox[{"Device", ",", " ", "Mat"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"IDSolve", "[", 
       RowBox[{"Device", ",", " ", "Prec", ",", " ", "MaxIter", ",", " ", 
        RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "Silent"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"IDFieldMapWithHeader", "[", 
       RowBox[{"Device", ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"Li", ",", " ", "Lf"}], "}"}], ",", " ", "1", ",", " ", "1", 
        ",", " ", "Lnpts", ",", " ", "MagnetName", ",", " ", "Polarization", 
        ",", " ", "PhaseName", ",", " ", "MagnetLength", ",", "\[Lambda]u", 
        ",", " ", "Gap", ",", " ", "\[Delta]P", ",", " ", "\[Delta]GV", ",", 
        " ", "\[Delta]GH", ",", " ", "\[Delta]CP"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"CalcTraj", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"IDTrajectoryFile", "[", 
          RowBox[{"Device", ",", " ", "Energy", ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", " ", "0", ",", " ", "Li", ",", " ", "0", ",", " ", "0", 
             ",", " ", "1"}], "}"}], ",", "Lf", ",", "Lstep", ",", " ", 
           "MagnetName", ",", " ", "Polarization", ",", " ", "PhaseName", ",",
            " ", "MagnetLength", ",", "\[Lambda]u", ",", " ", "Gap", ",", " ",
            "\[Delta]P", ",", " ", "\[Delta]GV", ",", " ", "\[Delta]GH", ",", 
           " ", "\[Delta]CP"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Elapsed time = \>\"", ",", 
    RowBox[{"(", 
     RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8200481107642474`*^9, 3.8200481587837424`*^9}, {
   3.820048197117392*^9, 3.820048197937029*^9}, {3.8200509409117136`*^9, 
   3.820050944440159*^9}, {3.820051064048478*^9, 3.8200510642184086`*^9}, {
   3.8200512480184298`*^9, 3.8200512573242693`*^9}, {3.8200521112218113`*^9, 
   3.820052115329935*^9}, {3.8200630689414687`*^9, 3.8200631054369073`*^9}, {
   3.8200633049361115`*^9, 3.820063306815239*^9}, {3.820063371675081*^9, 
   3.8200633761430044`*^9}, {3.82006390421078*^9, 3.820063904720542*^9}, {
   3.8201495538865643`*^9, 3.8201495542966237`*^9}, {3.8201497915822363`*^9, 
   3.820149983546794*^9}, 3.8201500276496797`*^9, {3.8201501945306916`*^9, 
   3.8201501959708023`*^9}, {3.8201508544391437`*^9, 
   3.8201508593694563`*^9}, {3.820152769570441*^9, 3.820152771470558*^9}, {
   3.820152848715656*^9, 3.8201529443319683`*^9}, {3.820152999816786*^9, 
   3.8201530180679955`*^9}, {3.8201536575874186`*^9, 3.8201536681081467`*^9}, 
   3.8201539351575203`*^9, {3.8201568830223465`*^9, 3.8201568873025694`*^9}, {
   3.8201576175133305`*^9, 3.820157623623746*^9}, {3.820158038650758*^9, 
   3.8201580409408894`*^9}, {3.8201581036150494`*^9, 3.820158219334298*^9}, {
   3.820158294020669*^9, 3.820158317492241*^9}, {3.820158522885709*^9, 
   3.820158523105774*^9}, {3.8201621548682823`*^9, 3.820162159680563*^9}, {
   3.8201623862764215`*^9, 3.8201623866464415`*^9}, {3.820171784694354*^9, 
   3.8201717876365805`*^9}, {3.8202010023315287`*^9, 3.8202010027215433`*^9}, 
   3.8202333041906033`*^9, 3.820247738214993*^9},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[172]:=",ExpressionUUID->"1b23cff8-b2cb-4916-89b2-000eb8cd33a1"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", "0.`"}],
  SequenceForm["shift[mm]: ", 0.],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202500941123095`*^9},
 CellLabel->
  "During evaluation of \
In[172]:=",ExpressionUUID->"4d5507c1-25cd-4276-b255-9755e46fed95"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=2.22_Kv=5.58_Z=-\
800_800mm_dGV.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=2.22_Kv=5.58_Z=-\
800_800mm_dGV.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.82025015664758*^9},
 CellLabel->
  "During evaluation of \
In[172]:=",ExpressionUUID->"4cc6f6f9-58c2-419d-81e6-ab8c9a66da9c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.084204`8.795626743722138", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.084204`8.795626743722138, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.82025015664758*^9},
 CellLabel->
  "During evaluation of \
In[172]:=",ExpressionUUID->"8a1fe4ab-ddf9-4142-8269-34f6dd40a720"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "6.5625`"}]}],
  SequenceForm["shift[mm]: ", -6.5625],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202501566575727`*^9},
 CellLabel->
  "During evaluation of \
In[172]:=",ExpressionUUID->"ba2674f3-b75a-4d94-842e-44a9788e11d1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=2.12_Kv=5.13_Z=-\
800_800mm_dGV.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=2.12_Kv=5.13_Z=-\
800_800mm_dGV.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202502187032223`*^9},
 CellLabel->
  "During evaluation of \
In[172]:=",ExpressionUUID->"3ac659fa-9bf4-433a-b3dd-d22973be305b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.2241325`8.7983698111555", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.2241325`8.7983698111555, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202502187032223`*^9},
 CellLabel->
  "During evaluation of \
In[172]:=",ExpressionUUID->"ea5c5c16-fb65-4fdd-9e18-11b76200205e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "13.125`"}]}],
  SequenceForm["shift[mm]: ", -13.125],
  Editable->False]], "Print",
 CellChangeTimes->{3.820250218713189*^9},
 CellLabel->
  "During evaluation of \
In[172]:=",ExpressionUUID->"efab6a62-2169-4c06-9b82-4df90dc2ca6f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=1.64_Kv=3.9_Z=-\
800_800mm_dGV.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=1.64_Kv=3.9_Z=-\
800_800mm_dGV.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820250283187071*^9},
 CellLabel->
  "During evaluation of \
In[172]:=",ExpressionUUID->"674b3917-1c8b-481c-afde-5d79ea05a3c4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.1741408`8.797391794353825", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.1741408`8.797391794353825, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202502831970634`*^9},
 CellLabel->
  "During evaluation of \
In[172]:=",ExpressionUUID->"2934c1b3-277b-469c-992c-3b78e41052a5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "19.6875`"}]}],
  SequenceForm["shift[mm]: ", -19.6875],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202502831970634`*^9},
 CellLabel->
  "During evaluation of \
In[172]:=",ExpressionUUID->"d2cb4b27-b15b-4383-8d14-9d941bc00120"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=0.82_Kv=2.13_Z=-\
800_800mm_dGV.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_EllipticalPolarization_Kh=0.82_Kv=2.13_Z=-\
800_800mm_dGV.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202503461833286`*^9},
 CellLabel->
  "During evaluation of \
In[172]:=",ExpressionUUID->"257cc543-0802-423d-a185-d2794cef6217"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.0842026`8.79562671619059", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.0842026`8.79562671619059, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202503461833286`*^9},
 CellLabel->
  "During evaluation of \
In[172]:=",ExpressionUUID->"c90f9f3f-3e33-47ff-b6ea-f68e98ea617f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Elapsed time = \"\>", "\[InvisibleSpace]", 
   "252.0710192`9.853067910870093", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm["Elapsed time = ", 252.0710192`9.853067910870093, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202503461833286`*^9},
 CellLabel->
  "During evaluation of \
In[172]:=",ExpressionUUID->"0247baa8-c292-48b3-9e4d-a4ac89896be2"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Linear Polarization", "Chapter",
 CellChangeTimes->{{3.681300194179221*^9, 3.6813002033832407`*^9}, {
   3.681305983976405*^9, 3.6813059853359213`*^9}, {3.6813176225703306`*^9, 
   3.6813176235079107`*^9}, {3.6813177175941257`*^9, 3.68131771915676*^9}, {
   3.708272177122472*^9, 3.708272189394394*^9}, {3.708272239370994*^9, 
   3.708272253185425*^9}, {3.7247626663439655`*^9, 3.724762668594143*^9}, 
   3.724763762181196*^9, {3.725974849294973*^9, 3.725974857279992*^9}, {
   3.7316800228814087`*^9, 3.7316800249126425`*^9}, {3.731761928333893*^9, 
   3.731761928740137*^9}, {3.7377345647344294`*^9, 3.7377345664687967`*^9}, {
   3.737994165253688*^9, 3.7379941653786864`*^9}, {3.7489625392900763`*^9, 
   3.7489625531505637`*^9}, {3.749318816981333*^9, 3.749318817559469*^9}, {
   3.7656382216793394`*^9, 3.7656382261328287`*^9}, {3.7662401432029853`*^9, 
   3.766240154985159*^9}, {3.7663282678653297`*^9, 3.766328270484855*^9}, {
   3.766331146283388*^9, 3.7663311568355923`*^9}, {3.7663982782306576`*^9, 
   3.7663982795028768`*^9}, {3.7664037488989267`*^9, 
   3.7664037535714073`*^9}, {3.76675425955847*^9, 3.766754260902328*^9}, {
   3.767446029232342*^9, 3.7674460297011285`*^9}, {3.7675176217294626`*^9, 
   3.767517621841589*^9}, {3.7685471006341314`*^9, 3.7685471031625986`*^9}, {
   3.782651674525923*^9, 3.7826516762290554`*^9}, {3.7827472341594315`*^9, 
   3.7827472344406757`*^9}, {3.7845390971377993`*^9, 
   3.7845390993098416`*^9}, {3.7846213628789454`*^9, 
   3.7846213635508842`*^9}, {3.784971285415371*^9, 3.784971285852929*^9}, {
   3.80003815573755*^9, 3.8000381597687845`*^9}, {3.8049514458306084`*^9, 
   3.804951448440013*^9}, {3.8062446719465714`*^9, 3.8062446751540537`*^9}, {
   3.811791929593967*^9, 3.8117919321569138`*^9}, {3.8117920042649097`*^9, 
   3.811792032147236*^9}, {3.8118212232455654`*^9, 3.8118212243258395`*^9}, {
   3.811855173078432*^9, 3.8118551748205085`*^9}, {3.813666226120046*^9, 
   3.8136662293236427`*^9}, {3.8157445404480095`*^9, 3.815744553217987*^9}, 
   3.8194444635501432`*^9, {3.8200470241049037`*^9, 3.8200470540438976`*^9}, {
   3.8200479202353115`*^9, 3.8200479218146176`*^9}, {3.820063087622788*^9, 
   3.8200630909436483`*^9}, {3.820162369245296*^9, 3.820162370625386*^9}, {
   3.820171705419344*^9, 3.8201717076095247`*^9}, {3.8202009861404676`*^9, 
   3.8202009909207892`*^9}, {3.820201362587964*^9, 
   3.820201363968054*^9}},ExpressionUUID->"930c4d10-6381-4203-810f-\
2f248a6c1542"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]P", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]CP", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GV", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GH", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Polarization", "=", "\"\<LinearPolarization\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PhaseName", " ", "=", " ", "\"\<\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t0", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", " ", 
      RowBox[{"Length", "[", "\[Delta]CPList", "]"}]}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<shift[mm]: \>\"", ",", " ", 
        RowBox[{"\[Delta]CPList", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Delta]CP", "=", " ", 
       RowBox[{"\[Delta]CPList", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Device", "=", " ", 
       RowBox[{"IDDelta", "[", 
        RowBox[{
        "\[Lambda]u", ",", " ", "Np", ",", " ", "Mr", ",", " ", "Gap", ",", 
         "  ", 
         RowBox[{"\"\<\[Delta]P\>\"", "\[Rule]", " ", "\[Delta]P"}], ",", " ", 
         RowBox[{"\"\<\[Delta]GV\>\"", "\[Rule]", " ", "\[Delta]GV"}], ",", 
         " ", 
         RowBox[{"\"\<\[Delta]GH\>\"", "\[Rule]", " ", "\[Delta]GH"}], ",", 
         " ", 
         RowBox[{"\"\<\[Delta]CP\>\"", "\[Rule]", " ", "\[Delta]CP"}], ",", 
         " ", 
         RowBox[{"\"\<BlockShape\>\"", " ", "\[Rule]", " ", "BlockShape"}], 
         " ", ",", " ", 
         RowBox[{"\"\<BlockGap\>\"", " ", "\[Rule]", " ", "BlockGap"}], " ", 
         ",", 
         RowBox[{"\"\<Termination\>\"", "\[Rule]", " ", "Termination"}], ",", 
         " ", 
         RowBox[{
         "\"\<BlockSubdivision\>\"", "\[Rule]", " ", "BlockSubdivision"}], 
         ",", " ", 
         RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "Silent"}], ",", "  ", 
         RowBox[{"\"\<Size1\>\"", "\[Rule]", " ", "Size1"}], ",", " ", 
         RowBox[{"\"\<Size2\>\"", "\[Rule]", " ", "Size2"}], ",", " ", 
         RowBox[{"\"\<Size3\>\"", "\[Rule]", " ", "Size3"}], ",", " ", 
         RowBox[{"\"\<Size4\>\"", "\[Rule]", " ", "Size4"}], ",", 
         RowBox[{"\"\<Gap1\>\"", "\[Rule]", " ", "Gap1"}], ",", " ", 
         RowBox[{"\"\<Gap2\>\"", "\[Rule]", " ", "Gap2"}], ",", " ", 
         RowBox[{"\"\<Gap3\>\"", "\[Rule]", " ", "Gap3"}], ",", 
         RowBox[{"\"\<Gap4\>\"", "\[Rule]", " ", "Gap4"}], ",", " ", 
         RowBox[{"\"\<Shift1\>\"", "\[Rule]", " ", "Shift1"}], ",", " ", 
         RowBox[{"\"\<Shift2\>\"", "\[Rule]", " ", "Shift2"}], ",", " ", 
         RowBox[{"\"\<Shift3\>\"", "\[Rule]", " ", "Shift3"}], ",", " ", 
         RowBox[{"\"\<Shift4\>\"", "\[Rule]", " ", "Shift4"}], ",", " ", 
         RowBox[{"\"\<FourBlocks\>\"", "\[Rule]", " ", "1"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Mat", "=", " ", 
       RowBox[{"RadMatNdFeB", "[", "Mr", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Device", "=", " ", 
       RowBox[{"radMatApl", "[", 
        RowBox[{"Device", ",", " ", "Mat"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"IDSolve", "[", 
       RowBox[{"Device", ",", " ", "Prec", ",", " ", "MaxIter", ",", " ", 
        RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "Silent"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"IDFieldMapWithHeader", "[", 
       RowBox[{"Device", ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"Li", ",", " ", "Lf"}], "}"}], ",", " ", "1", ",", " ", "1", 
        ",", " ", "Lnpts", ",", " ", "MagnetName", ",", " ", "Polarization", 
        ",", " ", "PhaseName", ",", " ", "MagnetLength", ",", "\[Lambda]u", 
        ",", " ", "Gap", ",", " ", "\[Delta]P", ",", " ", "\[Delta]GV", ",", 
        " ", "\[Delta]GH", ",", " ", "\[Delta]CP"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"CalcTraj", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"IDTrajectoryFile", "[", 
          RowBox[{"Device", ",", " ", "Energy", ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", " ", "0", ",", " ", "Li", ",", " ", "0", ",", " ", "0", 
             ",", " ", "1"}], "}"}], ",", "Lf", ",", "Lstep", ",", " ", 
           "MagnetName", ",", " ", "Polarization", ",", " ", "PhaseName", ",",
            " ", "MagnetLength", ",", "\[Lambda]u", ",", " ", "Gap", ",", " ",
            "\[Delta]P", ",", " ", "\[Delta]GV", ",", " ", "\[Delta]GH", ",", 
           " ", "\[Delta]CP"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Elapsed time = \>\"", ",", 
    RowBox[{"(", 
     RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8200481107642474`*^9, 3.8200481587837424`*^9}, {
   3.820048197117392*^9, 3.820048197937029*^9}, {3.8200509409117136`*^9, 
   3.820050944440159*^9}, {3.820051064048478*^9, 3.8200510642184086`*^9}, {
   3.8200512480184298`*^9, 3.8200512573242693`*^9}, {3.8200521112218113`*^9, 
   3.820052115329935*^9}, {3.8200630689414687`*^9, 3.8200631054369073`*^9}, {
   3.8200633049361115`*^9, 3.820063306815239*^9}, {3.820063371675081*^9, 
   3.8200633761430044`*^9}, {3.82006390421078*^9, 3.820063904720542*^9}, {
   3.8201495538865643`*^9, 3.8201495542966237`*^9}, {3.8201497915822363`*^9, 
   3.820149983546794*^9}, 3.8201500276496797`*^9, {3.8201501945306916`*^9, 
   3.8201501959708023`*^9}, {3.8201508544391437`*^9, 
   3.8201508593694563`*^9}, {3.820152769570441*^9, 3.820152771470558*^9}, {
   3.820152848715656*^9, 3.8201529443319683`*^9}, {3.820152999816786*^9, 
   3.8201530180679955`*^9}, {3.8201536575874186`*^9, 3.8201536681081467`*^9}, 
   3.8201539351575203`*^9, {3.8201568830223465`*^9, 3.8201568873025694`*^9}, {
   3.8201576175133305`*^9, 3.820157623623746*^9}, {3.820158038650758*^9, 
   3.8201580409408894`*^9}, {3.8201581036150494`*^9, 3.820158219334298*^9}, {
   3.820158294020669*^9, 3.820158317492241*^9}, {3.820158522885709*^9, 
   3.820158523105774*^9}, {3.8201623771057973`*^9, 3.8201623793259583`*^9}, {
   3.820171768247072*^9, 3.8201717774821677`*^9}, {3.820200993600941*^9, 
   3.8202009943409896`*^9}, {3.8202013544774323`*^9, 3.820201356777582*^9}, {
   3.820201399190357*^9, 3.8202014034206576`*^9}, {3.8202186498318267`*^9, 
   3.8202186522508497`*^9}, {3.820239702570224*^9, 3.8202397298559413`*^9}, 
   3.820247745741121*^9},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[182]:=",ExpressionUUID->"71a25101-c494-48eb-ae85-58252ce6792c"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", "6.5625`"}],
  SequenceForm["shift[mm]: ", 6.5625],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202503462632704`*^9},
 CellLabel->
  "During evaluation of \
In[182]:=",ExpressionUUID->"d2b7a1a5-ae7a-4366-84db-db1025912e0f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=5.14_Kv=0.85_Z=-800_\
800mm.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=5.14_Kv=0.85_Z=-800_\
800mm.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202504095490947`*^9},
 CellLabel->
  "During evaluation of \
In[182]:=",ExpressionUUID->"2a7384e0-6732-4f62-8e9f-80e66c86608c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.165238`8.797217392408193", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.165238`8.797217392408193, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202504095490947`*^9},
 CellLabel->
  "During evaluation of \
In[182]:=",ExpressionUUID->"4eca2ebf-7a3a-45f1-b71d-c49591247a12"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", "13.125`"}],
  SequenceForm["shift[mm]: ", 13.125],
  Editable->False]], "Print",
 CellChangeTimes->{3.820250409559085*^9},
 CellLabel->
  "During evaluation of \
In[182]:=",ExpressionUUID->"838ebb14-d363-4805-a8cd-64587be3452b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=2.99_Kv=2.99_Z=-800_\
800mm.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=2.99_Kv=2.99_Z=-800_\
800mm.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202504724640903`*^9},
 CellLabel->
  "During evaluation of \
In[182]:=",ExpressionUUID->"a5973d91-8f52-4ed2-979e-0bbdf8f04011"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.0941921`8.79582311919846", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.0941921`8.79582311919846, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820250472474083*^9},
 CellLabel->
  "During evaluation of \
In[182]:=",ExpressionUUID->"b33e8e65-ba2f-48b2-9902-0394c6e40d18"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"shift[mm]: \"\>", "\[InvisibleSpace]", "19.6875`"}],
  SequenceForm["shift[mm]: ", 19.6875],
  Editable->False]], "Print",
 CellChangeTimes->{3.820250472474083*^9},
 CellLabel->
  "During evaluation of \
In[182]:=",ExpressionUUID->"796c9efa-730f-4220-a2d3-a9b42b17417b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=0.85_Kv=5.14_Z=-800_\
800mm.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_LinearPolarization_Kh=0.85_Kv=5.14_Z=-800_\
800mm.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202505355010843`*^9},
 CellLabel->
  "During evaluation of \
In[182]:=",ExpressionUUID->"9605f601-d1f6-48dc-9218-8be77c6cceea"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.1941263`8.797783046639406", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.1941263`8.797783046639406, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820250535511097*^9},
 CellLabel->
  "During evaluation of \
In[182]:=",ExpressionUUID->"f31a9910-8a3f-4c0a-b256-d924724ae62a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Elapsed time = \"\>", "\[InvisibleSpace]", 
   "189.2378141`9.72855291633376", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm["Elapsed time = ", 189.2378141`9.72855291633376, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820250535511097*^9},
 CellLabel->
  "During evaluation of \
In[182]:=",ExpressionUUID->"5ba0adcc-3fdd-4dc0-83e7-4435480ebf0c"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Without Radiation", "Chapter",
 CellChangeTimes->{{3.681300194179221*^9, 3.6813002033832407`*^9}, {
   3.681305983976405*^9, 3.6813059853359213`*^9}, {3.6813176225703306`*^9, 
   3.6813176235079107`*^9}, {3.6813177175941257`*^9, 3.68131771915676*^9}, {
   3.708272177122472*^9, 3.708272189394394*^9}, {3.708272239370994*^9, 
   3.708272253185425*^9}, {3.7247626663439655`*^9, 3.724762668594143*^9}, 
   3.724763762181196*^9, {3.725974849294973*^9, 3.725974857279992*^9}, {
   3.7316800228814087`*^9, 3.7316800249126425`*^9}, {3.731761928333893*^9, 
   3.731761928740137*^9}, {3.7377345647344294`*^9, 3.7377345664687967`*^9}, {
   3.737994165253688*^9, 3.7379941653786864`*^9}, {3.7489625392900763`*^9, 
   3.7489625531505637`*^9}, {3.749318816981333*^9, 3.749318817559469*^9}, {
   3.7656382216793394`*^9, 3.7656382261328287`*^9}, {3.7662401432029853`*^9, 
   3.766240154985159*^9}, {3.7663282678653297`*^9, 3.766328270484855*^9}, {
   3.766331146283388*^9, 3.7663311568355923`*^9}, {3.7663982782306576`*^9, 
   3.7663982795028768`*^9}, {3.7664037488989267`*^9, 
   3.7664037535714073`*^9}, {3.76675425955847*^9, 3.766754260902328*^9}, {
   3.767446029232342*^9, 3.7674460297011285`*^9}, {3.7675176217294626`*^9, 
   3.767517621841589*^9}, {3.7685471006341314`*^9, 3.7685471031625986`*^9}, {
   3.782651674525923*^9, 3.7826516762290554`*^9}, {3.7827472341594315`*^9, 
   3.7827472344406757`*^9}, {3.7845390971377993`*^9, 
   3.7845390993098416`*^9}, {3.7846213628789454`*^9, 
   3.7846213635508842`*^9}, {3.784971285415371*^9, 3.784971285852929*^9}, {
   3.80003815573755*^9, 3.8000381597687845`*^9}, {3.8049514458306084`*^9, 
   3.804951448440013*^9}, {3.8062446719465714`*^9, 3.8062446751540537`*^9}, {
   3.811791929593967*^9, 3.8117919321569138`*^9}, {3.8117920042649097`*^9, 
   3.811792032147236*^9}, {3.8118212232455654`*^9, 3.8118212243258395`*^9}, {
   3.811855173078432*^9, 3.8118551748205085`*^9}, {3.813666226120046*^9, 
   3.8136662293236427`*^9}, {3.8157445404480095`*^9, 3.815744553217987*^9}, 
   3.8194444635501432`*^9, {3.8200470241049037`*^9, 3.8200470540438976`*^9}, {
   3.8200479202353115`*^9, 3.8200479218146176`*^9}, {3.820063087622788*^9, 
   3.8200630909436483`*^9}, {3.820162369245296*^9, 3.820162370625386*^9}, {
   3.820171705419344*^9, 3.8201717076095247`*^9}, {3.8202009861404676`*^9, 
   3.8202009909207892`*^9}, {3.820201362587964*^9, 3.820201363968054*^9}, {
   3.8202409011475177`*^9, 
   3.8202409147205257`*^9}},ExpressionUUID->"dcccadcc-d6f2-47fc-96b2-\
04a6ac5c2e66"],

Cell[CellGroupData[{

Cell["\[Delta]GH", "Section",
 CellChangeTimes->{{3.8201580063786097`*^9, 
  3.820158019009424*^9}},ExpressionUUID->"3e3631be-f887-46ed-9785-\
a5e2cf2b0e4f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]P", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]CP", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GV", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GH", "=", " ", 
   RowBox[{
    RowBox[{"-", "\[Lambda]u"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Polarization", "=", "\"\<WithoutRadiation\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PhaseName", " ", "=", " ", "\"\<dGH\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t0", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Device", "=", " ", 
   RowBox[{"IDDelta", "[", 
    RowBox[{
    "\[Lambda]u", ",", " ", "Np", ",", " ", "Mr", ",", " ", "Gap", ",", "  ", 
     RowBox[{"\"\<\[Delta]P\>\"", "\[Rule]", " ", "\[Delta]P"}], ",", " ", 
     RowBox[{"\"\<\[Delta]GV\>\"", "\[Rule]", " ", "\[Delta]GV"}], ",", " ", 
     RowBox[{"\"\<\[Delta]GH\>\"", "\[Rule]", " ", "\[Delta]GH"}], ",", " ", 
     RowBox[{"\"\<\[Delta]CP\>\"", "\[Rule]", " ", "\[Delta]CP"}], ",", " ", 
     RowBox[{"\"\<BlockShape\>\"", " ", "\[Rule]", " ", "BlockShape"}], " ", 
     ",", " ", 
     RowBox[{"\"\<BlockGap\>\"", " ", "\[Rule]", " ", "BlockGap"}], " ", ",", 
     RowBox[{"\"\<Termination\>\"", "\[Rule]", " ", "Termination"}], ",", " ", 
     RowBox[{"\"\<BlockSubdivision\>\"", "\[Rule]", " ", "BlockSubdivision"}],
      ",", " ", 
     RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "Silent"}], ",", "  ", 
     RowBox[{"\"\<Size1\>\"", "\[Rule]", " ", "Size1"}], ",", " ", 
     RowBox[{"\"\<Size2\>\"", "\[Rule]", " ", "Size2"}], ",", " ", 
     RowBox[{"\"\<Size3\>\"", "\[Rule]", " ", "Size3"}], ",", " ", 
     RowBox[{"\"\<Size4\>\"", "\[Rule]", " ", "Size4"}], ",", 
     RowBox[{"\"\<Gap1\>\"", "\[Rule]", " ", "Gap1"}], ",", " ", 
     RowBox[{"\"\<Gap2\>\"", "\[Rule]", " ", "Gap2"}], ",", " ", 
     RowBox[{"\"\<Gap3\>\"", "\[Rule]", " ", "Gap3"}], ",", 
     RowBox[{"\"\<Gap4\>\"", "\[Rule]", " ", "Gap4"}], ",", " ", 
     RowBox[{"\"\<Shift1\>\"", "\[Rule]", " ", "Shift1"}], ",", " ", 
     RowBox[{"\"\<Shift2\>\"", "\[Rule]", " ", "Shift2"}], ",", " ", 
     RowBox[{"\"\<Shift3\>\"", "\[Rule]", " ", "Shift3"}], ",", " ", 
     RowBox[{"\"\<Shift4\>\"", "\[Rule]", " ", "Shift4"}], ",", " ", 
     RowBox[{"\"\<FourBlocks\>\"", "\[Rule]", " ", "1"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mat", "=", " ", 
   RowBox[{"RadMatNdFeB", "[", "Mr", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Device", "=", " ", 
   RowBox[{"radMatApl", "[", 
    RowBox[{"Device", ",", " ", "Mat"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDSolve", "[", 
    RowBox[{"Device", ",", " ", "Prec", ",", " ", "MaxIter", ",", " ", 
     RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "Silent"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDFieldMapWithHeader", "[", 
    RowBox[{"Device", ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"Li", ",", " ", "Lf"}], "}"}], ",", " ", "1", ",", " ", "1", 
     ",", " ", "Lnpts", ",", " ", "MagnetName", ",", " ", "Polarization", ",",
      " ", "PhaseName", ",", " ", "MagnetLength", ",", "\[Lambda]u", ",", " ",
      "Gap", ",", " ", "\[Delta]P", ",", " ", "\[Delta]GV", ",", " ", 
     "\[Delta]GH", ",", " ", "\[Delta]CP"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{"CalcTraj", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"IDTrajectoryFile", "[", 
       RowBox[{"Device", ",", " ", "Energy", ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", " ", "0", ",", " ", "Li", ",", " ", "0", ",", " ", "0", 
          ",", " ", "1"}], "}"}], ",", "Lf", ",", "Lstep", ",", " ", 
        "MagnetName", ",", " ", "Polarization", ",", " ", "PhaseName", ",", 
        " ", "MagnetLength", ",", "\[Lambda]u", ",", " ", "Gap", ",", " ", 
        "\[Delta]P", ",", " ", "\[Delta]GV", ",", " ", "\[Delta]GH", ",", " ",
         "\[Delta]CP"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Elapsed time = \>\"", ",", 
    RowBox[{"(", 
     RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8200481107642474`*^9, 3.8200481587837424`*^9}, {
   3.820048197117392*^9, 3.820048197937029*^9}, {3.8200509409117136`*^9, 
   3.820050944440159*^9}, {3.820051064048478*^9, 3.8200510642184086`*^9}, {
   3.8200512480184298`*^9, 3.8200512573242693`*^9}, {3.8200521112218113`*^9, 
   3.820052115329935*^9}, {3.8200630689414687`*^9, 3.8200631054369073`*^9}, {
   3.8200633049361115`*^9, 3.820063306815239*^9}, {3.820063371675081*^9, 
   3.8200633761430044`*^9}, {3.82006390421078*^9, 3.820063904720542*^9}, {
   3.8201495538865643`*^9, 3.8201495542966237`*^9}, {3.8201497915822363`*^9, 
   3.820149983546794*^9}, 3.8201500276496797`*^9, {3.8201501945306916`*^9, 
   3.8201501959708023`*^9}, {3.8201508544391437`*^9, 
   3.8201508593694563`*^9}, {3.820152769570441*^9, 3.820152771470558*^9}, {
   3.820152848715656*^9, 3.8201529443319683`*^9}, {3.820152999816786*^9, 
   3.8201530180679955`*^9}, {3.8201536575874186`*^9, 3.8201536681081467`*^9}, 
   3.8201539351575203`*^9, {3.8201568830223465`*^9, 3.8201568873025694`*^9}, {
   3.8201576175133305`*^9, 3.820157623623746*^9}, {3.820158038650758*^9, 
   3.8201580409408894`*^9}, {3.8201581036150494`*^9, 3.820158219334298*^9}, {
   3.820158294020669*^9, 3.820158317492241*^9}, {3.820158522885709*^9, 
   3.820158523105774*^9}, {3.8201623771057973`*^9, 3.8201623793259583`*^9}, {
   3.820171768247072*^9, 3.8201717774821677`*^9}, {3.820200993600941*^9, 
   3.8202009943409896`*^9}, {3.8202013544774323`*^9, 3.820201356777582*^9}, {
   3.820201399190357*^9, 3.8202014034206576`*^9}, {3.8202186498318267`*^9, 
   3.8202186522508497`*^9}, {3.820239702570224*^9, 3.8202397298559413`*^9}, {
   3.8202409211271954`*^9, 3.8202409448749666`*^9}, 3.8202410622086105`*^9, {
   3.8202413229716015`*^9, 3.820241336275093*^9}, {3.820241653205037*^9, 
   3.820241656443483*^9}, {3.8202418717529354`*^9, 3.820241891143393*^9}, 
   3.8202477513282127`*^9},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[192]:=",ExpressionUUID->"0abaf0a7-9319-4811-b267-0097b6734244"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_WithoutRadiation_Kh=0.0_Kv=0.0_Z=-800_\
800mm_dGH.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_WithoutRadiation_Kh=0.0_Kv=0.0_Z=-800_800mm_\
dGH.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202505986059465`*^9},
 CellLabel->
  "During evaluation of \
In[192]:=",ExpressionUUID->"5ef396e3-56b6-4813-8f76-452a01e1f22c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.0842063`8.79562678895253", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.0842063`8.79562678895253, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202505986059465`*^9},
 CellLabel->
  "During evaluation of \
In[192]:=",ExpressionUUID->"d1b3326b-99aa-4094-8ba7-d9d81eb5e22e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Elapsed time = \"\>", "\[InvisibleSpace]", 
   "63.0049094`9.250919384890167", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm["Elapsed time = ", 63.0049094`9.250919384890167, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.82025059861594*^9},
 CellLabel->
  "During evaluation of \
In[192]:=",ExpressionUUID->"84b8db07-79b8-4ef0-8144-3f97ae00f3af"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Delta]GV", "Section",
 CellChangeTimes->{{3.8201580063786097`*^9, 3.820158019009424*^9}, {
  3.8202418623175993`*^9, 
  3.820241862687416*^9}},ExpressionUUID->"e5cf1f3c-072c-4389-9e8f-\
7bfcd85b8467"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]P", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]CP", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GV", " ", "=", 
   RowBox[{
    RowBox[{"-", "\[Lambda]u"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]GH", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Polarization", "=", "\"\<WithoutRadiation\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PhaseName", " ", "=", " ", "\"\<dGV\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t0", "=", 
    RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Device", "=", " ", 
   RowBox[{"IDDelta", "[", 
    RowBox[{
    "\[Lambda]u", ",", " ", "Np", ",", " ", "Mr", ",", " ", "Gap", ",", "  ", 
     RowBox[{"\"\<\[Delta]P\>\"", "\[Rule]", " ", "\[Delta]P"}], ",", " ", 
     RowBox[{"\"\<\[Delta]GV\>\"", "\[Rule]", " ", "\[Delta]GV"}], ",", " ", 
     RowBox[{"\"\<\[Delta]GH\>\"", "\[Rule]", " ", "\[Delta]GH"}], ",", " ", 
     RowBox[{"\"\<\[Delta]CP\>\"", "\[Rule]", " ", "\[Delta]CP"}], ",", " ", 
     RowBox[{"\"\<BlockShape\>\"", " ", "\[Rule]", " ", "BlockShape"}], " ", 
     ",", " ", 
     RowBox[{"\"\<BlockGap\>\"", " ", "\[Rule]", " ", "BlockGap"}], " ", ",", 
     RowBox[{"\"\<Termination\>\"", "\[Rule]", " ", "Termination"}], ",", " ", 
     RowBox[{"\"\<BlockSubdivision\>\"", "\[Rule]", " ", "BlockSubdivision"}],
      ",", " ", 
     RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "Silent"}], ",", "  ", 
     RowBox[{"\"\<Size1\>\"", "\[Rule]", " ", "Size1"}], ",", " ", 
     RowBox[{"\"\<Size2\>\"", "\[Rule]", " ", "Size2"}], ",", " ", 
     RowBox[{"\"\<Size3\>\"", "\[Rule]", " ", "Size3"}], ",", " ", 
     RowBox[{"\"\<Size4\>\"", "\[Rule]", " ", "Size4"}], ",", 
     RowBox[{"\"\<Gap1\>\"", "\[Rule]", " ", "Gap1"}], ",", " ", 
     RowBox[{"\"\<Gap2\>\"", "\[Rule]", " ", "Gap2"}], ",", " ", 
     RowBox[{"\"\<Gap3\>\"", "\[Rule]", " ", "Gap3"}], ",", 
     RowBox[{"\"\<Gap4\>\"", "\[Rule]", " ", "Gap4"}], ",", " ", 
     RowBox[{"\"\<Shift1\>\"", "\[Rule]", " ", "Shift1"}], ",", " ", 
     RowBox[{"\"\<Shift2\>\"", "\[Rule]", " ", "Shift2"}], ",", " ", 
     RowBox[{"\"\<Shift3\>\"", "\[Rule]", " ", "Shift3"}], ",", " ", 
     RowBox[{"\"\<Shift4\>\"", "\[Rule]", " ", "Shift4"}], ",", " ", 
     RowBox[{"\"\<FourBlocks\>\"", "\[Rule]", " ", "1"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mat", "=", " ", 
   RowBox[{"RadMatNdFeB", "[", "Mr", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Device", "=", " ", 
   RowBox[{"radMatApl", "[", 
    RowBox[{"Device", ",", " ", "Mat"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDSolve", "[", 
    RowBox[{"Device", ",", " ", "Prec", ",", " ", "MaxIter", ",", " ", 
     RowBox[{"\"\<Silent\>\"", "\[Rule]", " ", "Silent"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IDFieldMapWithHeader", "[", 
    RowBox[{"Device", ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"Li", ",", " ", "Lf"}], "}"}], ",", " ", "1", ",", " ", "1", 
     ",", " ", "Lnpts", ",", " ", "MagnetName", ",", " ", "Polarization", ",",
      " ", "PhaseName", ",", " ", "MagnetLength", ",", "\[Lambda]u", ",", " ",
      "Gap", ",", " ", "\[Delta]P", ",", " ", "\[Delta]GV", ",", " ", 
     "\[Delta]GH", ",", " ", "\[Delta]CP"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{"CalcTraj", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"IDTrajectoryFile", "[", 
       RowBox[{"Device", ",", " ", "Energy", ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", " ", "0", ",", " ", "Li", ",", " ", "0", ",", " ", "0", 
          ",", " ", "1"}], "}"}], ",", "Lf", ",", "Lstep", ",", " ", 
        "MagnetName", ",", " ", "Polarization", ",", " ", "PhaseName", ",", 
        " ", "MagnetLength", ",", "\[Lambda]u", ",", " ", "Gap", ",", " ", 
        "\[Delta]P", ",", " ", "\[Delta]GV", ",", " ", "\[Delta]GH", ",", " ",
         "\[Delta]CP"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Elapsed time = \>\"", ",", 
    RowBox[{"(", 
     RowBox[{"t1", "-", "t0"}], ")"}], ",", "\"\< s\>\""}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8200481107642474`*^9, 3.8200481587837424`*^9}, {
   3.820048197117392*^9, 3.820048197937029*^9}, {3.8200509409117136`*^9, 
   3.820050944440159*^9}, {3.820051064048478*^9, 3.8200510642184086`*^9}, {
   3.8200512480184298`*^9, 3.8200512573242693`*^9}, {3.8200521112218113`*^9, 
   3.820052115329935*^9}, {3.8200630689414687`*^9, 3.8200631054369073`*^9}, {
   3.8200633049361115`*^9, 3.820063306815239*^9}, {3.820063371675081*^9, 
   3.8200633761430044`*^9}, {3.82006390421078*^9, 3.820063904720542*^9}, {
   3.8201495538865643`*^9, 3.8201495542966237`*^9}, {3.8201497915822363`*^9, 
   3.820149983546794*^9}, 3.8201500276496797`*^9, {3.8201501945306916`*^9, 
   3.8201501959708023`*^9}, {3.8201508544391437`*^9, 
   3.8201508593694563`*^9}, {3.820152769570441*^9, 3.820152771470558*^9}, {
   3.820152848715656*^9, 3.8201529443319683`*^9}, {3.820152999816786*^9, 
   3.8201530180679955`*^9}, {3.8201536575874186`*^9, 3.8201536681081467`*^9}, 
   3.8201539351575203`*^9, {3.8201568830223465`*^9, 3.8201568873025694`*^9}, {
   3.8201576175133305`*^9, 3.820157623623746*^9}, {3.820158038650758*^9, 
   3.8201580409408894`*^9}, {3.8201581036150494`*^9, 3.820158219334298*^9}, {
   3.820158294020669*^9, 3.820158317492241*^9}, {3.820158522885709*^9, 
   3.820158523105774*^9}, {3.8201623771057973`*^9, 3.8201623793259583`*^9}, {
   3.820171768247072*^9, 3.8201717774821677`*^9}, {3.820200993600941*^9, 
   3.8202009943409896`*^9}, {3.8202013544774323`*^9, 3.820201356777582*^9}, {
   3.820201399190357*^9, 3.8202014034206576`*^9}, {3.8202186498318267`*^9, 
   3.8202186522508497`*^9}, {3.820239702570224*^9, 3.8202397298559413`*^9}, {
   3.8202409211271954`*^9, 3.8202409448749666`*^9}, 3.8202410622086105`*^9, {
   3.8202413229716015`*^9, 3.820241336275093*^9}, {3.820241653205037*^9, 
   3.820241656443483*^9}, {3.820241878969374*^9, 3.8202418863357906`*^9}, 
   3.8202477570752707`*^9},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[207]:=",ExpressionUUID->"9b1f3ae8-d780-414a-a194-bb3df70cc905"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fieldmap saved in file: \"\>", 
   "\[InvisibleSpace]", \
"\<\"2021-01-21_DeltaSabia_Model02_WithoutRadiation_Kh=0.0_Kv=0.0_Z=-800_\
800mm_dGV.fld\"\>"}],
  SequenceForm[
  "Fieldmap saved in file: ", 
   "2021-01-21_DeltaSabia_Model02_WithoutRadiation_Kh=0.0_Kv=0.0_Z=-800_800mm_\
dGV.fld"],
  Editable->False]], "Print",
 CellChangeTimes->{3.820250660381768*^9},
 CellLabel->
  "During evaluation of \
In[207]:=",ExpressionUUID->"fd12edb5-710c-444b-9858-d984d97ea471"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"IDFieldMap: elapsed time = \"\>", "\[InvisibleSpace]", 
   "22.0142618`8.794249120422482", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm[
  "IDFieldMap: elapsed time = ", 22.0142618`8.794249120422482, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202506603917522`*^9},
 CellLabel->
  "During evaluation of \
In[207]:=",ExpressionUUID->"fe167e22-8102-4fa3-80a2-8802ff5a6bcc"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Elapsed time = \"\>", "\[InvisibleSpace]", 
   "61.725855`9.242012107802012", "\[InvisibleSpace]", "\<\" s\"\>"}],
  SequenceForm["Elapsed time = ", 61.725855`9.242012107802012, " s"],
  Editable->False]], "Print",
 CellChangeTimes->{3.8202506603917522`*^9},
 CellLabel->
  "During evaluation of \
In[207]:=",ExpressionUUID->"5cda469d-dfef-4673-a4aa-6068c45d9527"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1903, 987},
WindowMargins->{{0, Automatic}, {Automatic, 1}},
Magnification:>0.9 Inherited,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 2798, 39, 87, "Title",ExpressionUUID->"6afd2076-4493-4f08-b468-fa4711877d85"],
Cell[CellGroupData[{
Cell[3403, 65, 156, 3, 62, "Chapter",ExpressionUUID->"d737e070-6f97-4607-ac28-30ab012a12aa"],
Cell[CellGroupData[{
Cell[3584, 72, 206, 4, 60, "Section",ExpressionUUID->"0e22e4d4-c6dd-44c6-aced-c34f7308122d"],
Cell[CellGroupData[{
Cell[3815, 80, 339, 7, 59, "Input",ExpressionUUID->"3eccabbd-bb9c-4e0e-b532-6f6408da7c58"],
Cell[CellGroupData[{
Cell[4179, 91, 402, 9, 21, "Print",ExpressionUUID->"3d364ba5-65da-47ce-a437-88bb72ee250a"],
Cell[4584, 102, 236, 4, 21, "Print",ExpressionUUID->"580e8cc3-6795-4535-828b-c73a64713c7c"],
Cell[4823, 108, 252, 5, 21, "Print",ExpressionUUID->"1465ff4b-d002-403e-b748-6ac96e8fd977"],
Cell[5078, 115, 245, 4, 21, "Print",ExpressionUUID->"e77cf66a-c0df-45b5-aefe-a3826f3559b9"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[5384, 126, 154, 3, 60, "Section",ExpressionUUID->"3b9f4df9-b498-4bb2-a855-8df473489a1f"],
Cell[CellGroupData[{
Cell[5563, 133, 254, 4, 48, "Subsection",ExpressionUUID->"edd14911-287c-45ca-b6c8-e5cb4d8bede9"],
Cell[5820, 139, 37260, 732, 2255, "Input",ExpressionUUID->"d4295d6b-5e5f-4955-8ce4-9cdda100a50e"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[43129, 877, 209, 4, 48, "Section",ExpressionUUID->"f4366deb-1b60-41eb-9dc8-6ebd3361a7fc"],
Cell[CellGroupData[{
Cell[43363, 885, 185, 4, 48, "Subsection",ExpressionUUID->"2ad9b229-e14f-4a3a-8e5f-2858a5e5451b"],
Cell[43551, 891, 3939, 92, 560, "Input",ExpressionUUID->"068e143d-bd0f-46f2-9082-ce6f19ee2c7b"]
}, Closed]],
Cell[CellGroupData[{
Cell[47527, 988, 130, 3, 34, "Subsection",ExpressionUUID->"80d519b9-e0f1-46b9-b652-4e226e79bc05"],
Cell[47660, 993, 4998, 108, 680, "Input",ExpressionUUID->"d01a001e-9065-45b4-8e73-d9728b90eeea"]
}, Closed]],
Cell[CellGroupData[{
Cell[52695, 1106, 204, 4, 34, "Subsection",ExpressionUUID->"53ad71eb-17b9-4d6d-ac98-0730df07584e"],
Cell[52902, 1112, 4694, 104, 419, "Input",ExpressionUUID->"f619c123-566c-42f1-a68a-7bbe2814a613"]
}, Closed]],
Cell[CellGroupData[{
Cell[57633, 1221, 138, 3, 34, "Subsection",ExpressionUUID->"75a7f740-ea21-4afe-8108-05b029f59846"],
Cell[57774, 1226, 14397, 321, 707, "Input",ExpressionUUID->"bd41ff99-499b-46be-91ce-555d82436805"]
}, Closed]],
Cell[CellGroupData[{
Cell[72208, 1552, 142, 3, 34, "Subsection",ExpressionUUID->"bb19f30a-f850-414b-b3be-1dd929f5855c"],
Cell[72353, 1557, 6904, 156, 824, "Input",ExpressionUUID->"24664741-e07d-4598-8b68-6b4113008b82"]
}, Closed]],
Cell[CellGroupData[{
Cell[79294, 1718, 300, 5, 34, "Subsection",ExpressionUUID->"cdeaf6fe-40fd-4cda-8432-a30fc6389d80"],
Cell[79597, 1725, 6016, 135, 776, "Input",ExpressionUUID->"a88e2988-4885-46a3-ab3f-cbf916edb31d"]
}, Closed]],
Cell[CellGroupData[{
Cell[85650, 1865, 190, 4, 34, "Subsection",ExpressionUUID->"c7130cda-35d4-4dfa-aec2-ed9d1e576d19"],
Cell[85843, 1871, 4495, 104, 383, "Input",ExpressionUUID->"aa4fa799-86cd-462b-b44a-5bf06a051ea2"]
}, Closed]],
Cell[CellGroupData[{
Cell[90375, 1980, 210, 4, 34, "Subsection",ExpressionUUID->"316b54f4-260c-4ab7-bc23-0da6dd39fb46"],
Cell[90588, 1986, 8841, 189, 1160, "Input",ExpressionUUID->"40008148-2423-4d1a-aa09-6e0b7f4651d7"]
}, Closed]],
Cell[CellGroupData[{
Cell[99466, 2180, 266, 4, 34, "Subsection",ExpressionUUID->"b5d71522-78aa-4e39-b901-2b1c796bfe78"],
Cell[99735, 2186, 20971, 439, 2237, "Input",ExpressionUUID->"1691ba71-b213-4cf8-94e8-cd5d10f95e49"]
}, Closed]],
Cell[CellGroupData[{
Cell[120743, 2630, 190, 2, 34, "Subsection",ExpressionUUID->"dc98927d-e916-471e-b538-f605e04d23e3"],
Cell[120936, 2634, 12242, 294, 1103, "Input",ExpressionUUID->"494c7822-7765-4f5f-bf96-15e4412f31ad"]
}, Closed]],
Cell[CellGroupData[{
Cell[133215, 2933, 312, 5, 34, "Subsection",ExpressionUUID->"ba0c27f7-7afe-4d7f-bf71-31b954642dee"],
Cell[133530, 2940, 17764, 368, 1913, "Input",ExpressionUUID->"ee2a2080-707a-4eb3-87d9-c28ada49e95e"]
}, Closed]],
Cell[CellGroupData[{
Cell[151331, 3313, 248, 4, 34, "Subsection",ExpressionUUID->"157ca7c9-6722-4d5a-ad5b-229aadb8b0bc"],
Cell[151582, 3319, 7832, 177, 680, "Input",ExpressionUUID->"f697a71f-6997-415d-96c1-093eac60228d"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[159463, 3502, 208, 4, 48, "Section",ExpressionUUID->"5ae070d1-0cf0-4ac4-b054-32f42780450f"],
Cell[CellGroupData[{
Cell[159696, 3510, 163, 3, 48, "Subsection",ExpressionUUID->"c13b4fd0-95fa-44e0-b443-c53463a08608"],
Cell[159862, 3515, 96698, 2009, 8011, "Input",ExpressionUUID->"88230ced-7ab0-4c04-8a67-eb24bb06a7fd"]
}, Closed]],
Cell[CellGroupData[{
Cell[256597, 5529, 169, 3, 34, "Subsection",ExpressionUUID->"ed6540fc-c052-4b41-a1d1-11fc8d3448cf"],
Cell[256769, 5534, 1926, 46, 113, "Input",ExpressionUUID->"dbe544c3-e306-475e-8f6f-f45de39e73df"]
}, Closed]],
Cell[CellGroupData[{
Cell[258732, 5585, 198, 3, 34, "Subsection",ExpressionUUID->"07ebf3db-cb91-4b84-a9a7-c807351444a8"],
Cell[258933, 5590, 2995, 85, 280, "Input",ExpressionUUID->"55cadbff-321c-415c-8140-4da3fa8ee30a"]
}, Closed]],
Cell[CellGroupData[{
Cell[261965, 5680, 139, 3, 34, "Subsection",ExpressionUUID->"5bb9eb47-9ccd-4f6a-96cc-a524dcee03b5"],
Cell[262107, 5685, 1192, 29, 168, "Input",ExpressionUUID->"a1dde243-caf9-45aa-b999-a81e2e28e907"]
}, Closed]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[263360, 5721, 211, 4, 62, "Chapter",ExpressionUUID->"62a97ffb-394e-4e84-afed-3b5318232eab"],
Cell[263574, 5727, 1391, 22, 40, "Input",ExpressionUUID->"4c139ebb-aba3-4042-8355-2160f9f0f573"]
}, Open  ]],
Cell[CellGroupData[{
Cell[265002, 5754, 2103, 29, 62, "Chapter",ExpressionUUID->"14114740-1747-4179-b27c-fc3a885d635f"],
Cell[CellGroupData[{
Cell[267130, 5787, 255, 4, 60, "Section",ExpressionUUID->"203cdc6e-83ea-4360-b14c-6ae2bef4e227"],
Cell[267388, 5793, 15320, 347, 1373, "Input",ExpressionUUID->"7e941638-cf76-41c4-b8fa-d0bc095ce284"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[282757, 6146, 2262, 31, 62, "Chapter",ExpressionUUID->"1093adc8-81a2-4d0f-9b14-0bb8a553561a"],
Cell[CellGroupData[{
Cell[285044, 6181, 157, 3, 60, "Section",ExpressionUUID->"053c45df-8ca5-4967-baf7-b8ccd3a87258"],
Cell[CellGroupData[{
Cell[285226, 6188, 7100, 139, 527, "Input",ExpressionUUID->"f4b38c68-7e12-42de-8041-808a089820a4"],
Cell[CellGroupData[{
Cell[292351, 6331, 310, 8, 21, "Print",ExpressionUUID->"14fce203-3d39-40cf-a214-747e769c1373"],
Cell[292664, 6341, 526, 14, 21, "Print",ExpressionUUID->"3e2c1324-e8b7-4df4-8870-a35882a47910"],
Cell[293193, 6357, 441, 10, 21, "Print",ExpressionUUID->"9d61db12-cac8-4573-81df-4ec4bb812416"],
Cell[293637, 6369, 338, 9, 21, "Print",ExpressionUUID->"c9641b38-244b-438d-86aa-344b6affb64c"],
Cell[293978, 6380, 526, 14, 21, "Print",ExpressionUUID->"dc99ab99-59d8-4225-875a-c87026b6639c"],
Cell[294507, 6396, 439, 10, 21, "Print",ExpressionUUID->"47b43f16-afa8-4e6a-92f6-870141fddf9a"],
Cell[294949, 6408, 336, 9, 21, "Print",ExpressionUUID->"1a94137c-5527-4601-b624-278de172bc3e"],
Cell[295288, 6419, 524, 14, 21, "Print",ExpressionUUID->"cee11326-a691-4b92-90ed-8c69b584acfb"],
Cell[295815, 6435, 439, 10, 21, "Print",ExpressionUUID->"fe6578ac-2b11-4b28-bcb9-7f509efd6c11"],
Cell[296257, 6447, 340, 9, 21, "Print",ExpressionUUID->"87bbd9e6-7fbd-4d34-847a-c4ed9c3457aa"],
Cell[296600, 6458, 522, 14, 21, "Print",ExpressionUUID->"504532fc-1467-410e-b06e-5ac6650517be"],
Cell[297125, 6474, 439, 10, 21, "Print",ExpressionUUID->"0d61aa58-8786-4efa-a35d-0443d59e5f03"],
Cell[297567, 6486, 414, 9, 21, "Print",ExpressionUUID->"9dc14c0a-0fc6-4663-b464-fe95ddf82e5f"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[298042, 6502, 208, 4, 60, "Section",ExpressionUUID->"293453a5-abcf-4424-a928-43ea6fecda5f"],
Cell[CellGroupData[{
Cell[298275, 6510, 7204, 141, 527, "Input",ExpressionUUID->"4a778b85-2da4-4f4c-95b0-759decc84ff8"],
Cell[CellGroupData[{
Cell[305504, 6655, 310, 8, 21, "Print",ExpressionUUID->"499c0dd5-6071-4cba-a6d3-af5ef34de2d8"],
Cell[305817, 6665, 524, 14, 21, "Print",ExpressionUUID->"c478c19a-99f5-4b1b-a9c3-3a7edfca5035"],
Cell[306344, 6681, 441, 10, 21, "Print",ExpressionUUID->"d3b99824-d366-4d0f-b48c-2e90c427c5e1"],
Cell[306788, 6693, 338, 9, 21, "Print",ExpressionUUID->"a38c11d6-4021-40af-a07e-32b026d5f191"],
Cell[307129, 6704, 524, 14, 21, "Print",ExpressionUUID->"a9d5d437-499a-4d4e-9ff2-cc7190a0c0f3"],
Cell[307656, 6720, 439, 10, 21, "Print",ExpressionUUID->"5c87a11c-7fd4-4295-b42a-44ede4f34886"],
Cell[308098, 6732, 338, 9, 21, "Print",ExpressionUUID->"c5808032-a3b1-48ff-8b10-254d056563ad"],
Cell[308439, 6743, 526, 14, 21, "Print",ExpressionUUID->"c2a7cbe5-eb14-4fd9-a3a8-f26b700206fd"],
Cell[308968, 6759, 439, 10, 21, "Print",ExpressionUUID->"67cff6c8-c53a-4176-9e76-94eb12c9cc2b"],
Cell[309410, 6771, 340, 9, 21, "Print",ExpressionUUID->"adbb446e-3f4f-415a-a043-8a008072d0cd"],
Cell[309753, 6782, 526, 14, 21, "Print",ExpressionUUID->"85d3b6c9-116d-4ea4-8850-968d0c88ad1e"],
Cell[310282, 6798, 441, 10, 21, "Print",ExpressionUUID->"40708665-3ca5-4687-984f-a02793b30137"],
Cell[310726, 6810, 416, 9, 21, "Print",ExpressionUUID->"14e44b42-c042-4694-9ade-d0d616a64990"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[311215, 6827, 2310, 32, 62, "Chapter",ExpressionUUID->"1b06b555-66f5-4d5e-bd16-da67c7332007"],
Cell[CellGroupData[{
Cell[313550, 6863, 157, 3, 60, "Section",ExpressionUUID->"1e5882e0-f91f-42df-9307-d3db53d41218"],
Cell[CellGroupData[{
Cell[313732, 6870, 7146, 142, 509, "Input",ExpressionUUID->"6a42638e-6281-4e3d-a895-b99fabcf5636"],
Cell[CellGroupData[{
Cell[320903, 7016, 309, 8, 21, "Print",ExpressionUUID->"1d7997d7-023b-403e-bc13-18646f567850"],
Cell[321215, 7026, 527, 14, 21, "Print",ExpressionUUID->"a917581c-2087-43e5-9ff9-cb79999f8baf"],
Cell[321745, 7042, 442, 10, 21, "Print",ExpressionUUID->"98871d09-6e5a-4bcd-8f8c-9cbd1322eb6e"],
Cell[322190, 7054, 339, 9, 21, "Print",ExpressionUUID->"350f1194-9a9e-46da-a406-edaef15654fb"],
Cell[322532, 7065, 525, 14, 21, "Print",ExpressionUUID->"e19edec4-44d1-4e69-91fc-b86c6c31709e"],
Cell[323060, 7081, 440, 10, 21, "Print",ExpressionUUID->"47607753-540c-4079-a4db-389b1a80424c"],
Cell[323503, 7093, 337, 9, 21, "Print",ExpressionUUID->"e6c4275c-900a-4620-884e-b4402edc624d"],
Cell[323843, 7104, 527, 14, 21, "Print",ExpressionUUID->"639956b6-7fd8-4bf0-8cbe-95be674206f8"],
Cell[324373, 7120, 442, 10, 21, "Print",ExpressionUUID->"d99377a3-ca20-4e13-b10a-1923f471c580"],
Cell[324818, 7132, 341, 9, 21, "Print",ExpressionUUID->"3dff6eb3-431d-46a8-9875-cb19441a9610"],
Cell[325162, 7143, 527, 14, 21, "Print",ExpressionUUID->"c28d271f-484f-4989-a815-0b24ff419b18"],
Cell[325692, 7159, 440, 10, 21, "Print",ExpressionUUID->"deb744b3-488d-4c8c-a6ec-6e29608bb71f"],
Cell[326135, 7171, 417, 9, 21, "Print",ExpressionUUID->"9c796c64-0546-4398-b9a9-c4ff2523e4a9"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[326613, 7187, 208, 4, 60, "Section",ExpressionUUID->"2d0dd69f-9c7b-4d0f-afc6-dd6cd943a1ea"],
Cell[CellGroupData[{
Cell[326846, 7195, 7194, 142, 509, "Input",ExpressionUUID->"71e8d84d-ccda-4306-9525-06142fb93633"],
Cell[CellGroupData[{
Cell[334065, 7341, 311, 8, 21, "Print",ExpressionUUID->"0ba41a7c-5a22-492b-9a92-58154e5eadff"],
Cell[334379, 7351, 527, 14, 21, "Print",ExpressionUUID->"e756d1f8-70c8-42d4-8f03-bf2c2208c3e4"],
Cell[334909, 7367, 442, 10, 21, "Print",ExpressionUUID->"ee36e45f-6b9a-4517-b5af-25204a960e36"],
Cell[335354, 7379, 339, 9, 21, "Print",ExpressionUUID->"2e259d9b-3136-4380-97d9-fafc60927317"],
Cell[335696, 7390, 525, 14, 21, "Print",ExpressionUUID->"7462d561-2218-4937-9eb5-2efcb2cec49a"],
Cell[336224, 7406, 440, 10, 21, "Print",ExpressionUUID->"6d4e48b5-8328-4357-8383-86421fa64a41"],
Cell[336667, 7418, 337, 9, 21, "Print",ExpressionUUID->"a640c3b1-0f13-4863-8ee8-85491e928af3"],
Cell[337007, 7429, 525, 14, 21, "Print",ExpressionUUID->"4517c679-9247-4301-bfb1-def254fe35f2"],
Cell[337535, 7445, 438, 10, 21, "Print",ExpressionUUID->"cc6ef70d-9b6d-4a18-9e12-6478dd8777e5"],
Cell[337976, 7457, 341, 9, 21, "Print",ExpressionUUID->"4b98350a-e81b-4eeb-9e01-1d5d3fc13f05"],
Cell[338320, 7468, 525, 14, 21, "Print",ExpressionUUID->"d32bd10a-488d-4eb3-9301-ccabfdec95ad"],
Cell[338848, 7484, 442, 10, 21, "Print",ExpressionUUID->"4928c091-62d3-4c76-b749-422e71b36e94"],
Cell[339293, 7496, 415, 9, 21, "Print",ExpressionUUID->"6073d814-143b-414e-8259-fbeee181e45d"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[339781, 7513, 2362, 33, 62, "Chapter",ExpressionUUID->"5917cd86-5516-4bb5-8b29-ce4be1a5c9f7"],
Cell[CellGroupData[{
Cell[342168, 7550, 157, 3, 60, "Section",ExpressionUUID->"0e2d6539-eb6e-4db1-9262-0c2debe616e3"],
Cell[CellGroupData[{
Cell[342350, 7557, 7198, 142, 509, "Input",ExpressionUUID->"2c3c149e-6544-4629-b690-8405eca4c41f"],
Cell[CellGroupData[{
Cell[349573, 7703, 311, 8, 21, "Print",ExpressionUUID->"b134a5d8-8f48-4df0-a530-f98212024201"],
Cell[349887, 7713, 537, 14, 21, "Print",ExpressionUUID->"f1cff87a-7ddb-45ec-81d0-25a5c7c1bed0"],
Cell[350427, 7729, 438, 10, 21, "Print",ExpressionUUID->"c125984a-f8be-43ad-a5f4-e2985ad1e024"],
Cell[350868, 7741, 339, 9, 21, "Print",ExpressionUUID->"fc3907d6-2f1a-468d-b81e-85a84861c3d9"],
Cell[351210, 7752, 537, 14, 21, "Print",ExpressionUUID->"fd1e9bad-50f2-4e84-bc0b-beee3a580e83"],
Cell[351750, 7768, 442, 10, 21, "Print",ExpressionUUID->"44a006da-4615-45a1-9035-a4eb1e0f033d"],
Cell[352195, 7780, 339, 9, 21, "Print",ExpressionUUID->"0a732b2c-6b9a-42f7-b62a-161bf859a552"],
Cell[352537, 7791, 535, 14, 21, "Print",ExpressionUUID->"db8f4fcb-d47c-45b2-9b4a-c21b7e8ea08e"],
Cell[353075, 7807, 442, 10, 21, "Print",ExpressionUUID->"b1e0cc5f-d633-4104-8e51-b6f0aa145a69"],
Cell[353520, 7819, 341, 9, 21, "Print",ExpressionUUID->"49573079-013a-47a2-8c9c-5f6a1396bd41"],
Cell[353864, 7830, 537, 14, 21, "Print",ExpressionUUID->"9e519a8c-5345-4df9-bc1f-e4b96ff9fcc8"],
Cell[354404, 7846, 442, 10, 21, "Print",ExpressionUUID->"489f9a18-f4d5-4a14-9e04-6273f0c999f5"],
Cell[354849, 7858, 415, 9, 21, "Print",ExpressionUUID->"92df68c5-b35c-4b34-86dc-e265481eb99c"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[355325, 7874, 208, 4, 60, "Section",ExpressionUUID->"5e4b8abd-3ed5-4456-894c-11b2aed96dc0"],
Cell[CellGroupData[{
Cell[355558, 7882, 7248, 143, 509, "Input",ExpressionUUID->"3ce3934f-8311-42bf-a0d7-9854e8c54457"],
Cell[CellGroupData[{
Cell[362831, 8029, 311, 8, 21, "Print",ExpressionUUID->"244918dd-824c-4e97-b06f-a7af5bfd4779"],
Cell[363145, 8039, 537, 14, 21, "Print",ExpressionUUID->"ee9e81a5-dde2-424b-9f4c-e3e2b5c8b134"],
Cell[363685, 8055, 440, 10, 21, "Print",ExpressionUUID->"85abc03b-e1fc-4b07-8399-32e267b5ced6"],
Cell[364128, 8067, 339, 9, 21, "Print",ExpressionUUID->"6ab162cf-2e4c-4bc6-bf7d-4572e4544feb"],
Cell[364470, 8078, 537, 14, 21, "Print",ExpressionUUID->"3fbbbb8c-a21b-4f61-8381-a6f46eee3f4b"],
Cell[365010, 8094, 442, 10, 21, "Print",ExpressionUUID->"d791a5f0-48ab-4cc1-8a29-748d0dc08c57"],
Cell[365455, 8106, 339, 9, 21, "Print",ExpressionUUID->"c5e493d1-cdea-49e4-9830-2695581a881e"],
Cell[365797, 8117, 537, 14, 21, "Print",ExpressionUUID->"630041cc-f59a-4867-9b65-8474cb94b58c"],
Cell[366337, 8133, 440, 10, 21, "Print",ExpressionUUID->"5933ab74-b6f7-4f6d-a996-cc0061c32a67"],
Cell[366780, 8145, 339, 9, 21, "Print",ExpressionUUID->"242f7897-268b-4b93-baf2-94deb6989d1f"],
Cell[367122, 8156, 537, 14, 21, "Print",ExpressionUUID->"9c60a640-3af5-465f-8f67-5df0de28aff6"],
Cell[367662, 8172, 442, 10, 21, "Print",ExpressionUUID->"e4f9c427-3bc9-4c67-afb3-78c2c54997b3"],
Cell[368107, 8184, 415, 9, 21, "Print",ExpressionUUID->"4542b4ce-d1b2-41c4-96c6-599f3ea3f1b0"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[368595, 8201, 2481, 34, 62, "Chapter",ExpressionUUID->"0c821744-7c1c-4f36-b521-85f8e95aa7dc"],
Cell[CellGroupData[{
Cell[371101, 8239, 157, 3, 60, "Section",ExpressionUUID->"278e3bb1-c860-4919-b016-2a0e35d70ab2"],
Cell[CellGroupData[{
Cell[371283, 8246, 7250, 143, 509, "Input",ExpressionUUID->"7e477691-f526-4288-9624-caa408c1c77c"],
Cell[CellGroupData[{
Cell[378558, 8393, 309, 8, 21, "Print",ExpressionUUID->"9bebe6dd-93a3-4af4-ac38-dcbd7a8ad9d5"],
Cell[378870, 8403, 535, 14, 21, "Print",ExpressionUUID->"46b277a6-b846-4b0b-b1a1-ee328ddefcc4"],
Cell[379408, 8419, 440, 10, 21, "Print",ExpressionUUID->"ffb0b7dd-7d07-4488-99c9-d4d9209959cf"],
Cell[379851, 8431, 337, 9, 21, "Print",ExpressionUUID->"80972ad2-9098-4b7f-a8e2-171088d3dec7"],
Cell[380191, 8442, 537, 14, 21, "Print",ExpressionUUID->"749c43bb-3f48-43f9-aafd-933d62c1923f"],
Cell[380731, 8458, 440, 10, 21, "Print",ExpressionUUID->"3d0128ab-5d05-4f42-a3ce-f9ec0e87a13d"],
Cell[381174, 8470, 337, 9, 21, "Print",ExpressionUUID->"a06639c5-fcf3-42b1-95f7-ee0965c71dbe"],
Cell[381514, 8481, 535, 14, 21, "Print",ExpressionUUID->"729cfde9-4485-426e-8489-ac596e3f3e1c"],
Cell[382052, 8497, 438, 10, 21, "Print",ExpressionUUID->"54b1e933-bbb9-4d7c-94c1-8e2b61e67a82"],
Cell[382493, 8509, 339, 9, 21, "Print",ExpressionUUID->"d751b5c4-5c8f-456a-8156-8127df3e0f00"],
Cell[382835, 8520, 535, 14, 21, "Print",ExpressionUUID->"8a4b7772-4928-44cf-8eb3-e0f0268bd31d"],
Cell[383373, 8536, 442, 10, 21, "Print",ExpressionUUID->"ccdc691e-7dc0-458d-a2fe-18fdfbf52db2"],
Cell[383818, 8548, 417, 9, 21, "Print",ExpressionUUID->"ee499e2a-7ba5-4176-8f93-5a610deaf282"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[384296, 8564, 208, 4, 60, "Section",ExpressionUUID->"8a6af01e-5de7-4476-93dd-ba048430b4d9"],
Cell[CellGroupData[{
Cell[384529, 8572, 7304, 144, 509, "Input",ExpressionUUID->"a1749903-7203-4dfa-9708-30cff12a7aa9"],
Cell[CellGroupData[{
Cell[391858, 8720, 309, 8, 21, "Print",ExpressionUUID->"ebec0e90-9a0d-4e74-b337-444945df226b"],
Cell[392170, 8730, 537, 14, 21, "Print",ExpressionUUID->"ad8a463b-6480-4f6b-8625-3fb1058ea224"],
Cell[392710, 8746, 442, 10, 21, "Print",ExpressionUUID->"39572aa8-7259-4f68-9d21-981cee9cda11"],
Cell[393155, 8758, 337, 9, 21, "Print",ExpressionUUID->"41798388-95b6-4094-9c37-4d436ba6869e"],
Cell[393495, 8769, 537, 14, 21, "Print",ExpressionUUID->"02e3d1ed-7f04-45d4-b742-17a28924199b"],
Cell[394035, 8785, 442, 10, 21, "Print",ExpressionUUID->"9173dda8-415e-414f-8709-c89a7d9d53b7"],
Cell[394480, 8797, 339, 9, 21, "Print",ExpressionUUID->"60b94101-1202-41d1-b2f1-13242bda1c9d"],
Cell[394822, 8808, 535, 14, 21, "Print",ExpressionUUID->"fe226d12-c004-49a6-9d19-ab642ddb2440"],
Cell[395360, 8824, 436, 10, 21, "Print",ExpressionUUID->"b50a7ef9-4555-4dca-9372-afff221f0e77"],
Cell[395799, 8836, 339, 9, 21, "Print",ExpressionUUID->"a6c2021a-e64c-4beb-9583-db7111f48a51"],
Cell[396141, 8847, 535, 14, 21, "Print",ExpressionUUID->"f703f4a1-96e8-4f63-9a67-4a125c1c113c"],
Cell[396679, 8863, 440, 10, 21, "Print",ExpressionUUID->"42113784-b075-44a7-8213-739bbb4dc52d"],
Cell[397122, 8875, 415, 9, 21, "Print",ExpressionUUID->"c4dffb06-fc6a-4eb5-9f49-088baf1d2fcd"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[397610, 8892, 2478, 34, 62, "Chapter",ExpressionUUID->"1f878c74-c86b-4f64-a3cd-19b138092c7c"],
Cell[CellGroupData[{
Cell[400113, 8930, 157, 3, 60, "Section",ExpressionUUID->"a4d8a82d-2df6-44be-9cb5-af8e7e1a5f9b"],
Cell[CellGroupData[{
Cell[400295, 8937, 7290, 144, 509, "Input",ExpressionUUID->"8dea78c3-e942-4fa2-a6e9-ef1476b6bb5a"],
Cell[CellGroupData[{
Cell[407610, 9085, 309, 8, 21, "Print",ExpressionUUID->"caa972cf-3209-48a1-ad3a-1542b48c7bb4"],
Cell[407922, 9095, 535, 14, 21, "Print",ExpressionUUID->"fde1fd47-a636-46c7-b09c-4f2958f72913"],
Cell[408460, 9111, 442, 10, 21, "Print",ExpressionUUID->"97426c25-c4c6-47fc-8489-791761652253"],
Cell[408905, 9123, 339, 9, 21, "Print",ExpressionUUID->"64af72e9-da0a-43db-87d7-2a3a1c190431"],
Cell[409247, 9134, 535, 14, 21, "Print",ExpressionUUID->"634d119d-7ffa-4f4d-ac07-1504467f2282"],
Cell[409785, 9150, 438, 10, 21, "Print",ExpressionUUID->"eb3cf253-13f6-4a3c-a1e4-74f6cc45dc33"],
Cell[410226, 9162, 337, 9, 21, "Print",ExpressionUUID->"1f854546-7c36-4125-ad1b-c147d6c012df"],
Cell[410566, 9173, 534, 14, 21, "Print",ExpressionUUID->"624f5380-0c3e-4b44-a3f7-b75a7b898512"],
Cell[411103, 9189, 438, 10, 21, "Print",ExpressionUUID->"6e241372-e9ca-43c7-a787-592ce3ed0836"],
Cell[411544, 9201, 339, 9, 21, "Print",ExpressionUUID->"eeaae044-5f88-4157-80d5-ea1aa6e62001"],
Cell[411886, 9212, 537, 14, 21, "Print",ExpressionUUID->"92a7b973-6413-48ba-916c-9db5d89564f9"],
Cell[412426, 9228, 440, 10, 21, "Print",ExpressionUUID->"6d2a6c51-1283-42c2-9f6f-495245dfeed1"],
Cell[412869, 9240, 413, 9, 21, "Print",ExpressionUUID->"c9b5c6e1-9b86-4f84-9092-9e12e1c6bd2f"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[413343, 9256, 208, 4, 60, "Section",ExpressionUUID->"71874014-ed78-4af7-8eb7-6b9584f50b63"],
Cell[CellGroupData[{
Cell[413576, 9264, 7346, 145, 509, "Input",ExpressionUUID->"1b23cff8-b2cb-4916-89b2-000eb8cd33a1"],
Cell[CellGroupData[{
Cell[420947, 9413, 311, 8, 21, "Print",ExpressionUUID->"4d5507c1-25cd-4276-b255-9755e46fed95"],
Cell[421261, 9423, 534, 14, 21, "Print",ExpressionUUID->"4cc6f6f9-58c2-419d-81e6-ab8c9a66da9c"],
Cell[421798, 9439, 437, 10, 21, "Print",ExpressionUUID->"8a1fe4ab-ddf9-4142-8269-34f6dd40a720"],
Cell[422238, 9451, 339, 9, 21, "Print",ExpressionUUID->"ba2674f3-b75a-4d94-842e-44a9788e11d1"],
Cell[422580, 9462, 537, 14, 21, "Print",ExpressionUUID->"3ac659fa-9bf4-433a-b3dd-d22973be305b"],
Cell[423120, 9478, 438, 10, 21, "Print",ExpressionUUID->"ea5c5c16-fb65-4fdd-9e18-11b76200205e"],
Cell[423561, 9490, 337, 9, 21, "Print",ExpressionUUID->"efab6a62-2169-4c06-9b82-4df90dc2ca6f"],
Cell[423901, 9501, 533, 14, 21, "Print",ExpressionUUID->"674b3917-1c8b-481c-afde-5d79ea05a3c4"],
Cell[424437, 9517, 442, 10, 21, "Print",ExpressionUUID->"2934c1b3-277b-469c-992c-3b78e41052a5"],
Cell[424882, 9529, 341, 9, 21, "Print",ExpressionUUID->"d2cb4b27-b15b-4383-8d14-9d941bc00120"],
Cell[425226, 9540, 537, 14, 21, "Print",ExpressionUUID->"257cc543-0802-423d-a185-d2794cef6217"],
Cell[425766, 9556, 440, 10, 21, "Print",ExpressionUUID->"c90f9f3f-3e33-47ff-b6ea-f68e98ea617f"],
Cell[426209, 9568, 417, 9, 21, "Print",ExpressionUUID->"0247baa8-c292-48b3-9e4d-a4ac89896be2"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[426699, 9585, 2460, 34, 62, "Chapter",ExpressionUUID->"930c4d10-6381-4203-810f-2f248a6c1542"],
Cell[CellGroupData[{
Cell[429184, 9623, 7412, 145, 509, "Input",ExpressionUUID->"71a25101-c494-48eb-ae85-58252ce6792c"],
Cell[CellGroupData[{
Cell[436621, 9772, 319, 8, 21, "Print",ExpressionUUID->"d2b7a1a5-ae7a-4366-84db-db1025912e0f"],
Cell[436943, 9782, 521, 14, 21, "Print",ExpressionUUID->"2a7384e0-6732-4f62-8e9f-80e66c86608c"],
Cell[437467, 9798, 440, 10, 21, "Print",ExpressionUUID->"4eca2ebf-7a3a-45f1-b71d-c49591247a12"],
Cell[437910, 9810, 317, 8, 21, "Print",ExpressionUUID->"838ebb14-d363-4805-a8cd-64587be3452b"],
Cell[438230, 9820, 521, 14, 21, "Print",ExpressionUUID->"a5973d91-8f52-4ed2-979e-0bbdf8f04011"],
Cell[438754, 9836, 438, 10, 21, "Print",ExpressionUUID->"b33e8e65-ba2f-48b2-9902-0394c6e40d18"],
Cell[439195, 9848, 319, 8, 21, "Print",ExpressionUUID->"796c9efa-730f-4220-a2d3-a9b42b17417b"],
Cell[439517, 9858, 521, 14, 21, "Print",ExpressionUUID->"9605f601-d1f6-48dc-9218-8be77c6cceea"],
Cell[440041, 9874, 440, 10, 21, "Print",ExpressionUUID->"f31a9910-8a3f-4c0a-b256-d924724ae62a"],
Cell[440484, 9886, 413, 9, 21, "Print",ExpressionUUID->"5ba0adcc-3fdd-4dc0-83e7-4435480ebf0c"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[440958, 9902, 2512, 35, 62, "Chapter",ExpressionUUID->"dcccadcc-d6f2-47fc-96b2-04a6ac5c2e66"],
Cell[CellGroupData[{
Cell[443495, 9941, 157, 3, 60, "Section",ExpressionUUID->"3e3631be-f887-46ed-9785-a5e2cf2b0e4f"],
Cell[CellGroupData[{
Cell[443677, 9948, 6839, 135, 437, "Input",ExpressionUUID->"0abaf0a7-9319-4811-b267-0097b6734244"],
Cell[CellGroupData[{
Cell[450541, 10087, 521, 14, 21, "Print",ExpressionUUID->"5ef396e3-56b6-4813-8f76-452a01e1f22c"],
Cell[451065, 10103, 440, 10, 21, "Print",ExpressionUUID->"d1b3326b-99aa-4094-8ba7-d9d81eb5e22e"],
Cell[451508, 10115, 412, 9, 21, "Print",ExpressionUUID->"84b8db07-79b8-4ef0-8144-3f97ae00f3af"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[451981, 10131, 208, 4, 60, "Section",ExpressionUUID->"e5cf1f3c-072c-4389-9e8f-7bfcd85b8467"],
Cell[CellGroupData[{
Cell[452214, 10139, 6839, 135, 437, "Input",ExpressionUUID->"9b1f3ae8-d780-414a-a194-bb3df70cc905"],
Cell[CellGroupData[{
Cell[459078, 10278, 519, 14, 21, "Print",ExpressionUUID->"fd12edb5-710c-444b-9858-d984d97ea471"],
Cell[459600, 10294, 442, 10, 21, "Print",ExpressionUUID->"fe167e22-8102-4fa3-80a2-8802ff5a6bcc"],
Cell[460045, 10306, 413, 9, 21, "Print",ExpressionUUID->"5cda469d-dfef-4673-a4aa-6068c45d9527"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

